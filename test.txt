./rd/app/controller/cAccessPoints.js:            if(!Ext.WindowManager.get('winAccessPointEditApId')){
./rd/app/controller/cAccessPoints.js:                    id              :'winAccessPointEditApId',
./rd/app/controller/cAccessPointEdits.js:            if(!Ext.WindowManager.get('winAccessPointEditApId')){
./rd/app/controller/cAccessPointEdits.js:                    id              :'winAccessPointEditApId',
./rd/build/production/Rd/app.js:(Ext.cmd.derive("Ext.ux.desktop.Wallpaper",Ext.Component,{cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',stretch:false,wallpaper:null,stateful:true,stateId:"desk-wallpaper",afterRender:function(){var b=this;Ext.Component.prototype.afterRender.call(this);b.setWallpaper(b.wallpaper,b.stretch)},applyState:function(){var d=this,e=d.wallpaper;Ext.Component.prototype.applyState.apply(this,arguments);if(e!=d.wallpaper){d.setWallpaper(d.wallpaper)}},getState:function(){return this.wallpaper&&{wallpaper:this.wallpaper}},setWallpaper:function(h,i){var l=this,j,k;l.stretch=(i!==false);l.wallpaper=h;if(l.rendered){j=l.el.dom.firstChild;if(!h||h==Ext.BLANK_IMAGE_URL){Ext.fly(j).hide()}else{if(l.stretch){j.src=h;l.el.removeCls("ux-wallpaper-tiled");Ext.fly(j).setStyle({width:"100%",height:"100%"}).show()}else{Ext.fly(j).hide();k="url("+h+")";l.el.addCls("ux-wallpaper-tiled")}}l.el.setStyle({backgroundImage:k||""});if(l.stateful){l.saveState()}}return l}},0,["wallpaper"],["component","box","wallpaper"],{component:true,box:true,wallpaper:true},["widget.wallpaper"],0,[Ext.ux.desktop,"Wallpaper"],0));(Ext.cmd.derive("Ext.ux.event.RecorderManager",Ext.panel.Panel,{layout:"fit",buttonAlign:"left",eventsToIgnore:{mousemove:1,mouseover:1,mouseout:1},bodyBorder:false,playSpeed:1,initComponent:function(){var e=this;e.recorder=new Ext.ux.event.Recorder({attachTo:e.attachTo,listeners:{add:e.updateEvents,coalesce:e.updateEvents,buffer:200,scope:e}});e.recorder.eventsToRecord=Ext.apply({},e.recorder.eventsToRecord);function h(a,b){return{text:a,speed:b,group:"speed",checked:b==e.playSpeed,handler:e.onPlaySpeed,scope:e}}e.tbar=[{text:"Record",xtype:"splitbutton",whenIdle:true,handler:e.onRecord,scope:e,menu:e.makeRecordButtonMenu()},{text:"Play",xtype:"splitbutton",whenIdle:true,handler:e.onPlay,scope:e,menu:[h("Qarter Speed (0.25x)",0.25),h("Half Speed (0.5x)",0.5),h("3/4 Speed (0.75x)",0.75),"-",h("Recorded Speed (1x)",1),h("Double Speed (2x)",2),h("Quad Speed (4x)",4),"-",h("Full Speed",1000)]},{text:"Clear",whenIdle:true,handler:e.onClear,scope:e},"->",{text:"Stop",whenActive:true,disabled:true,handler:e.onStop,scope:e}];var g=e.attachTo&&e.attachTo.testEvents;e.items=[{xtype:"textarea",itemId:"eventView",fieldStyle:"font-family: monospace",selectOnFocus:true,emptyText:"Events go here!",value:g?e.stringifyEvents(g):"",scrollToBottom:function(){var a=this.inputEl.dom;a.scrollTop=a.scrollHeight}}];e.fbar=[{xtype:"tbtext",text:"Attached To: "+(e.attachTo&&e.attachTo.location.href)}];Ext.panel.Panel.prototype.initComponent.call(this)},makeRecordButtonMenu:function(){var h=[],l={},j=this.recorder.eventsToRecord,k=this.eventsToIgnore;Ext.Object.each(j,function(d,a){var b=l[a.kind];if(!b){l[a.kind]=b=[];h.push({text:a.kind,menu:b})}b.push({text:d,checked:true,handler:function(e){if(e.checked){j[d]=a}else{delete j[d]}}});if(k[d]){b[b.length-1].checked=false;Ext.Function.defer(function(){delete j[d]},1)}});function i(b,a){return(b.text<a.text)?-1:((a.text<b.text)?1:0)}h.sort(i);Ext.Array.each(h,function(a){a.menu.sort(i)});return h},getEventView:function(){return this.down("#eventView")},onClear:function(){var b=this.getEventView();b.setValue("")},onPlay:function(){var h=this,g=h.getEventView(),e=g.getValue();if(e){e=Ext.decode(e);if(e.length){h.player=Ext.create("Ext.ux.event.Player",{attachTo:window.opener,eventQueue:e,speed:h.playSpeed,listeners:{stop:h.onPlayStop,scope:h}});h.player.start();h.syncBtnUI()}}},onPlayStop:function(){this.player=null;this.syncBtnUI()},onPlaySpeed:function(b){this.playSpeed=b.speed},onRecord:function(){this.recorder.start();this.syncBtnUI()},onStop:function(){var b=this;if(b.player){b.player.stop();b.player=null}else{b.recorder.stop()}b.syncBtnUI();b.updateEvents()},syncBtnUI:function(){var h=this,e=!h.player&&!h.recorder.active;Ext.each(h.query("[whenIdle]"),function(a){a.setDisabled(!e)});Ext.each(h.query("[whenActive]"),function(a){a.setDisabled(e)});var g=h.getEventView();g.setReadOnly(!e)},stringifyEvents:function(h){var e,g=[];Ext.each(h,function(a){e=[];Ext.Object.each(a,function(d,b){if(e.length){e.push(", ")}else{e.push("  { ")}e.push(d,": ");e.push(Ext.encode(b))});e.push(" }");g.push(e.join(""))});return"[\n"+g.join(",\n")+"\n]"},updateEvents:function(){var e=this,h=e.stringifyEvents(e.recorder.getRecordedEvents()),g=e.getEventView();g.setValue(h);g.scrollToBottom()}},0,["eventrecordermanager"],["component","box","container","panel","eventrecordermanager"],{component:true,box:true,container:true,panel:true,eventrecordermanager:true},["widget.eventrecordermanager"],0,[Ext.ux.event,"RecorderManager"],0));(Ext.cmd.derive("Ext.ux.form.MultiSelect",Ext.form.FieldContainer,{alternateClassName:"Ext.ux.Multiselect",layout:"anchor",ddReorder:false,appendOnly:false,displayField:"text",allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:"This field is required",minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) required",delimiter:",",dragText:"{0} Item{1}",ignoreSelectChange:0,pageSize:10,initComponent:function(){var b=this;b.items=b.setupItems();b.bindStore(b.store,true);Ext.form.FieldContainer.prototype.initComponent.call(this);b.initField()},setupItems:function(){var b=this;b.boundList=new Ext.view.BoundList(Ext.apply({anchor:"none 100%",border:1,multiSelect:true,store:b.store,displayField:b.displayField,disabled:b.disabled,tabIndex:0,navigationModel:{type:"default"}},b.listConfig));b.boundList.getNavigationModel().addKeyBindings({pageUp:b.onKeyPageUp,pageDown:b.onKeyPageDown,scope:b});b.boundList.getSelectionModel().on("selectionchange",b.onSelectChange,b);b.boundList.pickerField=b;if(!b.title){return b.boundList}b.boundList.border=false;return{xtype:"panel",isAriaRegion:false,border:true,anchor:"none 100%",layout:"anchor",title:b.title,tbar:b.tbar,items:b.boundList}},onSelectChange:function(e,d){if(!this.ignoreSelectChange){this.setValue(d)}},getSelected:function(){return this.boundList.getSelectionModel().getSelection()},isEqual:function(j,k){var h=Ext.Array.from,l=0,i;j=h(j);k=h(k);i=j.length;if(i!==k.length){return false}for(;l<i;l++){if(k[l]!==j[l]){return false}}return true},afterRender:function(){var i=this,j=i.boundList,g,h;Ext.form.FieldContainer.prototype.afterRender.call(this);if(i.selectOnRender){g=i.getRecordsForValue(i.value);if(g.length){++i.ignoreSelectChange;i.boundList.getSelectionModel().select(g);--i.ignoreSelectChange}delete i.toSelect}if(i.ddReorder&&!i.dragGroup&&!i.dropGroup){i.dragGroup=i.dropGroup="MultiselectDD-"+Ext.id()}if(i.draggable||i.dragGroup){i.dragZone=Ext.create("Ext.view.DragZone",{view:i.boundList,ddGroup:i.dragGroup,dragText:i.dragText})}if(i.droppable||i.dropGroup){i.dropZone=Ext.create("Ext.view.DropZone",{view:i.boundList,ddGroup:i.dropGroup,handleNodeDrop:function(a,b,p){var o=this.view,e=o.getStore(),n=a.records,d;a.view.store.remove(n);d=e.indexOf(b);if(p==="after"){d++}e.insert(d,n);o.getSelectionModel().select(n);i.fireEvent("drop",i,n)}})}h=i.down("panel");if(h&&j){j.ariaEl.dom.setAttribute("aria-labelledby",h.header.id+"-title-textEl")}},onKeyPageUp:function(l){var m=this,e=m.pageSize,p=m.boundList,k=p.getNavigationModel(),o,n;o=k.recordIndex;n=o>e?o-e:0;k.setPosition(n,l)},onKeyPageDown:function(m){var n=this,e=n.pageSize,r=n.boundList,l=r.getNavigationModel(),o,q,p;o=r.getStore().getCount();q=l.recordIndex;p=q<(o-e)?q+e:o-1;l.setPosition(p,m)},isValid:function(){var e=this,g=e.disabled,h=e.forceValidation||!g;return h?e.validateValue(e.value):g},validateValue:function(g){var h=this,i=h.getErrors(g),j=Ext.isEmpty(i);if(!h.preventMark){if(j){h.clearInvalid()}else{h.markInvalid(i)}}return j},markInvalid:function(h){var e=this,g=e.getActiveError();e.setActiveErrors(Ext.Array.from(h));if(g!==e.getActiveError()){e.updateLayout()}},clearInvalid:function(){var d=this,e=d.hasActiveError();d.unsetActiveError();if(e){d.updateLayout()}},getSubmitData:function(){var g=this,e=null,h;if(!g.disabled&&g.submitValue&&!g.isFileUpload()){h=g.getSubmitValue();if(h!==null){e={};e[g.getName()]=h}}return e},getSubmitValue:function(){var e=this,g=e.delimiter,h=e.getValue();return Ext.isString(g)?h.join(g):h},getValue:function(){return this.value||[]},getRecordsForValue:function(p){var q=this,w=[],o=q.store.getRange(),i=q.valueField,s=0,j=o.length,u,t,r;for(r=p.length;s<r;++s){for(t=0;t<j;++t){u=o[t];if(u.get(i)==p[s]){w.push(u)}}}return w},setupValue:function(l){var i=this.delimiter,o=this.valueField,n=0,p,k,m;if(Ext.isDefined(l)){if(i&&Ext.isString(l)){l=l.split(i)}else{if(!Ext.isArray(l)){l=[l]}}for(k=l.length;n<k;++n){m=l[n];if(m&&m.isModel){l[n]=m.get(o)}}p=Ext.Array.unique(l)}else{p=[]}return p},setValue:function(i){var j=this,g=j.boundList.getSelectionModel(),h=j.store;if(!h.getCount()){h.on({load:Ext.Function.bind(j.setValue,j,[i]),single:true});return}i=j.setupValue(i);j.mixins.field.setValue.call(j,i);if(j.rendered){++j.ignoreSelectChange;g.deselectAll();if(i.length){g.select(j.getRecordsForValue(i))}--j.ignoreSelectChange}else{j.selectOnRender=true}},clearValue:function(){this.setValue([])},onEnable:function(){var b=this.boundList;Ext.form.FieldContainer.prototype.onEnable.call(this);if(b){b.enable()}},onDisable:function(){var b=this.boundList;Ext.form.FieldContainer.prototype.onDisable.call(this);if(b){b.disable()}},getErrors:function(h){var i=this,l=Ext.String.format,j=[],k;h=Ext.Array.from(h||i.getValue());k=h.length;if(!i.allowBlank&&k<1){j.push(i.blankText)}if(k<i.minSelections){j.push(l(i.minSelectionsText,i.minSelections))}if(k>i.maxSelections){j.push(l(i.maxSelectionsText,i.maxSelections))}return j},doDestroy:function(){var b=this;b.bindStore(null);Ext.destroy(b.dragZone,b.dropZone,b.keyNav);Ext.form.FieldContainer.prototype.doDestroy.call(this)},onBindStore:function(g){var h=this,e=this.boundList;if(g.autoCreated){h.resolveDisplayField()}if(!Ext.isDefined(h.valueField)){h.valueField=h.displayField}if(e){e.bindStore(g)}},resolveDisplayField:function(){var h=this,e=h.boundList,g=h.getStore();h.valueField=h.displayField="field1";if(!g.expanded){h.displayField="field2"}if(e){e.setDisplayField(h.displayField)}}},0,["multiselectfield","multiselect"],["component","box","container","fieldcontainer","multiselectfield","multiselect"],{component:true,box:true,container:true,fieldcontainer:true,multiselectfield:true,multiselect:true},["widget.multiselect","widget.multiselectfield"],[[Ext.util.StoreHolder.prototype.mixinId||Ext.util.StoreHolder.$className,Ext.util.StoreHolder],[Ext.form.field.Field.prototype.mixinId||Ext.form.field.Field.$className,Ext.form.field.Field]],[Ext.ux.form,"MultiSelect",Ext.ux,"Multiselect"],0));(Ext.cmd.derive("Ext.ux.form.ItemSelector",Ext.ux.form.MultiSelect,{alternateClassName:["Ext.ux.ItemSelector"],hideNavIcons:false,buttons:["top","up","add","remove","down","bottom"],buttonsText:{top:"Move to Top",up:"Move Up",add:"Add to Selected",remove:"Remove from Selected",down:"Move Down",bottom:"Move to Bottom"},layout:{type:"hbox",align:"stretch"},ariaRole:"group",initComponent:function(){var b=this;b.ddGroup=b.id+"-dd";b.ariaRenderAttributes=b.ariaRenderAttributes||{};b.ariaRenderAttributes["aria-labelledby"]=b.id+"-labelEl";Ext.ux.form.MultiSelect.prototype.initComponent.call(this);b.bindStore(b.store)},createList:function(d){var e=this;return Ext.create("Ext.ux.form.MultiSelect",{submitValue:false,getSubmitData:function(){return null},getModelData:function(){return null},flex:1,dragGroup:e.ddGroup,dropGroup:e.ddGroup,title:d,store:{model:e.store.model,data:[]},displayField:e.displayField,valueField:e.valueField,disabled:e.disabled,listeners:{boundList:{scope:e,itemdblclick:e.onItemDblClick,drop:e.syncValue}}})},setupItems:function(){var b=this;b.fromField=b.createList(b.fromTitle);b.toField=b.createList(b.toTitle);return[b.fromField,{xtype:"toolbar",margin:"0 4",padding:0,layout:{type:"vbox",pack:"center"},items:b.createButtons()},b.toField]},createButtons:function(){var d=this,e=[];if(!d.hideNavIcons){Ext.Array.forEach(d.buttons,function(a){e.push({xtype:"button",ui:"default",tooltip:d.buttonsText[a],ariaLabel:d.buttonsText[a],handler:d["on"+Ext.String.capitalize(a)+"BtnClick"],cls:"x-form-itemselector-btn",iconCls:"x-form-itemselector-"+a,navBtn:true,scope:d,margin:"4 0 0 0"})})}return e},getSelections:function(d){var e=d.getStore();return Ext.Array.sort(d.getSelectionModel().getSelection(),function(a,b){a=e.indexOf(a);b=e.indexOf(b);if(a<b){return -1}else{if(a>b){return 1}}return 0})},onTopBtnClick:function(){var h=this.toField.boundList,g=h.getStore(),e=this.getSelections(h);g.suspendEvents();g.remove(e,true);g.insert(0,e);g.resumeEvents();h.refresh();this.syncValue();h.getSelectionModel().select(e)},onBottomBtnClick:function(){var h=this.toField.boundList,g=h.getStore(),e=this.getSelections(h);g.suspendEvents();g.remove(e,true);g.add(e);g.resumeEvents();h.refresh();this.syncValue();h.getSelectionModel().select(e)},onUpBtnClick:function(){var m=this.toField.boundList,i=m.getStore(),n=this.getSelections(m),l,o=0,k=n.length,p=0;i.suspendEvents();for(;o<k;++o,p++){l=n[o];p=Math.max(p,i.indexOf(l)-1);i.remove(l,true);i.insert(p,l)}i.resumeEvents();m.refresh();this.syncValue();m.getSelectionModel().select(n)},onDownBtnClick:function(){var l=this.toField.boundList,j=l.getStore(),m=this.getSelections(l),k,n=m.length-1,i=j.getCount()-1;j.suspendEvents();for(;n>-1;--n,i--){k=m[n];i=Math.min(i,j.indexOf(k)+1);j.remove(k,true);j.insert(i,k)}j.resumeEvents();l.refresh();this.syncValue();l.getSelectionModel().select(m)},onAddBtnClick:function(){var d=this,e=d.getSelections(d.fromField.boundList);d.moveRec(true,e);d.toField.boundList.getSelectionModel().select(e)},onRemoveBtnClick:function(){var d=this,e=d.getSelections(d.toField.boundList);d.moveRec(false,e);d.fromField.boundList.getSelectionModel().select(e)},moveRec:function(m,n){var p=this,l=p.fromField,k=p.toField,j=m?l.store:k.store,o=m?k.store:l.store;j.suspendEvents();o.suspendEvents();j.remove(n);o.add(n);j.resumeEvents();o.resumeEvents();if(l.boundList.containsFocus){l.boundList.focus()}l.boundList.refresh();k.boundList.refresh();p.syncValue()},syncValue:function(){var b=this;b.mixins.field.setValue.call(b,b.setupValue(b.toField.store.getRange()))},onItemDblClick:function(e,d){this.moveRec(e===this.fromField.boundList,d)},setValue:function(m){var o=this,l=o.fromField,k=o.toField,j=l.store,n=k.store,p;if(!o.fromStorePopulated){o.fromField.store.on({load:Ext.Function.bind(o.setValue,o,[m]),single:true});return}m=o.setupValue(m);o.mixins.field.setValue.call(o,m);p=o.getRecordsForValue(m);j.suspendEvents();n.suspendEvents();j.removeAll();n.removeAll();o.populateFromStore(o.store);Ext.Array.forEach(p,function(a){if(j.indexOf(a)>-1){j.remove(a)}n.add(a)});j.resumeEvents();n.resumeEvents();Ext.suspendLayouts();l.boundList.refresh();k.boundList.refresh();Ext.resumeLayouts(true)},onBindStore:function(h,l){var k=this,j=k.fromField,i=k.toField;if(j){j.store.removeAll();i.store.removeAll();if(h.autoCreated){j.resolveDisplayField();i.resolveDisplayField();k.resolveDisplayField()}if(!Ext.isDefined(k.valueField)){k.valueField=k.displayField}if(h.getCount()){k.populateFromStore(h)}else{k.store.on("load",k.populateFromStore,k)}}},populateFromStore:function(e){var d=this.fromField.store;this.fromStorePopulated=true;d.add(e.getRange());d.fireEvent("load",d)},onEnable:function(){var b=this;Ext.ux.form.MultiSelect.prototype.onEnable.call(this);b.fromField.enable();b.toField.enable();Ext.Array.forEach(b.query("[navBtn]"),function(a){a.enable()})},onDisable:function(){var b=this;Ext.ux.form.MultiSelect.prototype.onDisable.call(this);b.fromField.disable();b.toField.disable();Ext.Array.forEach(b.query("[navBtn]"),function(a){a.disable()})},doDestroy:function(){this.bindStore(null);Ext.ux.form.MultiSelect.prototype.doDestroy.call(this)}},0,["itemselector","itemselectorfield"],["component","box","container","fieldcontainer","multiselectfield","multiselect","itemselectorfield","itemselector"],{component:true,box:true,container:true,fieldcontainer:true,multiselectfield:true,multiselect:true,itemselectorfield:true,itemselector:true},["widget.itemselector","widget.itemselectorfield"],0,[Ext.ux.form,"ItemSelector",Ext.ux,"ItemSelector"],0));(Ext.cmd.derive("Ext.ux.form.SearchField",Ext.form.field.Text,{triggers:{clear:{weight:0,cls:"x-form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:"x-form-search-trigger",handler:"onSearchClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var h=this,g=h.store,e;Ext.form.field.Text.prototype.initComponent.apply(this,arguments);h.on("specialkey",function(b,a){if(a.getKey()==a.ENTER){h.onSearchClick()}});if(!g||!g.isStore){g=h.store=Ext.data.StoreManager.lookup(g)}g.setRemoteFilter(true);e=h.store.getProxy();e.setFilterParam(h.paramName);e.encodeFilters=function(a){return a[0].getValue()}},onClearClick:function(){var d=this,e=d.activeFilter;if(e){d.setValue("");d.store.getFilters().remove(e);d.activeFilter=null;d.getTrigger("clear").hide();d.updateLayout()}},onSearchClick:function(){var e=this,d=e.getValue();if(d.length>0){e.activeFilter=new Ext.util.Filter({property:e.paramName,value:d});e.store.getFilters().add(e.activeFilter);e.getTrigger("clear").show();e.updateLayout()}}},0,["searchfield"],["component","box","field","textfield","searchfield"],{component:true,box:true,field:true,textfield:true,searchfield:true},["widget.searchfield"],0,[Ext.ux.form,"SearchField"],0));(Ext.cmd.derive("Ext.ux.grid.SubTable",Ext.grid.plugin.RowExpander,{rowBodyTpl:['<table class="x-grid-subtable">',"{%","this.owner.renderTable(out, values);","%}","</table>"],init:function(m){var l=this,n=l.columns,j,i,k;Ext.grid.plugin.RowExpander.prototype.init.apply(this,arguments);l.columns=[];if(n){for(i=0,j=n.length;i<j;++i){k=Ext.apply({preventRegister:true},n[i]);k.xtype=k.xtype||"gridcolumn";l.columns.push(Ext.widget(k))}}},destroy:function(){var h=this.columns,g,e;if(h){for(e=0,g=h.length;e<g;++e){h[e].destroy()}}this.columns=null;Ext.grid.plugin.RowExpander.prototype.destroy.call(this)},getRowBodyFeatureData:function(e,g,h){Ext.grid.plugin.RowExpander.prototype.getRowBodyFeatureData.apply(this,arguments);h.rowBodyCls+=" x-grid-subtable-row"},renderTable:function(t,j){var r=this,x=r.columns,A=x.length,y=r.getAssociatedRecords(j.record),i=y.length,w,z,s,u,q;t.push("<thead>");for(u=0;u<A;u++){t.push('<th class="x-grid-subtable-header">',x[u].text,"</th>")}t.push("</thead><tbody>");for(s=0;s<i;s++){w=y[s];t.push("<tr>");for(u=0;u<A;u++){z=x[u];q=w.get(z.dataIndex);if(z.renderer&&z.renderer.call){q=z.renderer.call(z.scope||r,q,{},w)}t.push('<td class="x-grid-subtable-cell"');if(z.width!=null){t.push(' style="width:'+z.width+'px"')}t.push('><div class="x-grid-cell-inner">',q,"</div></td>")}t.push("</tr>")}t.push("</tbody>")},getRowBodyContentsFn:function(e){var d=this;return function(a){e.owner=d;return e.applyTemplate(a)}},getAssociatedRecords:function(b){return b[this.association]().getRange()}},0,0,0,0,["plugin.subtable"],0,[Ext.ux.grid,"SubTable"],0));(Ext.cmd.derive("Ext.ux.grid.TransformGrid",Ext.grid.Panel,{constructor:function(I,C){C=Ext.apply({},C);I=this.table=Ext.get(I);var z=C.fields||[],F=C.columns||[],y=[],w=[],D=I.query("thead th"),A=0,x=D.length,B=I.dom,G,i,u,E,t,H;for(;A<x;++A){E=D[A];t=E.innerHTML;H="tcol-"+A;y.push(Ext.applyIf(z[A]||{},{name:H,mapping:"td:nth("+(A+1)+")/@innerHTML"}));w.push(Ext.applyIf(F[A]||{},{text:t,dataIndex:H,width:E.offsetWidth,tooltip:E.title,sortable:true}))}if(C.width){G=C.width}else{G=I.getWidth()+1}if(C.height){i=C.height}Ext.applyIf(C,{store:{data:B,fields:y,proxy:{type:"memory",reader:{record:"tbody tr",type:"xml"}}},columns:w,width:G,height:i});Ext.grid.Panel.prototype.constructor.call(this,C);if(C.remove!==false){B.parentNode.removeChild(B)}},doDestroy:function(){this.table.remove();this.tabl=null;Ext.grid.Panel.prototype.doDestroy.call(this)}},1,0,["component","box","container","panel","tablepanel","gridpanel","grid"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true},0,0,[Ext.ux.grid,"TransformGrid"],0));(Ext.cmd.derive("Ext.ux.grid.plugin.AutoSelector",Ext.plugin.Abstract,{config:{store:null},init:function(e){var d=this;d.grid=e;d.watchGrid();e.on({reconfigure:d.watchGrid,scope:d})},destroy:function(){this.setStore(null);this.grid=null;Ext.plugin.Abstract.prototype.destroy.call(this)},ensureSelection:function(){var e=this.grid,g=e.getStore(),h;if(g.getCount()){h=e.getSelection();if(!h||!h.length){e.getSelectionModel().select(0)}}},watchGrid:function(){this.setStore(this.grid.getStore());this.ensureSelection()},updateStore:function(e){var d=this;Ext.destroy(d.storeListeners);d.storeListeners=e&&e.on({add:d.ensureSelection,remove:d.ensureSelection,destroyable:true,scope:d})}},0,0,0,0,["plugin.gridautoselector"],0,[Ext.ux.grid.plugin,"AutoSelector"],0));(Ext.cmd.derive("Ext.ux.layout.ResponsiveColumn",Ext.layout.container.Auto,{states:{small:1000,large:0},_responsiveCls:"x-responsivecolumn",initLayout:function(){this.innerCtCls+=" "+this._responsiveCls;Ext.layout.container.Auto.prototype.initLayout.call(this)},beginLayout:function(s){var n=this,o=Ext.Element.getViewportWidth(),m=n.states,p=Infinity,u=n.innerCt,t=n._currentState,w,q,r;for(w in m){q=m[w]||Infinity;if(o<=q&&q<=p){p=q;r=w}}if(r!==t){u.replaceCls(t,r,n._responsiveCls);n._currentState=r}Ext.layout.container.Auto.prototype.beginLayout.apply(this,arguments)},onAdd:function(e){Ext.layout.container.Auto.prototype.onAdd.call(this,e);var d=e.responsiveCls;if(d){e.addCls(d)}}},0,0,0,0,["layout.responsivecolumn"],0,[Ext.ux.layout,"ResponsiveColumn"],function(b){if(Ext.isIE8){b.override({responsiveSizePolicy:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:0},setsItemSize:true,calculateItems:function(B,E){var i=this,A=B.targetContext,s=B.childItems,u=s.length,z=E.gotWidth,D=E.width,x,a,y,C,w,t;if(z===false){A.domBlock(i,"width");return false}if(!z){return true}for(y=0;y<u;++y){C=s[y];t=parseInt(C.el.getStyle("background-position-x"),10);w=parseInt(C.el.getStyle("background-position-y"),10);C.setWidth((t/100*(D-w))-w)}B.setContentWidth(D+B.paddingContext.getPaddingInfo().width);return true},getItemSizePolicy:function(){return this.responsiveSizePolicy}})}}));(Ext.cmd.derive("Ext.ux.rating.Picker",Ext.Widget,{focusable:true,cachedConfig:{family:"monospace",glyphs:"☆★",minimum:1,limit:5,overStyle:null,rounding:1,scale:"125%",selectedStyle:null,tooltip:null,trackOver:true,value:null,tooltipText:null,trackingValue:null},config:{animate:null},element:{cls:"ux-rating-picker",reference:"element",children:[{reference:"innerEl",cls:"ux-rating-picker-inner",listeners:{click:"onClick",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},children:[{reference:"valueEl",cls:"ux-rating-picker-value"},{reference:"trackerEl",cls:"ux-rating-picker-tracker"}]}]},defaultBindProperty:"value",twoWayBindable:"value",overCls:"ux-rating-picker-over",trackOverCls:"ux-rating-picker-track-over",applyGlyphs:function(b){if(typeof b==="string"){b=[b.charAt(0),b.charAt(1)]}else{if(typeof b[0]==="number"){b=[String.fromCharCode(b[0]),String.fromCharCode(b[1])]}}return b},applyOverStyle:function(b){this.trackerEl.applyStyles(b)},applySelectedStyle:function(b){this.valueEl.applyStyles(b)},applyTooltip:function(b){if(b&&typeof b!=="function"){if(!b.isTemplate){b=new Ext.XTemplate(b)}b=b.apply.bind(b)}return b},applyTrackingValue:function(b){return this.applyValue(b)},applyValue:function(j){if(j!==null){var g=this.getRounding(),h=this.getLimit(),i=this.getMinimum();j=Math.round(Math.round(j/g)*g*1000)/1000;j=(j<i)?i:(j>h?h:j)}return j},onClick:function(e){var d=this.valueFromEvent(e);this.setValue(d)},onMouseEnter:function(){this.element.addCls(this.overCls)},onMouseLeave:function(){this.element.removeCls(this.overCls)},onMouseMove:function(e){var d=this.valueFromEvent(e);this.setTrackingValue(d)},updateFamily:function(b){this.element.setStyle("fontFamily","'"+b+"'")},updateGlyphs:function(){this.refreshGlyphs()},updateLimit:function(){this.refreshGlyphs()},updateScale:function(b){this.element.setStyle("fontSize",b)},updateTooltip:function(){this.refreshTooltip()},updateTooltipText:function(j){var k=this.innerEl,i=Ext.tip&&Ext.tip.QuickTipManager,h=i&&i.tip,l;if(i){k.dom.setAttribute("data-qtip",j);this.trackerEl.dom.setAttribute("data-qtip",j);l=h&&h.activeTarget;l=l&&l.el;if(l&&k.contains(l)){h.update(j)}}},updateTrackingValue:function(i){var j=this,h=j.trackerEl,g=j.valueToPercent(i);h.setStyle("width",g);j.refreshTooltip()},updateTrackOver:function(b){this.element[b?"addCls":"removeCls"](this.trackOverCls)},updateValue:function(m,r){var o=this,k=o.getAnimate(),n=o.valueEl,p=o.valueToPercent(m),q,l;if(o.isConfiguring||!k){n.setStyle("width",p)}else{n.stopAnimation();n.animate(Ext.merge({from:{width:o.valueToPercent(r)},to:{width:p}},k))}o.refreshTooltip();if(!o.isConfiguring){if(o.hasListeners.change){o.fireEvent("change",o,m,r)}q=o.getWidgetColumn&&o.getWidgetColumn();l=q&&o.getWidgetRecord&&o.getWidgetRecord();if(l&&q.dataIndex){l.set(q.dataIndex,m)}}},afterCachedConfig:function(){this.refresh();return Ext.Widget.prototype.afterCachedConfig.apply(this,arguments)},initConfig:function(b){this.isConfiguring=true;this.callParent([b]);this.refresh()},setConfig:function(){var b=this;b.isReconfiguring=true;b.callParent(arguments);b.isReconfiguring=false;b.refresh();return b},destroy:function(){this.tip=Ext.destroy(this.tip);Ext.Widget.prototype.destroy.call(this)},privates:{getGlyphTextNode:function(d){var e=d.lastChild;if(!e||e.nodeType!==3){e=d.ownerDocument.createTextNode("");d.appendChild(e)}return e},getTooltipData:function(){var b=this;return{component:b,tracking:b.getTrackingValue(),trackOver:b.getTrackOver(),value:b.getValue()}},refresh:function(){var b=this;if(b.invalidGlyphs){b.refreshGlyphs(true)}if(b.invalidTooltip){b.refreshTooltip(true)}},refreshGlyphs:function(w){var n=this,p=!w&&(n.isConfiguring||n.isReconfiguring),t,m,q,o,r,u,s;if(!p){t=n.getGlyphTextNode(n.innerEl.dom);s=n.getGlyphTextNode(n.valueEl.dom);u=n.getGlyphTextNode(n.trackerEl.dom);m=n.getGlyphs();q=n.getLimit();for(o=r="";q--;){r+=m[0];o+=m[1]}t.nodeValue=r;s.nodeValue=o;u.nodeValue=o}n.invalidGlyphs=p},refreshTooltip:function(i){var n=this,j=!i&&(n.isConfiguring||n.isReconfiguring),l=n.getTooltip(),m,k;if(!j){l=n.getTooltip();if(l){m=n.getTooltipData();k=l(m);n.setTooltipText(k)}}n.invalidTooltip=j},valueFromEvent:function(w){var q=this,u=q.innerEl,r=w.getX(),m=q.getRounding(),s=u.getX(),p=r-s,o=u.getWidth(),t=q.getLimit(),n;if(q.getInherited().rtl){p=o-p}n=p/o*t;n=Math.ceil(n/m)*m;return n},valueToPercent:function(b){b=(b/this.getLimit())*100;return b+"%"}}},0,["rating"],["widget","rating"],{widget:true,rating:true},["widget.rating"],0,[Ext.ux.rating,"Picker"],0));(Ext.cmd.derive("Ext.ux.statusbar.ValidationStatus",Ext.Component,{errorIconCls:"x-status-error",errorListCls:"x-status-error-list",validIconCls:"x-status-valid",showText:"The form has errors (click for details...)",hideText:"Click again to hide the error list",submitText:"Saving...",init:function(d){var e=this;e.statusBar=d;d.on({single:true,scope:e,render:e.onStatusbarRender});d.on({click:{element:"el",fn:e.onStatusClick,scope:e,buffer:200}})},onStatusbarRender:function(h){var e=this,g=function(){e.monitor=true};e.monitor=true;e.errors=Ext.create("Ext.util.MixedCollection");e.listAlign=(h.statusAlign==="right"?"br-tr?":"bl-tl?");if(e.form){e.formPanel=Ext.getCmp(e.form)||e.statusBar.lookupController().lookupReference(e.form);e.basicForm=e.formPanel.getForm();e.startMonitoring();e.basicForm.on({beforeaction:function(a,b){if(b.type==="submit"){e.monitor=false}}});e.formPanel.on({beforedestroy:e.destroy,scope:e});e.basicForm.on("actioncomplete",g);e.basicForm.on("actionfailed",g)}},startMonitoring:function(){this.basicForm.getFields().each(function(b){b.on("validitychange",this.onFieldValidation,this)},this)},stopMonitoring:function(){var b=this.basicForm;if(!b.destroyed){b.getFields().each(function(a){a.un("validitychange",this.onFieldValidation,this)},this)}},doDestroy:function(){Ext.destroy(this.msgEl);this.stopMonitoring();this.statusBar.statusEl.un("click",this.onStatusClick,this);Ext.Component.prototype.doDestroy.call(this)},onFieldValidation:function(g,j){var h=this,i;if(!h.monitor){return false}i=g.getErrors()[0];if(i){h.errors.add(g.id,{field:g,msg:i})}else{h.errors.removeAtKey(g.id)}this.updateErrorList();if(h.errors.getCount()>0){if(h.statusBar.getText()!==h.showText){h.statusBar.setStatus({text:h.showText,iconCls:h.errorIconCls})}}else{h.statusBar.clearStatus().setIcon(h.validIconCls)}},updateErrorList:function(){var e=this,h,g=e.getMsgEl();if(e.errors.getCount()>0){h=["<ul>"];this.errors.each(function(a){h.push('<li id="x-err-',a.field.id,'"><a href="#">',a.msg,"</a></li>")});h.push("</ul>");g.update(h.join(""))}else{g.update("")}g.setSize("auto","auto")},getMsgEl:function(){var h=this,g=h.msgEl,e;if(!g){g=h.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:h.errorListCls},true);g.hide();g.on("click",function(a){e=a.getTarget("li",10,true);if(e){Ext.getCmp(e.id.split("x-err-")[1]).focus();h.hideErrors()}},null,{stopEvent:true})}return g},showErrors:function(){var b=this;b.updateErrorList();b.getMsgEl().alignTo(b.statusBar.getEl(),b.listAlign).slideIn("b",{duration:300,easing:"easeOut"});b.statusBar.setText(b.hideText);b.formPanel.body.on("click",b.hideErrors,b,{single:true})},hideErrors:function(){var b=this.getMsgEl();if(b.isVisible()){b.slideOut("b",{duration:300,easing:"easeIn"});this.statusBar.setText(this.showText)}this.formPanel.body.un("click",this.hideErrors,this)},onStatusClick:function(){if(this.getMsgEl().isVisible()){this.hideErrors()}else{if(this.errors.getCount()>0){this.showErrors()}}}},0,0,["component","box"],{component:true,box:true},["plugin.validationstatus"],0,[Ext.ux.statusbar,"ValidationStatus"],0));Ext.override(Ext.grid.column.Column,{constructor:function(b){Ext.apply(b,{align:"left"});this.callParent([b])}});(Ext.cmd.derive("Rd.view.aps.pnlAccessPointEdit",Ext.tab.Panel,{border:false,plain:true,cls:"subTab",tabPosition:"top",ap_profile_id:undefined,initComponent:function(){var b=this;b.items=[{title:"SSIDs",itemId:"tabEntryPoints",xtype:"gridAccessPointEntries",apProfileId:b.ap_profile_id},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridAccessPointExits",apProfileId:b.ap_profile_id},{title:"Common Settings",itemId:"tabAccessPointCommonSettings",xtype:"pnlAccessPointCommonSettings",apProfileId:b.ap_profile_id},{title:"Devices",itemId:"tabAccessPointAps",xtype:"gridAccessPointAps",apProfileId:b.ap_profile_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointEdit"],["component","box","container","panel","tabpanel","pnlAccessPointEdit"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessPointEdit:true},["widget.pnlAccessPointEdit"],0,[Rd.view.aps,"pnlAccessPointEdit"],0));(Ext.cmd.derive("Rd.model.mAccessPointEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"name",type:"string"},{name:"encryption",type:"string"},{name:"hidden",type:"bool"},{name:"isolate",type:"bool"},{name:"key",type:"string"},{name:"auth_server",type:"string"},{name:"auth_secret",type:"string"},{name:"connected_to_exit",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAccessPointEntry"],0));(Ext.cmd.derive("Rd.model.mAccessPointExit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"type",type:"string"},"connects_with"]},0,0,0,0,0,0,[Rd.model,"mAccessPointExit"],0));(Ext.cmd.derive("Rd.model.mAp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},"last_contact_human","country_code","country_name","city","postal_code",{name:"available_to_siblings",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAp"],0));(Ext.cmd.derive("Rd.model.mAccessPointEntryPoint",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mAccessPointEntryPoint"],0));(Ext.cmd.derive("Rd.model.mRealm",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},"phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon","twitter","facebook","youtube","google_plus","linkedin","t_c_title","t_c_content",{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mRealm"],0));(Ext.cmd.derive("Rd.model.mPermanentUser",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"owner",type:"string"},{name:"owner_id",type:"int"},{name:"auth_type",type:"string"},{name:"realm",type:"string"},{name:"realm_id"},{name:"profile",type:"string"},{name:"profile_id"},"perc_time_used","perc_data_used","name","surname","phone","email","address",{name:"active",type:"bool"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage","data_cap","time_cap",{name:"static_ip",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"notes",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPermanentUser"],0));(Ext.cmd.derive("Rd.view.components.cmbApProfile",Ext.form.ComboBox,{fieldLabel:"Profile",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"ap_profile_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_profile_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbApProfile"],["component","box","field","textfield","pickerfield","combobox","combo","cmbApProfile"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbApProfile:true},["widget.cmbApProfile"],0,[Rd.view.components,"cmbApProfile"],0));(Ext.cmd.derive("Rd.view.aps.cmbApHardwareModels",Ext.form.ComboBox,{fieldLabel:i18n("sHardware_model"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"hardware",name:"hardware",value:"dragino",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name","radios"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/aps/hardware_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbApHardwareModels"],["component","box","field","textfield","pickerfield","combobox","combo","cmbApHardwareModels"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbApHardwareModels:true},["widget.cmbApHardwareModels"],0,[Rd.view.aps,"cmbApHardwareModels"],0));(Ext.cmd.derive("Rd.view.components.cmbFiveGigChannels",Ext.form.ComboBox,{fieldLabel:"5G Channel",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"five_chan",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"36",text:"36 (low power)"},{id:"40",text:"40 (low power)"},{id:"44",text:"44 (low power)"},{id:"48",text:"48 (low power)"},{id:"52",text:"52 (DFS)"},{id:"56",text:"56 (DFS)"},{id:"60",text:"60 (DFS)"},{id:"64",text:"64 (DFS)"},{id:"149",text:"149 (high power)"},{id:"153",text:"153 (high power)"},{id:"157",text:"157 (high power)"},{id:"161",text:"161 (high power)"},{id:"165",text:"165 (high power)"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbFiveGigChannels"],["component","box","field","textfield","pickerfield","combobox","combo","cmbFiveGigChannels"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbFiveGigChannels:true},["widget.cmbFiveGigChannels"],0,[Rd.view.components,"cmbFiveGigChannels"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Device",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAddAp"],["component","box","container","panel","window","winAccessPointAddAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddAp:true},["widget.winAccessPointAddAp"],0,[Rd.view.aps,"winAccessPointAddAp"],0));(Ext.cmd.derive("Rd.view.components.cmbDynamicDetail",Ext.form.ComboBox,{fieldLabel:"Login Page",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"dynamic_detail_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mDynamicDetail",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicDetail"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicDetail"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicDetail:true},["widget.cmbDynamicDetail"],0,[Rd.view.components,"cmbDynamicDetail"],0));(Ext.cmd.derive("Rd.view.components.cmbOpenVpnServers",Ext.form.ComboBox,{fieldLabel:i18n("sOpenVPN_Server"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",name:"openvpn_server_id",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/openvpn_servers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbOpenVpnServers"],["component","box","field","textfield","pickerfield","combobox","combo","cmbOpenVpnServers"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbOpenVpnServers:true},["widget.cmbOpenVpnServers"],0,[Rd.view.components,"cmbOpenVpnServers"],0));(Ext.cmd.derive("Rd.view.aps.vcAccessPointExitPoint",Ext.app.ViewController,{config:{urlCheckExperimental:"/cake2/rd_cake/ap_profiles/ap_experimental_check.json"},init:function(){var b=this},onChkDnsOverrideChange:function(i){var l=this;var m=i.up("form");var k=m.down("#txtDns1");var n=m.down("#txtDns2");var j=m.down("#chkDnsDesk");if(i.getValue()){k.enable();n.enable();j.setValue(false);j.disable()}else{k.disable();n.disable();j.enable()}},onChkDnsDeskChange:function(i){var k=this;var l=i.up("form");var h=l.down("#chkDnsOverride");var j=l.down("#chkAnyDns");if(i.getValue()){j.setValue(false);j.disable();h.setValue(false);h.disable()}else{j.enable();h.enable()}},onDnsDeskBeforeRender:function(e){var d=this;Ext.Ajax.request({url:d.getUrlCheckExperimental(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.active){e.show();e.enable()}else{e.hide();e.disable()}}},scope:d})}},0,0,0,0,["controller.vcAccessPointExitPoint"],0,[Rd.view.aps,"vcAccessPointExitPoint"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Access Point Exit",width:530,height:530,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,apProfileId:"",exitId:"",store:undefined,defaults:{border:false},controller:"vcAccessPointExitPoint",initComponent:function(){var o=this;var k=Ext.create("Rd.view.aps.cmbAccessPointEntryPoints",{labelClsExtra:"lblRdlReq"});var p=true;if(o.type=="captive_portal"){p=false}k.getStore().getProxy().setExtraParam("ap_profile_id",o.apProfileId);k.getStore().getProxy().setExtraParam("exit_id",o.exitId);k.getStore().load();var m=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:o.apProfileId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},k,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Auto-add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Auto-add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",hidden:p,items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sBasic"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq",emptyText:"http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/",blankText:"Try http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:i18n("sProxy"),itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:i18n("sEnable"),name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUpstream_proxy"),name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sUpstream_port"),name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_name"),name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_password"),name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:i18n("sCoova_specific"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:i18n("sOptional_config_items"),name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});var q=m.down("#tabCaptivePortal");var l=m.down("#chkNasClient");var n=m.down("#chkLoginPage");var r=m.down("cmbDynamicDetail");if(o.type=="captive_portal"){q.setDisabled(false);l.setVisible(true);l.setDisabled(false);n.setVisible(true);n.setDisabled(false);r.setVisible(true);r.setDisabled(false)}else{q.setDisabled(true);l.setVisible(false);l.setDisabled(true);n.setVisible(false);n.setDisabled(true);r.setVisible(false);r.setDisabled(true)}o.items=m;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditExit"],["component","box","container","panel","window","winAccessPointEditExit"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditExit:true},["widget.winAccessPointEditExit"],0,[Rd.view.aps,"winAccessPointEditExit"],0));(Ext.cmd.derive("Rd.store.sAccessPointEntries",Ext.data.Store,{model:"Rd.model.mAccessPointEntry",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_entries_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_entry_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointEntries"],0));(Ext.cmd.derive("Rd.store.sAccessPointExits",Ext.data.Store,{model:"Rd.model.mAccessPointExit",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_exits_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_exit_delete.json"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointExits"],0));(Ext.cmd.derive("Rd.store.sAps",Ext.data.Store,{model:"Rd.model.mAp",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_ap_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_ap_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAps"],0));(Ext.cmd.derive("Rd.store.sAccessPointEntryPoints",Ext.data.Store,{model:"Rd.model.mAccessPointEntryPoint",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/access_point_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointEntryPoints"],0));(Ext.cmd.derive("Rd.store.sRealms",Ext.data.Store,{model:"Rd.model.mRealm",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/realms/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sRealms"],0));(Ext.cmd.derive("Rd.view.components.cmbEncryptionOptions",Ext.form.ComboBox,{fieldLabel:i18n("sEncryption"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"encryption",name:"encryption",value:"none",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEncryptionOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEncryptionOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEncryptionOptions:true},["widget.cmbEncryptionOptions"],0,[Rd.view.components,"cmbEncryptionOptions"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Access Point SSID",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,ap_profile_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:e.apProfileId},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Frequency",defaultType:"radiofield",labelClsExtra:"lblRdReq",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"2.4G",name:"frequency_band",inputValue:"two",margin:Rd.config.radioMargin},{boxLabel:"5G",name:"frequency_band",inputValue:"five",margin:Rd.config.radioMargin},{boxLabel:"Both",name:"frequency_band",inputValue:"both",value:true,margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabEncryption",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAddEntry"],["component","box","container","panel","window","winAccessPointAddEntry"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddEntry:true},["widget.winAccessPointAddEntry"],0,[Rd.view.aps,"winAccessPointAddEntry"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Device",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_id",xtype:"textfield",name:"id",hidden:true,value:g.apId},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditAp"],["component","box","container","panel","window","winAccessPointEditAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditAp:true},["widget.winAccessPointEditAp"],0,[Rd.view.aps,"winAccessPointEditAp"],0));(Ext.cmd.derive("Rd.view.components.cmbRealm",Ext.form.ComboBox,{fieldLabel:i18n("sRealm"),labelSeparator:"",store:"sRealms",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"realm_id",labelClsExtra:"lblRd",type:"create",extraParam:false,initComponent:function(){var h=this;var g="/cake3/rd_cake/realms/index-ap-update.json";if(h.type=="create"){g="/cake3/rd_cake/realms/index-ap-create.json"}var e=Ext.create("Ext.data.Store",{model:"Rd.model.mRealm",proxy:{type:"ajax",format:"json",batchActions:true,url:g,reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(h.extraParam){e.getProxy().setExtraParam("ap_id",h.extraParam)}h.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbRealm"],["component","box","field","textfield","pickerfield","combobox","combo","cmbRealm"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbRealm:true},["widget.cmbRealm"],0,[Rd.view.components,"cmbRealm"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Access Point Exit",width:530,height:530,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,store:undefined,defaults:{border:false},startScreen:"scrnType",controller:"vcAccessPointExitPoint",initComponent:function(){var e=this;var g=e.mkScrnType();var h=e.mkScrnData();e.items=[g,h];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnType:function(){var l=this;var h=[{itemId:"btnTypeNext",text:i18n("sNext"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}];var i=false;l.store.each(function(a,e,b){var d=a.get("type");if(d=="bridge"){i=true;return false}});if(i==true){var j=[{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge",checked:true},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}else{var j=[{boxLabel:i18n("sEthernet_bridge"),name:"exit_type",inputValue:"bridge",checked:true},{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge"},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}var k=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:i18n("sExit_point_type"),columns:1,vertical:true,items:j}],buttons:h});return k},mkScrnData:function(){var e=this;var g=Ext.create("Rd.view.aps.cmbAccessPointEntryPoints",{labelClsExtra:"lblRdReq"});g.getStore().getProxy().setExtraParam("ap_profile_id",e.apProfileId);g.getStore().load();var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:e.apProfileId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},g,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Auto-add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Auto-add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sBasic"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq",emptyText:"http://your_ip_here/cake3/rd_cake/dynamic-details/chilli_browser_detect/",blankText:"Try http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:i18n("sProxy"),itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:i18n("sEnable"),name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUpstream_proxy"),name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sUpstream_port"),name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_name"),name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_password"),name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:i18n("sCoova_specific"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:i18n("sOptional_config_items"),name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});return h}},0,["winAccessPointAddExit"],["component","box","container","panel","window","winAccessPointAddExit"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddExit:true},["widget.winAccessPointAddExit"],0,[Rd.view.aps,"winAccessPointAddExit"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Access Point SSID",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,ap_profile_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Frequency",defaultType:"radiofield",labelClsExtra:"lblRdReq",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"2.4G",name:"frequency_band",inputValue:"two",margin:Rd.config.radioMargin},{boxLabel:"5G",name:"frequency_band",inputValue:"five",margin:Rd.config.radioMargin},{boxLabel:"Both",name:"frequency_band",inputValue:"both",value:true,margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabEncryption",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditEntry"],["component","box","container","panel","window","winAccessPointEditEntry"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditEntry:true},["widget.winAccessPointEditEntry"],0,[Rd.view.aps,"winAccessPointEditEntry"],0));(Ext.cmd.derive("Rd.view.components.ajaxToolbar",Ext.toolbar.Toolbar,{url:null,extra_text:null,initComponent:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",success:b.buildToolbar,scope:b});Ext.toolbar.Toolbar.prototype.initComponent.apply(this,arguments)},buildToolbar:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);if(e.success){Ext.each(e.items,function(a){h.add(a)});if(h.extra_text!=null){h.add({xtype:"tbtext",html:h.extra_text})}}}},0,["ajaxToolbar"],["component","box","container","toolbar","ajaxToolbar"],{component:true,box:true,container:true,toolbar:true,ajaxToolbar:true},["widget.ajaxToolbar"],0,[Rd.view.components,"ajaxToolbar"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridAccessPointEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_entries_grid.json",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAccessPointEntries,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessPointEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridAccessPointEntries2"},{text:i18n("sEncryption"),dataIndex:"encryption",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="encryption==\'none\'"><div class="fieldGreyWhite"><i class="fa fa-unlock"></i>  '+i18n("sNone")+"</div></tpl>",'<tpl if="encryption==\'wep\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWEP")+"</div></tpl>",'<tpl if="encryption==\'psk\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Personal")+"</div></tpl>",'<tpl if="encryption==\'psk2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Personal")+"</div></tpl>",'<tpl if="encryption==\'wpa\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Enterprise")+"</div></tpl>",'<tpl if="encryption==\'wpa2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Enterprise")+"</div></tpl>"),stateId:"StateGridAccessPointEntries3"},{text:i18n("sHidden"),dataIndex:"hidden",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries4",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="hidden"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sClient_isolation"),dataIndex:"isolate",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="isolate"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:"Connected to Exit",dataIndex:"connected_to_exit",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries6",renderer:function(h,a,g){if(h==true){return'<div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>'}if(h==false){a.tdAttr="data-qtip=\"<div><label class='lblTipItem'>Go to Exit Points and connect this SSID to an Exit Point</label></div>\"";return'<div class="fieldRedWhite"><i class="fa  fa-exclamation-circle"></i> No</div>'}}},{text:"Frequency",dataIndex:"frequency_band",tdCls:"gridTree",flex:1,renderer:function(g,h,a){if(g=="both"){return"2.4G and 5G"}if(g=="two"){return"2.4G"}if(g=="five"){return"5G"}},stateId:"StateGridAccessPointEntries7"},{text:"WPA Personal Key",hidden:true,dataIndex:"key",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries8"},{text:"RADIUS Server",hidden:true,dataIndex:"auth_server",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries9"},{text:"RADIUS Secret",hidden:true,dataIndex:"auth_secret",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointEntries:true},["widget.gridAccessPointEntries"],0,[Rd.view.aps,"gridAccessPointEntries"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointExits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridAccessPointExitsId",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_exits_grid.json",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAccessPointExits,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessPointExitsId1"},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'bridge\'"><div class="fieldGreyWhite"><i class="fa fa-bars"></i>  Bridge</div></tpl>','<tpl if="type==\'captive_portal\'"><div class="fieldPurpleWhite"><i class="fa fa-key"></i>  Captive Portal</div></tpl>','<tpl if="type==\'nat\'"><div class="fieldGreenWhite"><i class="fa fa-arrows-alt"></i>  NAT+DHCP</div></tpl>','<tpl if="type==\'tagged_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-tag"></i>  Tagged Ethernet Bridge</div></tpl>','<tpl if="type==\'openvpn_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-quote-right"></i>  OpenVPN Bridge</div></tpl>'),stateId:"StateGridAccessPointExitsId2"},{text:i18n("sConnects_with"),sortable:false,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(connects_with)"><div class="fieldRedWhite"><i class="fa fa-exclamation-circle"></i> '+i18n("sNo_one")+"</div></tpl>",'<tpl for="connects_with">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"connects_with",stateId:"StateGridAccessPointExitsId3"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointExits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointExits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointExits:true},["widget.gridAccessPointExits"],0,[Rd.view.aps,"gridAccessPointExits"],0));(Ext.cmd.derive("Rd.view.components.cmbCountries",Ext.form.ComboBox,{fieldLabel:"Country",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"country",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/country_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCountries"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCountries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCountries:true},["widget.cmbCountries"],0,[Rd.view.components,"cmbCountries"],0));(Ext.cmd.derive("Rd.view.components.cmbTimezones",Ext.form.ComboBox,{fieldLabel:"Timezone",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"timezone",multiSelect:false,labelClsExtra:"lblRd",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/timezone_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbTimezones"],["component","box","field","textfield","pickerfield","combobox","combo","cmbTimezones"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbTimezones:true},["widget.cmbTimezones"],0,[Rd.view.components,"cmbTimezones"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointCommonSettings",Ext.panel.Panel,{border:false,layout:"hbox",align:"stretch",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:400,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"System",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"}]},{title:i18n("sMonitor"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",name:"heartbeat_interval",itemId:"heartbeat_interval",fieldLabel:i18n("sHeartbeat_interval"),value:60,maxValue:21600,minValue:60},{xtype:"numberfield",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:600,maxValue:21600,minValue:300}]},{title:i18n("sGateway"),layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{labelWidth:300},autoScroll:true,items:[{xtype:"numberfield",name:"gw_dhcp_timeout",itemId:"gw_dhcp_timeout",fieldLabel:i18n("sWait_time_for_DHCP_IP"),value:120,maxValue:600,minValue:120,labelWidth:280},{xtype:"checkbox",fieldLabel:i18n("sUse_previous_settings_when_DHCP_fails"),name:"gw_use_previous",inputValue:"gw_use_previous",itemId:"gw_use_previous",checked:true,labelClsExtra:"lblRd",labelWidth:280}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointCommonSettings"],["component","box","container","panel","pnlAccessPointCommonSettings"],{component:true,box:true,container:true,panel:true,pnlAccessPointCommonSettings:true},["widget.pnlAccessPointCommonSettings"],0,[Rd.view.aps,"pnlAccessPointCommonSettings"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointAps",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGAPD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_devices_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAps,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGAPD1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGAPD2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGAPD3"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGAPD4"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,stateId:"StateGAPD5"},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGAPD6"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",width:170,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_from_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGAPD7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointAps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointAps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointAps:true},["widget.gridAccessPointAps"],0,[Rd.view.aps,"gridAccessPointAps"],0));(Ext.cmd.derive("Rd.view.aps.cmbAccessPointEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:true,labelClsExtra:"lblRdReq",allowBlank:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_profiles/ap_profile_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAccessPointEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAccessPointEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAccessPointEntryPoints:true},["widget.cmbAccessPointEntryPoints"],0,[Rd.view.aps,"cmbAccessPointEntryPoints"],0));(Ext.cmd.derive("Rd.view.components.cmbMacFilter",Ext.form.ComboBox,{fieldLabel:i18n("sMacFilter"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"macfilter",labelClsExtra:"lblRd",value:"disable",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"disable",text:i18n("sDisabled")},{id:"allow",text:i18n("sAllow")},{id:"deny",text:i18n("sDeny")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMacFilter"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMacFilter"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMacFilter:true},["widget.cmbMacFilter"],0,[Rd.view.components,"cmbMacFilter"],0));(Ext.cmd.derive("Rd.view.components.cmbPermanentUser",Ext.form.ComboBox,{fieldLabel:i18n("sOwner"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"username",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"user_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mPermanentUser",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/permanent-users/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(j,k,a,l){if(!a){var b=l.getError();Ext.ux.Toaster.msg("Warning",b,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPermanentUser"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPermanentUser"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPermanentUser:true},["widget.cmbPermanentUser"],0,[Rd.view.components,"cmbPermanentUser"],0));(Ext.cmd.derive("Rd.controller.cAccessPointEdits",Ext.app.Controller,{views:["aps.pnlAccessPointEdit","aps.gridAccessPointEntries","aps.gridAccessPointExits","aps.pnlAccessPointCommonSettings","aps.gridAccessPointAps","aps.winAccessPointAddEntry","components.cmbEncryptionOptions","aps.winAccessPointEditEntry","aps.winAccessPointAddExit","aps.cmbAccessPointEntryPoints","aps.winAccessPointEditExit","aps.cmbApHardwareModels","aps.winAccessPointAddAp","aps.winAccessPointEditAp","components.cmbTimezones","components.cmbCountries","components.cmbFiveGigChannels","components.cmbRealm","components.cmbMacFilter","components.cmbPermanentUser"],stores:["sAccessPointEntries","sAccessPointExits","sAps","sAccessPointEntryPoints","sRealms"],models:["mAccessPointEntry","mAccessPointExit","mAp","mAccessPointEntryPoint","mRealm","mPermanentUser"],config:{urlAddEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_add.json",urlViewEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_view.json",urlEditEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_edit.json",urlExitAddDefaults:"/cake2/rd_cake/ap_profiles/ap_profile_exit_add_defaults.json",urlAddExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_add.json",urlViewExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_view.json",urlEditExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_edit.json",urlViewApCommonSettings:"/cake2/rd_cake/ap_profiles/ap_common_settings_view.json",urlEditApCommonSettings:"/cake2/rd_cake/ap_profiles/ap_common_settings_edit.json",urlAddAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_add.json",urlViewAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_view.json",urlEditAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_edit.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlMapPrefEdit:"/cake2/rd_cake/meshes/map_pref_edit.json",urlMapSave:"/cake2/rd_cake/meshes/map_node_save.json",urlMapDelete:"/cake2/rd_cake/meshes/map_node_delete.json",urlMeshNodes:"/cake2/rd_cake/meshes/mesh_nodes_index.json",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlAdvancedSettingsForModel:"/cake2/rd_cake/ap_profiles/advanced_settings_for_model.json"},refs:[{ref:"editEntryWin",selector:"winAccessPointEditEntry"},{ref:"editExitWin",selector:"winAccessPointEditExit"},{ref:"tabAccessPoints",selector:"#tabAccessPoints"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"gridAccessPointEntries #reload":{click:b.reloadEntry},"gridAccessPointEntries #add":{click:b.addEntry},"gridAccessPointEntries #edit":{click:b.editEntry},"winAccessPointAddEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winAccessPointAddEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winAccessPointAddEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winAccessPointAddEntry #save":{click:b.btnAddEntrySave},"gridAccessPointEntries #delete":{click:b.delEntry},winAccessPointEditEntry:{beforeshow:b.loadEntry},"winAccessPointEditEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winAccessPointEditEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winAccessPointEditEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winAccessPointEditEntry #save":{click:b.btnEditEntrySave},"gridAccessPointExits #reload":{click:b.reloadExit},"gridAccessPointExits #add":{click:b.addExit},winAccessPointAddExit:{beforeshow:b.loadAddExit},"winAccessPointAddExit #btnTypeNext":{click:b.btnExitTypeNext},"winAccessPointAddExit #btnDataPrev":{click:b.btnExitDataPrev},"winAccessPointAddExit #save":{click:b.btnAddExitSave},"gridAccessPointExits #delete":{click:b.delExit},"gridAccessPointExits #edit":{click:b.editExit},winAccessPointEditExit:{beforeshow:b.loadExit},"winAccessPointEditExit #save":{click:b.btnEditExitSave},"#chkProxyEnable":{change:b.chkProxyEnableChange},"pnlAccessPointEdit #tabAccessPointCommonSettings":{activate:b.frmApCommonSettingsLoad},"pnlAccessPointCommonSettings #save":{click:b.btnApCommonSettingsSave},"gridAccessPointAps #reload":{click:b.reloadAps},"gridAccessPointAps #add":{click:b.addAp},"#winAccessPointAddApEdit #save":{click:b.btnAddApSave},"gridAccessPointAps #delete":{click:b.delAp},"gridAccessPointAps #edit":{click:b.editAp},"#winAccessPointEditApEdit":{beforeshow:b.loadAp},"#winAccessPointEditApEdit #save":{click:b.btnEditApSave},"#winAccessPointAddApEdit #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApEdit #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApEdit radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointAddApEdit radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointAddApEdit cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"#winAccessPointAddApEdit":{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointEditApEdit #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApEdit #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApEdit radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointEditApEdit radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointEditApEdit cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"winAccessPointAddExit #chkNasClient":{change:b.chkNasClientChange},"winAccessPointEditExit #chkNasClient":{change:b.chkNasClientChange},"winAccessPointAddExit #chkLoginPage":{change:b.chkLoginPageChange},"winAccessPointEditExit #chkLoginPage":{change:b.chkLoginPageChange}})},actionIndex:function(j,n){var m=this;var k="tabAccessPoint"+j;var i=m.getTabAccessPoints();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnEdit,title:n,closable:true,layout:"fit",xtype:"pnlAccessPointEdit",itemId:k,ap_profile_id:j})}i.setActiveTab(l)},reloadEntry:function(g){var i=this;var h=g.up("pnlAccessPointEdit");var j=h.down("gridAccessPointEntries");j.getStore().reload()},addEntry:function(k){var j=this;var l=k.up("pnlAccessPointEdit");var h=l.down("gridAccessPointEntries").getStore();if(!Ext.WindowManager.get("winAccessPointAddEntryId")){var i=Ext.widget("winAccessPointAddEntry",{id:"winAccessPointAddEntryId",store:h,apProfileId:l.ap_profile_id});i.show()}},cmbEncryptionChange:function(l){var o=this;var p=l.up("form");var j=p.down("#key");var k=p.down("#auth_server");var n=p.down("#auth_secret");var m=l.getValue();if(m=="none"){j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wep")|(m=="psk")|(m=="psk2")){j.setVisible(true);j.setDisabled(false);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wpa")|(m=="wpa2")){j.setVisible(false);j.setDisabled(true);k.setVisible(true);k.setDisabled(false);n.setVisible(true);n.setDisabled(false)}},chkMaxassocChange:function(i){var k=this;var l=i.up("form");var h=l.down("#maxassoc");var j=i.getValue();if(j){h.setVisible(true);h.setDisabled(false)}else{h.setVisible(false);h.setDisabled(true)}},cmbMacFilterChange:function(j){var h=this;var i=j.up("form");var l=i.down("cmbPermanentUser");var k=j.getValue();if(k=="disable"){l.setVisible(false);l.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false)}},btnAddEntrySave:function(h){var j=this;var i=h.up("winAccessPointAddEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){i.store.load();i.close();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("New Access Point SSID created fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:"formFailure"})},editEntry:function(o){var m=this;var p=o.up("pnlAccessPointEdit");var j=p.down("gridAccessPointEntries").getStore();if(p.down("gridAccessPointEntries").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=p.down("gridAccessPointEntries").getSelectionModel().getLastSelected();var l=n.getId();if(!Ext.WindowManager.get("winAccessPointEditEntryId")){var k=Ext.widget("winAccessPointEditEntry",{id:"winAccessPointEditEntryId",store:j,entryId:l});k.show()}else{var k=Ext.WindowManager.get("winAccessPointEditEntryId");k.entryId=l;m.loadEntry(k)}}},loadEntry:function(i){var j=this;var g=i.down("form");var h=i.entryId;g.load({url:j.getUrlViewEntry(),method:"GET",params:{entry_id:h},success:function(o,p,a){var n=g.down("cmbMacFilter");var b=n.getValue();if(b!="disable"){var d=g.down("cmbPermanentUser");var e=Ext.create("Rd.model.mPermanentUser",{username:p.result.data.username,id:p.result.data.permanent_user_id});d.getStore().loadData([e],false);d.setValue(p.result.data.permanent_user_id)}}})},btnEditEntrySave:function(h){var j=this;var i=h.up("winAccessPointEditEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delEntry:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointEntries");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},chkNasClientChange:function(h){var j=this;var g=h.up("form");var i=g.down("#cmbRealm");if(h.getValue()){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},chkLoginPageChange:function(h){var i=this;var j=h.up("form");var g=j.down("#cmbDynamicDetail");if(h.getValue()){g.setVisible(true);g.setDisabled(false)}else{g.setVisible(false);g.setDisabled(true)}},reloadExit:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointExits");h.getStore().reload()},loadAddExit:function(h){var e=this;var g=h.down("#scrnData");g.load({url:e.getUrlExitAddDefaults(),method:"GET"})},addExit:function(l){var k=this;var m=l.up("pnlAccessPointEdit");var i=m.down("gridAccessPointEntries").getStore().count();if(i==0){Ext.ux.Toaster.msg(i18n("sDefine_some_entry_points_first"),i18n("sDefine_some_entry_points_first"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}var n=m.down("gridAccessPointExits").getStore();if(!Ext.WindowManager.get("winAccessPointAddExitId")){var j=Ext.widget("winAccessPointAddExit",{id:"winAccessPointAddExitId",store:n,apProfileId:m.ap_profile_id});j.show()}},btnExitTypeNext:function(y){var u=this;var x=y.up("winAccessPointAddExit");var t=x.down("radiogroup").getValue().exit_type;var z=x.down("#vlan");var r=x.down("#tabCaptivePortal");var w=x.down("#type");var q=x.down("#cmbOpenVpnServers");var o=x.down("#chkNasClient");var p=x.down("#cmbRealm");var A=x.down("#chkLoginPage");var s=x.down("cmbDynamicDetail");w.setValue(t);if(t=="openvpn_bridge"){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}if(t=="tagged_bridge"){z.setVisible(true);z.setDisabled(false)}else{z.setVisible(false);z.setDisabled(true)}if(t=="captive_portal"){r.setDisabled(false);r.tab.show();o.setVisible(true);o.setDisabled(false);A.setVisible(true);A.setDisabled(false);s.setVisible(true);s.setDisabled(false);p.setVisible(true);p.setDisabled(false)}else{r.setDisabled(true);r.tab.hide();o.setVisible(false);o.setDisabled(true);A.setVisible(false);A.setDisabled(true);s.setVisible(false);s.setDisabled(true);p.setVisible(false);p.setDisabled(true)}x.getLayout().setActiveItem("scrnData")},btnExitDataPrev:function(g){var e=this;var h=g.up("winAccessPointAddExit");h.getLayout().setActiveItem("scrnType")},btnAddExitSave:function(h){var j=this;var i=h.up("winAccessPointAddExit");var g=i.down("#scrnData");g.submit({clientValidation:true,url:j.getUrlAddExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delExit:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointExits");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},editExit:function(A){var z=this;var B=A.up("pnlAccessPointEdit");var t=B.down("gridAccessPointExits").getStore();if(B.down("gridAccessPointExits").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var G=B.down("gridAccessPointExits").getSelectionModel().getLastSelected();var F=G.getId();var C=G.get("ap_profile_id");var y=G.get("type");if(!Ext.WindowManager.get("winAccessPointEditExitId")){var u=Ext.widget("winAccessPointEditExit",{id:"winAccessPointEditExitId",store:t,exitId:F,apProfileId:C,type:y});u.show()}else{var u=Ext.WindowManager.get("winAccessPointEditExitId");var D=u.down("#vlan");var w=u.down("#tabCaptivePortal");u.exitId=F;u.apProfileId=C;var s=win.down("#cmbOpenVpnServers");var r=u.down("#chkNasClient");var E=u.down("#chkLoginPage");var x=u.down("cmbDynamicDetail");if(y=="openvpn_bridge"){s.setVisible(true);s.setDisabled(false);D.setVisible(false);D.setDisabled(true)}else{s.setVisible(false);s.setDisabled(true)}if(y=="tagged_bridge"){D.setVisible(true);D.setDisabled(false)}else{D.setVisible(false);D.setDisabled(true)}if(y=="captive_portal"){w.setDisabled(false);w.tab.show();r.setVisible(true);r.setDisabled(false);E.setVisible(true);E.setDisabled(false);x.setVisible(true);x.setDisabled(false)}else{w.setDisabled(true);w.tab.hide();r.setVisible(false);r.setDisabled(true);E.setVisible(false);E.setDisabled(true);x.setVisible(false);x.setDisabled(true)}z.loadExit(u)}}},loadExit:function(i){var g=this;var h=i.down("form");var j=i.exitId;h.load({url:g.getUrlViewExit(),method:"GET",params:{exit_id:j},success:function(d,e,s){var a=h.down("#type");var w=a.getValue();var A=h.down("#vlan");var b=h.down("#cmbOpenVpnServers");if(w=="openvpn_bridge"){b.setVisible(true);b.setDisabled(false);A.setVisible(false);A.setDisabled(true)}else{b.setVisible(false);b.setDisabled(true)}if(w=="tagged_bridge"){A.setVisible(true);A.setDisabled(false)}else{A.setVisible(false);A.setDisabled(true)}var t=h.down("cmbAccessPointEntryPoints");t.setValue(e.result.data.entry_points);if(e.result.data.type=="captive_portal"){if((e.result.data.auto_login_page==true)&&(e.result.data.dynamic_detail!=null)){var x=h.down("cmbDynamicDetail");var y=Ext.create("Rd.model.mDynamicDetail",{name:e.result.data.dynamic_detail,id:e.result.data.dynamic_detail_id});x.getStore().loadData([y],false);x.setValue(e.result.data.dynamic_detail_id)}else{h.down("cmbDynamicDetail").setVisible(false);h.down("cmbDynamicDetail").setDisabled(true)}if((e.result.data.auto_dynamic_client==true)&&(e.result.data.realm_records!=null)){var z=h.down("cmbRealm");var u=[];Ext.Array.forEach(e.result.data.realm_records,function(l){var k=Ext.create("Rd.model.mRealm",{name:l.name,id:l.id});Ext.Array.push(u,k)});z.getStore().loadData(u,false);z.setValue(e.result.data.realm_ids)}else{h.down("cmbRealm").setVisible(false);h.down("cmbRealm").setDisabled(true)}}}})},btnEditExitSave:function(h){var j=this;var i=h.up("winAccessPointEditExit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},chkProxyEnableChange:function(g){var i=this;var h=g.up("panel");var j=Ext.ComponentQuery.query("textfield",h);if(g.getValue()){Ext.Array.each(j,function(a,d,b){a.setDisabled(false);a.setVisible(true)})}else{Ext.Array.each(j,function(a,d,b){a.setDisabled(true);a.setVisible(false)})}},frmApCommonSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.apProfileId;j.load({url:i.getUrlViewApCommonSettings(),method:"GET",params:{ap_profile_id:h}})},btnApCommonSettingsSave:function(i){var j=this;var k=i.up("form");var l=i.up("#tabAccessPointCommonSettings");var h=l.apProfileId;k.submit({clientValidation:true,url:j.getUrlEditApCommonSettings(),params:{ap_profile_id:h},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},reloadAps:function(g){var i=this;var h=g.up("pnlAccessPointEdit");var j=h.down("gridAccessPointAps");j.getStore().reload()},cmbApHardwareModelsChange:function(r){var m=this;var t=r.up("form");var s=r.getValue();var o=1;var q=r.getSelection();if(q!=null){o=q.get("radios")}var l=t.down("#tabRadiosRadio1");var p=t.down("#tabAdvWifiRadio1");var n=r.up("window");if(n.getItemId()!="winAccessPointEditApEdit"){t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s}})}else{t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s,ap_id:n.apId}})}if(o==2){l.setDisabled(false);l.tab.show();p.setDisabled(false);p.tab.show()}else{l.setDisabled(true);l.tab.hide();p.setDisabled(true);p.tab.hide()}},loadAdvancedWifiSettings:function(m){var o=this;var p=m.down("form");var k=p.down("cmbApHardwareModels");var l=k.getValue();var n=p.down("#tabAdvWifiRadio1");n.setDisabled(true);n.tab.hide();var j=p.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide();p.load({url:o.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:l}})},addAp:function(k){var j=this;var l=k.up("pnlAccessPointEdit");var h=l.down("gridAccessPointAps").getStore();if(!Ext.WindowManager.get("winAccessPointAddApId")){var i=Ext.widget("winAccessPointAddAp",{id:"winAccessPointAddApId",store:h,apProfileId:l.ap_profile_id,apProfileName:l.title,itemId:"winAccessPointAddApEdit"});i.show()}},btnAddApSave:function(h){var j=this;var i=h.up("winAccessPointAddAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delAp:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointAps");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},editAp:function(q){var n=this;var r=q.up("pnlAccessPointEdit");var k=r.down("gridAccessPointAps").getStore();if(r.down("gridAccessPointAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var o=r.down("gridAccessPointAps").getSelectionModel().getLastSelected();var m=o.getId();var p=o.get("ap_profile_id");if(!Ext.WindowManager.get("winAccessPointEditApId")){var l=Ext.widget("winAccessPointEditAp",{id:"winAccessPointEditApId",store:k,apId:m,apProfileId:r.ap_profile_id,apProfileName:r.title,itemId:"winAccessPointEditApEdit"});l.show()}}},loadAp:function(l){var n=this;var i=l.down("form");var k=l.apId;i.load({url:n.getUrlViewAp(),method:"GET",params:{ap_id:k}});var m=i.down("#tabAdvWifiRadio1");m.setDisabled(true);m.tab.hide();var j=i.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide()},btnEditApSave:function(h){var j=this;var i=h.up("winAccessPointEditAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},chkRadioEnableChange:function(l){var k=this;var h=l.up("panel");var j=l.getValue();var i=Ext.ComponentQuery.query("field",h);Ext.Array.forEach(i,function(a){if(a!=l){a.setDisabled(!j)}})},radio_0_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},radio_1_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg(i18n("sLoading_Google_Maps_API"),i18n("sLoading_Google_Maps_API"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("pnlAccessPointEdit");var l="mapTab";var k=j.down("#"+l);if(k){j.setActiveTab(l);return}var m=i18n("sGoogle_Maps");var n=j.mesh_id;Ext.Ajax.request({url:o.getUrlMapPrefView(),method:"GET",params:{mesh_id:n},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.add({title:m,itemId:l,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshEditGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:n});j.setActiveTab(l)}},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sError_encountered"),i18n("sMap_preferences_could_not_be_fetched"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:o})},dragStart:function(i,g,h){var j=this;j.lastMovedMarker=h;j.lastOrigPosition=h.getPosition();j.editWindow=g.editwindow},dragEnd:function(j,l,i){var k=this;var h=i.getPosition();l.new_lng=h.lng();l.new_lat=h.lat();l.editwindow.open(l.gmap,i);k.lastLng=h.lng();k.lastLat=h.lat();k.lastDragId=j},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapDelete(),method:"GET",params:{id:j.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},btnMapSave:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapSave(),method:"GET",params:{id:j.lastDragId,lat:j.lastLat,lon:j.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},mapPreferences:function(n){var m=this;var o=n.up("pnlMeshEdit");var l=o.mesh_id;var j="winMeshMapPreferences_"+l;var p=o.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(j)){var k=Ext.widget("winMeshMapPreferences",{id:j,mapPanel:p,meshId:l});k.show();k.down("form").load({url:m.getUrlMapPrefView(),method:"GET",params:{mesh_id:l}})}},mapNodeAdd:function(n){var m=this;var o=n.up("pnlMeshEdit");var l=o.mesh_id;var k="winMeshMapNodeAdd_"+l;var p=o.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(k)){var j=Ext.widget("winMeshMapNodeAdd",{id:k,mapPanel:p,meshId:l});j.show()}},meshMapNodeAddSubmit:function(r){var p=this;var n=r.up("winMeshMapNodeAdd");var q=n.down("cmbMeshAddMapNodes");var m=q.getValue();var k=n.mapPanel;n.close();var o=k.gmap.getCenter();var l=k.addMarker({lat:o.lat(),lng:o.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:i18n("sNew_marker"),listeners:{dragend:function(){p.dragEnd(m,k,l)},dragstart:function(){k.addwindow.close();p.dragStart(m,k,l)}}});k.addwindow.open(k.gmap,l)},mapPreferencesSnapshot:function(t){var r=this;var w=t.up("form");var n=t.up("winMeshMapPreferences");var u=n.mapPanel;var m=u.gmap.getZoom();var q=u.gmap.getMapTypeId();var o=u.gmap.getCenter();var s=o.lat();var p=o.lng();w.down("#lat").setValue(s);w.down("#lng").setValue(p);w.down("#zoom").setValue(m);w.down("#type").setValue(q.toUpperCase())},mapPreferencesSave:function(i){var l=this;var h=i.up("form");var j=i.up("winMeshMapPreferences");var k=j.meshId;h.submit({clientValidation:true,url:l.getUrlMapPrefEdit(),params:{mesh_id:k},success:function(b,a){j.close();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:l,failure:Ext.ux.formFail})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();var h=g.meshId;Ext.Ajax.request({url:e.getUrlMeshNodes(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var l=g.addMarker({lat:i.lat,lng:i.lng,icon:d,draggable:true,title:i.name,listeners:{dragend:function(){e.dragEnd(i.id,g,l)},dragstart:function(){e.dragStart(i.id,g,l)}}})});g.setLoading(false)}},scope:e})}},0,0,0,0,0,0,[Rd.controller,"cAccessPointEdits"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointView",Ext.tab.Panel,{border:false,plain:true,cls:"subTab",tabPosition:"top",ap_id:undefined,apName:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sOverview"),itemId:"tabAccessPointViewOverwiew",xtype:"pnlChartApMain",apId:b.ap_id},{title:i18n("sSSID_to_Device"),itemId:"tabAccessPointViewEntries",xtype:"gridApViewEntries",apId:b.ap_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointView"],["component","box","container","panel","tabpanel","pnlAccessPointView"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessPointView:true},["widget.pnlAccessPointView"],0,[Rd.view.aps,"pnlAccessPointView"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartBase",Ext.panel.Panel,{layout:"fit",initComponent:function(){var b=this;b.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload")},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",labelWidth:40,extraParam:b.apId},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",pressed:true},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week"},{xtype:"button",text:"Past month",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"month"}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartBase"],["component","box","container","panel","pnlChartBase"],{component:true,box:true,container:true,panel:true,pnlChartBase:true},["widget.pnlChartBase"],0,[Rd.view.charts,"pnlChartBase"],0));(Ext.cmd.derive("Rd.view.charts.vcChartApData",Ext.app.ViewController,{span:"hour",entry_id:0,init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},onCmbSsidChange:function(d){var e=this;e.entry_id=d.getValue();e.load()},pnlAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var h=e.getView().apId;var g=e.getView().down("cartesian");g.getStore().getProxy().setExtraParams({timespan:e.span,entry_id:e.entry_id,ap_id:h});g.getStore().load()}},0,0,0,0,["controller.vcChartApData"],0,[Rd.view.charts,"vcChartApData"],0));(Ext.cmd.derive("Rd.view.aps.cmbAccessPointEntryPointReports",Ext.form.ComboBox,{fieldLabel:"SSID",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"entry_point_id",labelClsExtra:"lblRdReq",allowBlank:true,apId:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_reports/view_entry_points.json",extraParams:{ap_id:d.apId},reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;d.setValue(0);Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAccessPointEntryPointReports"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAccessPointEntryPointReports"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAccessPointEntryPointReports:true},["widget.cmbAccessPointEntryPointReports"],0,[Rd.view.aps,"cmbAccessPointEntryPointReports"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApData",Ext.panel.Panel,{controller:"vcChartApData",apId:"",listeners:{afterrender:"pnlAfterRender"},url:"/cake2/rd_cake/ap_reports/view_data_usage.json",initComponent:function(){var h=this;var g="Data usage";h.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"cmbAccessPointEntryPointReports",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"ssid",labelWidth:40,addAll:true,apId:h.apId,listeners:{change:"onCmbSsidChange"}},{xtype:"button",text:"Hourly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Daily",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Weekly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]},"->",{xtype:"component",itemId:"totals",tpl:"In <b>{in}</b> Out <b>{out}</b> Total <b>{total}</b>",style:"margin-right:5px",cls:"lblRd"}];h.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"}],proxy:{type:"ajax",format:"json",url:h.url,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(l){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var d=Ext.ux.bytesToHuman(a.totalIn);var k=Ext.ux.bytesToHuman(a.totalOut);var b=Ext.ux.bytesToHuman(a.totalInOut);h.down("#totals").update({"in":d,out:k,total:b})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:10,left:10,right:10,bottom:10},width:"100%",store:h.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["tx_bytes","rx_bytes"],renderer:function(a,b,d){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",fields:["time_unit"],position:"bottom",grid:true,label:{rotate:{degrees:-45}}}],series:[{type:"area",title:["TX Bytes","RX Bytes"],xField:"time_unit",yField:["tx_bytes","rx_bytes"],style:{opacity:0.8},marker:{opacity:0,scaling:0.01,fx:{duration:200,easing:"easeOut"}},highlightCfg:{opacity:1,scaling:1.5},tooltip:{trackMouse:true,renderer:function(a,k,b){var d=Ext.ux.bytesToHuman(k.get("tx_bytes"));var l=Ext.ux.bytesToHuman(k.get("rx_bytes"));a.setHtml("Data TX <b>"+d+"</b><br>Data RX <b>"+l+"</b>")}}}]});h.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartApData"],["component","box","container","panel","pnlChartApData"],{component:true,box:true,container:true,panel:true,pnlChartApData:true},["widget.pnlChartApData"],0,[Rd.view.charts,"pnlChartApData"],0));(Ext.cmd.derive("Rd.view.charts.vcChartApUsers",Ext.app.ViewController,{span:"hour",entry_id:0,init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},onCmbSsidChange:function(d){var e=this;e.entry_id=d.getValue();e.load()},pnlAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var h=e.getView().apId;var g=e.getView().down("cartesian");g.getStore().getProxy().setExtraParams({timespan:e.span,entry_id:e.entry_id,ap_id:h});g.getStore().load()}},0,0,0,0,["controller.vcChartApUsers"],0,[Rd.view.charts,"vcChartApUsers"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApUsers",Ext.panel.Panel,{controller:"vcChartApUsers",apId:"",listeners:{afterrender:"pnlAfterRender"},url:"/cake2/rd_cake/ap_reports/view_connected_users.json",initComponent:function(){var h=this;var g="Data usage";h.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"cmbAccessPointEntryPointReports",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"ssid",labelWidth:40,addAll:true,apId:h.apId,listeners:{change:"onCmbSsidChange"}},{xtype:"button",text:"Hourly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Daily",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Weekly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]},"->",{xtype:"component",itemId:"totals",tpl:"Users: <b>{users}</b>",style:"margin-right:5px",cls:"lblRd"}];h.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"users",type:"int"}],proxy:{type:"ajax",format:"json",url:h.url,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(b){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var d=a.totalUsers;h.down("#totals").update({users:d})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:10,left:10,right:10,bottom:10},width:"100%",store:h.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,increment:1,grid:true,fields:["users"],minimum:0},{type:"category",fields:["time_unit"],position:"bottom",grid:true,label:{rotate:{degrees:-45}}}],series:[{type:"area",title:["Users"],xField:"time_unit",yField:["users"],style:{opacity:0.8},marker:{opacity:0,scaling:0.01,fx:{duration:200,easing:"easeOut"}},highlightCfg:{opacity:1,scaling:1.5},tooltip:{trackMouse:true,renderer:function(b,j,d){var a=j.get("users");b.setHtml("<b>"+a+"</b> Users")}}}]});h.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartApUsers"],["component","box","container","panel","pnlChartApUsers"],{component:true,box:true,container:true,panel:true,pnlChartApUsers:true},["widget.pnlChartApUsers"],0,[Rd.view.charts,"pnlChartApUsers"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApMain",Ext.panel.Panel,{layout:{type:"hbox",pack:"start",align:"stretch"},defaults:{frame:false,bodyPadding:10},url:"/cake2/rd_cake/ap_reports/view_overview.json",apId:"",initComponent:function(){var b=this;b.items=[{flex:1,margin:"0 10 0 0",frame:false,border:false,layout:"fit",title:"Hardware",ui:"light",glyph:Rd.config.icnGears,itemId:"pnlOverview",tpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{img}.png" alt="dragino" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{model}</span>","</div>","<div class='twoColumnContainer'>",'<tpl for="components">',"<div class='twoColumnItem'>",'<div class="sectionHeader">',"<h2>{name}</h2>","</div>",'<ul class="fa-ul">','<tpl for="items">',"<tpl if=\"style == 'rdOk'\">","<li style='color:green;'><i class='fa-li fa  fa-check-circle'></i>","{description} <b>{value}</b>.</li>","</tpl>","<tpl if=\"style == 'rdWarn'\">","<li style='color:red;'><i class='fa-li fa  fa-exclamation-circle'></i>","{description} <b>{value}</b>.</li>","</tpl>","<tpl if=\"style == 'rdInfo'\">","<li><i class='fa-li fa fa-arrow-circle-right'></i>","{description} <b>{value}</b>.</li>","</tpl>","</tpl>","</ul>","</div>","</tpl>","</div>"),tools:[{type:"refresh",tooltip:"Refresh",handler:function(g,h,a){b.refresh()}}]},{flex:1,frame:false,border:false,layout:"accordion",scrollable:true,items:[{title:i18n("sData_Usage"),glyph:Rd.config.icnData,layout:"fit",margins:"0 0 0 0",plain:true,xtype:"pnlChartApData",apId:b.apId},{title:i18n("sUsers_Connected"),glyph:Rd.config.icnUser,layout:"fit",margins:"0 0 0 0",plain:true,xtype:"pnlChartApUsers",apId:b.apId}]}];b.fetchData();Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},refresh:function(){var b=this;b.down("#pnlOverview").setLoading(true);b.fetchData()},fetchData:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",params:{ap_id:b.apId},success:"dataToGui",scope:b})},dataToGui:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);h.down("#pnlOverview").setLoading(false);if(e.success==true){h.down("#pnlOverview").setData(e.data)}}},0,["pnlChartApMain"],["component","box","container","panel","pnlChartApMain"],{component:true,box:true,container:true,panel:true,pnlChartApMain:true},["widget.pnlChartApMain"],0,[Rd.view.charts,"pnlChartApMain"],0));(Ext.cmd.derive("Rd.model.mApViewEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"ap_profile_entry_id"},{name:"mac"},{name:"vendor"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_node"}]},0,0,0,0,0,0,[Rd.model,"mApViewEntry"],0));(Ext.cmd.derive("Rd.store.sApViewEntries",Ext.data.Store,{model:"Rd.model.mApViewEntry",remoteSort:false,groupField:"name",proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_reports/view_entries.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sApViewEntries"],0));(Ext.cmd.derive("Rd.view.aps.vcApViewEntries",Ext.app.ViewController,{span:"hour",init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},gridAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var d=e.getView().apId;e.getView().getStore().getProxy().setExtraParams({timespan:e.span,ap_id:d});e.getView().getStore().load()}},0,0,0,0,["controller.vcApViewEntries"],0,[Rd.view.aps,"vcApViewEntries"],0));(Ext.cmd.derive("Rd.view.aps.gridApViewEntries",Ext.grid.Panel,{controller:"vcApViewEntries",multiSelect:true,stateful:true,stateId:"StateGridApViewEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},apId:"",listeners:{afterrender:"gridAfterRender"},tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"button",text:"Past hour",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Past day",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Past week",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:"{name}",hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sApViewEntries,{});b.store.getProxy().setExtraParam("ap_id",b.apId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApViewEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridApViewEntries2"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridApViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridApViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var t=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var B=k.get("l_tx_bitrate");var h=k.get("l_rx_bitrate");var y=k.get("l_modified");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var e=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var g=k.get("l_tx_failed");var A=k.get("l_tx_retries");var i=k.get("l_authenticated");var d=k.get("l_authorized");var p=k.get("l_node");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+B+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+h+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApViewEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApViewEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApViewEntries:true},["widget.gridApViewEntries"],0,[Rd.view.aps,"gridApViewEntries"],0));(Ext.cmd.derive("Rd.controller.cAccessPointViews",Ext.app.Controller,{views:["aps.pnlAccessPointView","charts.pnlChartApMain","aps.gridApViewEntries"],config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlMapPrefView:"/cake2/rd_cake/ap_profiles/map_pref_view.json",urlOverviewGoogleMap:"/cake2/rd_cake/ap_reports/overview_google_map.json",urlRestartNodes:"/cake2/rd_cake/ap_reports/restart_nodes.json",urlApProfileAddApAction:"/cake2/rd_cake/ap_actions/add.json"},refs:[{ref:"tabAccessPoints",selector:"#tabAccessPoints"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlApView gridAccessPointViewEntries #reload":{click:b.reloadViewEntry},"pnlApView gridAccessPointViewEntries button":{toggle:b.viewEntryTimeToggle},"pnlApView #tabAccessPointViewEntries":{},"pnlApView gridAccessPointViewEntries #reload menuitem[group=refresh]":{click:function(e){var a=this;a.autoRefresh(e,"entries")}},pnlApView:{beforeshow:b.pnlViewClose,destroy:b.pnlViewClose}})},actionIndex:function(m,i){var n=this;var k="tabAccessPointView"+m;var j=n.getTabAccessPoints();var l=j.items.findBy(function(a){return a.getItemId()===k});if(!l){l=j.add({glyph:Rd.config.icnView,title:i,closable:true,layout:"fit",xtype:"pnlAccessPointView",itemId:k,ap_id:m})}j.setActiveTab(l)},viewEntryTimeToggle:function(g,h){var e=this;if(h){e.reloadViewEntry(g)}},reloadViewEntry:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewEntries");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},viewNodeTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNode(g)}},reloadViewNode:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewNodes");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},viewNodeNodesTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNodeNodes(g)}},reloadViewNodeNodes:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewNodeNodes");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},tabMeshViewNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNode(b)},tabMeshViewEntriesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewEntry(b)},tabMeshViewNodeNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeNodes(b)},tabMeshViewNodeDetailsActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeDetails(b)},autoRefresh:function(n,k){var l=this;var j=n.getItemId();var b=n.up("button");var m=30000;clearInterval(l.autoRefresInterval);b.setGlyph(Rd.config.icnTime);if(j=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(j=="mnuRefresh1m"){m=60000}if(j=="mnuRefresh5m"){m=360000}l.autoRefresInterval=setInterval(function(){if(k=="nodes"){l.reloadViewNode(b)}if(k=="node_nodes"){l.reloadViewNodeNodes(b)}if(k=="entries"){l.reloadViewEntry(b)}},m)},pnlViewClose:function(){var b=this;if(b.autoRefresInterval!=undefined){clearInterval(b.autoRefresInterval)}}},0,0,0,0,0,0,[Rd.controller,"cAccessPointViews"],0));(Ext.cmd.derive("Rd.view.aps.gridApProfiles",Ext.grid.Panel,{multiSelect:true,store:"sApProfiles",stateful:true,stateId:"StateGridApProfiles",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApProfiles1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApProfiles2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridApProfiles3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridApProfiles4"},{text:"AP Count",dataIndex:"ap_count",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl><div class="fieldGreyWhite">{ap_count}</div></tpl>'),stateId:"StateGridApProfiles7",width:Rd.config.gridNumberCol},{text:"APs Up",dataIndex:"aps_up",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='aps_up &gt; 0'><div class=\"fieldGreenWhite\">{aps_up}</div>",'<tpl else><div class="fieldBlue">{aps_up}</div></tpl>'),stateId:"StateGridApProfiles8",width:Rd.config.gridNumberCol},{text:"APs Down",dataIndex:"aps_down",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='aps_down &gt; 0'><div class=\"fieldRedWhite\">{aps_down}</div>",'<tpl else><div class="fieldBlue">{aps_down}</div></tpl>'),stateId:"StateGridApProfiles9",width:Rd.config.gridNumberCol},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridApProfiles10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApProfiles"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApProfiles"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApProfiles:true},["widget.gridApProfiles"],0,[Rd.view.aps,"gridApProfiles"],0));(Ext.cmd.derive("Rd.view.aps.gridApLists",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridApLists",stateEvents:["groupclick","columnhide"],store:"sApLists",border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_aps_grid.json",plugins:["gridfilters",{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{hardware}.png" alt="{hardware}" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{hw_human}</span>","</div>",'<div class="sectionHeader">',"<h2>DEVICE INFORMATION (for the past hour)</h2>","</div>","<div style='background-color:white; padding:5px;'>",'<ul class="fa-ul">',"<tpl if='state == \"never\"'>","<li style='color:blue;'><i class='fa-li fa fa-question-circle'></i>Never connected before</li>","</tpl>","<tpl if='state == \"down\"'>","<li style='color:red;'><i class='fa-li fa  fa-exclamation-circle'></i>Offline (last check-in <b>{last_contact_human}</b> ago).</li>","</tpl>","<tpl if='state == \"up\"'>",'<li style="color:green;"><i class="fa-li fa fa-check-circle"></i>Online (last check-in <b>{last_contact_human}</b> ago).</li>',"</tpl>",'<tpl for="ssids">','<li><i class="fa-li fa fa-wifi"></i><b>{name}</b> had <b>{users}</b> users.</li>',"</tpl>",'<li><i class="fa-li fa fa-info-circle"></i>Public IP <b>{last_contact_from_ip}</b>.</li>','<li><i class="fa-li fa fa-database"></i>Data usage <b>{data_past_hour}</b>.</li>','<li><i class="fa-li fa fa-link"></i>Last connection from <b>{newest_station}</b> which was <b>{newest_time}</b> ({newest_vendor}).</li>',"</ul>","</div>")}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApLists1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,stateId:"StateGridApLists2",sortable:false,hidden:true},{text:i18n("sProfile"),dataIndex:"ap_profile",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridApLists4"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists5",hidden:true},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists6"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists7",hidden:true},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",width:170,renderer:function(k,l,a){var i=a.get("state");if(i!="never"){var j=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreenWhite">'+j+"</div>"}if(i=="down"){return'<div class="fieldRedWhite">'+j+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGridApLists8"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",width:170,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_from_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGridApLists9"},{text:"Last command",sortable:false,width:170,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'last_cmd_status == ""\'><div class="fieldBlue">(nothing)</div></tpl>','<tpl if=\'last_cmd_status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> {last_cmd}</div></tpl>','<tpl if=\'last_cmd_status == "fetched"\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> {last_cmd}</div></tpl>'),stateId:"StateGridApLists10",hidden:false},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGridApLists11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApLists:true},["widget.gridApLists"],0,[Rd.view.aps,"gridApLists"],0));(Ext.cmd.derive("Rd.view.aps.gridUnknownAps",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUnknownAps",stateEvents:["groupclick","columnhide"],border:false,store:"sUnknownAps",viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/unknown_aps/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridUnknownAps1"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUnknownAps2"},{text:i18n("sVendor"),dataIndex:"vendor",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUnknownAps3"},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUnknownAps4"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUnknownAps5"},{text:"Redirect To",flex:1,hidden:false,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='new_server'>",'<tpl if=\'new_server_status == "awaiting"\'><div class="fieldBlueWhite">{new_server}</div></tpl>','<tpl if=\'new_server_status == "fetched"\'><div class="fieldGreenWhite">{new_server}</div></tpl>',"</tpl>"),dataIndex:"new_server",filter:{type:"boolean"},stateId:"StateGridUnknownAps6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownAps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownAps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownAps:true},["widget.gridUnknownAps"],0,[Rd.view.aps,"gridUnknownAps"],0));(Ext.cmd.derive("Rd.model.mAccessProviderTree",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"}],idProperty:"id"},0,0,0,0,0,0,[Rd.model,"mAccessProviderTree"],0));(Ext.cmd.derive("Rd.model.mUnknownAp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"},{name:"vendor",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},"last_contact_human","country_code","country_name","city","postal_code","new_server","new_server_status"]},0,0,0,0,0,0,[Rd.model,"mUnknownAp"],0));(Ext.cmd.derive("Rd.model.mApProfile",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"ap_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"aps_up",type:"int"},{name:"aps_down",type:"int"},{name:"connected_users",type:"int"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"view",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mApProfile"],0));(Ext.cmd.derive("Rd.model.mApList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"ap_profile",type:"string"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"last_contact_human","state","country_code","country_name","city","postal_code","data_past_hour","newest_station","newest_time","newest_vendor","ssids","hardware","hw_human","last_cmd","last_cmd_status","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mApList"],0));(Ext.cmd.derive("Rd.model.mDynamicDetail",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},"user_id","phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon","theme","register_users","lost_password",{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicDetail"],0));(Ext.cmd.derive("Rd.view.components.winHardwareAddAction",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:220,glyph:Rd.config.icnAdd,grid:null,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winHardwareAddAction"],["component","box","container","panel","window","winHardwareAddAction"],{component:true,box:true,container:true,panel:true,window:true,winHardwareAddAction:true},["widget.winHardwareAddAction"],0,[Rd.view.components,"winHardwareAddAction"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAttachAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Device to Profile",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAttach,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"saveAttach",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:g.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAttachAp"],["component","box","container","panel","window","winAccessPointAttachAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAttachAp:true},["widget.winAccessPointAttachAp"],0,[Rd.view.aps,"winAccessPointAttachAp"],0));(Ext.cmd.derive("Rd.store.sAccessProvidersTree",Ext.data.TreeStore,{model:"Rd.model.mAccessProviderTree",proxy:{type:"ajax",url:"/cake3/rd_cake/access-providers/index-tree.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},root:{username:i18n("sLogged_in_user"),leaf:false,id:"0",iconCls:"admin",expanded:false,monitor:"na",active:"na"},listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},exception:function(h,e,g){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.responseText,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sAccessProvidersTree"],0));(Ext.cmd.derive("Rd.store.sUnknownAps",Ext.data.Store,{model:"Rd.model.mUnknownAp",remoteSort:false,proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/unknown_aps/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/unknown_aps/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownAps"],0));(Ext.cmd.derive("Rd.store.sApProfiles",Ext.data.Store,{model:"Rd.model.mApProfile",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},listeners:{exception:function(h,e,g){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.responseText,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},api:{destroy:"/cake2/rd_cake/ap_profile/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sApProfiles"],0));(Ext.cmd.derive("Rd.store.sApLists",Ext.data.Store,{model:"Rd.model.mApList",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/aps/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_ap_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sApLists"],0));(Ext.cmd.derive("Rd.view.aps.winApUnknownRedirect",Ext.window.Window,{title:"Redirect To Another Server",layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnRedirect,unknownApId:"",new_server:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"unknown_node_id",xtype:"textfield",name:"id",hidden:true,value:b.unknownApId},{xtype:"textfield",fieldLabel:"IP Address / FQDN",name:"new_server",allowBlank:false,labelClsExtra:"lblRdReq",value:b.new_server}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winApUnknownRedirect"],["component","box","container","panel","window","winApUnknownRedirect"],{component:true,box:true,container:true,panel:true,window:true,winApUnknownRedirect:true},["widget.winApUnknownRedirect"],0,[Rd.view.aps,"winApUnknownRedirect"],0));(Ext.cmd.derive("Rd.view.aps.winApProfileAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:"New Access Point Profile",width:400,height:400,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,formBind:true}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,formBind:true}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winApProfileAddWizard"],["component","box","container","panel","window","winApProfileAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winApProfileAddWizard:true},["widget.winApProfileAddWizard"],0,[Rd.view.aps,"winApProfileAddWizard"],0));(Ext.cmd.derive("Rd.controller.cAccessPoints",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:true,itemId:"tabAccessPoints",items:[{xtype:"gridApProfiles",title:i18n("sAccess_Point_Profiles"),glyph:Rd.config.icnProfile},{xtype:"gridApLists",title:i18n("sAttached_Devices"),glyph:Rd.config.icnChain},{xtype:"gridUnknownAps",title:i18n("sDetached_Devices"),glyph:Rd.config.icnChainBroken}]});d.populated=true},views:["aps.gridApProfiles","aps.gridApLists","aps.gridUnknownAps","aps.winAccessPointAttachAp","aps.cmbApHardwareModels","aps.winApProfileAddWizard","aps.winAccessPointEditAp","aps.winAccessPointAddAp","components.cmbDynamicDetail","components.winHardwareAddAction","aps.winApUnknownRedirect"],stores:["sAccessProvidersTree","sUnknownAps","sApProfiles","sApLists"],models:["mAccessProviderTree","mUnknownAp","mApProfile","mApList","mDynamicDetail"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake2/rd_cake/ap_profiles/add.json",urlDelete:"/cake2/rd_cake/ap_profiles/delete.json",urlAddAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_add.json",urlViewAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_view.json",urlEditAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_edit.json",urlAdvancedSettingsForModel:"/cake2/rd_cake/ap_profiles/advanced_settings_for_model.json",urlNoteAdd:"/cake2/rd_cake/ap_profiles/note_add.json",urlApProfileAddApAction:"/cake2/rd_cake/ap_actions/add.json",urlRestartAps:"/cake2/rd_cake/ap_actions/restart_aps.json",urlRedirectAp:"/cake2/rd_cake/aps/redirect_unknown.json"},refs:[{ref:"grid",selector:"gridApProfiles"},{ref:"gridApLists",selector:"gridApLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabAccessPoints":{destroy:b.appClose},"#tabAccessPoints gridApProfiles":{activate:b.gridActivate},"#tabAccessPoints gridApLists":{activate:b.gridActivate},"#tabAccessPoints gridUnknownAps":{activate:b.gridActivate},"gridApProfiles #reload":{click:b.reload},"gridApProfiles #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridApProfiles #add":{click:b.add},"gridApProfiles #delete":{click:b.del},"gridApProfiles #edit":{click:b.edit},gridApProfiles:{select:b.select},"winApProfileAddWizard #btnTreeNext":{click:b.btnTreeNext},"winApProfileAddWizard #btnDataPrev":{click:b.btnDataPrev},"winApProfileAddWizard #btnDataNext":{click:b.btnDataNext},"gridUnknownAps #reload":{click:b.gridUnknownApsReload},"gridUnknownAps #reload menuitem[group=refresh]":{click:b.reloadUnknownApsOptionClick},"gridUnknownAps #attach":{click:b.attachAp},"winAccessPointAttachAp cmbHardwareOptions":{change:b.cmbHardwareOptionsChange},"winAccessPointAttachAp #saveAttach":{click:b.btnAttachApSave},"gridUnknownAps #delete":{click:b.delUnknownAp},"gridUnknownAps #redirect":{click:b.redirectAp},"winApUnknownRedirect #save":{click:b.btnRedirectApSave},"gridApLists #reload":{click:b.gridApListsReload},"gridApLists #reload menuitem[group=refresh]":{click:b.reloadApListsOptionClick},"gridApLists #add":{click:b.addAp},"#winAccessPointAddApMain #save":{click:b.btnAddApSave},"gridApLists #delete":{click:b.delAp},"gridApLists #edit":{click:b.editAp},"#winAccessPointEditApMain":{beforeshow:b.loadAp},"#winAccessPointEditApMain #save":{click:b.btnEditApSave},"gridApLists #view":{click:b.viewAp},"gridApLists #execute":{click:b.execute},"#winHardwareAddActionMain #save":{click:b.commitExecute},"gridApLists #restart":{click:b.restart},"winAccessPointAttachAp #chkRadio0Enable":{change:b.chkRadioEnableChange},"winAccessPointAttachAp #chkRadio1Enable":{change:b.chkRadioEnableChange},"winAccessPointAttachAp radio[name=radio0_band]":{change:b.radio_0_BandChange},"winAccessPointAttachAp radio[name=radio1_band]":{change:b.radio_1_BandChange},"winAccessPointAttachAp cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},winAccessPointAttachAp:{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointAddApMain #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApMain #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApMain radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointAddApMainradio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointAddApMain cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"#winAccessPointAddApMain":{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointEditApMain #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApMain #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApMain radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointEditApMain radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointEditApMain cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"gridApProfiles #note":{click:b.note},"gridNote[noteForGrid=ap_profiles] #reload":{click:b.noteReload},"gridNote[noteForGrid=ap_profiles] #add":{click:b.noteAdd},"gridNote[noteForGrid=ap_profiles] #delete":{click:b.noteDelete},"gridNote[noteForGrid=ap_profiles]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=ap_profiles] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=ap_profiles] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=ap_profiles] #btnNoteAddNext":{click:b.btnNoteAddNext}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadApLists!=undefined){clearInterval(b.autoReloadApLists)}if(b.autoReloadUnknownAps!=undefined){clearInterval(b.autoReloadUnknownAps)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},gridActivate:function(d){var e=this;d.getStore().load()},gridApListsReload:function(g){var h=this;var e=g.up("gridApLists");e.getStore().load()},reloadApListsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadApLists);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadApLists=setInterval(function(){j.gridApListsReload(b)},k)},gridUnknownApsReload:function(g){var h=this;var e=g.up("gridUnknownAps");e.getStore().load()},reloadUnknownApsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownAps);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownAps=setInterval(function(){j.gridUnknownApsReload(b)},k)},select:function(m,n){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=n.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=n.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var j=n.get("view");if(j==true){if(tb.down("#view")!=null){tb.down("#view").setDisabled(false)}}else{if(tb.down("#view")!=null){tb.down("#view").setDisabled(true)}}},addAp:function(l){var j=this;var k=l.up("#tabAccessPoints");var h=k.down("gridApLists").getStore();if(!Ext.WindowManager.get("winAccessPointAddApId")){var i=Ext.widget("winAccessPointAddAp",{id:"winAccessPointAddApId",store:h,apProfileId:"",apProfileName:"",itemId:"winAccessPointAddApMain"});i.show()}},btnAddApSave:function(h){var j=this;var i=h.up("winAccessPointAddAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delAp:function(e){var h=this;var g=e.up("gridApLists");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},editAp:function(p){var o=this;var r=p.up("#tabAccessPoints");var l=r.down("gridApLists").getStore();if(r.down("gridApLists").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var t=r.down("gridApLists").getSelectionModel().getLastSelected();var s=t.getId();var q=t.get("ap_profile_id");var n=t.get("ap_profile");if(!Ext.WindowManager.get("winAccessPointEditApId")){var m=Ext.widget("winAccessPointEditAp",{id:"winAccessPointEditApId",store:l,apId:s,apProfileId:q,apProfileName:n,itemId:"winAccessPointEditApMain"});m.show()}}},loadAp:function(l){var n=this;var i=l.down("form");var k=l.apId;i.load({url:n.getUrlViewAp(),method:"GET",params:{ap_id:k}});var m=i.down("#tabAdvWifiRadio1");m.setDisabled(true);m.tab.hide();var j=i.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide()},btnEditApSave:function(h){var j=this;var i=h.up("winAccessPointEditAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},execute:function(l){var j=this;var k=l.up("#tabAccessPoints");var h=k.down("gridApLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sSelect_an_item_on_which_to_execute_the_command"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winHardwareAddActionMain")){var i=Ext.widget("winHardwareAddAction",{id:"winHardwareAddActionMain",grid:h});i.show()}}},commitExecute:function(j){var m=this;var k=j.up("#winHardwareAddActionMain");var n=k.down("form");var i=k.grid.getSelectionModel().getSelection();var l=[];Ext.Array.forEach(i,function(b){var a=b.getId();Ext.Array.push(l,{id:a})});n.submit({clientValidation:true,url:m.getUrlApProfileAddApAction(),params:l,success:function(b,a){k.grid.getStore().reload();k.close();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:m,failure:Ext.ux.formFail})},restart:function(g){var i=this;var j=g.up("#tabAccessPoints");var h=j.down("gridApLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_restart"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(d){if("yes"===d){var b=h.getSelectionModel().getSelection();var a=[];Ext.Array.forEach(b,function(l){var e=l.getId();Ext.Array.push(a,{id:e})});Ext.Ajax.request({url:i.getUrlRestartAps(),method:"POST",jsonData:{aps:a},success:function(e,l){Ext.ux.Toaster.msg(i18n("sCommand_queued"),i18n("sCommand_queued_for_execution"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().reload()},failure:function(e,l){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().reload()}})}}})}},viewAp:function(i){var l=this;var m=l.getGridApLists().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGridApLists().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cAccessPointViews","Index",k,j)}}},attachAp:function(r){var o=this;var p=r.up("#tabAccessPoints");var k=p.down("gridUnknownAps").getStore();if(p.down("gridUnknownAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var q=p.down("gridUnknownAps").getSelectionModel().getLastSelected();var m=q.getId();var n=q.get("mac");if(!Ext.WindowManager.get("winAccessPointAttachApId")){var l=Ext.widget("winAccessPointAttachAp",{id:"winAccessPointAttachApId",mac:n,store:k});l.show()}}},btnAttachApSave:function(h){var j=this;var i=h.up("winAccessPointAttachAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delUnknownAp:function(e){var h=this;var g=e.up("gridUnknownAps");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sFirst_select_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}}})}},chkRadioEnableChange:function(l){var k=this;var h=l.up("panel");var j=l.getValue();h.down("fieldcontainer").setVisible(j);var i=Ext.ComponentQuery.query("field",h);Ext.Array.forEach(i,function(a){if(a!=l){if(!(a.isDisabled())){a.setVisible(j)}}})},radio_0_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},radio_1_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},cmbApHardwareModelsChange:function(r){var m=this;var t=r.up("form");var s=r.getValue();var o=1;var q=r.getSelection();if(q!=null){o=q.get("radios")}var l=t.down("#tabRadiosRadio1");var p=t.down("#tabAdvWifiRadio1");var n=r.up("window");if(n.getItemId()!="winAccessPointEditApMain"){t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s}})}else{t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s,ap_id:n.apId}})}if(o==2){l.setDisabled(false);l.tab.show();p.setDisabled(false);p.tab.show()}else{l.setDisabled(true);l.tab.hide();p.setDisabled(true);p.tab.hide()}},loadAdvancedWifiSettings:function(m){var o=this;var p=m.down("form");var k=p.down("cmbApHardwareModels");var l=k.getValue();var n=p.down("#tabAdvWifiRadio1");n.setDisabled(true);n.tab.hide();var j=p.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide();p.load({url:o.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:l}})},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winApProfileAddWizardId")){var h=Ext.widget("winApProfileAddWizard",{id:"winApProfileAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winApProfileAddWizardId")){var h=Ext.widget("winApProfileAddWizard",{id:"winApProfileAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winApProfileAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winApProfileAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sApProfiles").load();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){var h=b.getGrid().getSelectionModel().getSelection();var g=[];Ext.Array.forEach(h,function(e){var d=e.getId();Ext.Array.push(g,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:g,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}}})}},edit:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cAccessPointEdits","Index",k,j)}}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteApProfiles"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteApProfiles"+m.getId(),noteForId:m.getId(),noteForGrid:"ap_profiles",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteApProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteApProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}}})}},redirectAp:function(q){var n=this;var o=q.up("#tabAccessPoints");var r=o.down("gridUnknownAps").getStore();if(o.down("gridUnknownAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=o.down("gridUnknownAps").getSelectionModel().getLastSelected();var m=p.getId();var l=p.get("new_server");if(!Ext.WindowManager.get("winApUnknownRedirectId")){var k=Ext.widget("winApUnknownRedirect",{id:"winApUnknownRedirectId",unknownApId:m,new_server:l,store:r});k.show()}}},btnRedirectApSave:function(h){var j=this;var i=h.up("winApUnknownRedirect");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlRedirectAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cAccessPoints"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridAccessProviders",Ext.grid.Panel,{multiSelect:true,store:"sAccessProvidersGrid",stateful:true,stateId:"StateGridAccessProviders",stateEvents:["groupclick","columnhide"],border:false,urlMenu:"/cake3/rd_cake/access-providers/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessProviders1"},{text:i18n("sOwner"),sortable:true,flex:1,dataIndex:"owner",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders2"},{text:i18n("sUsername"),sortable:true,flex:1,dataIndex:"username",tdCls:"gridMain",filter:{type:"string"},stateId:"StateGridAccessProviders3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders4"},{text:i18n("sSurname"),dataIndex:"surname",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders5"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders6"},{text:i18n("s_email"),flex:1,dataIndex:"email",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders7"},{text:i18n("sActive"),xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridAccessProviders9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridAccessProviders10",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridAccessProviders11"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridAccessProviders12"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessProviders"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessProviders"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessProviders:true},["widget.gridAccessProviders"],0,[Rd.view.accessProviders,"gridAccessProviders"],0));(Ext.cmd.derive("Rd.view.components.winCsvColumnSelect",Ext.window.Window,{title:i18n("sCSV_export"),layout:"fit",autoShow:false,width:450,height:400,glyph:Rd.config.icnCsv,columns:[],initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"checkboxgroup",columns:2,vertical:true,items:b.columns}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winCsvColumnSelect"],["component","box","container","panel","window","winCsvColumnSelect"],{component:true,box:true,container:true,panel:true,window:true,winCsvColumnSelect:true},["widget.winCsvColumnSelect"],0,[Rd.view.components,"winCsvColumnSelect"],0));(Ext.cmd.derive("Rd.model.mApUserRight",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"group_right"},{name:"parent_id",type:"int"},{name:"allowed",type:"bool"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index_ap.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mApUserRight"],0));(Ext.cmd.derive("Rd.model.mApRealms",Ext.data.Model,{fields:["id","name","create","read","update","delete"]},0,0,0,0,0,0,[Rd.model,"mApRealms"],0));(Ext.cmd.derive("Rd.model.mAccessProviderGrid",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"username",type:"string"},"name","surname","phone","email","monitor","active","language",{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAccessProviderGrid"],0));(Ext.cmd.derive("Rd.view.accessProviders.pnlAccessProvider",Ext.tab.Panel,{border:false,ap_id:null,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;if(b.limits){b.items=[{title:i18n("sDetail"),itemId:"tabDetail",xtype:"pnlAccessProviderDetail",ap_id:b.ap_id},{title:i18n("sRealms"),itemId:"tabRealms",xtype:"gridApRealms",ap_id:b.ap_id},{title:i18n("sRights"),itemId:"tabRights",xtype:"treeApUserRights",ap_id:b.ap_id},{title:i18n("sLimits"),itemId:"tabLimits",xtype:"gridAccessProviderLimits",ap_id:b.ap_id}]}else{b.items=[{title:i18n("sDetail"),itemId:"tabDetail",xtype:"pnlAccessProviderDetail",ap_id:b.ap_id},{title:i18n("sRealms"),itemId:"tabRealms",xtype:"gridApRealms",ap_id:b.ap_id},{title:i18n("sRights"),itemId:"tabRights",xtype:"treeApUserRights",ap_id:b.ap_id}]}Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessProvider"],["component","box","container","panel","tabpanel","pnlAccessProvider"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessProvider:true},["widget.pnlAccessProvider"],0,[Rd.view.accessProviders,"pnlAccessProvider"],0));(Ext.cmd.derive("Rd.store.sLanguages",Ext.data.Store,{fields:["id","country","language","icon_file","text","rtl"],proxy:{type:"rest",url:"/cake3/rd_cake/dashboard/i18n.json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sLanguages"],0));(Ext.cmd.derive("Rd.model.mApRight",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"parent_id",type:"int"},{name:"allowed",type:"bool"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index_ap.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mApRight"],0));(Ext.cmd.derive("Rd.store.sApRights",Ext.data.TreeStore,{model:"Rd.model.mApRight",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index_ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index_ap.json",update:"/cake2/rd_cake/acos_rights/edit_ap.json"}},root:{alias:i18n("sDefault_Access_Provider_Rights"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}},0,0,0,0,0,0,[Rd.store,"sApRights"],0));(Ext.cmd.derive("Rd.store.sAccessProvidersGrid",Ext.data.Store,{model:"Rd.model.mAccessProviderGrid",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/access-providers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessProvidersGrid"],0));(Ext.cmd.derive("Rd.view.accessProviders.winApAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_Access_Provider"),width:400,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"parent_id",xtype:"textfield",name:"parent_id",value:e.user_id,hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"}]},{title:i18n("sOptional_info"),layout:"anchor",itemId:"tabOptional",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name"},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",vtype:"email"},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]}]}]});return d}},0,["winApAddWizard"],["component","box","container","panel","window","winApAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winApAddWizard:true},["widget.winApAddWizard"],0,[Rd.view.accessProviders,"winApAddWizard"],0));(Ext.cmd.derive("Rd.view.components.winNoteAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Note"),width:350,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",noteForId:"",noteForGrid:"",refreshGrid:"",initComponent:function(){var e=this;var h=e.mkScrnApTree();var g=e.mkScrnNote();e.items=[h,g];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnNote:function(){var e=this;var g=[{itemId:"btnNoteAddPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnNoteAddNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnNoteAddNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnNote",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"note",fieldLabel:i18n("sNote"),anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winNoteAdd"],["component","box","container","panel","window","winNoteAdd"],{component:true,box:true,container:true,panel:true,window:true,winNoteAdd:true},["widget.winNoteAdd"],0,[Rd.view.components,"winNoteAdd"],0));(Ext.cmd.derive("Rd.view.components.winEnableDisable",Ext.window.Window,{title:i18n("sEnable_fs_Disable"),layout:"fit",autoShow:false,width:350,height:300,iconCls:"rights",glyph:Rd.config.icnLight,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:i18n("sAction"),columns:1,vertical:true,items:[{boxLabel:i18n("sEnable"),name:"rb",inputValue:"enable",checked:true},{boxLabel:i18n("sDisable"),name:"rb",inputValue:"disable"}]}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winEnableDisable"],["component","box","container","panel","window","winEnableDisable"],{component:true,box:true,container:true,panel:true,window:true,winEnableDisable:true},["widget.winEnableDisable"],0,[Rd.view.components,"winEnableDisable"],0));(Ext.cmd.derive("Rd.model.mNote",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"note",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNote"],0));(Ext.cmd.derive("Rd.view.components.gridNote",Ext.grid.Panel,{multiSelect:true,border:false,noteForId:"",noteForGrid:"",tbar:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete"),disabled:true}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer"},{text:i18n("sNote"),dataIndex:"note",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{note}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{note}</div></tpl>")},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",width:150}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mNote",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/"+b.noteForGrid+"/note-index.json",extraParams:{for_id:b.noteForId},reader:{type:"json",rootProperty:"items",messageProperty:"message",keepRawData:true},api:{destroy:"/cake3/rd_cake/"+b.noteForGrid+"/note-del.json"}},autoLoad:true});b.getStore().addListener("load",b.onStoreNoteLoaded,b);Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},onStoreNoteLoaded:function(){var d=this;console.log(d.getStore().getTotalCount());var e=d.getStore().getTotalCount();d.down("#count").update({count:e})}},0,["gridNote"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNote"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNote:true},["widget.gridNote"],0,[Rd.view.components,"gridNote"],0));(Ext.cmd.derive("Rd.view.components.winNote",Ext.window.Window,{title:i18n("sNote_management"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"note",glyph:Rd.config.icnNote,noteForId:"",noteForGrid:"",noteForName:"",initComponent:function(){var b=this;b.items={xtype:"gridNote",noteForId:b.noteForId,noteForGrid:b.noteForGrid};b.title=i18n("sNote_management")+": "+b.noteForName;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winNote"],["component","box","container","panel","window","winNote"],{component:true,box:true,container:true,panel:true,window:true,winNote:true},["widget.winNote"],0,[Rd.view.components,"winNote"],0));(Ext.cmd.derive("Rd.view.accessProviders.vcAccessProviderDetails",Ext.app.ViewController,{init:function(){},onChkWlActiveChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("#txtWlHeader").setDisabled(false);e.down("#clrWlHeaderBg").setDisabled(false);e.down("#clrWlHeaderFg").setDisabled(false);e.down("#txtWlFooter").setDisabled(false);e.down("#chkWlImgActive").setDisabled(false);e.down("#flWlImgFileUpload").setDisabled(false)}else{e.down("#txtWlHeader").setDisabled(true);e.down("#clrWlHeaderBg").setDisabled(true);e.down("#clrWlHeaderFg").setDisabled(true);e.down("#txtWlFooter").setDisabled(true);e.down("#chkWlImgActive").setDisabled(true);e.down("#flWlImgFileUpload").setDisabled(true)}},onChkWlImgActiveChange:function(h){var j=this;var g=h.up("panel");var i=h.getValue();if(i){g.down("#flWlImgFileUpload").setDisabled(false)}else{g.down("#flWlImgFileUpload").setDisabled(true)}}},0,0,0,0,["controller.vcAccessProviderDetails"],0,[Rd.view.accessProviders,"vcAccessProviderDetails"],0));(Ext.cmd.derive("Rd.view.accessProviders.pnlAccessProviderDetail",Ext.panel.Panel,{border:false,ap_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},controller:"vcAccessProviderDetails",initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,border:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true,value:b.ap_id,itemId:"ap_id"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"}]},{title:i18n("sOptional_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name"},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",vtype:"email"},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]},{title:"White Label",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",itemId:"chkWlActive",fieldLabel:i18n("sActivate"),name:"wl_active",inputValue:"wl_active",checked:false,listeners:{change:"onChkWlActiveChange"}},{xtype:"textfield",fieldLabel:"Header Text",name:"wl_header",itemId:"txtWlHeader",disabled:true},{xtype:"colorfield",fieldLabel:"Header Background",name:"wl_h_bg",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#FFFFFF",itemId:"clrWlHeaderBg",disabled:true},{xtype:"colorfield",fieldLabel:"Header Foreground",name:"wl_h_fg",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#4b4c4c",itemId:"clrWlHeaderFg",disabled:true},{xtype:"textfield",fieldLabel:"Footer Text",name:"wl_footer",itemId:"txtWlFooter",disabled:true},{xtype:"checkbox",itemId:"chkWlImgActive",fieldLabel:"Include Logo",name:"wl_img_active",inputValue:"wl_img_active",checked:false,disabled:true,listeners:{change:"onChkWlImgActiveChange"}},{xtype:"filefield",itemId:"flWlImgFileUpload",emptyText:i18n("sSelect_an_image"),fieldLabel:"New Logo File",allowBlank:true,name:"wl_img_file_upload",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"textfield",name:"wl_img_file",hidden:true},{xtype:"image",autoEl:"div",title:"Current Logo",itemId:"imgWlLogo"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessProviderDetail"],["component","box","container","panel","pnlAccessProviderDetail"],{component:true,box:true,container:true,panel:true,pnlAccessProviderDetail:true},["widget.pnlAccessProviderDetail"],0,[Rd.view.accessProviders,"pnlAccessProviderDetail"],0));(Ext.cmd.derive("Rd.view.components.advCheckColumn",Ext.grid.column.Check,{renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},0,["advCheckColumn"],["component","box","container","headercontainer","gridcolumn","checkcolumn","advCheckColumn"],{component:true,box:true,container:true,headercontainer:true,gridcolumn:true,checkcolumn:true,advCheckColumn:true},["widget.advCheckColumn"],0,[Rd.view.components,"advCheckColumn"],0));(Ext.cmd.derive("Rd.view.accessProviders.treeApUserRights",Ext.tree.Panel,{useArrows:true,rootVisible:true,rowLines:true,stripeRows:true,border:false,ap_id:null,columns:[{xtype:"treecolumn",text:i18n("sName"),sortable:true,dataIndex:"alias",tdCls:"gridTree",width:300},{xtype:"advCheckColumn",text:i18n("sAllow"),dataIndex:"allowed",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=true;if(i.isLeaf()){n=false}if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},{text:"Default Group Right",xtype:"templatecolumn",width:"120",dataIndex:"group_right",tpl:new Ext.XTemplate('<tpl if=\'group_right == "yes"\'><div class="fieldGreen">'+i18n("sYes")+"</div></tpl>",'<tpl if=\'group_right == "no"\'><div class="fieldRed">'+i18n("sNo")+"</div></tpl>")},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridComment"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.TreeStore,{model:"Rd.model.mApUserRight",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index_ap.json",extraParams:{ap_id:b.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index_ap.json",update:"/cake2/rd_cake/acos_rights/edit_ap.json"}},root:{alias:i18n("sAccess_Provider_Rights"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(j,k,l,a,m){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});Ext.tree.Panel.prototype.initComponent.apply(this,arguments)}},0,["treeApUserRights"],["component","box","container","panel","tablepanel","treepanel","treeApUserRights"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeApUserRights:true},["widget.treeApUserRights"],0,[Rd.view.accessProviders,"treeApUserRights"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridRealms",Ext.grid.Panel,{stateful:true,stateId:"StateGridApRealms",stateEvents:["groupclick","columnhide"],border:false,ap_id:null,columns:[{xtype:"rownumberer",stateId:"StateGridApRealms1"},{text:i18n("sRealm"),dataIndex:"name",tdCls:"gridMain",flex:1},{xtype:"advCheckColumn",text:i18n("sCreate"),dataIndex:"create",stateId:"StateGridApRealms2"},{xtype:"advCheckColumn",text:i18n("sRead"),dataIndex:"read",stateId:"StateGridApRealms3"},{xtype:"advCheckColumn",text:i18n("sUpdate"),dataIndex:"update",stateId:"StateGridApRealms4"},{xtype:"advCheckColumn",text:i18n("sDelete"),dataIndex:"delete",stateId:"StateGridApRealms5"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mApRealms",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/index-ap.json",extraParams:{ap_id:b.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/index-ap.json",update:"/cake3/rd_cake/realms/edit-ap.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_right"),i18n("sRight_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_right"),i18n("sRight_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false,autoSync:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApRealms"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApRealms"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApRealms:true},["widget.gridApRealms"],0,[Rd.view.accessProviders,"gridRealms"],0));(Ext.cmd.derive("Rd.view.permanentUsers.winPermanentUserPassword",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,iconCls:"rights",glyph:Rd.config.icnKey,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),allowBlank:false,labelClsExtra:"lblRdReq",name:"password",allowBlank:false}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPermanentUserPassword"],["component","box","container","panel","window","winPermanentUserPassword"],{component:true,box:true,container:true,panel:true,window:true,winPermanentUserPassword:true},["widget.winPermanentUserPassword"],0,[Rd.view.permanentUsers,"winPermanentUserPassword"],0));(Ext.cmd.derive("Rd.view.components.vCmbLanguages",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sLanguages",queryMode:"local",valueField:"id",displayField:"text",typeAhead:true,mode:"local",itemId:"cmbLanguage",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item">','<img src="{icon_file}" style="float:left;margin:5px;"/>','<div style="margin-left:70px;font-weight:bold;font-size:16px;">{country}</div>','<div style="margin-left:70px;font-size: 14px;color: #4d4d4d;">{language}</div>',"</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{country} - {language}","</tpl>")},0,["cmbLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbLanguages:true},["widget.cmbLanguages"],0,[Rd.view.components,"vCmbLanguages"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridAccessProviderLimits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridApl",stateEvents:["groupclick","columnhide"],border:false,comp_id:null,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var d=this;d.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];var e=Ext.create("Ext.grid.plugin.RowEditing",{clicksToMoveEditor:1,autoCancel:false});d.plugins=[e];d.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"active",type:"bool"},{name:"count",type:"int"},{name:"description",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{ap_id:d.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake2/rd_cake/limits/add.json",read:"/cake2/rd_cake/limits/index.json",update:"/cake2/rd_cake/limits/edit.json",destroy:"/cake2/rd_cake/limits/delete.json"}},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.load()},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);k.load()}})}},scope:this},autoLoad:true,autoSync:false});d.columns=[{xtype:"rownumberer",stateId:"StateGridApl1"},{text:"Item to Limit",dataIndex:"alias",tdCls:"gridTree",stateId:"StateGridApl12"},{text:i18n("sActive"),xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",stateId:"StateGridApl3",editor:{xtype:"checkbox",cls:"x-grid-checkheader-editor"}},{text:"Limit count",dataIndex:"count",tdCls:"gridTree",stateId:"StateGridApl14",editor:{xtype:"numberfield",allowBlank:false,minValue:0,maxValue:150000}},{text:"Description",flex:1,dataIndex:"description",tdCls:"gridTree",stateId:"StateGridApl15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessProviderLimits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessProviderLimits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessProviderLimits:true},["widget.gridAccessProviderLimits"],0,[Rd.view.accessProviders,"gridAccessProviderLimits"],0));(Ext.cmd.derive("Rd.controller.cAccessProviders",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,plain:true,itemId:"tabAccessProviders",cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridAccessProviders",glyph:Rd.config.icnHome}]});d.populated=true},views:["accessProviders.pnlAccessProvider","accessProviders.pnlAccessProviderDetail","accessProviders.treeApUserRights","accessProviders.gridRealms","accessProviders.gridAccessProviders","accessProviders.winApAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","permanentUsers.winPermanentUserPassword","components.winEnableDisable","components.vCmbLanguages","accessProviders.gridAccessProviderLimits"],stores:["sLanguages","sApRights","sAccessProvidersGrid","sAccessProvidersTree"],models:["mApUserRight","mApRealms","mAccessProviderGrid","mAccessProviderTree"],selectedRecord:undefined,config:{urlAdd:"/cake2/rd_cake/access_providers/add.json",urlEdit:"/cake3/rd_cake/access-providers/edit.json",urlDelete:"/cake2/rd_cake/access_providers/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/access-providers/exportCsv",urlNoteAdd:"/cake3/rd_cake/access-providers/note_add.json",urlViewAPDetail:"/cake3/rd_cake/access-providers/view.json",urlEnableDisable:"/cake3/rd_cake/access-providers/enable_disable.json",urlChangePassword:"/cake3/rd_cake/access-providers/change_password.json",urlLimitCheck:"/cake2/rd_cake/limits/limit_check.json"},refs:[{ref:"winAccessProviders",selector:"#accessProvidersWin"},{ref:"grid",selector:"gridAccessProviders"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabAccessProviders":{destroy:b.appClose},"gridAccessProviders #reload":{click:b.reload},"gridAccessProviders #add":{click:b.add},"gridAccessProviders #edit":{click:b.edit},"gridAccessProviders #delete":{click:b.del},"gridAccessProviders #note":{click:b.note},"gridAccessProviders #csv":{click:b.csvExport},"gridAccessProviders #password":{click:b.changePassword},"gridAccessProviders #enable_disable":{click:b.enableDisable},gridAccessProviders:{activate:b.gridActivate,itemclick:b.gridClick},"winApAddWizard #btnTreeNext":{click:b.btnTreeNext},"winApAddWizard #btnDetailPrev":{click:b.btnDetailPrev},"winApAddWizard #save":{click:b.addSubmit},"winAccessProviderDetail #save":{click:b.addSubmit},"pnlAccessProvider pnlAccessProviderDetail #save":{click:b.editSubmit},"pnlAccessProvider treeApUserRights #reload":{click:b.apRightReload},"pnlAccessProvider treeApUserRights #expand":{click:b.apRightExpand},"pnlAccessProvider treeApUserRights advCheckColumn":{checkchange:b.apRightChange},"pnlAccessProvider gridApRealms #reload":{click:b.apRealmsReload},"pnlAccessProvider gridAccessProviderLimits #reload":{click:b.limitsReload},"#winCsvColumnSelectAp #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=access-providers] #reload":{click:b.noteReload},"gridNote[noteForGrid=access-providers] #add":{click:b.noteAdd},"gridNote[noteForGrid=access-providers] #delete":{click:b.noteDelete},"gridNote[noteForGrid=access-providers]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=access-providers] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=access-providers] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=access-providers] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlAccessProvider #tabDetail":{beforerender:b.tabDetailActivate,activate:b.tabDetailActivate},"pnlAccessProvider #tabRealms":{activate:b.tabRealmsActivate},"pnlAccessProvider #tabRights":{activate:b.tabRightsActivate},"pnlAccessProvider #tabLimits":{activate:b.tabLimitsActivate},"winPermanentUserPassword #save":{click:b.changePasswordSubmit},"#winEnableDisableUser #save":{click:b.enableDisableSubmit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(){var b=this;Ext.Ajax.request({url:b.getUrlApChildCheck(),method:"GET",success:function(h){var g=Ext.JSON.decode(h.responseText);if(g.success){if(g.items.tree==true){if(!Ext.WindowManager.get("winApAddWizardId")){var a=Ext.widget("winApAddWizard",{id:"winApAddWizardId",no_tree:false,selLanguage:b.application.getSelLanguage()});a.show()}}else{if(!Ext.WindowManager.get("winApAddWizardId")){var a=Ext.widget("winApAddWizard",{id:"winApAddWizardId",noTree:true,selLanguage:b.application.getSelLanguage(),startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user")});a.show()}}}},scope:b})},btnTreeNext:function(i){var m=this;var j=i.up("treepanel");var n=j.getSelectionModel().getLastSelected();if(n){var l=i.up("winApAddWizard");l.down("#owner").setValue(n.get("username"));l.down("#parent_id").setValue(n.getId());l.getLayout().setActiveItem("scrnData");var k=l.down("tabpanel");k.setActiveTab(0)}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDetailPrev:function(g){var e=this;var h=g.up("winApAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var d=e.getId();var b="apTab_"+d;var n=a.down("#"+b);if(n){a.setActiveTab(b);return}var p=e.get("username");Ext.Ajax.request({url:i.getUrlLimitCheck(),method:"GET",success:function(m){var k=Ext.JSON.decode(m.responseText);console.log(k);if(k.success){var l=k.data.enabled;a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlAccessProvider",ap_id:d,limits:l}});a.setActiveTab(b)}},scope:i})})}},editSubmit:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=e.down("#ap_id").getValue();e.load({url:h.getUrlViewAPDetail(),method:"GET",params:{ap_id:a},success:function(o,p,m){if(p.result.data.wl_img!=null){var n=e.down("#imgWlLogo");n.setSrc(p.result.data.wl_img)}}})},failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(e){var d=Ext.JSON.decode(e.responseText);if(d.success){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()}else{Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),i18n("sProblems_deleting_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},apRightReload:function(e){var h=this;var g=e.up("treeApUserRights");g.getStore().load()},apRightExpand:function(l){var j=this;var i=l.up("treeApUserRights");var h=i.getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=i.getSelectionModel().getLastSelected();i.expandNode(k,true)}},apRightChange:function(e){var h=this;var g=e.up("treeApUserRights");g.getStore().sync({success:function(a,b){Ext.ux.Toaster.msg(i18n("sRight_Changed"),i18n("sRight_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sProblems_changing_right"),i18n("sThere_were_some_problems_experienced_during_changing_of_the_right"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},apRealmsReload:function(e){var h=this;var g=e.up("gridApRealms");g.getStore().load()},limitsReload:function(e){var h=this;var g=e.up("grid");g.getStore().load()},onStoreApLoaded:function(){var d=this;var e=d.getStore("sAccessProvidersGrid").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAp")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAp",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteAp"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteAp"+m.getId(),noteForId:m.getId(),noteForGrid:"access-providers",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteApAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteApAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(h){var j=this;var g=h.down("form");var i=h.up("pnlAccessProvider").ap_id;g.load({url:j.getUrlViewAPDetail(),method:"GET",params:{ap_id:i},success:function(d,e,a){if(e.result.data.wl_img!=null){var b=g.down("#imgWlLogo");b.setSrc(e.result.data.wl_img)}}})},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPermanentUsersPassword"+j.getId())){var h=Ext.widget("winPermanentUserPassword",{id:"winPermanentUsersPassword"+j.getId(),user_id:j.getId(),username:j.get("username"),title:i18n("sChange_password_for")+" "+j.get("username")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.user_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisableUser")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisableUser"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabRealmsActivate:function(e){var d=this;e.getStore().load()},tabRightsActivate:function(e){var d=this;e.getStore().load()},tabLimitsActivate:function(e){var d=this;e.getStore().load()}},0,0,0,0,0,0,[Rd.controller,"cAccessProviders"],0));(Ext.cmd.derive("Rd.view.acos.treeAco",Ext.tree.Panel,{useArrows:true,store:"sAcos",rootVisible:true,rowLines:true,stripeRows:true,border:false,columns:[{xtype:"treecolumn",text:i18n("sName"),flex:1,sortable:true,dataIndex:"alias",tdCls:"gridTree"},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridTree"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}],initComponent:function(){var b=this;b.mask=new Ext.LoadMask(b,{msg:i18n("sConnecting")+" ...."});Ext.tree.Panel.prototype.initComponent.apply(this,arguments)}},0,["treeAco"],["component","box","container","panel","tablepanel","treepanel","treeAco"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeAco:true},["widget.treeAco"],0,[Rd.view.acos,"treeAco"],0));(Ext.cmd.derive("Rd.view.acos.treeApRights",Ext.tree.Panel,{useArrows:true,store:"sApRights",rootVisible:true,rowLines:true,stripeRows:true,border:false,columns:[{xtype:"treecolumn",text:i18n("sName"),flex:1,sortable:true,dataIndex:"alias",tdCls:"gridTree"},{xtype:"advCheckColumn",text:i18n("sAllow"),dataIndex:"allowed",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=true;if(i.isLeaf()){n=false}if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridTree"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}]},0,["treeApRights"],["component","box","container","panel","tablepanel","treepanel","treeApRights"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeApRights:true},["widget.treeApRights"],0,[Rd.view.acos,"treeApRights"],0));(Ext.cmd.derive("Rd.model.mAco",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"parent_id",type:"int"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mAco"],0));(Ext.cmd.derive("Rd.view.acos.winAcoEdit",Ext.window.Window,{title:i18n("sEdit_ACO_object"),closable:true,draggable:false,resizable:false,border:false,layout:"fit",autoShow:false,width:350,height:350,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaults:{anchor:"100%"},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"parent_id",hidden:true},{xtype:"hiddenfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sAlias"),name:"alias",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sOptional_Description")}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAcoEdit"],["component","box","container","panel","window","winAcoEdit"],{component:true,box:true,container:true,panel:true,window:true,winAcoEdit:true},["widget.winAcoEdit"],0,[Rd.view.acos,"winAcoEdit"],0));(Ext.cmd.derive("Rd.store.sAcos",Ext.data.TreeStore,{model:"Rd.model.mAco",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index.json",destroy:"/cake2/rd_cake/acos_rights/delete.json"}},root:{alias:i18n("sAccess_control_objects_br_ACOs_br"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}},0,0,0,0,0,0,[Rd.store,"sAcos"],0));(Ext.cmd.derive("Rd.view.acos.winAcoAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,border:false,title:i18n("sAdd_ACO_object"),layout:"fit",autoShow:false,width:350,height:350,iconCls:"add",glyph:Rd.config.icnAdd,parentId:undefined,parentDisplay:undefined,initComponent:function(){var b=this;b.items=[{xtype:"form",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaults:{anchor:"100%"},items:[{itemId:"parent_id",xtype:"textfield",name:"parent_id",hidden:true,value:b.parentId},{xtype:"displayfield",fieldLabel:i18n("sParent_node"),value:b.parentDisplay,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sAlias"),name:"alias",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sOptional_Description")}],buttons:[{text:i18n("sSave"),scale:"large",action:"save",itemId:"save",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAcoAdd"],["component","box","container","panel","window","winAcoAdd"],{component:true,box:true,container:true,panel:true,window:true,winAcoAdd:true},["widget.winAcoAdd"],0,[Rd.view.acos,"winAcoAdd"],0));(Ext.cmd.derive("Rd.controller.cAcos",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabAcos",plain:true,cls:"subSubTab",items:[{title:i18n("sAccess_Controll_Objects"),xtype:"treeAco"},{title:i18n("sAccess_Provider_Rights"),xtype:"treeApRights"}]});d.populated=true},views:["acos.treeAco","acos.winAcoAdd","acos.winAcoEdit","acos.treeApRights"],stores:["sAcos","sApRights"],models:["mAco","mApRight"],acoSelectedRecord:undefined,apRightsSelectedRecord:undefined,config:{urlAcosRightsAdd:"/cake2/rd_cake/acos_rights/add.json",urlAcosRightEdit:"/cake2/rd_cake/acos_rights/edit.json"},refs:[{ref:"treeAco",selector:"treeAco"},{ref:"treeApRights",selector:"treeApRights"}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({"#tabAcos":{destroy:me.appClose},"treeAco #reload":{click:me.acoReload},"treeAco #add":{click:me.acoAdd},"treeAco #edit":{click:me.acoEdit},"treeAco #delete":{click:me.acoDelete},"treeAco #expand":{click:me.acoExpand},"winAcoAdd #save":{click:me.acoAddSubmit},"winAcoEdit #save":{click:me.acoEditSubmit},"#tabAcos treeAco":{itemclick:me.acoGridClick},"treeApRights advCheckColumn":{checkchange:me.apRightChange},"#tabAcos treeApRights":{itemclick:me.apRightsGridClick},"treeApRights #reload":{click:me.apRightsReload},"treeApRights #expand":{click:me.apRightsExpand}})},appClose:function(){var b=this;b.populated=false},acoReload:function(){var b=this;b.getStore("sAcos").load()},acoAdd:function(){var k=this;var h=k.getTreeAco().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_of_the_tree_under_which_to_add_an_ACO_entry"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{console.log(k.acoSelectedRecord.getId());var j=k.acoSelectedRecord.getId();var l=k.acoSelectedRecord.get("alias");if(!Ext.WindowManager.get("winAcoAddId")){var j=k.acoSelectedRecord.getId();var l=k.acoSelectedRecord.get("alias");var i=Ext.widget("winAcoAdd",{id:"winAcoAddId",parentId:j,parentDisplay:l});i.show()}}}},acoAddSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAcosRightsAdd(),success:function(b,a){i.close();j.getTreeAco().getStore().load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},acoEdit:function(){var h=this;var e=h.getTreeAco().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(e>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.acoSelectedRecord.getId()==0){Ext.ux.Toaster.msg(i18n("sRoot_node_selected"),i18n("sYou_can_not_edit_the_root_node"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winAcoEditId")){var g=Ext.widget("winAcoEdit",{id:"winAcoAddId"});g.show();g.down("form").loadRecord(h.acoSelectedRecord);g.down('hiddenfield[name="parent_id"]').setValue(h.acoSelectedRecord.parentNode.getId())}}}}},acoEditSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAcosRightEdit(),success:function(b,a){i.close();j.getTreeAco().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},acoDelete:function(){var b=this;if(b.getTreeAco().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){Ext.each(b.getTreeAco().getSelectionModel().getSelection(),function(e){e.remove(true)});b.getTreeAco().getStore().sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}})}},acoGridClick:function(n,j,k,i,l){var m=this;m.acoSelectedRecord=j},acoExpand:function(){var d=this;var e=d.getTreeAco().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{d.getTreeAco().expandNode(d.acoSelectedRecord,true)}},apRightChange:function(){var b=this;b.getTreeApRights().getStore().sync({success:function(e,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},apRightsGridClick:function(n,j,k,i,l){var m=this;m.apRightsSelectedRecord=j},apRightsReload:function(){var b=this;b.getStore("sApRights").load()},apRightsExpand:function(){var d=this;var e=d.getTreeApRights().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{d.getTreeApRights().expandNode(d.apRightsSelectedRecord,true)}}},0,0,0,0,0,0,[Rd.controller,"cAcos"],0));(Ext.cmd.derive("Rd.view.activityMonitor.gridRadaccts",Ext.grid.Panel,{multiSelect:true,store:"sRadaccts",stateful:true,stateId:"StateGridRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/radaccts/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var e=this;var d=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"user",text:"User"},{id:"voucher",text:"Voucher"},{id:"device",text:"Device"}]});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.columns=[{xtype:"rownumberer",stateId:"StateGridRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts3"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts4"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts5"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts6"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts7"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts8"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts9"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts10"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridRadaccts11"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(a,i,j){if(j.get("active")==true){var b=j.get("online_human");return'<div class="fieldGreen">'+b+" "+i18n("sOnline")+"</div>"}else{return a}},stateId:"StateGridRadaccts12"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.secondsToHuman(a)},stateId:"StateGridRadaccts13"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts14"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts15"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts16"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridRadaccts17"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridRadaccts18"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts19"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts20"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts21"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts22"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts23"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts24"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts25"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts26"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts27"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRadaccts:true},["widget.gridRadaccts"],0,[Rd.view.activityMonitor,"gridRadaccts"],0));(Ext.cmd.derive("Rd.view.activityMonitor.gridRadpostauths",Ext.grid.Panel,{multiSelect:true,store:"sRadpostauths",stateful:true,stateId:"StateGridRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/radpostauths/menu_for_grid.json",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths3"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths4"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridRadpostauths5"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths6"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridRadpostauths7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRadpostauths:true},["widget.gridRadpostauths"],0,[Rd.view.activityMonitor,"gridRadpostauths"],0));(Ext.cmd.derive("Rd.model.mRadacct",Ext.data.Model,{fields:[{name:"id",type:"int"},"acctsessionid","acctuniqueid","username","groupname","realm","nasipaddress","nasidentifier","nasportid","nasporttype",{name:"acctstarttime",type:"date",dateFormat:"Y-m-d H:i:s"},"acctstoptime","acctsessiontime","acctauthentic","connectinfo_start","connectinfo_stop","acctinputoctets","acctoutputoctets","calledstationid","callingstationid","acctterminatecause","servicetype","framedprotocol","framedipaddress","acctstartdelay","acctstopdelay","xascendsessionsvrkey","active","online_human"]},0,0,0,0,0,0,[Rd.model,"mRadacct"],0));(Ext.cmd.derive("Rd.model.mRadpostauth",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"realm",type:"string"},{name:"pass",type:"string"},{name:"reply",type:"string"},{name:"nasname",type:"string"},"authdate"]},0,0,0,0,0,0,[Rd.model,"mRadpostauth"],0));(Ext.cmd.derive("Rd.model.mNas",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"nasname",type:"string"},{name:"shortname",type:"string"},{name:"nasidentifier",type:"string"},{name:"type",type:"string"},{name:"ports",type:"string"},{name:"secret",type:"string"},{name:"community",type:"string"},{name:"server",type:"string"},{name:"description",type:"string"},"connection_type","record_auth","dynamic_attribute","dynamic_value","monitor","ping_interval","heartbeat_dead_after","session_auto_close","session_dead_time","on_public_maps","lat","lon","photo_file_name",{name:"owner",type:"string"},"user_id","realms","tags","connection_type","status",{name:"status_time",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"manage_tags",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNas"],0));(Ext.cmd.derive("Rd.model.mUserStat",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mUserStat"],0));(Ext.cmd.derive("Rd.store.sRadaccts",Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}},0,0,0,0,0,0,[Rd.store,"sRadaccts"],0));(Ext.cmd.derive("Rd.store.sRadpostauths",Ext.data.Store,{model:"Rd.model.mRadpostauth",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}},0,0,0,0,0,0,[Rd.store,"sRadpostauths"],0));(Ext.cmd.derive("Rd.view.components.pnlUsageGraph",Ext.panel.Panel,{margins:"0 0 0 0",plain:true,border:false,tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"datefield",fieldLabel:i18n("sDay"),name:"day",itemId:"day",value:new Date(),format:"Y-m-d",labelClsExtra:"lblRd",labelAlign:"left",labelWidth:50,margin:2,labelSeparator:""}]},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}],type:"permanent",span:"daily",username:false,initComponent:function(){var d=this;d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mUserStat",proxy:{type:"ajax",format:"json",extraParams:{username:d.username,type:d.type,span:d.span},url:"/cake2/rd_cake/user_stats/index.json",reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(l){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var j=Ext.ux.bytesToHuman(a.totalIn);var k=Ext.ux.bytesToHuman(a.totalOut);var b=Ext.ux.bytesToHuman(a.totalInOut);d.down("#totals").update({"in":j,out:k,total:b})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:20,left:20,right:20,bottom:20},width:"100%",store:d.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["data_in","data_out"],renderer:function(a,b,h){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",position:"bottom",grid:false,fields:["time_unit"]}],interactions:["itemhighlight"],series:[{type:"bar",title:["Data In","Data out"],xField:"time_unit",yField:["data_in","data_out"],stacked:true,style:{opacity:0.8},highlight:{fillStyle:"yellow"},tooltip:{renderer:function(a,k,b){var j=Ext.ux.bytesToHuman(k.get("data_in"));var l=Ext.ux.bytesToHuman(k.get("data_out"));a.setHtml("Data in <b>"+j+"</b><br>Data out <b>"+l+"</b>")}}}]});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlUsageGraph"],["component","box","container","panel","pnlUsageGraph"],{component:true,box:true,container:true,panel:true,pnlUsageGraph:true},["widget.pnlUsageGraph"],0,[Rd.view.components,"pnlUsageGraph"],0));(Ext.cmd.derive("Rd.view.components.cmbNas",Ext.form.ComboBox,{fieldLabel:i18n("sNAS_IP_Address"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"nasname",typeAhead:true,allowBlank:false,mode:"local",name:"profile_id",pageSize:1,labelClsExtra:"lblRd",listConfig:{getInnerTpl:function(){return'<div data-qtip="{nasname} : {shortname}"><div class="combo-main">{nasname}</div><div class="combo-detail"> {shortname}</div></div>'}},initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mNas",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbNas"],["component","box","field","textfield","pickerfield","combobox","combo","cmbNas"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbNas:true},["widget.cmbNas"],0,[Rd.view.components,"cmbNas"],0));(Ext.cmd.derive("Rd.view.components.chrtBasicPie",Ext.chart.PolarChart,{width:250,height:350,animate:true,shadow:true,interactions:["rotate"],insetPadding:50,innerPadding:20,legend:{docked:"bottom"},initComponent:function(){var b=this;Ext.chart.PolarChart.prototype.initComponent.apply(this,arguments)}},0,0,["component","box","container","panel","draw","polar"],{component:true,box:true,container:true,panel:true,draw:true,polar:true},0,0,[Rd.view.components,"chrtBasicPie"],0));(Ext.cmd.derive("Rd.view.activityMonitor.pnlRadius",Ext.panel.Panel,{border:false,layout:{type:"hbox",align:"stretch"},tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">'+i18n("sReload_every")+"</b>",{text:i18n("s30_seconds"),itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:i18n("s1_minute"),itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:i18n("s5_minutes"),itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:i18n("sStop_auto_reload"),itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"cmbNas",allowBlank:true,width:400}],bbar:[{xtype:"component",itemId:"status",tpl:"Status: {mesg}",style:"margin-right:5px",cls:"lblYfi"}],authBasicStore:null,authDetailStore:null,initComponent:function(){var b=this;b.items=[{xtype:"panel",title:i18n("sAuthentication"),autoScroll:true,flex:2,layout:{type:"hbox"},collapsible:true,collapseDirection:"left"},{xtype:"panel",title:i18n("sAccounting"),autoScroll:true,flex:1,layout:{type:"hbox"},collapsible:true,collapseDirection:"right"}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},auth_basic:function(){var d=this;d.authBasicStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.authBasicStore});return e},auth_detail:function(){var d=this;d.authDetailStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.authDetailStore});return e},acct_detail:function(){var d=this;d.acctDetailStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.acctDetailStore});return e}},0,["pnlRadius"],["component","box","container","panel","pnlRadius"],{component:true,box:true,container:true,panel:true,pnlRadius:true},["widget.pnlRadius"],0,[Rd.view.activityMonitor,"pnlRadius"],0));(Ext.cmd.derive("Rd.controller.cActivityMonitor",Ext.app.Controller,{actionIndex:function(g){var j=this;var i=g.up("tabpanel");am_id="tabActivityMonitor";var h=i.down("#"+am_id);if(h){i.setActiveTab(am_id);return}i.add({title:"Activity Monitor",xtype:"tabpanel",itemId:am_id,closable:true,glyph:Rd.config.icnActivity,border:false,itemId:"tabActivityMonitor",plain:true,cls:"subSubTab",layout:"fit",items:[{title:i18n("sAccounting_data"),xtype:"gridRadaccts"},{title:i18n("sAuthentication_data"),xtype:"gridRadpostauths"}]});i.setActiveTab(am_id)},views:["activityMonitor.gridRadaccts","activityMonitor.gridRadpostauths","components.cmbNas","activityMonitor.pnlRadius","components.winCsvColumnSelect","components.pnlUsageGraph"],stores:["sRadaccts","sRadpostauths"],models:["mRadacct","mRadpostauth","mNas","mUserStat"],selectedRecord:null,specific_nas:undefined,config:{urlExportCsvAcct:"/cake2/rd_cake/radaccts/export_csv",urlExportCsvAuth:"/cake2/rd_cake/radpostauths/export_csv",urlKickActive:"/cake2/rd_cake/radaccts/kick_active.json",urlCloseOpen:"/cake2/rd_cake/radaccts/close_open.json"},refs:[{ref:"grid",selector:"gridRadaccts"},{ref:"gridRadpostauths",selector:"gridRadpostauths"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.getStore("sRadaccts").addListener("load",b.onStoreRadacctsLoaded,b);b.control({"#tabActivityMonitor":{destroy:b.appClose},"gridRadaccts #reload":{click:b.reload},"gridRadaccts #reload menuitem[group=refresh]":{click:b.acctReloadOptionClick},"gridRadaccts #connected":{click:b.reload},"gridRadaccts #csv":{click:b.csvExportAcct},"gridRadaccts #graph":{click:b.usageGraph},"gridRadaccts #kick":{click:b.kickActive},"gridRadaccts #close":{click:b.closeOpen},gridRadaccts:{},gridRadaccts:{activate:b.reload},"gridRadpostauths #reload":{click:b.reloadPostAuths},gridRadpostauths:{activate:b.gridActivate},"gridRadpostauths #reload menuitem[group=refresh]":{click:b.authReloadOptionClick},"gridRadpostauths #csv":{click:b.csvExportAuth},"pnlRadius #reload":{click:b.radiusReload},"pnlRadius #reload menuitem[group=refresh]":{click:b.radiusReloadOptionClick},pnlRadius:{activate:b.radiusActivate},"pnlRadius  cmbNas":{change:b.cmbNasChange},"#winCsvColumnSelectAcct #save":{click:b.csvExportSubmitAcct},"#winCsvColumnSelectAuth #save":{click:b.csvExportSubmitAuth},"#daily":{activate:b.loadGraph},"#daily #reload":{click:b.reloadDailyGraph},"#daily #day":{change:b.changeDailyGraph},"#weekly":{activate:b.loadGraph},"#weekly #reload":{click:b.reloadWeeklyGraph},"#weekly #day":{change:b.changeWeeklyGraph},"#monthly":{activate:b.loadGraph},"#monthly #reload":{click:b.reloadMonthlyGraph},"#monthly #day":{change:b.changeMonthlyGraph}})},reload:function(){var d=this;var e=d.getGrid().down("#connected");if(e==null){e=true}else{e=e.pressed}d.getStore("sRadaccts").getProxy().extraParams={only_connected:e};d.getStore("sRadaccts").load()},onStoreRadacctsLoaded:function(){var g=this;var j=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalIn);var h=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalOut);var i=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalInOut);g.getGrid().down("#totals").update({"in":j,out:h,total:i})},gridActivate:function(d){var e=this;d.getStore().load()},reloadPostAuths:function(){var b=this;b.getStore("sRadpostauths").load()},appClose:function(){var b=this;b.populated=false;if(b.autoReloadAcct!=undefined){clearInterval(b.autoReloadAcct)}if(b.autoReloadAuth!=undefined){clearInterval(b.autoReloadAuth)}if(b.autoReloadRadius!=undefined){clearInterval(b.autoReloadRadius)}},acctReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadAcct);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadAcct=setInterval(function(){j.reload()},k)},authReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadAuth);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadAuth=setInterval(function(){j.reloadPostAuths()},k)},radiusReload:function(g){var j=this;var h=g.up("pnlRadius");var i={};h.down("#status").update({mesg:"fetching the latest info"});if(j.specific_nas!=undefined){console.log(j.specific_nas);i.nas_id=j.specific_nas}Ext.Ajax.request({url:"/cake2/rd_cake/free_radius/index.json",method:"GET",params:i,success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){h.authBasicStore.loadData(a.items.auth_basic);h.authDetailStore.loadData(a.items.auth_detail);h.acctDetailStore.loadData(a.items.acct_detail);h.down("#status").update({mesg:"idle"})}},scope:j})},radiusActivate:function(e){var h=this;var g=e.down("#reload");h.radiusReload(g)},radiusReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadRadius);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadRadius=setInterval(function(){j.radiusReload(b)},k)},cmbNasChange:function(j){var l=this;var k=j.getValue();var i=j.getStore();var h=i.getById(k);if(h!=null){l.specific_nas=k}},csvExportAcct:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAcct")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAcct",columns:k});j.show()}},csvExportSubmitAcct:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsvAcct()+B);I.close()}},csvExportAuth:function(n,l){var m=this;var i=m.getGridRadpostauths().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAuth")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAuth",columns:k});j.show()}},csvExportSubmitAuth:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsvAuth()+B);I.close()}},closeOpen:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k={};var l=i.getSelectionModel().getSelection();Ext.Array.each(l,function(b){var a=b.getId();k[a]=a});Ext.Ajax.request({url:j.getUrlCloseOpen(),method:"GET",params:k,success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reload()}},scope:j})}},kickActive:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.ux.Toaster.msg("Sending request","Please be patient",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.setDisabled(true);var k={};var l=i.getSelectionModel().getSelection();Ext.Array.each(l,function(b){var a=b.getId();k[a]=a});Ext.Ajax.request({url:j.getUrlKickActive(),method:"GET",params:k,success:function(b){h.setDisabled(false);var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reload()}},scope:j})}},usageGraph:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(d,e){var a=i.up("tabpanel");var b=d.get("username");b=b.replace("@","_");b=b.toLowerCase();var p=d.get("username");var g="graphTab_"+b;var o=a.down("#"+g);if(o){a.setActiveTab(g);return}a.add({title:b,itemId:g,closable:true,iconCls:"graph",glyph:Rd.config.icnGraph,layout:"fit",xtype:"tabpanel",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",items:[{title:"Daily",itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:p,type:"activity_viewer"},{title:"Weekly",itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:p,type:"activity_viewer"},{title:"Monthly",itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:p,type:"activity_viewer"}]});a.setActiveTab(g)})}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cActivityMonitor"],0));(Ext.cmd.derive("Rd.view.blackLists.gridBlackLists",Ext.grid.Panel,{multiSelect:true,store:"sBlackLists",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/black-lists/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridBl1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridBl3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridBl6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridBlackLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridBlackLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridBlackLists:true},["widget.gridBlackLists"],0,[Rd.view.blackLists,"gridBlackLists"],0));(Ext.cmd.derive("Rd.model.mBlackList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mBlackList"],0));(Ext.cmd.derive("Rd.model.mBlackListEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"black_list_id",type:"int"},{name:"domain",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mBlackListEntry"],0));(Ext.cmd.derive("Rd.view.blackLists.pnlBlackListDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",black_list_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Black List Entries",layout:"fit",xtype:"gridBlackListEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlBlackListDetail"],["component","box","container","panel","tabpanel","pnlBlackListDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlBlackListDetail:true},["widget.pnlBlackListDetail"],0,[Rd.view.blackLists,"pnlBlackListDetail"],0));(Ext.cmd.derive("Rd.store.sBlackLists",Ext.data.Store,{model:"Rd.model.mBlackList",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/black-lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sBlackLists"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Black List",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winBlackListAddWizard"],["component","box","container","panel","window","winBlackListAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winBlackListAddWizard:true},["widget.winBlackListAddWizard"],0,[Rd.view.blackLists,"winBlackListAddWizard"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Black List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:false,labelClsExtra:"lblRdReq"},{itemId:"black_list_id",xtype:"textfield",name:"black_list_id",hidden:true,value:e.black_list_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winBlackListEntryAdd"],["component","box","container","panel","window","winBlackListEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winBlackListEntryAdd:true},["widget.winBlackListEntryAdd"],0,[Rd.view.blackLists,"winBlackListEntryAdd"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Black List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRdReq",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:true,value:g.get("domain")},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id},{itemId:"black_list_id",xtype:"textfield",name:"black_list_id",hidden:true,value:g.get("black_list_id")}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winBlackListEntryEdit"],["component","box","container","panel","window","winBlackListEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winBlackListEntryEdit:true},["widget.winBlackListEntryEdit"],0,[Rd.view.blackLists,"winBlackListEntryEdit"],0));(Ext.cmd.derive("Rd.view.blackLists.gridBlackListEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/black-lists/menu-for-black-list-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"BLE1"},{text:"Domain",dataIndex:"domain",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"BLE2"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE3"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE4"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mBlackListEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/black-lists/index-black-list-entry.json",extraParams:{black_list_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridBlackListEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridBlackListEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridBlackListEntries:true},["widget.gridBlackListEntries"],0,[Rd.view.blackLists,"gridBlackListEntries"],0));(Ext.cmd.derive("Rd.controller.cBlackLists",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabBlackLists",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridBlackLists",glyph:Rd.config.icnHome}]});d.populated=true},views:["blackLists.gridBlackLists","blackLists.winBlackListAddWizard","blackLists.pnlBlackListDetail","blackLists.gridBlackListEntries","blackLists.winBlackListEntryAdd","blackLists.winBlackListEntryEdit"],stores:["sAccessProvidersTree","sBlackLists"],models:["mAccessProviderTree","mBlackList","mBlackListEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/black-lists/add.json",urlDelete:"/cake3/rd_cake/black-lists/delete.json",urlEdit:"/cake3/rd_cake/black-lists/edit.json",urlAddEntry:"/cake3/rd_cake/black-lists/add-blacklist-entry.json",urlEditEntry:"/cake3/rd_cake/black-lists/edit-blacklist-entry.json",urlDeleteEntry:"/cake3/rd_cake/black-lists/delete-blacklist-entry.json"},refs:[{ref:"grid",selector:"gridBlackLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabBlackLists":{destroy:b.appClose},"gridBlackLists #reload":{click:b.reload},"gridBlackLists #add":{click:b.add},"gridBlackLists #delete":{click:b.del},"gridBlackLists #edit":{click:b.edit},gridBlackLists:{select:b.select},"winBlackListAddWizard #btnTreeNext":{click:b.btnTreeNext},"winBlackListAddWizard #btnDataPrev":{click:b.btnDataPrev},"winBlackListAddWizard #btnDataNext":{click:b.btnDataNext},"winBlackListEdit #save":{click:b.btnEditSave},"pnlBlackListDetail gridBlackListEntries":{activate:b.gridActivate},"#tabBlackLists gridBlackLists":{activate:b.gridActivate},"pnlBlackListDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridBlackListEntries #reload":{click:b.reloadEntries},"gridBlackListEntries #add":{click:b.addEntry},"gridBlackListEntries #edit":{click:b.editEntry},"gridBlackListEntries #delete":{click:b.deleteEntry},"winBlackListEntryAdd  #save":{click:b.saveBlackListEntryAdd},"winBlackListEntryEdit  #save":{click:b.saveBlackListEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winBlackListAddWizardId")){var h=Ext.widget("winBlackListAddWizard",{id:"winBlackListAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winBlackListAddWizardId")){var h=Ext.widget("winBlackListAddWizard",{id:"winBlackListAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winBlackListAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winBlackListAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sBlackLists").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="blackListTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlBlackListDetail",black_list_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlBlackListDetail").black_list_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winBlackListEntryAdd",{id:"winBlackListEntryAdd"+k,black_list_id:k,store:i});j.show()}},saveBlackListEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winBlackListEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winBlackListEntryEditId")){var j=Ext.widget("winBlackListEntryEdit",{id:"winBlackListEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveBlackListEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winBlackListEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cBlackLists"],0));(Ext.cmd.derive("Rd.view.categories.gridCategories",Ext.grid.Panel,{multiSelect:true,store:"sCategories",stateful:true,stateId:"StateGridCtg",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/categories/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridCtg1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridCtg3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridCtg6"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "low"\'><div class="fieldGreen">Low</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "high"\'><div class="fieldOrange">High</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridCtg7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridCategories"],["component","box","container","panel","tablepanel","gridpanel","grid","gridCategories"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridCategories:true},["widget.gridCategories"],0,[Rd.view.categories,"gridCategories"],0));(Ext.cmd.derive("Rd.model.mCategory",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mCategory"],0));(Ext.cmd.derive("Rd.view.categories.winCategoryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Category",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winCategoryEdit"],["component","box","container","panel","window","winCategoryEdit"],{component:true,box:true,container:true,panel:true,window:true,winCategoryEdit:true},["widget.winCategoryEdit"],0,[Rd.view.categories,"winCategoryEdit"],0));(Ext.cmd.derive("Rd.store.sCategories",Ext.data.Store,{model:"Rd.model.mCategory",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/categories/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sCategories"],0));(Ext.cmd.derive("Rd.view.categories.winCategoryAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Category",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winCategoryAddWizard"],["component","box","container","panel","window","winCategoryAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winCategoryAddWizard:true},["widget.winCategoryAddWizard"],0,[Rd.view.categories,"winCategoryAddWizard"],0));(Ext.cmd.derive("Rd.view.categories.cmbProtectionLevel",Ext.form.ComboBox,{fieldLabel:"Protection Level",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"protection_level",labelClsExtra:"lblRd",value:"medium",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"low",text:"Low"},{id:"medium",text:"Medium"},{id:"high",text:"High"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProtectionLevel"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProtectionLevel"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProtectionLevel:true},["widget.cmbProtectionLevel"],0,[Rd.view.categories,"cmbProtectionLevel"],0));(Ext.cmd.derive("Rd.controller.cCategories",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridCategories",border:true,itemId:"tabCategories",plain:true});d.populated=true},views:["categories.gridCategories","categories.winCategoryEdit","categories.winCategoryAddWizard","categories.cmbProtectionLevel"],stores:["sAccessProvidersTree","sCategories"],models:["mAccessProviderTree","mCategory"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/categories/add.json",urlDelete:"/cake3/rd_cake/categories/delete.json",urlEdit:"/cake3/rd_cake/categories/edit.json"},refs:[{ref:"grid",selector:"gridCategories"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabCategories":{destroy:b.appClose},"gridCategories #reload":{click:b.reload},"gridCategories #add":{click:b.add},"gridCategories #delete":{click:b.del},"gridCategories #edit":{click:b.edit},gridCategories:{select:b.select},"winCategoryAddWizard #btnTreeNext":{click:b.btnTreeNext},"winCategoryAddWizard #btnDataPrev":{click:b.btnDataPrev},"winCategoryAddWizard #btnDataNext":{click:b.btnDataNext},"winCategoryEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winCategoryAddWizardId")){var h=Ext.widget("winCategoryAddWizard",{id:"winCategoryAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winCategoryAddWizardId")){var h=Ext.widget("winCategoryAddWizard",{id:"winCategoryAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winCategoryAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winCategoryAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sCategories").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winCategoryEditId")){var i=Ext.widget("winCategoryEdit",{id:"winCategoryEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winCategoryEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cCategories"],0));(Ext.cmd.derive("Rd.view.dashboard.winPasswordChanger",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnLock,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"password",itemId:"password",allowBlank:false,inputType:"password",fieldLabel:i18n("sPassword"),labelClsExtra:"lblRdReq"},{name:"confirm",itemId:"confirm",allowBlank:false,inputType:"password",fieldLabel:i18n("sConfirm"),labelClsExtra:"lblRdReq",vtype:"PasswordMatch"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPasswordChanger"],["component","box","container","panel","window","winPasswordChanger"],{component:true,box:true,container:true,panel:true,window:true,winPasswordChanger:true},["widget.winPasswordChanger"],0,[Rd.view.dashboard,"winPasswordChanger"],0));(Ext.cmd.derive("Rd.view.Viewport",Ext.container.Viewport,{layout:{type:"fit"}},0,["viewP"],["component","box","container","viewport","viewP"],{component:true,box:true,container:true,viewport:true,viewP:true},["widget.viewP"],0,[Rd.view,"Viewport"],0));(Ext.cmd.derive("Rd.view.dashboard.pnlDashboard",Ext.panel.Panel,{layout:"fit",dashboard_data:undefined,initComponent:function(){var s=this;var x=s.dashboard_data.user.username;var w=Rd.config.headerName;var t=Rd.config.levelAColor;var q="color:"+t+";font-weight:200; font-size: smaller;";var u=new Ext.XTemplate("<h1>"+w+'<span style="'+q+'"> | <i class="fa">{fa_value}</i> {value}</span><h1>');var r=Rd.config.footerName;var B={};var A=false;var p="";var C=false;if(s.dashboard_data.white_label.active==true){w=s.dashboard_data.white_label.hName;r=s.dashboard_data.white_label.fName;var y=s.dashboard_data.white_label.hBg;B={background:y};C=s.dashboard_data.white_label.hFg;if(s.dashboard_data.white_label.imgActive==true){var z=s.dashboard_data.white_label.imgFile;var u=new Ext.XTemplate('<img src="'+z+'" alt="Logo" style="float:left; padding-right: 20px;">','<h1 style="color:'+C+';">'+w+'<span style="'+q+'"> | <i class="fa">{fa_value}</i> {value}</span><h1>')}else{var u=new Ext.XTemplate('<h1 style="color:'+C+';">'+w+'<span style="'+q+'">',' | <i class="fa">{fa_value}</i> {value}</span><h1>')}}s.dockedItems=[{xtype:"toolbar",dock:"bottom",ui:"footer",items:['<b><i class="fa fa-graduation-cap"></i> '+x+"</b>","->","<b>"+r+"</b> "+Rd.config.footerLicense]},{xtype:"toolbar",dock:"top",ui:"default",style:B,items:[{xtype:"tbtext",itemId:"tbtHeader",tpl:u,data:{headerName:Rd.config.headerName}},"->",{xtype:"button",glyph:Rd.config.icnMenu,scale:"medium",menu:[{text:i18n("sLogout"),glyph:Rd.config.icnPower,itemId:"mnuLogout"},"-",{text:i18n("sSettings"),glyph:Rd.config.icnSpanner,itemId:"mnuSettings"},{text:i18n("sPassword"),glyph:Rd.config.icnLock,itemId:"mnuPassword"}]}]}];Ext.panel.Panel.prototype.initComponent.call(this)}},0,["pnlDashboard"],["component","box","container","panel","pnlDashboard"],{component:true,box:true,container:true,panel:true,pnlDashboard:true},["widget.pnlDashboard"],0,[Rd.view.dashboard,"pnlDashboard"],0));(Ext.cmd.derive("Rd.view.dashboard.winDashboardSettings",Ext.window.Window,{title:i18n("sSettings"),layout:"fit",autoShow:false,width:350,height:300,glyph:Rd.config.icnSpanner,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbRealm"},{xtype:"checkbox",boxLabel:"Show Data Usage",name:"show_data_usage",inputValue:"show_data_usage",checked:true,cls:"lblRdReq"},{xtype:"checkbox",boxLabel:"Compact View",name:"compact_view",inputValue:"compact_view",checked:true,cls:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winDashboardSettings"],["component","box","container","panel","window","winDashboardSettings"],{component:true,box:true,container:true,panel:true,window:true,winDashboardSettings:true},["widget.winDashboardSettings"],0,[Rd.view.dashboard,"winDashboardSettings"],0));(Ext.cmd.derive("Rd.view.dashboard.tpDashboard",Ext.tab.Panel,{layout:"fit",ui:"navigation",tabPosition:"left",tabRotation:0,defaults:{textAlign:"left"},initComponent:function(){var b=this;b.items=b.dashboard_data.tabs;Ext.tab.Panel.prototype.initComponent.call(this)}},0,["tpDashboard"],["component","box","container","panel","tabpanel","tpDashboard"],{component:true,box:true,container:true,panel:true,tabpanel:true,tpDashboard:true},["widget.tpDashboard"],0,[Rd.view.dashboard,"tpDashboard"],0));(Ext.cmd.derive("Rd.controller.cDashboard",Ext.app.Controller,{views:["components.cmbRealm","dashboard.pnlDashboard","dashboard.tpDashboard","dashboard.winPasswordChanger","dashboard.winDashboardSettings"],config:{urlChangePassword:"/cake3/rd_cake/dashboard/change_password.json",urlSettingsSubmit:"/cake3/rd_cake/dashboard/settings_submit.json",urlViewSettings:"/cake3/rd_cake/dashboard/settings_view.json"},models:["mRealm"],stores:[],refs:[{ref:"viewP",selector:"viewP",xtype:"viewP",autoCreate:true},{ref:"pnlDashboard",selector:"pnlDashboard",xtype:"pnlDashboard"}],init:function(){var b=this;if(b.inited){return}b.inited=true;this.control({"tpDashboard #cWelcome":{activate:function(a){b.application.runAction("cWelcome","Index",a)}},"tpDashboard #cDataUsage":{activate:function(a){b.application.runAction("cDataUsage","Index",a)}},"tpDashboard #cUtilities":{activate:function(a){b.application.runAction("cUtilities","Index",a)}},"tpDashboard #cAccessProviders":{activate:function(a){b.application.runAction("cAccessProviders","Index",a)}},"tpDashboard #cMeshes":{activate:function(a){b.application.runAction("cMeshes","Index",a);b.updateBanner(a)}},"tpDashboard #cAccessPoints":{activate:function(a){b.application.runAction("cAccessPoints","Index",a);b.updateBanner(a)}},"tpDashboard #cProfileComponents":{activate:function(a){b.application.runAction("cProfileComponents","Index",a)}},"tpDashboard #cProfiles":{activate:function(a){b.application.runAction("cProfiles","Index",a)}},"tpDashboard #cActivityMonitor":{activate:function(a){b.application.runAction("cActivityMonitor","Index",a)}},"tpDashboard #cPermanentUsers":{activate:function(a){b.application.runAction("cPermanentUsers","Index",a)}},"tpDashboard #cVouchers":{activate:function(a){b.application.runAction("cVouchers","Index",a)}},"tpDashboard #cDevices":{activate:function(a){b.application.runAction("cDevices","Index",a)}},"tpDashboard #cTopUps":{activate:function(a){b.application.runAction("cTopUps","Index",a)}},"tpDashboard #cRealms":{activate:function(a){b.application.runAction("cRealms","Index",a)}},"tpDashboard #cDynamicClients":{activate:function(a){b.application.runAction("cDynamicClients","Index",a)}},"tpDashboard #cNas":{activate:function(a){b.application.runAction("cNas","Index",a)}},"tpDashboard #cTags":{activate:function(a){b.application.runAction("cTags","Index",a)}},"tpDashboard #cSsids":{activate:function(a){b.application.runAction("cSsids","Index",a)}},"tpDashboard #cDynamicDetails":{activate:function(a){b.application.runAction("cDynamicDetails","Index",a)}},"tpDashboard #cOpenvpnServers":{activate:function(a){b.application.runAction("cOpenvpnServers","Index",a)}},"tpDashboard #cIpPools":{activate:function(a){b.application.runAction("cIpPools","Index",a)}},"tpDashboard #cAcos":{activate:function(a){b.application.runAction("cAcos","Index",a)}},"tpDashboard #cLogViewer":{activate:function(a){b.application.runAction("cLogViewer","Index",a)}},"tpDashboard #cDebug":{activate:function(a){b.application.runAction("cDebug","Index",a)}},"pnlDashboard  #mnuLogout":{click:b.onLogout},"pnlDashboard  #mnuSettings":{click:b.onSettings},"winDashboardSettings #save":{click:b.onSettingsSubmit},winDashboardSettings:{beforeshow:b.loadSettings},"pnlDashboard  #mnuPassword":{click:b.onPassword},"winPasswordChanger #save":{click:b.onChangePassword},"tpDashboard #cGlobalDomains":{activate:function(a){b.application.runAction("cGlobalDomains","Index",a)}},"tpDashboard #cCategories":{activate:function(a){b.application.runAction("cCategories","Index",a)}},"tpDashboard #cFilters":{activate:function(a){b.application.runAction("cFilters","Index",a)}},"tpDashboard #cBlackLists":{activate:function(a){b.application.runAction("cBlackLists","Index",a)}},"tpDashboard #cWhiteLists":{activate:function(a){b.application.runAction("cWhiteLists","Index",a)}},"tpDashboard #cSchedules":{activate:function(a){b.application.runAction("cSchedules","Index",a)}},"tpDashboard #cPolicies":{activate:function(a){b.application.runAction("cPolicies","Index",a)}},"tpDashboard > tabpanel":{activate:b.updateBanner}})},actionIndex:function(){var l=this;var k=l.application.getDashboardData();var o=k.user.username;var j=k.user.cls;var m=l.getView("dashboard.pnlDashboard").create({dashboard_data:k});var n=l.getView("dashboard.tpDashboard").create({dashboard_data:k});var p=l.getViewP();p.removeAll(true);p.add([m]);m.add([n])},onLogout:function(b){var e=this;b.up("panel").close();e.getViewP().removeAll(true);e.application.runAction("cLogin","Exit")},loadSettings:function(h){var e=this;var g=h.down("form");g.load({url:e.getUrlViewSettings(),method:"GET",success:function(k,l,a){var b=g.down("cmbRealm");var d=Ext.create("Rd.model.mRealm",{name:l.result.data.realm_name,id:l.result.data.realm_id});b.getStore().loadData([d],false);b.setValue(l.result.data.realm_id)}})},onSettings:function(b){var g=this;if(!Ext.WindowManager.get("winDashboardSettingsId")){var h=Ext.widget("winDashboardSettings",{id:"winDashboardSettingsId"});h.show()}},onSettingsSubmit:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlSettingsSubmit(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onPassword:function(b){var g=this;if(!Ext.WindowManager.get("winPasswordChangerId")){var h=Ext.widget("winPasswordChanger",{id:"winPasswordChangerId"});h.show()}},onChangePassword:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlChangePassword(),success:function(b,a){var e=new Date();e.setDate(e.getDate()+1);Ext.util.Cookies.set("Token",a.result.data.token,e,"/",null,false);var d=a.result.data.token;Ext.Ajax.setExtraParams({token:d});i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},updateBanner:function(h){var k=h.getGlyph();var j=h.getTitle();var i=h.getInitialConfig();if(i.tooltip!==undefined){j=i.tooltip}k=k.replace("@FontAwesome","");var l=h.up("pnlDashboard");l.down("#tbtHeader").setData({fa_value:"&#"+k+";",value:j})}},0,0,0,0,0,0,[Rd.controller,"cDashboard"],0));(Ext.cmd.derive("Rd.view.dataUsage.vcPnlDataUsage",Ext.app.ViewController,{onClickTodayButton:function(e){var d=this;d.getView().setScrollY(0,{duration:1000})},onClickThisWeekButton:function(e){var h=this;var g=h.getView().down("pnlDataUsageDay").getHeight();h.getView().setScrollY(g+1,{duration:1000})},onClickThisMonthButton:function(j){var i=this;var g=i.getView().down("pnlDataUsageDay").getHeight();var h=i.getView().down("pnlDataUsageWeek").getHeight();i.getView().setScrollY(g+h+1,{duration:1000})}},0,0,0,0,["controller.vcPnlDataUsage"],0,[Rd.view.dataUsage,"vcPnlDataUsage"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageDay",Ext.panel.Panel,{title:"Today",headerPosition:"right",height:550,margin:0,padding:0,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"dayStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});Ext.create("Ext.data.Store",{storeId:"activeStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"callingstationid",type:"string"},{name:"online_human",type:"string"},{name:"online",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"dailyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:g,padding:h,border:false,itemId:"plrDaily",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("dayStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:10,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users Today",itemId:"gridTopTenDaily",border:true,store:Ext.data.StoreManager.lookup("dayStore"),emptyText:"No Users for Today",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:2,margin:g,padding:h,layout:"fit",border:false},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Active Sessions",border:true,store:Ext.data.StoreManager.lookup("activeStore"),emptyText:"No Active Sessions Now",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"MAC Address",dataIndex:"callingstationid"},{text:"Time Online",dataIndex:"online",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(a,d,j){var b=j.get("online_human");return'<div class="fieldGreen">'+b+" "+i18n("sOnline")+"</div>"}}],flex:1}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageDay"],["component","box","container","panel","pnlDataUsageDay"],{component:true,box:true,container:true,panel:true,pnlDataUsageDay:true},["widget.pnlDataUsageDay"],0,[Rd.view.dataUsage,"pnlDataUsageDay"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageWeek",Ext.panel.Panel,{ui:"light",title:"This Week",headerPosition:"right",height:550,margin:0,padding:0,border:true,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"weekStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"weeklyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:0,padding:0,border:false,itemId:"plrWeekly",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("weekStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:10,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users This Week",itemId:"gridTopTenDaily",border:true,store:Ext.data.StoreManager.lookup("weekStore"),emptyText:"No Users For This Week",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:1,margin:0,padding:0,layout:"fit",border:false}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageWeek"],["component","box","container","panel","pnlDataUsageWeek"],{component:true,box:true,container:true,panel:true,pnlDataUsageWeek:true},["widget.pnlDataUsageWeek"],0,[Rd.view.dataUsage,"pnlDataUsageWeek"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageMonth",Ext.panel.Panel,{title:"This Month",headerPosition:"right",height:550,margin:0,padding:0,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"monthStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"monthlyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:g,padding:h,border:false,itemId:"plrMonthly",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("monthStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:20,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users This Month",itemId:"gridTopTenMonthly",border:true,store:Ext.data.StoreManager.lookup("monthStore"),emptyText:"No Users For This Month",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:1,margin:0,padding:0,layout:"fit",border:false}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageMonth"],["component","box","container","panel","pnlDataUsageMonth"],{component:true,box:true,container:true,panel:true,pnlDataUsageMonth:true},["widget.pnlDataUsageMonth"],0,[Rd.view.dataUsage,"pnlDataUsageMonth"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsage",Ext.panel.Panel,{scrollable:true,layout:{type:"vbox",align:"stretch"},controller:"vcPnlDataUsage",initComponent:function(){var b=this;b.dockedItems=[{xtype:"toolbar",dock:"top",cls:"subTab",frame:true,border:true,items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload")},{xtype:"cmbRealm"},{xtype:"button",scale:"small",itemId:"btnShowRealm",text:"Show Realm Data",hidden:true},"|",{xtype:"button",glyph:Rd.config.icnHourStart,text:"Today",listeners:{click:"onClickTodayButton"}},{xtype:"button",glyph:Rd.config.icnHourHalf,text:"This Week",listeners:{click:"onClickThisWeekButton"}},{xtype:"button",glyph:Rd.config.icnHourEnd,text:"This Month",listeners:{click:"onClickThisMonthButton"}}]}];b.items=[{xtype:"pnlDataUsageDay",glyph:Rd.config.icnHourStart},{xtype:"pnlDataUsageWeek",glyph:Rd.config.icnHourHalf},{xtype:"pnlDataUsageMonth",glyph:Rd.config.icnHourEnd}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsage"],["component","box","container","panel","pnlDataUsage"],{component:true,box:true,container:true,panel:true,pnlDataUsage:true},["widget.pnlDataUsage"],0,[Rd.view.dataUsage,"pnlDataUsage"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageGraph",Ext.panel.Panel,{margins:"0 0 0 0",plain:true,border:false,initComponent:function(){var d=this;d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mUserStat"});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:20,left:20,right:20,bottom:20},width:"100%",store:d.store,axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["data_in","data_out"],renderer:function(a,b,h){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",position:"bottom",grid:false,fields:["time_unit"]}],interactions:["itemhighlight"],series:[{type:"bar",title:["Data In","Data out"],xField:"time_unit",yField:["data_in","data_out"],stacked:true,style:{opacity:0.8},highlight:{fillStyle:"yellow"},tooltip:{renderer:function(a,k,b){var j=Ext.ux.bytesToHuman(k.get("data_in"));var l=Ext.ux.bytesToHuman(k.get("data_out"));a.setHtml("Data in <b>"+j+"</b><br>Data out <b>"+l+"</b>")}}}]});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageGraph"],["component","box","container","panel","pnlDataUsageGraph"],{component:true,box:true,container:true,panel:true,pnlDataUsageGraph:true},["widget.pnlDataUsageGraph"],0,[Rd.view.dataUsage,"pnlDataUsageGraph"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageUserDetail",Ext.panel.Panel,{scrollable:true,layout:{type:"vbox",align:"stretch"},border:true,ui:"light",title:"Today",headerPosition:"right",initComponent:function(){var b=this;b.items=[{xtype:"progressbar",itemId:"pbData",text:'<i class="fa  fa-database"></i> Data Usage',height:20,margin:5,value:1},{xtype:"progressbar",itemId:"pbTime",text:'<i class="fa fa-clock-o"></i> Time Usage',height:20,margin:5,width:"100%",value:0.5},{xtype:"panel",itemId:"pnlInfo",height:150,tpl:new Ext.XTemplate("<div>",'<ul class="fa-ul">',"<tpl if='type == \"voucher\"'>","<li style='color:blue;'><i class='fa-li fa  fa-ticket'></i> Voucher</li>","</tpl>","<li><i class='fa-li fa  fa-cubes'></i> {profile}</li>","<li><i class='fa-li fa  fa-star'></i><b>Created</b> {created}</li>",'<tpl if="Ext.isDefined(last_reject_time)">',"<li style='color:red;'><i class='fa-li fa fa-warning'></i> <b>Last Failed Login</b> {last_reject_time}</li>","</tpl>",'<tpl if="Ext.isDefined(last_reject_message)">',"<li style='color:red;'><i class='fa-li fa fa-warning'></i> <b>Failed Login Message</b> {last_reject_message}</li>","</tpl>",'<tpl if="Ext.isDefined(last_accept_time)">',"<li style='color:green;'><i class='fa-li fa fa-check-circle'></i> <b>Last Good Login</b> {last_accept_time}</li>","</tpl>",'<tpl if="Ext.isDefined(data_cap)">',"<li><i class='fa-li fa fa-database'></i> <b>Data Cap</b> {data_cap}</li>","</tpl>",'<tpl if="Ext.isDefined(data_used)">',"<li style='color:blue;'><i class='fa-li fa fa-database'></i> <b>Data Used</b> {data_used}</li>","</tpl>",'<tpl if="Ext.isDefined(time_cap)">',"<li><i class='fa-li fa fa-clock-o'></i> <b>Time Cap</b> {time_cap}</li>","</tpl>",'<tpl if="Ext.isDefined(time_used)">',"<li style='color:blue;'><i class='fa-li fa fa-clock-o'></i> <b>Time Used</b> {time_used}</li>","</tpl>","</ul>","</div>")}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},paintUserDetail:function(o){var p=this;if(Ext.isDefined(o.username)){p.setTitle(o.username)}if(Ext.isDefined(o.type)){if(o.type=="voucher"){p.setGlyph(Rd.config.icnVoucher)}if(o.type=="user"){p.setGlyph(Rd.config.icnUser)}if(o.type=="device"){p.setGlyph(Rd.config.icnDevice)}}if(Ext.isDefined(o.perc_data_used)){if(o.perc_data_used<70){var j="wifigreen";p.down("#pbData").toggleCls("wifiyellow",false);p.down("#pbData").toggleCls("wifired",false);p.down("#pbData").toggleCls(j,true)}if(o.perc_data_used>=70&&o.perc_data_used<90){j="wifiyellow";p.down("#pbData").toggleCls("wifigreen",false);p.down("#pbData").toggleCls("wifired",false);p.down("#pbData").toggleCls(j,true)}if(o.perc_data_used>=90){j="wifired";p.down("#pbData").toggleCls("wifigreen",false);p.down("#pbData").toggleCls("wifiyellow",false);p.down("#pbData").toggleCls(j,true)}var k='<i class="fa  fa-database"></i>  Data Usage '+o.perc_data_used+" %";var l=o.perc_data_used/100;p.down("#pbData").show().setValue(l).updateText(k)}else{p.down("#pbData").hide()}if(Ext.isDefined(o.perc_time_used)){if(o.perc_time_used<70){var j="wifigreen";p.down("#pbTime").toggleCls("wifiyellow",false);p.down("#pbTime").toggleCls("wifired",false);p.down("#pbTime").toggleCls(j,true)}if(o.perc_time_used>=70&&o.perc_time_used<90){j="wifiyellow";p.down("#pbTime").toggleCls("wifigreen",false);p.down("#pbTime").toggleCls("wifired",false);p.down("#pbTime").toggleCls(j,true)}if(o.perc_time_used>=90){j="wifired";p.down("#pbTime").toggleCls("wifigreen",false);p.down("#pbTime").toggleCls("wifiyellow",false);p.down("#pbTime").toggleCls(j,true)}var n='<i class="fa fa-clock-o"></i> Time Usage '+o.perc_time_used+" %";var m=o.perc_time_used/100;p.down("#pbTime").show().setValue(m).updateText(n)}else{p.down("#pbTime").hide()}p.down("#pnlInfo").setData(o)}},0,["pnlDataUsageUserDetail"],["component","box","container","panel","pnlDataUsageUserDetail"],{component:true,box:true,container:true,panel:true,pnlDataUsageUserDetail:true},["widget.pnlDataUsageUserDetail"],0,[Rd.view.dataUsage,"pnlDataUsageUserDetail"],0));(Ext.cmd.derive("Rd.controller.cDataUsage",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"pnlDataUsage",border:true,itemId:"tabDataUsage",plain:true});d.populated=true},views:["dataUsage.pnlDataUsage","components.cmbRealm","components.pnlUsageGraph","dataUsage.pnlDataUsageDay","dataUsage.pnlDataUsageWeek","dataUsage.pnlDataUsageMonth","dataUsage.pnlDataUsageGraph","dataUsage.pnlDataUsageUserDetail"],stores:[],models:["mRealm","mUserStat"],selectedRecord:null,config:{urlUsageForRealm:"/cake2/rd_cake/data_usage/usage_for_realm.json",username:false,type:"realm"},refs:[{ref:"pnlDataUsageDay",selector:"pnlDataUsageDay"},{ref:"pnlDataUsageWeek",selector:"pnlDataUsageWeek"},{ref:"pnlDataUsageMonth",selector:"pnlDataUsageMonth"},{ref:"pnlDataUsage",selector:"pnlDataUsage"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({pnlDataUsage:{afterlayout:b.resizeSegments},"#tabDataUsage":{destroy:b.appClose},"#tabDataUsage cmbRealm":{change:b.realmChange,afterrender:b.afterRenderEventRealm},"#tabDataUsage #reload":{click:b.reload},"#tabDataUsage #btnShowRealm":{click:b.btnShowRealmClick},"#tabDataUsage grid":{rowclick:b.rowClickEvent},"#tabDataUsage #btnSeeMore":{click:b.openActivityViewer}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.fetchDataUsage()},realmChange:function(d){var e=this;e.setType("realm");e.setUsername(d.getValue());e.fetchDataUsage()},afterRenderEventRealm:function(k){var n=this;var j=n.application.getDashboardData();var m=j.data_usage.realm_name;var i=j.data_usage.realm_id;var l=Ext.create("Rd.model.mRealm",{name:m,id:i});k.getStore().loadData([l],false);k.setValue(i)},fetchDataUsage:function(){var b=this;b.getPnlDataUsage().setLoading(true);Ext.Ajax.request({url:b.getUrlUsageForRealm(),params:{type:b.getType(),username:b.getUsername()},method:"GET",success:function(a){var e=Ext.JSON.decode(a.responseText);b.getPnlDataUsage().setLoading(false);if(e.success){console.log(e);b.paintDataUsage(e.data)}else{}}})},paintDataUsage:function(j){var k=this;var l=k.getPnlDataUsageDay().down("#dailyTotal");var i=k.getPnlDataUsageWeek().down("#weeklyTotal");var h=k.getPnlDataUsageMonth().down("#monthlyTotal");j.daily.totals.data_in=Ext.ux.bytesToHuman(j.daily.totals.data_in);j.daily.totals.data_out=Ext.ux.bytesToHuman(j.daily.totals.data_out);j.daily.totals.data_total=Ext.ux.bytesToHuman(j.daily.totals.data_total);l.setData(j.daily.totals);j.weekly.totals.data_in=Ext.ux.bytesToHuman(j.weekly.totals.data_in);j.weekly.totals.data_out=Ext.ux.bytesToHuman(j.weekly.totals.data_out);j.weekly.totals.data_total=Ext.ux.bytesToHuman(j.weekly.totals.data_total);i.setData(j.weekly.totals);j.monthly.totals.data_in=Ext.ux.bytesToHuman(j.monthly.totals.data_in);j.monthly.totals.data_out=Ext.ux.bytesToHuman(j.monthly.totals.data_out);j.monthly.totals.data_total=Ext.ux.bytesToHuman(j.monthly.totals.data_total);h.setData(j.monthly.totals);Ext.data.StoreManager.lookup("dayStore").setData(j.daily.top_ten);Ext.data.StoreManager.lookup("activeStore").setData(j.daily.active_sessions);k.getPnlDataUsageDay().down("cartesian").getStore().setData(j.daily.graph.items);Ext.data.StoreManager.lookup("weekStore").setData(j.weekly.top_ten);k.getPnlDataUsageWeek().down("cartesian").getStore().setData(j.weekly.graph.items);Ext.data.StoreManager.lookup("monthStore").setData(j.monthly.top_ten);k.getPnlDataUsageMonth().down("cartesian").getStore().setData(j.monthly.graph.items);if(j.user_detail!=undefined){k.paintUserDetail(j.user_detail)}else{k.hideUserDetail()}},paintUserDetail:function(d){var e=this;e.getPnlDataUsageDay().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageDay().down("#plrDaily").hide();e.getPnlDataUsageDay().down("pnlDataUsageUserDetail").show();e.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageWeek().down("#plrWeekly").hide();e.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").show();e.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageMonth().down("#plrMonthly").hide();e.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").show()},hideUserDetail:function(){var b=this;b.getPnlDataUsageDay().down("#plrDaily").show();b.getPnlDataUsageDay().down("pnlDataUsageUserDetail").hide();b.getPnlDataUsageWeek().down("#plrWeekly").show();b.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").hide();b.getPnlDataUsageMonth().down("#plrMonthly").show();b.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").hide()},rowClickEvent:function(g,h){var j=this;var i=h.get("username");j.getPnlDataUsage().down("#btnShowRealm").show();j.getPnlDataUsage().down("cmbRealm").setDisabled(true);j.setUsername(i);j.setType("user");j.fetchDataUsage()},btnShowRealmClick:function(e){var d=this;d.getPnlDataUsage().down("cmbRealm").setDisabled(false);e.hide();d.setUsername(d.getPnlDataUsage().down("cmbRealm").getValue());d.setType("realm");d.fetchDataUsage()},resizeSegments:function(e){var d=this;if(e.getHeight()>400){d.getPnlDataUsageDay().setHeight((e.getHeight()-40));d.getPnlDataUsageWeek().setHeight((e.getHeight()-40));d.getPnlDataUsageMonth().setHeight((e.getHeight()-40))}},openActivityViewer:function(e){var h=this;var g=h.getPnlDataUsage();h.application.runAction("cActivityMonitor","Index",g)}},0,0,0,0,0,0,[Rd.controller,"cDataUsage"],0));(Ext.cmd.derive("Rd.view.debugOutput.pnlViewDebug",Ext.panel.Panel,{html:"",autoScroll:true,autoCreate:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")},{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_debug"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_debug"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"time",tooltip:i18n("sAdd_debug_time")}]},{xtype:"buttongroup",title:i18n("sFilters"),items:[{xtype:"cmbNas",itemId:"nas",emptyText:i18n("sAny_NAS_device"),forceSelection:false,allowBlank:true,labelWidth:120,width:400},{xtype:"tbspacer",width:10},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",itemId:"username",allowBlank:true,emptyText:i18n("sAny_user"),labelSeparator:"",labelClsExtra:"lblRd",labelWidth:120}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlViewDebug"],["component","box","container","panel","pnlViewDebug"],{component:true,box:true,container:true,panel:true,pnlViewDebug:true},["widget.pnlViewDebug"],0,[Rd.view.debugOutput,"pnlViewDebug"],0));(Ext.cmd.derive("Rd.controller.cDebug",Ext.app.Controller,{actionIndex:function(e){var h=this;if(h.populated){return}var g=Ext.create("Rd.view.debugOutput.pnlViewDebug",{region:"center",layout:"fit",margins:"0 0 0 0",border:false,itemId:"pnlDebug"});e.add(g);h.populated=true},views:["debugOutput.pnlViewDebug"],stores:[],models:["mNas"],socket:undefined,showFirstTime:undefined,showDiv:undefined,htmlToAdd:"",renderFlag:undefined,countTimeout:undefined,timeout:undefined,config:{urlFrStatusDb:"/cake2/rd_cake/free_radius/status_debug.json",urlFrStartDb:"/cake2/rd_cake/free_radius/start_debug.json",urlFrStopDb:"/cake2/rd_cake/free_radius/stop_debug.json",urlFrTimeDb:"/cake2/rd_cake/free_radius/time_debug.json",portWebSocket:"8000"},refs:[{ref:"file",selector:"pnlViewDebug"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlViewDebug #clear":{click:b.clear},"pnlViewDebug #start":{click:b.start},"pnlViewDebug #stop":{click:b.stop},"pnlViewDebug #time":{click:b.time},"#pnlDebug":{afterrender:b.onShow,render:b.onRender,destroy:b.onDestroy}})},clear:function(b){var e=this;e.showDiv.innerHTML=""},start:function(b){var j=this;var k={};var l=b.up("pnlViewDebug").down("#nas").getValue();var i=b.up("pnlViewDebug").down("#username").getValue();if(l!=null){k.nas_id=l}if(i!=""){k.username=i}Ext.Ajax.request({url:j.getUrlFrStartDb(),method:"GET",params:k,success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(j.countTimeout);j.timeout=d.data.time_added;j.countTimeout=setInterval(function(){j.timeout=j.timeout-1;if(j.timeout>0){j.getFile().down("#feedback").update({message:"Stopping debug tace in "+j.timeout+" seconds"})}else{clearInterval(j.countTimeout);j.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000);Ext.ux.Toaster.msg("Debug trace started","Debug trace started fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.getFile().down("#time").setDisabled(false)}},scope:j})},stop:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStopDb(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(e.countTimeout);e.getFile().down("#feedback").update({message:"Debug tace stopped"});e.getFile().down("#time").setDisabled(true);Ext.ux.Toaster.msg("Debug trace stopped","Debug trace stopped fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},time:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrTimeDb(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(e.countTimeout);e.timeout=d.data.time_added;e.countTimeout=setInterval(function(){e.timeout=e.timeout-1;if(e.timeout>0){e.getFile().down("#feedback").update({message:"Stopping debug tace in "+e.timeout+" seconds"})}else{clearInterval(e.countTimeout);e.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000);Ext.ux.Toaster.msg("Debug timeout increased","Debug timeout increased fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},ioLoaded:function(g){var i=this;var h=i.application.getDashboardData().token;var j=document.location.host;i.socket=io.connect("http://"+j+":"+i.getPortWebSocket()+"?token="+h);i.socket.on("connect",function(){});i.socket.on("message",function(l){if(Ext.isString(l)){var b=i18n("sReceiving_new_logfile_data");i.getFile().down("#feedback").update({message:b});var a=l.split("\n");var e=a.length-1;var d=false;a.forEach(function(k,o,p){if(o==e){d=true}i.newText(k,d)})}});i.socket.on("error",function(a){console.error("Unable to connect Socket.IO",a)})},onShow:function(g){var h=this;if(h.showFirstTime==undefined){h.showFirstTime=true;h.showDiv=h.getFile().body.dom;var e=document.location.host;Ext.Loader.loadScript({url:"http://"+e+":"+h.getPortWebSocket()+"/socket.io/socket.io.js",onLoad:h.ioLoaded,scope:h})}else{if(h.renderFlag==true){h.showDiv=h.getFile().body.dom;h.socket.socket.reconnect();h.renderFlag=false}}},onRender:function(e){var d=this;if(d.showFirstTime==true){d.renderFlag=true}Ext.Ajax.request({url:d.getUrlFrStatusDb(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.data.level>0){d.getFile().down("#start").toggle(true);d.getFile().down("#time").setDisabled(false);if(a.data.time_added!=undefined){d.timeout=a.data.time_added;d.countTimeout=setInterval(function(){d.timeout=d.timeout-1;if(d.timeout>0){d.getFile().down("#feedback").update({message:"Stopping debug tace in "+d.timeout+" seconds"})}else{clearInterval(d.countTimeout);d.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000)}}else{d.getFile().down("#stop").toggle(true);d.getFile().down("#time").setDisabled(true)}}},scope:d})},onDestroy:function(e){var d=this;d.populated=false;d.renderFlag=false;d.socket.disconnect();clearInterval(d.countTimeout)},newText:function(d,r){var t=this;var y="<br />";if(r==true){y=""}var w=d.split(": ");if(w.length>=3){var x="<span class='txtGrey'>"+w[0]+"</span> : ";var s=w[1];var C="txtGrey";var A=/Info/i;if(s.search(A)!=-1){C="txtBlue"}var u=/Error/i;if(s.search(u)!=-1){C="txtRed"}var q="<span class='"+C+"'>"+w[1]+"</span> : ";w.shift();w.shift();var B=w.toString();if(C=="txtRed"){B="<span class='txtBold'>"+B+"</span>"}t.htmlToAdd=t.htmlToAdd+x+q+B+y}else{t.htmlToAdd=t.htmlToAdd+d+y}if(r==true){t.showDiv.innerHTML=t.showDiv.innerHTML+t.htmlToAdd;t.htmlToAdd="";t.getFile().body.scrollTo("top",99999,true);var z=i18n("sAwaiting_new_logfile_data");t.getFile().down("#feedback").update({message:z})}}},0,0,0,0,0,0,[Rd.controller,"cDebug"],0));(Ext.cmd.derive("Rd.view.devices.gridDevices",Ext.grid.Panel,{multiSelect:true,store:"sDevices",stateful:true,stateId:"StateGridDevices",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridDevices1"},{text:i18n("sOwner"),dataIndex:"permanent_user",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDevices2"},{text:i18n("sMAC_address"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDevices3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDevices4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridDevices5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridDevices6"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDevices7"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices8"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices9"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices10"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices11"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices12"},{header:i18n("sData_used"),hidden:true,dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_data_used");i.toggleCls("wifigreen",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridDevices13"},{header:i18n("sTime_used"),hidden:true,dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_time_used");i.toggleCls("wifired",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridDevices14"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridDevices15",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices16"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDevices17"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDevices:true},["widget.gridDevices"],0,[Rd.view.devices,"gridDevices"],0));(Ext.cmd.derive("Rd.model.mProfile",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"data_cap_in_profile",type:"bool"},{name:"time_cap_in_profile",type:"bool"},"profile_components",{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mProfile"],0));(Ext.cmd.derive("Rd.model.mDevice",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"permanent_user",type:"string"},{name:"permanent_user_id"},{name:"realm",type:"string"},{name:"profile",type:"string"},{name:"profile_id"},"perc_time_used","perc_data_used","name","description","vendor_id",{name:"active",type:"bool"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage",{name:"notes",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDevice"],0));(Ext.cmd.derive("Rd.model.mAttribute",Ext.data.Model,{fields:["id","name"]},0,0,0,0,0,0,[Rd.model,"mAttribute"],0));(Ext.cmd.derive("Rd.model.mVendor",Ext.data.Model,{fields:["id","name"]},0,0,0,0,0,0,[Rd.model,"mVendor"],0));(Ext.cmd.derive("Rd.model.mPrivateAttribute",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"type",type:"string"},{name:"attribute",type:"string"},{name:"op",type:"string"},{name:"value",type:"string"},{name:"edit",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPrivateAttribute"],0));(Ext.cmd.derive("Rd.view.devices.pnlDevice",Ext.tab.Panel,{border:false,d_id:null,d_name:null,cmbOwnerRendered:false,plain:true,record:undefined,cls:"subTab",initComponent:function(){var e=this;var g=new Date();var h=new Date();h.setYear(h.getFullYear()+1);e.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:500,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,name:"permanent_user_id",labelClsExtra:"lblRdReq",itemId:"owner"},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date("May 20, 2013 00:00:00"),hidden:true,disabled:true,value:g},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date("May 21, 2013 00:00:00"),hidden:true,disabled:true,value:h}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,plain:true,margin:"0 20 40 0"}]}},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridDevicePrivate",username:e.d_name},{title:i18n("sAuthentication_data"),layout:"fit",xtype:"gridDeviceRadpostauths",username:e.d_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridDeviceRadaccts",username:e.d_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDevice"],["component","box","container","panel","tabpanel","pnlDevice"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDevice:true},["widget.pnlDevice"],0,[Rd.view.devices,"pnlDevice"],0));(Ext.cmd.derive("Rd.store.sPermanentUsers",Ext.data.Store,{model:"Rd.model.mPermanentUser",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/permanent-users/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sPermanentUsers"],0));(Ext.cmd.derive("Rd.store.sProfiles",Ext.data.Store,{model:"Rd.model.mProfile",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sProfiles"],0));(Ext.cmd.derive("Rd.store.sDevices",Ext.data.Store,{model:"Rd.model.mDevice",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sDevices"],0));(Ext.cmd.derive("Rd.store.sAttributes",Ext.data.Store,{model:"Rd.model.mAttribute",proxy:{type:"ajax",url:"/cake2/rd_cake/profile_components/attributes.json",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sAttributes"],0));(Ext.cmd.derive("Rd.store.sVendors",Ext.data.Store,{model:"Rd.model.mVendor",proxy:{type:"ajax",url:"/cake2/rd_cake/profile_components/vendors.json",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sVendors"],0));(Ext.cmd.derive("Rd.view.devices.winDeviceAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_device"),width:500,height:460,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},owner:"",startScreen:"scrnData",selLanguage:null,initComponent:function(){var e=this;var d=e.mkScrnData();e.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnData:function(){var l=this;var i=new Date();var k=new Date();k.setYear(k.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(l.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:Rd.config.labelWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",cls:"subTab",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"owner",name:"permanent_user_id"},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:i},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:k}]}]}],buttons:h});return j}},0,["winDeviceAddWizard"],["component","box","container","panel","window","winDeviceAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDeviceAddWizard:true},["widget.winDeviceAddWizard"],0,[Rd.view.devices,"winDeviceAddWizard"],0));(Ext.cmd.derive("Rd.view.devices.pnlDeviceGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",d_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.d_name,type:"device"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.d_name,type:"device"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.d_name,type:"device"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDeviceGraphs"],["component","box","container","panel","tabpanel","pnlDeviceGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDeviceGraphs:true},["widget.pnlDeviceGraphs"],0,[Rd.view.devices,"pnlDeviceGraphs"],0));(Ext.cmd.derive("Rd.view.components.cmbProfile",Ext.form.ComboBox,{fieldLabel:i18n("sProfile"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"profile_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mProfile",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/profiles/index-ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProfile"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProfile"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProfile:true},["widget.cmbProfile"],0,[Rd.view.components,"cmbProfile"],0));(Ext.cmd.derive("Rd.view.components.cmbCap",Ext.form.ComboBox,{fieldLabel:i18n("sCap_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"cap",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"hard",text:i18n("sHard")},{id:"soft",text:i18n("sSoft")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCap"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCap"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCap:true},["widget.cmbCap"],0,[Rd.view.components,"cmbCap"],0));(Ext.cmd.derive("Rd.view.devices.gridDeviceRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDeviceRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-accounting-data.json",plugins:"gridfilters",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}],columns:[{xtype:"rownumberer",stateId:"StateGridDeviceRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDeviceRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StateGridDeviceRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StateGridDeviceRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridDeviceRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridDeviceRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",buffered:true,leadingBufferZone:450,pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{callingstationid:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(p,a,k){if(!k){Ext.ux.Toaster.msg("Error encountered",p.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=b.getStore().getTotalCount();var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var o=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#count").update({count:n});b.down("#totals").update({"in":m,out:o,total:l})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDeviceRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDeviceRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDeviceRadaccts:true},["widget.gridDeviceRadaccts"],0,[Rd.view.devices,"gridDeviceRadaccts"],0));(Ext.cmd.derive("Rd.view.devices.gridDeviceRadpostauths",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDeviceRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-authentication-data.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDeviceRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths3"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridDeviceRadpostauths4"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths5"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDeviceRadpostauths6"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadpostauth",buffered:true,leadingBufferZone:450,pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radpostauths/delete.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDeviceRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDeviceRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDeviceRadpostauths:true},["widget.gridDeviceRadpostauths"],0,[Rd.view.devices,"gridDeviceRadpostauths"],0));(Ext.cmd.derive("Rd.view.devices.gridDevicePrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDevicePrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridDevicePrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridDevicePrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridDevicePrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridDevicePrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridDevicePrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/devices/private-attr-add.json",read:"/cake3/rd_cake/devices/private-attr-index.json",update:"/cake3/rd_cake/devices/private-attr-edit.json",destroy:"/cake3/rd_cake/devices/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDevicePrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDevicePrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDevicePrivate:true},["widget.gridDevicePrivate"],0,[Rd.view.devices,"gridDevicePrivate"],0));(Ext.cmd.derive("Rd.view.components.cmbVendor",Ext.form.ComboBox,{fieldLabel:i18n("sVendor"),labelSeparator:"",store:"sVendors",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",labelClsExtra:"lblRd",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbVendor"],["component","box","field","textfield","pickerfield","combobox","combo","cmbVendor"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbVendor:true},["widget.cmbVendor"],0,[Rd.view.components,"cmbVendor"],0));(Ext.cmd.derive("Rd.view.components.cmbAttribute",Ext.form.ComboBox,{fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sAttributes",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",labelClsExtra:"lblRd",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAttribute"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAttribute"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAttribute:true},["widget.cmbAttribute"],0,[Rd.view.components,"cmbAttribute"],0));(Ext.cmd.derive("Rd.controller.cDevices",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDevices",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDevices",glyph:Rd.config.icnHome}]});d.populated=true},views:["devices.gridDevices","devices.winDeviceAddWizard","components.cmbPermanentUser","components.cmbProfile","components.cmbCap","components.winNote","components.winNoteAdd","components.winCsvColumnSelect","components.winEnableDisable","devices.pnlDevice","devices.gridDeviceRadaccts","devices.gridDeviceRadpostauths","devices.gridDevicePrivate","components.pnlUsageGraph","components.cmbVendor","components.cmbAttribute","devices.pnlDeviceGraphs"],stores:["sAccessProvidersTree","sPermanentUsers","sRealms","sProfiles","sDevices","sAttributes","sVendors"],models:["mAccessProviderTree","mPermanentUser","mRealm","mProfile","mDevice","mUserStat","mRadacct","mRadpostauth","mAttribute","mVendor","mPrivateAttribute"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/devices/add.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/devices/export-csv",urlNoteAdd:"/cake3/rd_cake/devices/note-add.json",urlViewBasic:"/cake3/rd_cake/devices/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/devices/edit-basic-info.json",urlEnableDisable:"/cake3/rd_cake/devices/enable-disable.json",urlDelete:"/cake3/rd_cake/devices/delete.json",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridDevices"},{ref:"privateGrid",selector:"gridDevicePrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDevices":{destroy:b.appClose},"gridDevices #reload":{click:b.reload},"gridDevices #add":{click:b.add},"gridDevices #delete":{click:b.del},"gridDevices #edit":{click:b.edit},"gridDevices #note":{click:b.note},"gridDevices #csv":{click:b.csvExport},"gridDevices #enable_disable":{click:b.enableDisable},"gridDevices #test_radius":{click:b.testRadius},"gridDevices #graph":{click:b.graph},gridDevices:{select:b.select,activate:b.gridActivate},"winDeviceAddWizard #btnDataNext":{click:b.btnDataNext},"winDeviceAddWizard #profile":{change:b.cmbProfileChange},"winDeviceAddWizard #owner":{change:b.cmbOwnerChange},"winDeviceAddWizard #always_active":{change:b.chkAlwaysActiveChange},"winDeviceAddWizard #to_date":{change:b.toDateChange},"winDeviceAddWizard #from_date":{change:b.fromDateChange},"#winCsvColumnSelectDevices #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=devices] #reload":{click:b.noteReload},"gridNote[noteForGrid=devices] #add":{click:b.noteAdd},"gridNote[noteForGrid=devices] #delete":{click:b.noteDelete},"gridNote[noteForGrid=devices]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=devices] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=devices] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=devices] #btnNoteAddNext":{click:b.btnNoteAddNext},"#winEnableDisableDevice #save":{click:b.enableDisableSubmit},"pnlDevice gridUserRadpostauths #reload":{click:b.gridDeviceRadpostauthsReload},"pnlDevice gridDeviceRadpostauths #delete":{click:b.deletePostAuths},"pnlDevice gridDevicePrivate":{select:b.selectDevicePrivate,activate:b.onDeviceActivate},"pnlDevice gridDeviceRadpostauths":{activate:b.onDeviceRadpostauthsActivate},"pnlDevice gridDeviceRadaccts #reload":{click:b.gridDeviceRadacctsReload},"pnlDevice gridDeviceRadaccts #delete":{click:b.deleteRadaccts},"pnlDevice gridDeviceRadaccts":{activate:b.onDeviceRadacctsActivate},"pnlDevice #profile":{change:b.cmbProfileChange,render:b.renderEventProfile},"pnlDevice #owner":{render:b.renderEventOwner,change:b.cmbOwnerChange},"pnlDevice #always_active":{change:b.chkAlwaysActiveChange},"pnlDevice #to_date":{change:b.toDateChange},"pnlDevice #from_date":{change:b.fromDateChange},"pnlDevice #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlDevice #tabBasicInfo #save":{click:b.saveBasicInfo},gridDevicePrivate:{beforeedit:b.onBeforeEditDevicePrivate},"gridDevicePrivate  #cmbVendor":{change:b.cmbVendorChange},"gridDevicePrivate  #add":{click:b.attrAdd},"gridDevicePrivate  #reload":{click:b.attrReload},"gridDevicePrivate  #delete":{click:b.attrDelete},"#tabDevices pnlDeviceGraphs #daily":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabDevices pnlDeviceGraphs #daily #day":{change:b.changeDailyGraph},"#tabDevices pnlDeviceGraphs #weekly":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabDevices pnlDeviceGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabDevices pnlDeviceGraphs #monthly":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabDevices pnlDeviceGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sDevices").load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var h=this;if(!Ext.WindowManager.get("winDeviceAddWizardId")){var g=Ext.widget("winDeviceAddWizard",{id:"winDeviceAddWizardId",selLanguage:h.application.getSelLanguage()});g.show()}},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sDevices").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},cmbOwnerChange:function(k){var i=this;var n=k.getValue();var l=k.getStore().getById(n);var m=l.get("owner_id");var j=k.up("form");j.down("cmbProfile").getStore().getProxy().setExtraParam("ap_id",m);j.down("cmbProfile").getStore().load()},cmbProfileChange:function(r){var p=this;var s=r.up("form");var q=s.down("#cmbDataCap");var t=s.down("#cmbTimeCap");var o=r.getValue();var m=r.getStore();var u=m.getById(o);if(u!=null){var n=u.get("data_cap_in_profile");if(n){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}var w=u.get("time_cap_in_profile");if(w){t.setVisible(true);t.setDisabled(false)}else{t.setVisible(false);t.setDisabled(true)}}},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}},toDateChange:function(k,l,j){var n=this;var d=k.up("form");var m=d.down("#from_date");if(l<=m.getValue()){Ext.ux.Toaster.msg(i18n("sEnd_date_wrong"),i18n("sThe_end_date_should_be_after_the_start_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},fromDateChange:function(k,l,d){var m=this;var n=k.up("form");var j=n.down("#to_date");if(l>=j.getValue()){Ext.ux.Toaster.msg(i18n("sStart_date_wrong"),i18n("sThe_start_date_should_be_before_the_end_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},onStoreDevicesLoaded:function(){var d=this;var e=d.getStore("sDevices").getTotalCount();d.getGrid().down("#count").update({count:e})},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(d,n){var a=i.getGrid().up("tabpanel");var p=d.getId();var o="dTab_"+p;var e=a.down("#"+o);if(e){a.setActiveTab(o);return}var b=d.get("name");a.add({title:b,itemId:o,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDevice",d_id:p,d_name:b,record:d}});a.setActiveTab(o)})}},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectDevices")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectDevices",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDevices"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDevices"+m.getId(),noteForId:m.getId(),noteForGrid:"devices",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDevicesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDevicesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDevicesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDevicesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_modify"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisableDevice")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisableDevice"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestDevice",j)}},onTabBasicInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDevice").d_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{device_id:h},success:function(d,e){if(e.result.data.data_cap_type!=undefined){var a=j.down("#cmbDataCap");a.setVisible(true);a.setDisabled(false);a.setValue(e.result.data.data_cap_type)}if(e.result.data.time_cap_type!=undefined){var b=j.down("#cmbTimeCap");b.setVisible(true);b.setDisabled(false);b.setValue(e.result.data.time_cap_type)}}})},saveBasicInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlDevice").d_id;j.submit({clientValidation:true,url:i.getUrlEditBasic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onDeviceActivate:function(d){var e=this;d.getStore().load()},onDeviceRadpostauthsActivate:function(d){var e=this;d.getStore().load()},gridDeviceRadpostauthsReload:function(g){var h=this;var e=g.up("gridDeviceRadpostauths");e.getStore().load()},onDeviceRadacctsActivate:function(d){var e=this;d.getStore().load()},onDevicePrivateActivate:function(d){var e=this;d.getStore().load()},gridDeviceRadacctsReload:function(g){var h=this;var e=g.up("gridDeviceRadaccts");e.getStore().load()},deletePostAuths:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeletePostAuths(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},selectDevicePrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditDevicePrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridDevicePrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridDevicePrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridDevicePrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridDevicePrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},renderEventOwner:function(k){var m=this;var i=k.up("pnlDevice");i.cmbOwnerRendered=true;if(i.record!=undefined){var j=i.record.get("permanent_user");var n=i.record.get("permanent_user_id");var l=Ext.create("Rd.model.mPermanentUser",{username:j,id:n});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var n=this;var i=k.up("pnlDevice");i.cmbProfileRendered=true;if(i.record!=undefined){var j=i.record.get("profile");var l=i.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="deviceTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlDeviceGraphs",d_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cDevices"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winAttachUnknownDynamicClient",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Unknown Client To Owner",width:500,height:520,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAttach,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var k=this;var l=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(k.no_tree==true){var l=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:k.user_id},{xtype:"textfield",name:"unknown_dynamic_client_id",hidden:true,value:k.unknown_dynamic_client_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:k.owner,labelClsExtra:"lblRdReq"},{xtype:"displayfield",fieldLabel:"NAS-Identifier",value:k.nasidentifier,labelClsExtra:"lblRdReq"},{xtype:"displayfield",fieldLabel:"Called-Station-Id",value:k.calledstationid,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Monitor",itemId:"tabMonitor",layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[i,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForDynamicClientOwner",realFlag:true}}]}],buttons:l});return j}},0,["winAttachUnknownDynamicClient"],["component","box","container","panel","window","winAttachUnknownDynamicClient"],{component:true,box:true,container:true,panel:true,window:true,winAttachUnknownDynamicClient:true},["widget.winAttachUnknownDynamicClient"],0,[Rd.view.dynamicClients,"winAttachUnknownDynamicClient"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridDynamicClients",Ext.grid.Panel,{multiSelect:true,store:"sDynamicClients",stateful:true,stateId:"StateGridDc1",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/dynamic_clients/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridDc1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDc2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDc3"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDc4"},{text:i18n("sCalled-Station-Id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDc5",hidden:true},{text:i18n("sActive"),width:130,hidden:true,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='active == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='active == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDc6"},{text:"To Sub-Providers",width:130,hidden:true,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDc7"},{text:i18n("sRealms"),sortable:false,width:150,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(realms)"><div class="fieldBlueWhite">Available to all!</div></tpl>','<tpl for="realms">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"realms"},{text:"Last Contact",dataIndex:"last_contact",width:150,tdCls:"gridTree",renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUdc4"},{text:"From IP",dataIndex:"last_contact_ip",tdCls:"gridTree",width:150,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGridUdc5"},{text:i18n("sStatus"),dataIndex:"status",tdCls:"gridTree",width:130,hidden:true,renderer:function(h,j,a){if(h!="unknown"){var i=a.get("status_time");if(h=="up"){return'<div class="fieldGreen">'+i18n("sUp")+" "+Ext.ux.secondsToHuman(i)+"</div>"}if(h=="down"){return'<div class="fieldRed">'+i18n("sDown")+" "+Ext.ux.secondsToHuman(i)+"</div>"}}else{return'<div class="fieldBlue">'+i18n("sUnknown")+"</div>"}},stateId:"StateGridDc10"},{text:i18n("sNotes"),sortable:false,width:130,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDc11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicClients"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicClients"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicClients:true},["widget.gridDynamicClients"],0,[Rd.view.dynamicClients,"gridDynamicClients"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridUnknownDynamicClients",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUdc",stateEvents:["groupclick","columnhide"],border:false,store:"sUnknownDynamicClients",viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/unknown_dynamic_clients/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridUdc1"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUdc2"},{text:"Called-Station-Id",dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUdc3"},{text:"Last Contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUdc4"},{text:"From IP",dataIndex:"last_contact_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{last_contact_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUdc5"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownDynamicClients"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownDynamicClients"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownDynamicClients:true},["widget.gridUnknownDynamicClients"],0,[Rd.view.dynamicClients,"gridUnknownDynamicClients"],0));(Ext.cmd.derive("Rd.model.mDynamicClient",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"nasidentifier",type:"string"},{name:"calledstationid",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_ip",type:"string"},"last_contact_human",{name:"timezone",type:"string"},{name:"monitor",type:"string"},{name:"session_auto_close",type:"bool"},{name:"session_dead_time",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"active",type:"bool"},{name:"on_public_maps",type:"bool"},"lat","lon",{name:"user_id",type:"int"},"country_code","country_name","city","postal_code",{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicClient"],0));(Ext.cmd.derive("Rd.model.mRealmForDynamicClientOwner",Ext.data.Model,{fields:["id","name","selected"]},0,0,0,0,0,0,[Rd.model,"mRealmForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.model.mUnknownDynamicClient",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"nasidentifier",type:"string"},{name:"calledstationid",type:"string"},{name:"last_contact_ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},"last_contact_human","country_code","country_name","city","postal_code"]},0,0,0,0,0,0,[Rd.model,"mUnknownDynamicClient"],0));(Ext.cmd.derive("Rd.model.mDynamicClientState",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"state",type:"bool"},{name:"time",type:"string"},{name:"start",type:"string"},{name:"end",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mDynamicClientState"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClient",Ext.tab.Panel,{border:false,dynamic_client_id:null,record:null,plain:true,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:"Dynamic Client",itemId:"tabDynamicClient",xtype:"pnlDynamicClientDynamicClient",dynamic_client_id:b.dynamic_client_id},{title:"Realms",itemId:"tabRealms",layout:"fit",border:false,xtype:"pnlRealmsForDynamicClientOwner",record:b.record,dynamic_client_id:b.dynamic_client_id},{title:"Photo",itemId:"tabPhoto",xtype:"pnlDynamicClientPhoto",dynamic_client_id:b.dynamic_client_id},{title:"Availability",itemId:"tabAvailability",xtype:"gridDynamicClientsAvailability",dynamic_client_id:b.dynamic_client_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClient"],["component","box","container","panel","tabpanel","pnlDynamicClient"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicClient:true},["widget.pnlDynamicClient"],0,[Rd.view.dynamicClients,"pnlDynamicClient"],0));(Ext.cmd.derive("Rd.view.nas.winMapPreferences",Ext.window.Window,{title:i18n("sPreferences"),layout:"fit",autoShow:false,width:350,height:350,iconCls:"settings",glyph:Rd.config.icnSpanner,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"HYBRID",text:i18n("sHybrid")},{id:"ROADMAP",text:i18n("sRoadmap")},{id:"SATELLITE",text:i18n("sSatellite")},{id:"TERRAIN",text:i18n("sTerrain")}]});this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"numberfield",name:"lng",itemId:"lng",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"lat",itemId:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"zoom",itemId:"zoom",fieldLabel:i18n("sZoom_level"),value:17,maxValue:22,minValue:0,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"type",itemId:"type",fieldLabel:i18n("sType"),store:e,queryMode:"local",displayField:"text",valueField:"id",allowBlank:false,forceSelection:true,labelClsExtra:"lblRdReq"}],buttons:[{itemId:"snapshot",text:i18n("sSnapshot"),scale:"large",iconCls:"b-snapshot",glyph:Rd.config.icnSnapshot,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapPreferences"],["component","box","container","panel","window","winMapPreferences"],{component:true,box:true,container:true,panel:true,window:true,winMapPreferences:true},["widget.winMapPreferences"],0,[Rd.view.nas,"winMapPreferences"],0));(Ext.cmd.derive("Rd.store.sDynamicClients",Ext.data.Store,{model:"Rd.model.mDynamicClient",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/dynamic_clients/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sDynamicClients"],0));(Ext.cmd.derive("Rd.store.sUnknownDynamicClients",Ext.data.Store,{model:"Rd.model.mUnknownDynamicClient",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/unknown_dynamic_clients/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/unknown_dynamic_clients/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownDynamicClients"],0));(Ext.cmd.derive("Rd.view.components.pnlGMap",Ext.ux.GMapPanel,{urlMenu:"/cake2/rd_cake/nas/menu_for_maps.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",markers:[],infoWindows:[],infowindow:undefined,editwindow:undefined,addwindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,initComponent:function(){var k=this;k.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:k.urlMenu});var l=k.centerLatLng.lat;var j=k.centerLatLng.lng;k.center=new google.maps.LatLng(l,j);k.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapInfoDiv";k.infowindow=new google.maps.InfoWindow({content:h});k.infoWindows.push(k.infowindow);google.maps.event.addListener(k.infowindow,"domready",function(){var q=k.infowindow.getContent();if(k.i_pnl){k.i_pnl.destroy()}var b=k.marker_record.get("photo_file_name");var d=k.urlPhotoBase+b;var r="N/A";if(k.marker_record.get("status")!="unknown"){if(k.marker_record.get("status")=="up"){var e=i18n("sUp")}if(k.marker_record.get("status")=="down"){var e=i18n("sDown")}r=e+" "+Ext.ux.secondsToHuman(k.marker_record.get("status_time"))}var a=Ext.apply({time_in_state:r},k.marker_record.data);var g=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sName")+"  </label><label class='lblValue'> {shortname}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sIP_Address")+"  </label><label class='lblValue'> {nasname}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sConnection")+"  </label><label class='lblValue'> {connection_type}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sCurrent_state")+"  </label><label class='lblValue'> {time_in_state}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sDescription")+"  </label><label class='lblValue'> {description}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sPublic")+"  </label><label class='lblValue'> {on_public_maps}</label><br>","</div>"]);var p=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='"+i18n("sNas_Image")+"'>","</div>"]);k.i_pnl=Ext.create("Ext.tab.Panel",{itemId:"pnlMapsInfo",width:350,height:250,layout:"fit",activeTab:0,items:[{title:"Info",itemId:"tabMapInfo",bodyPadding:2,tpl:g,autoScroll:true,data:a},{title:"Photo",itemId:"tabMapPhoto",bodyPadding:2,tpl:p,autoScroll:true,data:{image:d}}],renderTo:q});k.i_pnl.doLayout()});var i=document.createElement("div");i.className=i.className+"mapEditDiv";k.editwindow=new google.maps.InfoWindow({content:i});k.infoWindows.push(k.editwindow);google.maps.event.addListener(k.editwindow,"domready",function(){var a=k.editwindow.getContent();if(k.e_pnl){k.e_pnl.destroy()}var b=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sNew_position")+"</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLatitude")+"  </label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLongitude")+"  </label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","</div>"]);k.e_pnl=Ext.create("Ext.panel.Panel",{title:i18n("sAction_required"),itemId:"pnlMapsEdit",height:170,tpl:b,layout:"fit",buttonAlign:"center",buttons:[{xtype:"button",itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes},{xtype:"button",itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose},{xtype:"button",itemId:"delete",text:i18n("sDelete"),scale:"large",glyph:Rd.config.icnDelete}],renderTo:a});k.e_pnl.update({lng:k.new_lng,lat:k.new_lat})});k.addwindow=new google.maps.InfoWindow({content:"<div style='padding:5px;margin:5px; height:100px; width:200px;'><div class='lblRdReq'>"+i18n("sAction_required")+"</div><div class='lblRd'>"+i18n("sDrag_and_drop_marker_torequired_position")+"</div></div>"});k.infoWindows.push(k.addwindow);Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}},createMap:function(){var b=this;Ext.ux.GMapPanel.prototype.createMap.apply(this,arguments);b.store.load()}},0,["pnlGMap"],["component","box","container","panel","gmappanel","pnlGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlGMap:true},["widget.pnlGMap"],0,[Rd.view.components,"pnlGMap"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winMapDynamicClientAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:500,height:300,glyph:Rd.config.icnNote,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Select a Dynamic Client",cls:"lblWizard"}],items:[{xtype:"cmbDynamicClientsAddMap"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapDynamicClientAdd"],["component","box","container","panel","window","winMapDynamicClientAdd"],{component:true,box:true,container:true,panel:true,window:true,winMapDynamicClientAdd:true},["widget.winMapDynamicClientAdd"],0,[Rd.view.dynamicClients,"winMapDynamicClientAdd"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winDynamicClientAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Dynamic Client",width:500,height:510,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var k=this;var l=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(k.no_tree==true){var l=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:k.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:k.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"NAS-Identifier",name:"nasidentifier",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Called-Station-Id",name:"calledstationid",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Monitor",itemId:"tabMonitor",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[i,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForDynamicClientOwner",realFlag:true}}]}],buttons:l});return j}},0,["winDynamicClientAddWizard"],["component","box","container","panel","window","winDynamicClientAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDynamicClientAddWizard:true},["widget.winDynamicClientAddWizard"],0,[Rd.view.dynamicClients,"winDynamicClientAddWizard"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",dynamic_client_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.dynamic_client_id,type:"dynamic_client"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.dynamic_client_id,type:"dynamic_client"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.dynamic_client_id,type:"dynamic_client"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientGraphs"],["component","box","container","panel","tabpanel","pnlDynamicClientGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicClientGraphs:true},["widget.pnlDynamicClientGraphs"],0,[Rd.view.dynamicClients,"pnlDynamicClientGraphs"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientDynamicClient",Ext.panel.Panel,{border:false,dynamic_client_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:e,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});h.items={xtype:"form",height:"100%",width:500,layout:"fit",autoScroll:true,frame:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"dynamic_client_id",hidden:true,value:h.dynamic_client_id},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"NAS-Identifier",name:"nasidentifier",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Called-Station-Id",name:"calledstationid",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Monitor",itemId:"tabMonitor",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientDynamicClient"],["component","box","container","panel","pnlDynamicClientDynamicClient"],{component:true,box:true,container:true,panel:true,pnlDynamicClientDynamicClient:true},["widget.pnlDynamicClientDynamicClient"],0,[Rd.view.dynamicClients,"pnlDynamicClientDynamicClient"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlRealmsForDynamicClientOwner",Ext.panel.Panel,{border:false,dynamic_client_id:null,record:null,layout:"fit",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll"}],initComponent:function(){var d=this;var e=Ext.create("Rd.view.dynamicClients.gridRealmsForDynamicClientOwner",{realFlag:true});e.getStore().getProxy().setExtraParam("dynamic_client_id",d.dynamic_client_id);e.getStore().getProxy().setExtraParam("owner_id",d.record.get("user_id"));e.getStore().getProxy().setExtraParam("available_to_siblings",d.record.get("available_to_siblings"));d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmsForDynamicClientOwner"],["component","box","container","panel","pnlRealmsForDynamicClientOwner"],{component:true,box:true,container:true,panel:true,pnlRealmsForDynamicClientOwner:true},["widget.pnlRealmsForDynamicClientOwner"],0,[Rd.view.dynamicClients,"pnlRealmsForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridRealmsForDynamicClientOwner",Ext.grid.Panel,{border:false,realFlag:false,columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",flex:1},{xtype:"advCheckColumn",text:"Include",dataIndex:"selected",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;if(b.realFlag){urlUpdate="/cake3/rd_cake/realms/update-dynamic-client-realm.json";b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbseparator"},{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_sub_providers"),cls:"lblRd",itemId:"chkAvailSub",name:"available_to_siblings",inputValue:true}]}else{b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRealmForDynamicClientOwner",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/list-realms-for-dynamic-client-owner.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/list-realms-for-dynamic-client-owner.json",update:"/cake3/rd_cake/realms/update-dynamic-client-realm.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg("Updated Realm","Updated Realm",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg("Problems Updating Realm","Problems Updating Realm",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealmsForDynamicClientOwner"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealmsForDynamicClientOwner"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealmsForDynamicClientOwner:true},["widget.gridRealmsForDynamicClientOwner"],0,[Rd.view.dynamicClients,"gridRealmsForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.view.components.cmpImg",Ext.Component,{html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',url:"",afterRender:function(){var b=this;if(b.url!=""){b.setImage(b.url)}Ext.Component.prototype.afterRender.apply(this,arguments)},setImage:function(g){var e=this,h;h=e.el.dom.firstChild;h.src=g}},0,["cmpImg"],["component","box","cmpImg"],{component:true,box:true,cmpImg:true},["widget.cmpImg"],0,[Rd.view.components,"cmpImg"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientPhoto",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:"Current Photo",flex:1,border:false,items:[{xtype:"cmpImg"}]},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:"Select an image",fieldLabel:"New photo",allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientPhoto"],["component","box","container","panel","pnlDynamicClientPhoto"],{component:true,box:true,container:true,panel:true,pnlDynamicClientPhoto:true},["widget.pnlDynamicClientPhoto"],0,[Rd.view.dynamicClients,"pnlDynamicClientPhoto"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridDynamicClientsAvailability",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridDynamicClientsAvailability",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/dynamic_client_states/menu_for_grid.json",urlIndex:"/cake2/rd_cake/dynamic_client_states/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridDynamicClientsAvailability1"},{text:i18n("sState"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='state == true'><div class=\"fieldGreen\">"+i18n("sUp")+"</div></tpl>","<tpl if='state == false'><div class=\"fieldRed\">"+i18n("sDown")+"</div></tpl>"),dataIndex:"state",stateId:"StateGridDynamicClientsAvailability2"},{text:i18n("sDuration"),dataIndex:"time",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability3"},{text:i18n("sStarted"),dataIndex:"start",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability4"},{text:i18n("sEnded"),dataIndex:"end",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability5"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicClientState",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/dynamic_client_states/delete.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("dynamic_client_id",b.dynamic_client_id);Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicClientsAvailability"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicClientsAvailability"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicClientsAvailability:true},["widget.gridDynamicClientsAvailability"],0,[Rd.view.dynamicClients,"gridDynamicClientsAvailability"],0));(Ext.cmd.derive("Rd.view.dynamicClients.cmbDynamicClientsAddMap",Ext.form.ComboBox,{fieldLabel:"Available",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/dynamic_clients/clients_avail_for_map.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicClientsAddMap"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicClientsAddMap"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicClientsAddMap:true},["widget.cmbDynamicClientsAddMap"],0,[Rd.view.dynamicClients,"cmbDynamicClientsAddMap"],0));(Ext.cmd.derive("Rd.controller.cDynamicClients",Ext.app.Controller,{owner:undefined,user_id:undefined,actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDynamicClients",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDynamicClients",glyph:Rd.config.icnHome},{title:"Unknown clients",xtype:"gridUnknownDynamicClients",glyph:Rd.config.icnQuestion}]});d.populated=true},views:["dynamicClients.gridDynamicClients","dynamicClients.winDynamicClientAddWizard","dynamicClients.gridUnknownDynamicClients","dynamicClients.winAttachUnknownDynamicClient","components.cmbTimezones","components.winNote","components.winNoteAdd","dynamicClients.pnlDynamicClient","dynamicClients.pnlDynamicClientDynamicClient","dynamicClients.pnlRealmsForDynamicClientOwner","dynamicClients.gridRealmsForDynamicClientOwner","dynamicClients.pnlDynamicClientPhoto","dynamicClients.gridDynamicClientsAvailability","components.pnlUsageGraph","dynamicClients.pnlDynamicClientGraphs","components.pnlGMap","dynamicClients.winMapDynamicClientAdd","nas.winMapPreferences","dynamicClients.cmbDynamicClientsAddMap"],stores:["sAccessProvidersTree","sDynamicClients","sUnknownDynamicClients"],models:["mAccessProviderTree","mDynamicClient","mRealmForDynamicClientOwner","mUnknownDynamicClient","mDynamicClientState","mUserStat"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/dynamic_clients/export_csv",urlAdd:"/cake2/rd_cake/dynamic_clients/add.json",urlDelete:"/cake2/rd_cake/dynamic_clients/delete.json",urlEdit:"/cake2/rd_cake/dynamic_clients/edit.json",urlNoteAdd:"/cake2/rd_cake/dynamic_clients/note_add.json",urlView:"/cake2/rd_cake/dynamic_clients/view.json",urlViewPhoto:"/cake2/rd_cake/dynamic_clients/view_photo.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",urlUploadPhoto:"/cake2/rd_cake/dynamic_clients/upload_photo/",urlMapDelete:"/cake2/rd_cake/dynamic_clients/delete_map.json",urlMapSave:"/cake2/rd_cake/dynamic_clients/edit_map.json",urlGreenMark:"resources/images/map_markers/green-dot.png",urlRedMark:"resources/images/map_markers/red-dot.png",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlYellowMark:"resources/images/map_markers/yellow-dot.png",urlViewMapPref:"/cake2/rd_cake/dynamic_clients/view_map_pref.json",urlEditMapPref:"/cake2/rd_cake/dynamic_clients/edit_map_pref.json"},refs:[{ref:"grid",selector:"gridDynamicClients"},{ref:"pnlGMap",selector:"pnlGMap"}],autoReloadUnknownDynamicClients:undefined,autoReload:undefined,init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDynamicClients":{destroy:b.appClose},"#tabDynamicClients gridDynamicClients":{activate:b.gridActivate},"#tabDynamicClients gridUnknownDynamicClients":{activate:b.gridActivate},"gridDynamicClients #reload":{click:b.reload},"gridDynamicClients #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridDynamicClients #add":{click:b.add},"gridDynamicClients #delete":{click:b.del},"gridDynamicClients #edit":{click:b.edit},"pnlDynamicClient #tabDynamicClient":{activate:b.onTabDynamicClientActive},"pnlDynamicClient #tabDynamicClient #monitorType":{change:b.monitorTypeChange},"pnlDynamicClient #tabDynamicClient #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"pnlDynamicClient #tabDynamicClient #save":{click:b.saveDynamicClient},"pnlRealmsForDynamicClientOwner #chkAvailForAll":{change:b.chkAvailForAllChangeTab},"pnlRealmsForDynamicClientOwner gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"pnlRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"pnlDynamicClient #tabRealms":{activate:b.tabRealmsActivate},"pnlDynamicClient #tabPhoto":{activate:b.tabPhotoActivate},"pnlDynamicClient #tabPhoto #save":{click:b.photoSave},"pnlDynamicClient #tabPhoto #cancel":{click:b.photoCancel},"pnlDynamicClient #tabAvailability":{activate:b.tabAvailabilityActivate},"gridDynamicClientsAvailability #reload":{click:b.gridDynamicClientsAvailabilityReload},"gridDynamicClientsAvailability #delete":{click:b.gridDynamicClientsAvailabilityDelete},"gridDynamicClients #note":{click:b.note},"gridDynamicClients #graph":{click:b.graph},"gridDynamicClients #map":{click:b.mapLoadApi},gridDynamicClients:{select:b.select},"winDynamicClientAddWizard #btnTreeNext":{click:b.btnTreeNext},"winDynamicClientAddWizard #btnDataPrev":{click:b.btnDataPrev},"winDynamicClientAddWizard #btnDataNext":{click:b.btnDataNext},"winDynamicClientAddWizard #monitorType":{change:b.monitorTypeChange},"winDynamicClientAddWizard #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"winDynamicClientAddWizard gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"winDynamicClientAddWizard #tabRealms":{activate:b.gridRealmsForDynamicClientOwnerActivate},"winDynamicClientAddWizard #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winDynamicClientAddWizard gridRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"gridUnknownDynamicClients #reload":{click:b.gridUnknownDynamicClientsReload},"gridUnknownDynamicClients #reload menuitem[group=refresh]":{click:b.reloadUnknownDynamicClientsOptionClick},"gridUnknownDynamicClients #attach":{click:b.attachAttachUnknownDynamicClient},"winAttachUnknownDynamicClient #btnTreeNext":{click:b.btnTreeNext},"winAttachUnknownDynamicClient #btnDataPrev":{click:b.btnDataPrev},"winAttachUnknownDynamicClient #btnDataNext":{click:b.btnDataNext},"winAttachUnknownDynamicClient #monitorType":{change:b.monitorTypeChange},"winAttachUnknownDynamicClient #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"winAttachUnknownDynamicClient gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"winAttachUnknownDynamicClient #tabRealms":{activate:b.gridRealmsForDynamicClientOwnerActivate},"winAttachUnknownDynamicClient #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winAttachUnknownDynamicClient gridRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"gridUnknownDynamicClients #delete":{click:b.delUnknownDynamicClient},"gridNote[noteForGrid=dynamic_clients] #reload":{click:b.noteReload},"gridNote[noteForGrid=dynamic_clients] #add":{click:b.noteAdd},"gridNote[noteForGrid=dynamic_clients] #delete":{click:b.noteDelete},"gridNote[noteForGrid=dynamic_clients]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=dynamic_clients] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=dynamic_clients] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=dynamic_clients] #btnNoteAddNext":{click:b.btnNoteAddNext},"#tabDynamicClients pnlDynamicClientGraphs #daily":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabDynamicClients pnlDynamicClientGraphs #daily #day":{change:b.changeDailyGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly #day":{change:b.changeMonthlyGraph},"pnlGMap #preferences":{click:b.mapPreferences},"winMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMapPreferences #save":{click:b.mapPreferencesSave},"pnlGMap #add":{click:b.mapDynamicClientAdd},"winMapDynamicClientAdd #save":{click:b.mapDynamicClientAddSubmit},"pnlGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadUnknownDynamicClients!=undefined){clearInterval(b.autoReloadUnknownDynamicClients)}},gridActivate:function(d){var e=this;d.getStore().load()},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},add:function(g){var i=this;var j=g.up("#tabDynamicClients");var h=j.down("gridDynamicClients").getStore();Ext.Ajax.request({url:i.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winDynamicClientAddWizardId")){var d=Ext.widget("winDynamicClientAddWizard",{id:"winDynamicClientAddWizardId",store:h});d.show()}}else{if(!Ext.WindowManager.get("winDynamicClientAddWizardId")){var d=Ext.widget("winDynamicClientAddWizard",{id:"winDynamicClientAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,store:h});d.show()}}}},scope:i})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("window");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("window");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(q){var n=this;var p=q.up("window");var s=q.up("form");var m=s.down("tabpanel");var t=s.down("gridRealmsForDynamicClientOwner");var r={};var l=false;var o=s.down("#chkAvailForAll");if(o.getValue()==true){r.avail_for_all=true}else{t.getStore().each(function(a){if(a.get("selected")==true){l=true;r[a.getId()]=a.get("selected")}},n)}if(r.avail_for_all==undefined){if(l!=true){var m=s.down("tabpanel");m.setActiveTab("tabRealms");Ext.ux.Toaster.msg(i18n("sSelect_at_least_one_realm"),i18n("sSelect_one_or_more_realms"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}s.submit({clientValidation:true,url:n.getUrlAdd(),params:r,success:function(b,a){p.store.load();p.close();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,e,b,d){if(e.result.errors.username!=undefined){m.setActiveTab(0)}else{m.setActiveTab("tabNas")}Ext.ux.formFail(a,e)}})},monitorTypeChange:function(j){var l=this;var h=j.up("form");var i=h.down("#heartbeat_dead_after");var k=j.getValue();if(k=="heartbeat"){i.setVisible(true)}else{i.setVisible(false)}},chkSessionAutoCloseChange:function(h){var i=this;var g=h.up("panel");var j=g.down("#nrSessionDeadTime");if(h.getValue()==true){j.setVisible(true)}else{j.setVisible(false)}},chkAvailForAllChange:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForDynamicClientOwner");if(h.getValue()==true){g.hide()}else{g.show()}},chkAvailForAllChangeTab:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForDynamicClientOwner");if(h.getValue()==true){g.hide()}else{g.show()}g.getStore().getProxy().setExtraParam("clear_flag",true);g.getStore().load();g.getStore().getProxy().setExtraParam("clear_flag",false)},gridRealmsForDynamicClientOwnerReload:function(e){var h=this;var g=e.up("gridRealmsForDynamicClientOwner");g.getStore().load()},gridRealmsForDynamicClientOwnerActivate:function(g){var j=this;var i=g.down("#chkAvailSub").getValue();var h=g.down("gridRealmsForDynamicClientOwner");h.getStore().getProxy().setExtraParam("owner_id",j.owner_id);h.getStore().getProxy().setExtraParam("available_to_siblings",i);h.getStore().load()},gridRealmsForDynamicClientOwnerChkAvailSub:function(h){var j=this;var i=h.getValue();var g=h.up("gridRealmsForDynamicClientOwner");g.getStore().getProxy().setExtraParam("owner_id",j.owner_id);g.getStore().getProxy().setExtraParam("available_to_siblings",i);g.getStore().load()},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},edit:function(h){var j=this;var i=h.up("gridDynamicClients");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(d,g){var a=i.up("tabpanel");var b=d.getId();var o="dynamic_clientTab_"+b;var e=a.down("#"+o);if(e){a.setActiveTab(o);return}var p=d.get("name");a.add({title:p,itemId:o,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDynamicClient",dynamic_client_id:b,record:d}});a.setActiveTab(o)})}},onTabDynamicClientActive:function(h){var j=this;var g=h.down("form");var i=h.up("pnlDynamicClient").dynamic_client_id;g.load({url:j.getUrlView(),method:"GET",params:{dynamic_client_id:i}})},saveDynamicClient:function(h){var j=this;var g=h.up("form");var i=h.up("pnlDynamicClient").dynamic_client_id;g.submit({clientValidation:true,url:j.getUrlEdit(),params:{id:i},success:function(b,a){j.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabRealmsActivate:function(g){var h=this;var e=g.down("gridRealmsForDynamicClientOwner");e.getStore().load()},tabPhotoActivate:function(e){var h=this;var g=e.up("pnlDynamicClient");Ext.Ajax.request({url:h.getUrlViewPhoto(),method:"GET",params:{id:g.dynamic_client_id},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var j=e.down("cmpImg");var a=h.getUrlPhotoBase()+b.data.photo_file_name;j.setImage(a)}},scope:h})},photoSave:function(l){var j=this;var k=l.up("form");var i=k.up("pnlDynamicClient");var h=i.down("pnlDynamicClientPhoto");k.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:j.getUrlUploadPhoto(),params:{id:i.dynamic_client_id},success:function(d,b){if(b.result.success){var e=b.result.photo_file_name;var g=h.down("cmpImg");var a=j.getUrlPhotoBase()+e;g.setImage(a)}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},photoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabAvailabilityActivate:function(e){var d=this;e.getStore().load()},gridDynamicClientsAvailabilityReload:function(e){var h=this;var g=e.up("gridDynamicClientsAvailability");g.getStore().load()},gridDynamicClientsAvailabilityDelete:function(e){var h=this;var g=e.up("gridDynamicClientsAvailability");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},gridUnknownDynamicClientsReload:function(g){var h=this;var e=g.up("gridUnknownDynamicClients");e.getStore().load()},reloadUnknownDynamicClientsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownDynamicClients);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownDynamicClients=setInterval(function(){j.gridUnknownDynamicClientsReload(b)},k)},attachAttachUnknownDynamicClient:function(q){var p=this;var t=q.up("#tabDynamicClients");var n=t.down("gridUnknownDynamicClients").getStore();if(t.down("gridUnknownDynamicClients").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var w=t.down("gridUnknownDynamicClients").getSelectionModel().getLastSelected();var u=w.getId();var m=w.get("nasidentifier");var r=w.get("calledstationid");var s=true;if(!Ext.WindowManager.get("winAttachUnknownDynamicClientId")){var o=Ext.widget("winAttachUnknownDynamicClient",{id:"winAttachUnknownDynamicClientId",store:n,nasidentifier:m,calledstationid:r,unknown_dynamic_client_id:u});o.show()}}},delUnknownDynamicClient:function(g){var i=this;var j=g.up("#tabDynamicClients");var h=j.down("gridUnknownDynamicClients");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDynamicClient"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDynamicClient"+m.getId(),noteForId:m.getId(),noteForGrid:"dynamic_clients",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDynamicClientAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicClientAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDynamicClientAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicClientAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="dynamicClientTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlDynamicClientGraphs",dynamic_client_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("gridDynamicClients");var m=j.up("tabpanel");var l="mapTab";var k=m.down("#"+l);if(k){m.setActiveTab(l);return}var n=i18n("sGoogle_Maps");Ext.Ajax.request({url:o.getUrlViewMapPref(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){m.add({title:n,itemId:l,closable:true,iconCls:"map",glyph:Rd.config.icnMap,layout:"fit",items:{xtype:"pnlGMap",store:o.getStore("sDynamicClients"),mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[]}});m.setActiveTab(l)}},scope:o})},mapPreferences:function(e){var h=this;if(!Ext.WindowManager.get("winMapPreferencesId")){var g=Ext.widget("winMapPreferences",{id:"winMapPreferencesId"});g.show();g.down("form").load({url:h.getUrlViewMapPref(),method:"GET"})}},mapPreferencesSnapshot:function(r){var p=this;var t=r.up("form");var s=p.getPnlGMap();var l=s.gmap.getZoom();var o=s.gmap.getMapTypeId();var m=s.gmap.getCenter();var q=m.lat();var n=m.lng();t.down("#lat").setValue(q);t.down("#lng").setValue(n);t.down("#zoom").setValue(l);t.down("#type").setValue(o.toUpperCase())},mapPreferencesSave:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlEditMapPref(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},mapDynamicClientAdd:function(e){var h=this;if(!Ext.WindowManager.get("winMapDynamicClientAddId")){var g=Ext.widget("winMapDynamicClientAdd",{id:"winMapDynamicClientAddId"});g.show()}},mapDynamicClientAddSubmit:function(u){var p=this;var s=u.up("window");var o=s.down("cmbDynamicClientsAddMap");var x=o.getValue();var t=o.getStore().getById(x);s.close();var n=p.getGrid().up("tabpanel");var r=n.down("#mapTab");if(r!=null){var q=r.down("gmappanel");var y=q.gmap.getCenter();var w=q.addMarker({lat:y.lat(),lng:y.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){p.dragEnd(t,q,w)},dragstart:function(){q.addwindow.close();p.dragStart(t,q,w)}}});q.addwindow.open(q.gmap,w)}},markerClick:function(w,s,x){var q=this;var u=w.get("nasname");var y=w.get("shortname");s.marker_record=w;var p=Ext.ComponentQuery.query("#pnlMapsInfo");if(p[0]){var n="N/A";if(w.get("status")!="unknown"){if(w.get("status")=="up"){var d=i18n("sUp")}if(w.get("status")=="down"){var d=i18n("sDown")}n=d+" "+Ext.ux.secondsToHuman(w.get("status_time"))}var t=Ext.apply({time_in_state:n},w.data);p[0].down("#tabMapInfo").update(t);var r=q.getUrlPhotoBase()+w.get("photo_file_name");p[0].down("#tabMapPhoto").update({image:r})}s.infowindow.open(s.gmap,x)},dragStart:function(g,j,h){var i=this;i.lastMovedMarker=h;i.lastOrigPosition=h.getPosition();i.editWindow=j.editwindow},dragEnd:function(l,k,i){var j=this;var h=i.getPosition();k.new_lng=h.lng();k.new_lat=h.lat();k.editwindow.open(k.gmap,i);j.lastLng=h.lng();j.lastLat=h.lat();j.lastDragId=l.getId()},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapDelete(),method:"GET",params:{id:d.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},btnMapSave:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapSave(),method:"GET",params:{id:d.lastDragId,lat:d.lastLat,lon:d.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})}},0,0,0,0,0,0,[Rd.controller,"cDynamicClients"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPhotoAdd",Ext.window.Window,{title:i18n("sAdd_photo"),layout:"fit",autoShow:false,width:500,height:480,glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,data_view:undefined,initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"stretch_to_fit",name:"Stretch To Fit"},{id:"horizontal",name:"Horizontal Fit"},{id:"vertical",name:"Vertical Fit"},{id:"original",name:"Original Size"},{id:"dynamic",name:"Device Dependent Fit"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:"Fit",store:e,queryMode:"local",displayField:"name",valueField:"id",name:"fit",value:"stretch_to_fit"});h.items=[{xtype:"form",layout:"fit",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sTitle"),name:"title",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sPhoto"),allowBlank:false,labelClsExtra:"lblRdReq",name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"checkbox",fieldLabel:"Active",name:"active",inputValue:"active",checked:true,labelClsExtra:"lblRdReq"}]},{title:"Advanced",layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[g,{xtype:"colorfield",fieldLabel:"Background color",name:"background_color",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#DDDDE5"},{xtype:"textfield",fieldLabel:"URL",name:"url",labelClsExtra:"lblRd",vtype:"url"},{xtype:"numberfield",name:"slide_duration",fieldLabel:"Slide Duration",value:10,maxValue:300,minValue:2},{xtype:"checkbox",fieldLabel:"Include Title",name:"include_title",inputValue:"include_title",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include Description",name:"include_description",inputValue:"include_description",checked:true,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhotoAdd"],["component","box","container","panel","window","winPhotoAdd"],{component:true,box:true,container:true,panel:true,window:true,winPhotoAdd:true},["widget.winPhotoAdd"],0,[Rd.view.dynamicDetails,"winPhotoAdd"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPageEdit",Ext.window.Window,{title:i18n("sEdit_own_page"),layout:"fit",autoShow:false,width:600,height:450,iconCls:"edit",glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"htmleditor",width:580,height:250,name:"content",labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPageEdit"],["component","box","container","panel","window","winPageEdit"],{component:true,box:true,container:true,panel:true,window:true,winPageEdit:true},["widget.winPageEdit"],0,[Rd.view.dynamicDetails,"winPageEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetails",Ext.grid.Panel,{multiSelect:true,store:"sDynamicDetails",stateful:true,stateId:"StateGridDynamicDetails",stateEvents:["groupclick","columnhide"],border:false,plugins:"gridfilters",urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-grid.json",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridDynamicDetails1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails3"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails4"},{text:i18n("sFax"),dataIndex:"fax",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails5"},{text:i18n("sCell"),dataIndex:"cell",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails6"},{text:i18n("s_email"),dataIndex:"email",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails7"},{text:i18n("sURL"),dataIndex:"url",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails8"},{text:"Theme",dataIndex:"theme",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails8a"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDynamicDetails9"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDynamicDetails10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetails"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetails"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetails:true},["widget.gridDynamicDetails"],0,[Rd.view.dynamicDetails,"gridDynamicDetails"],0));(Ext.cmd.derive("Rd.model.mDynamicPhoto",Ext.data.Model,{fields:["id","dynamic_detail_id","title","description","url","file_name","img",{name:"active",type:"bool"},"fit","background_color","slide_duration",{name:"include_title",type:"bool"},{name:"include_description",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicPhoto"],0));(Ext.cmd.derive("Rd.model.mDynamicPage",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"content",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mDynamicPage"],0));(Ext.cmd.derive("Rd.model.mDynamicPair",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"value",type:"string"},{name:"priority",type:"int"},"dynamic_detail_id"]},0,0,0,0,0,0,[Rd.model,"mDynamicPair"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetail",Ext.tab.Panel,{border:false,dynamic_detail_id:null,plain:true,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDetail"),xtype:"pnlDynamicDetailDetail",itemId:"tabDetail"},{title:i18n("sLogo"),itemId:"tabLogo",xtype:"pnlDynamicDetailLogo",margin:5},{title:i18n("sPhotos"),itemId:"tabPhoto",xtype:"pnlDynamicDetailPhoto",dynamic_detail_id:b.dynamic_detail_id},{title:i18n("sOwn_pages"),itemId:"tabPages",xtype:"gridDynamicDetailPages",dynamic_detail_id:b.dynamic_detail_id},{title:i18n("sDynamic_keys"),itemId:"tabPairs",xtype:"gridDynamicDetailPairs",dynamic_detail_id:b.dynamic_detail_id},{title:"Settings",itemId:"tabSettings",xtype:"pnlDynamicDetailSettings",dynamic_detail_id:b.dynamic_detail_id,user_id:b.user_id},{title:"Click to connect",itemId:"tabClickToConect",xtype:"pnlDynamicDetailClickToConnect",dynamic_detail_id:b.dynamic_detail_id},{title:"Social login",itemId:"tabSocialLogin",xtype:"pnlDynamicDetailSocialLogin",dynamic_detail_id:b.dynamic_detail_id,user_id:b.user_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetail"],["component","box","container","panel","tabpanel","pnlDynamicDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicDetail:true},["widget.pnlDynamicDetail"],0,[Rd.view.dynamicDetails,"pnlDynamicDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPhotoEdit",Ext.window.Window,{title:i18n("sEdit_photo"),layout:"fit",autoShow:false,width:500,height:480,glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,data_view:undefined,initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"stretch_to_fit",name:"Stretch To Fit"},{id:"horizontal",name:"Horizontal Fit"},{id:"vertical",name:"Vertical Fit"},{id:"original",name:"Original Size"},{id:"dynamic",name:"Device Dependent Fit"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:"Fit",store:e,queryMode:"local",displayField:"name",name:"fit",valueField:"id",value:"stretch_to_fit"});h.items=[{xtype:"form",layout:"fit",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sTitle"),name:"title",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sOptional_photo"),allowBlank:true,labelClsExtra:"lblRd",name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"checkbox",fieldLabel:"Active",name:"active",inputValue:"active",checked:true,labelClsExtra:"lblRdReq"}]},{title:"Advanced",layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[g,{xtype:"colorfield",fieldLabel:"Background color",name:"background_color",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#DDDDE5"},{xtype:"textfield",fieldLabel:"URL",name:"url",labelClsExtra:"lblRd",vtype:"url"},{xtype:"numberfield",name:"slide_duration",fieldLabel:"Slide Duration",value:10,maxValue:300,minValue:2},{xtype:"checkbox",fieldLabel:"Include Title",name:"include_title",inputValue:"include_title",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include Description",name:"include_description",inputValue:"include_description",checked:true,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhotoEdit"],["component","box","container","panel","window","winPhotoEdit"],{component:true,box:true,container:true,panel:true,window:true,winPhotoEdit:true},["widget.winPhotoEdit"],0,[Rd.view.dynamicDetails,"winPhotoEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPairEdit",Ext.window.Window,{title:i18n("sEdit_dynamic_pair"),layout:"fit",autoShow:false,width:400,height:350,iconCls:"edit",glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sValue"),name:"value",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"numberfield",name:"priority",fieldLabel:i18n("sPriority"),value:1,maxValue:20,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPairEdit"],["component","box","container","panel","window","winPairEdit"],{component:true,box:true,container:true,panel:true,window:true,winPairEdit:true},["widget.winPairEdit"],0,[Rd.view.dynamicDetails,"winPairEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPairAdd",Ext.window.Window,{title:i18n("sAdd_dynamic_pair"),layout:"fit",autoShow:false,width:400,height:350,iconCls:"add",glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sValue"),name:"value",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"numberfield",name:"priority",fieldLabel:i18n("sPriority"),value:1,maxValue:20,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPairAdd"],["component","box","container","panel","window","winPairAdd"],{component:true,box:true,container:true,panel:true,window:true,winPairAdd:true},["widget.winPairAdd"],0,[Rd.view.dynamicDetails,"winPairAdd"],0));(Ext.cmd.derive("Rd.store.sDynamicDetails",Ext.data.Store,{model:"Rd.model.mDynamicDetail",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sDynamicDetails"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPageAdd",Ext.window.Window,{title:i18n("sAdd_own_page"),layout:"fit",autoShow:false,width:600,height:450,iconCls:"add",glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"htmleditor",width:580,height:250,name:"content",labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPageAdd"],["component","box","container","panel","window","winPageAdd"],{component:true,box:true,container:true,panel:true,window:true,winPageAdd:true},["widget.winPageAdd"],0,[Rd.view.dynamicDetails,"winPageAdd"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.frmDetail",Ext.form.Panel,{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",owner:"",user_id:"",no_tree:false,initComponent:function(){var d=this;var e=[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,margin:"0 20 40 0"}];if(d.no_tree){e=[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,margin:"0 20 40 0"}]}d.buttons=e;d.items=[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:d.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:d.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"fieldset",title:i18n("sOptional_Info"),collapsible:true,border:false,collapsed:true,defaults:{anchor:"100%"},items:[{xtype:"displayfield",fieldLabel:i18n("sContact_detail"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sAddress"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sLocation"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",allowBlank:true}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmDynamicDetailDetail"],["component","box","container","panel","form","frmDynamicDetailDetail"],{component:true,box:true,container:true,panel:true,form:true,frmDynamicDetailDetail:true},["widget.frmDynamicDetailDetail"],0,[Rd.view.dynamicDetails,"frmDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winDynamicDetailAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_dynamic_page"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",owner:"",user_id:"",no_tree:false,defaults:{border:false},initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var d=this;var e=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return e},mkScrnDynamicDetailDetail:function(){me=this;var b=Ext.create("Rd.view.dynamicDetails.frmDetail",{itemId:"scrnDynamicDetailDetail",user_id:me.user_id,owner:me.owner,no_tree:true});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]},{title:"T&C",layout:"anchor",itemId:"tabTc",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Compulsory",itemId:"chkTc",name:"t_c_check",inputValue:"t_c_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"URL",itemId:"txtTcUrl",name:"t_c_url",disabled:true,allowBlank:false,margin:15}]}]}]});return d}},0,["winDynamicDetailAddWizard"],["component","box","container","panel","window","winDynamicDetailAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDynamicDetailAddWizard:true},["widget.winDynamicDetailAddWizard"],0,[Rd.view.dynamicDetails,"winDynamicDetailAddWizard"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailDetail",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailDetail"],["component","box","container","panel","pnlDynamicDetailDetail"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailDetail:true},["widget.pnlDynamicDetailDetail"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailLogo",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var d=this;var e=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='DynamicDetail logo'>","</div>"]);d.items={xtype:"panel",frame:true,height:"100%",width:450,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:i18n("sCurrent_logo"),flex:1,border:false,itemId:"pnlImg",tpl:e,data:{img:d.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailLogo"],["component","box","container","panel","pnlDynamicDetailLogo"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailLogo:true},["widget.pnlDynamicDetailLogo"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailLogo"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailPhoto",Ext.panel.Panel,{border:false,frame:false,layout:{type:"hbox",align:"stretch"},store:undefined,dynamic_detail_id:null,bodyStyle:{backgroundColor:Rd.config.panelGrey},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-photos.json",urlShufflePhoto:"/cake3/rd_cake/dynamic-details/shuffle-photo.json",initComponent:function(){var h=this;var e=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap">',"<div>","<div><h1>{title}</h1></div>",'<img src="{img}" />','<div class="description">{description}</div>','<tpl if="Ext.isEmpty(url)">',"<div></div>","<tpl else>",'<div><a href="{url}" target="_blank">{url}</a></div>',"</tpl>","</div>",'<div class="thumb-info">','<ul class="fa-ul">','<tpl if="active">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Enabled</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Disabled</span></li>',"</tpl>","<tpl if=\"fit=='stretch_to_fit'\">",'<li><i class="fa-li fa fa-expand"></i>Stretch To Fit</li>',"</tpl>","<tpl if=\"fit=='horizontal'\">",'<li><i class="fa-li fa fa-expand"></i>Horizontal Fit</li>',"</tpl>","<tpl if=\"fit=='vertical'\">",'<li><i class="fa-li fa fa-expand"></i>Vertical Fit</li>',"</tpl>","<tpl if=\"fit=='original'\">",'<li><i class="fa-li fa fa-expand"></i>Original Size</li>',"</tpl>",'<li style="background-color:#{background_color};"><i class="fa-li fa fa-paint-brush"></i>Background HTML <b>#{background_color}</b></li>','<li><i class="fa-li fa fa-clock-o"></i>Slide duration <b>{slide_duration}</b> seconds</li>','<tpl if="include_title">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Show Title</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Hide Title</span></li>',"</tpl>",'<tpl if="include_description">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Show Description</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Hide Description</span></li>',"</tpl>","</ul>","</div>","</div>","</tpl>");h.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPhoto",proxy:{type:"ajax",url:"/cake3/rd_cake/dynamic-details/index-photo.json",extraParams:{dynamic_detail_id:h.dynamic_detail_id},batchActions:true,format:"json",reader:{keepRawData:true,type:"json",rootProperty:"items"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-photo.json"}},listeners:{load:function(d,j,a){if(!a){Ext.ux.Toaster.msg("Error encountered",d.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var b=h.down("dataview").getStore().getTotalCount();h.down("#count").update({count:b})}},scope:this}});var g=Ext.create("Ext.view.View",{store:h.store,multiSelect:true,tpl:e,itemSelector:"div.thumb-wrap",emptyText:i18n("sNo_images_available"),listeners:{render:function(b){var a=this;a.dragZone=new Ext.view.DragZone({view:b,ddGroup:"dynPhotos",dragText:'<span class="txtBlue"><i class="fa  fa-lightbulb-o"></i> <b>Drag & Drop</b> to rearrange items</span>'});a.dopZone=new Ext.view.DropZone({view:b,ddGroup:"dynPhotos",handleNodeDrop:function(x,u,t){var i=this.view,d=i.getStore(),r,y,w,s;if(x.copy){y=x.records;x.records=[];for(w=0,s=y.length;w<s;w++){x.records.push(y[w].copy(y[w].getId()))}}else{x.view.store.remove(x.records,x.view===i)}r=d.indexOf(u);if(t!=="before"){r++}d.insert(r,x.records);i.getSelectionModel().select(x.records);a.commitShuffle(d)}})},scope:h}});h.items={xtype:"panel",frame:false,height:"100%",width:550,itemId:"pnlForPhotoView",layout:{type:"vbox",align:"stretch"},items:g,autoScroll:true,tbar:Ext.create("Rd.view.components.ajaxToolbar",{url:h.urlMenu,extra_text:'<span class="txtBlue"><i class="fa  fa-lightbulb-o"></i> <b>Drag & Drop</b> to rearrange items</span>'}),bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},commitShuffle:function(g){var e=this;var h=[];g.each(function(b){var a=b.getId();Ext.Array.push(h,{id:a})});Ext.Ajax.request({url:e.urlShufflePhoto,method:"POST",jsonData:h,params:{dynamic_detail_id:e.dynamic_detail_id},success:function(a,b){Ext.ux.Toaster.msg("Updating Photo Position","Updating Photo Position Completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.reload()},failure:function(a,b){Ext.ux.Toaster.msg("Problems Updating Photo Position","Problems Updating Photo Position",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.reload()}})}},0,["pnlDynamicDetailPhoto"],["component","box","container","panel","pnlDynamicDetailPhoto"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailPhoto:true},["widget.pnlDynamicDetailPhoto"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailPhoto"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetailPages",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDynamicDetailPages",stateEvents:["groupclick","columnhide"],border:false,dynamic_detail_id:undefined,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-dynamic-pages.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDynamicDetailPages1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",width:200,stateId:"StateGridDynamicDetailPages2"},{text:i18n("sContent"),dataIndex:"content",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPages3"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPage",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index-page.json",extraParams:{dynamic_detail_id:b.dynamic_detail_id},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-page.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetailPages"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetailPages"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetailPages:true},["widget.gridDynamicDetailPages"],0,[Rd.view.dynamicDetails,"gridDynamicDetailPages"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetailPairs",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDynamicDetailPairs",stateEvents:["groupclick","columnhide"],border:false,dynamic_detail_id:undefined,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-dynamic-pairs.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDynamicDetailPairs1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridDynamicDetailPairs2"},{text:i18n("sValue"),dataIndex:"value",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPairs3"},{text:i18n("sPriority"),dataIndex:"priority",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPairs4"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPair",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index-pair.json",extraParams:{dynamic_detail_id:b.dynamic_detail_id},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-pair.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetailPairs"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetailPairs"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetailPairs:true},["widget.gridDynamicDetailPairs"],0,[Rd.view.dynamicDetails,"gridDynamicDetailPairs"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.vcDynamicDetailSettings",Ext.app.ViewController,{init:function(){},onCmbThemesChange:function(h){var e=this;e.theme=h.getValue();console.log("The Theme is now "+e.theme);var g=h.up("panel");if(e.theme=="Custom"){g.down("#txtCoovaDesktopUrl").setDisabled(false);g.down("#txtCoovaDesktopUrl").setHidden(false);g.down("#txtCoovaMobileUrl").setDisabled(false);g.down("#txtCoovaMobileUrl").setHidden(false);g.down("#txtMikrotikDesktopUrl").setDisabled(false);g.down("#txtMikrotikDesktopUrl").setHidden(false);g.down("#txtMikrotikMobileUrl").setDisabled(false);g.down("#txtMikrotikMobileUrl").setHidden(false)}else{g.down("#txtCoovaDesktopUrl").setDisabled(true);g.down("#txtCoovaDesktopUrl").setHidden(true);g.down("#txtCoovaMobileUrl").setDisabled(true);g.down("#txtCoovaMobileUrl").setHidden(true);g.down("#txtMikrotikDesktopUrl").setDisabled(true);g.down("#txtMikrotikDesktopUrl").setHidden(true);g.down("#txtMikrotikMobileUrl").setDisabled(true);g.down("#txtMikrotikMobileUrl").setHidden(true)}},onChkRegisterUsersChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("cmbRealm").setDisabled(false);e.down("cmbProfile").setDisabled(false);e.down("#chkRegMacCheck").setDisabled(false);e.down("#chkRegAutoAdd").setDisabled(false);e.down("#chkRegEmail").setDisabled(false)}else{e.down("cmbRealm").setDisabled(true);e.down("cmbProfile").setDisabled(true);e.down("#chkRegMacCheck").setDisabled(true);e.down("#chkRegAutoAdd").setDisabled(true);e.down("#chkRegEmail").setDisabled(true)}},onChkRegAutoSuffixChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("#txtRegSuffix").setDisabled(false)}else{e.down("#txtRegSuffix").setDisabled(true)}},chkSlideshowChange:function(j){var m=this;var n=j.up("form");var i=n.down("#nrEnforceInSeconds");var k=n.down("#chkSlideshowEnforce");var l=j.getValue();if(l){k.setDisabled(false);if(k.getValue()){i.setDisabled(false)}else{i.setDisabled(true)}}else{i.setDisabled(true);k.setDisabled(true)}},chkEnforceChange:function(i){var k=this;var l=i.up("form");var h=l.down("#nrEnforceInSeconds");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}}},0,0,0,0,["controller.vcDynamicDetailSettings"],0,[Rd.view.dynamicDetails,"vcDynamicDetailSettings"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailSettings",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},controller:"vcDynamicDetailSettings",user_id:undefined,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/i18n.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Theme",layout:"anchor",itemId:"tabTheme",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"cmbThemes",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbThemesChange"}},{xtype:"textfield",fieldLabel:"Coova Desktop URL",itemId:"txtCoovaDesktopUrl",name:"coova_desktop_url",value:"/rd_login/cc/d/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Coova Mobile URL",itemId:"txtCoovaMobileUrl",name:"coova_mobile_url",value:"/rd_login/cc/m/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Mikrotik Desktop URL",itemId:"txtMikrotikDesktopUrl",name:"mikrotik_desktop_url",value:"/rd_login/mt/d/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Mikrotik Mobile URL",itemId:"txtMikrotikMobileUrl",name:"mikrotik_mobile_url",value:"/rd_login/mt/m/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Slideshow",itemId:"chkSlideshow",name:"slideshow_check",inputValue:"slideshow_check",checked:false,labelClsExtra:"lblRdReq",listeners:{change:"chkSlideshowChange"}},{xtype:"checkbox",fieldLabel:"Enforce Watching",itemId:"chkSlideshowEnforce",name:"slideshow_enforce_watching",inputValue:"slideshow_enforce_watching",checked:false,labelClsExtra:"lblRd",disabled:true,listeners:{change:"chkEnforceChange"}},{xtype:"numberfield",name:"slideshow_enforce_seconds",fieldLabel:"Enforce in Seconds",itemId:"nrEnforceInSeconds",value:30,maxValue:300,minValue:1,disabled:true}]},{title:"Login",layout:"anchor",itemId:"tabUsersVouchers",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"User login",itemId:"chkUserLogin",name:"user_login_check",inputValue:"user_login_check",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Auto-add suffix",itemId:"chkAutoSuffix",name:"auto_suffix_check",inputValue:"auto_suffix_check",checked:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Suffix",itemId:"txtSuffix",name:"auto_suffix",disabled:true},{xtype:"checkbox",fieldLabel:"Lost password",itemId:"chkLostPassword",name:"lost_password",inputValue:"lost_password",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Voucher login",itemId:"chkVoucherLogin",name:"voucher_login_check",inputValue:"voucher_login_check",checked:true,labelClsExtra:"lblRdReq"}]},{title:"T&Cs",layout:"anchor",itemId:"tabTandC",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Agree to T&C",itemId:"chkTc",name:"t_c_check",inputValue:"t_c_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"T&C URL",itemId:"txtTcUrl",name:"t_c_url",disabled:true,allowBlank:false,vtype:"url"}]},{title:"Redirect",layout:"anchor",itemId:"tabRedirect",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Redirect after connect",itemId:"chkRedirect",name:"redirect_check",inputValue:"redirect_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Redirect to URL",itemId:"txtRedirectUrl",name:"redirect_url",disabled:true,allowBlank:false,vtype:"url"},{xtype:"checkbox",fieldLabel:"Show usage",itemId:"chkUsage",name:"usage_show_check",inputValue:"usage_show_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"usage_refresh_interval",fieldLabel:"Refresh every (seconds)",itemId:"nrUsageRefresh",value:120,maxValue:600,minValue:60,disabled:true}]},{title:i18n("sRegistration"),layout:"anchor",itemId:"tabRegistration",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sUser_registration"),itemId:"chkRegisterUsers",name:"register_users",inputValue:"register_users",labelClsExtra:"lblRdReq",listeners:{change:"onChkRegisterUsersChange"}},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",disabled:true,extraParam:d.user_id},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",disabled:true,extraParam:d.user_id},{xtype:"checkbox",boxLabel:"One user registration per device",itemId:"chkRegMacCheck",name:"reg_mac_check",inputValue:"reg_mac_check",disabled:true,checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Auto-add device after authentication",itemId:"chkRegAutoAdd",name:"reg_auto_add",inputValue:"reg_auto_add",disabled:true,checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Send confirmation email",itemId:"chkRegEmail",name:"reg_email",inputValue:"reg_email",disabled:true,checked:false,cls:"lblRd"}]},{title:i18n("sLanguage"),layout:"anchor",itemId:"tabLanguage",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbDynamicDetailLanguages",labelClsExtra:"lblRdReq"},{fieldLabel:"Available Languages",store:e,queryMode:"local",emptyText:"Just The Default Language",displayField:"name",valueField:"id",xtype:"tagfield",name:"available_languages[]",labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailSettings"],["component","box","container","panel","pnlDynamicDetailSettings"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailSettings:true},["widget.pnlDynamicDetailSettings"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailSettings"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailClickToConnect",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:200,maxWidth:Rd.config.maxWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkClickToConnect",name:"connect_check",inputValue:"connect_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",itemId:"txtConnectUsername",fieldLabel:"Connect as",name:"connect_username",allowBlank:false,blankText:i18n("sSupply_a_value"),disabled:true},{xtype:"textfield",itemId:"txtConnectSuffix",fieldLabel:"Add suffix of",name:"connect_suffix",allowBlank:false,blankText:i18n("sSupply_a_value"),disabled:true},{xtype:"numberfield",name:"connect_delay",fieldLabel:"Delay before connecting (seconds)",itemId:"nrConnectDelay",value:0,maxValue:600,minValue:0,disabled:true},{xtype:"checkbox",fieldLabel:"Only Click-to-connect",itemId:"chkConnectOnly",name:"connect_only",inputValue:"connect_only",checked:false,disabled:true}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailClickToConnect"],["component","box","container","panel","pnlDynamicDetailClickToConnect"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailClickToConnect:true},["widget.pnlDynamicDetailClickToConnect"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailClickToConnect"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.cmbThemes",Ext.form.ComboBox,{fieldLabel:"Theme",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"theme",name:"theme",value:"Default",multiSelect:false,labelClsExtra:"lblRd",allowBlank:false,excludeCustom:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{exclude_custom:d.excludeCustom},url:"/cake3/rd_cake/dynamic-details/available-themes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbThemes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbThemes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbThemes:true},["widget.cmbThemes"],0,[Rd.view.dynamicDetails,"cmbThemes"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailSocialLogin",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},user_id:undefined,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"voucher",name:"Voucher"},{id:"user",name:"Permanent User"}]});d.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabSocialBasic",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true,value:d.dynamic_detail_id},{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkEnableSocialLogin",name:"social_enable",inputValue:"social_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:"Temp login user",allowBlank:false,name:"social_temp_permanent_user_id",itemId:"socialTempUser"}]},{title:"Facebook",layout:"anchor",itemId:"tabFacebook",glyph:Rd.config.icnFacebook,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"fb_enable",inputValue:"fb_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"fb_record_info",inputValue:"fb_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"fb_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"fb_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"fb_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"fbRealm",extraParam:d.user_id,name:"fb_realm",allowBlank:false},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"fbProfile",extraParam:d.user_id,name:"fb_profile",allowBlank:true}]},{title:"Google+",layout:"anchor",itemId:"tabGoogle",glyph:Rd.config.icnGoogle,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"gp_enable",inputValue:"gp_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"gp_record_info",inputValue:"gp_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"gp_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"gp_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"gp_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"gpRealm",extraParam:d.user_id,name:"gp_realm",allowBlank:true},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"gpProfile",extraParam:d.user_id,name:"gp_profile",allowBlank:true}]},{title:"Twitter",layout:"anchor",itemId:"tabTwitter",glyph:Rd.config.icnTwitter,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"tw_enable",inputValue:"tw_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"tw_record_info",inputValue:"tw_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"tw_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"tw_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"tw_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"twRealm",extraParam:d.user_id,name:"tw_realm",allowBlank:true},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"twProfile",extraParam:d.user_id,name:"tw_profile",allowBlank:true}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailSocialLogin"],["component","box","container","panel","pnlDynamicDetailSocialLogin"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailSocialLogin:true},["widget.pnlDynamicDetailSocialLogin"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailSocialLogin"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.cmbDynamicDetailLanguages",Ext.form.ComboBox,{fieldLabel:"Default Language",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"default_language",multiSelect:false,allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/i18n.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicDetailLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicDetailLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicDetailLanguages:true},["widget.cmbDynamicDetailLanguages"],0,[Rd.view.dynamicDetails,"cmbDynamicDetailLanguages"],0));(Ext.cmd.derive("Rd.controller.cDynamicDetails",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDynamicDetails",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDynamicDetails",glyph:Rd.config.icnHome}]});d.populated=true},views:["dynamicDetails.gridDynamicDetails","dynamicDetails.winDynamicDetailAddWizard","dynamicDetails.pnlDynamicDetail","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","dynamicDetails.pnlDynamicDetailDetail","dynamicDetails.pnlDynamicDetailLogo","dynamicDetails.pnlDynamicDetailPhoto","dynamicDetails.winPhotoAdd","dynamicDetails.winPhotoEdit","dynamicDetails.gridDynamicDetailPages","dynamicDetails.winPageAdd","dynamicDetails.winPageEdit","dynamicDetails.gridDynamicDetailPairs","dynamicDetails.winPairAdd","dynamicDetails.winPairEdit","dynamicDetails.pnlDynamicDetailSettings","dynamicDetails.pnlDynamicDetailClickToConnect","dynamicDetails.cmbThemes","components.cmbPermanentUser","components.cmbRealm","components.cmbProfile","dynamicDetails.pnlDynamicDetailSocialLogin","dynamicDetails.cmbDynamicDetailLanguages"],stores:["sDynamicDetails","sAccessProvidersTree","sPermanentUsers","sProfiles","sRealms"],models:["mDynamicDetail","mAccessProviderTree","mDynamicPhoto","mDynamicPage","mDynamicPair","mPermanentUser","mProfile","mRealm"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/dynamic-details/add.json",urlEdit:"/cake3/rd_cake/dynamic-details/edit.json",urlEditSettings:"/cake3/rd_cake/dynamic-details/edit-settings.json",urlEditClickToConnect:"/cake3/rd_cake/dynamic-details/edit-click-to-connect.json",urlDelete:"/cake3/rd_cake/dynamic-details/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/dynamic-details/export-csv",urlNoteAdd:"/cake3/rd_cake/dynamic-details/note-add.json",urlViewDynamicDetail:"/cake3/rd_cake/dynamic-details/view.json",urlLogoBase:"/cake3/rd_cake/img/dynamic_details/",urlUploadLogo:"/cake3/rd_cake/dynamic-details/upload_logo/",urlUploadPhoto:"/cake3/rd_cake/dynamic-details/upload-photo/",urlEditPhoto:"/cake3/rd_cake/dynamic-details/edit-photo/",urlAddPage:"/cake3/rd_cake/dynamic-details/add-page.json",urlEditPage:"/cake3/rd_cake/dynamic-details/edit_page.json",urlAddPair:"/cake3/rd_cake/dynamic-details/add_pair.json",urlEditPair:"/cake3/rd_cake/dynamic-details/edit_pair.json",urlPreviewMobile:"/cake3/rd_cake/dynamic-details/preview-chilli-mobile",urlPreviewDesktop:"/cake3/rd_cake/dynamic-details/preview-chilli-desktop",urlViewSocial:"/cake3/rd_cake/dynamic-details/view-social-login.json",urlEditSocial:"/cake3/rd_cake/dynamic-details/edit-social-login.json"},refs:[{ref:"grid",selector:"gridDynamicDetails"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDynamicDetails":{destroy:b.appClose},"gridDynamicDetails #reload":{click:b.reload},"gridDynamicDetails #add":{click:b.add},"gridDynamicDetails #delete":{click:b.del},"gridDynamicDetails #edit":{click:b.edit},"gridDynamicDetails #note":{click:b.note},"gridDynamicDetails #csv":{click:b.csvExport},"gridDynamicDetails #mobile":{click:b.previewMobile},"gridDynamicDetails #desktop":{click:b.previewDesktop},gridDynamicDetails:{itemclick:b.gridClick},"winDynamicDetailAddWizard #btnTreeNext":{click:b.btnTreeNext},"winDynamicDetailAddWizard #btnDynamicDetailDetailPrev":{click:b.btnDynamicDetailDetailPrev},"winDynamicDetailAddWizard #chkTc":{change:b.chkTcChange},"winDynamicDetailAddWizard #save":{click:b.addSubmit},"pnlDynamicDetail pnlDynamicDetailDetail #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEdit())}},"#winCsvColumnSelectDynamicDetails #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=dynamicDetails] #reload":{click:b.noteReload},"gridNote[noteForGrid=dynamicDetails] #add":{click:b.noteAdd},"gridNote[noteForGrid=dynamicDetails] #delete":{click:b.noteDelete},"gridNote[noteForGrid=dynamicDetails]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=dynamicDetails] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=dynamicDetails] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=dynamicDetails] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlDynamicDetail #tabDetail":{beforerender:b.tabDetailActivate,activate:b.tabDetailActivate},"pnlDynamicDetail #tabSettings #chkUserLogin":{change:b.chkUserLoginChange},"pnlDynamicDetail #tabSettings #chkAutoSuffix":{change:b.chkAutoSuffixChange},"pnlDynamicDetail #tabSettings #chkTc":{change:b.chkTcChange},"pnlDynamicDetail #tabSettings #chkRedirect":{change:b.chkRedirectChange},"pnlDynamicDetail #tabSettings #chkUsage":{change:b.chkUsageChange},"pnlDynamicDetail #tabClickToConect #chkClickToConnect":{change:b.chkClickToConnectChange},"pnlDynamicDetail #tabLogo":{activate:b.tabLogoActivate},"pnlDynamicDetail #tabLogo #save":{click:b.logoSave},"pnlDynamicDetail #tabLogo #cancel":{click:b.logoCancel},"pnlDynamicDetail #tabPhoto":{activate:b.tabPhotoActivate},"pnlDynamicDetail #tabPhoto #reload":{click:b.photoReload},"pnlDynamicDetail #tabPhoto #add":{click:b.photoAdd},"pnlDynamicDetail #tabPhoto #delete":{click:b.photoDel},"pnlDynamicDetail #tabPhoto #edit":{click:b.photoEdit},"winPhotoAdd #save":{click:b.photoAddSave},"winPhotoAdd #cancel":{click:b.photoAddCancel},"winPhotoEdit #save":{click:b.photoEditSave},"winPhotoEdit #cancel":{click:b.photoEditCancel},"pnlDynamicDetail #tabPages":{activate:b.tabPagesActivate},"pnlDynamicDetail gridDynamicDetailPages #reload":{click:b.pageReload},"pnlDynamicDetail gridDynamicDetailPages #add":{click:b.pageAdd},"pnlDynamicDetail gridDynamicDetailPages #delete":{click:b.pageDel},"pnlDynamicDetail gridDynamicDetailPages #edit":{click:b.pageEdit},"winPageAdd #save":{click:b.pageAddSave},"winPageEdit #save":{click:b.pageEditSave},"pnlDynamicDetail #tabPairs":{activate:b.tabPairsActivate},"pnlDynamicDetail gridDynamicDetailPairs #reload":{click:b.pairReload},"pnlDynamicDetail gridDynamicDetailPairs #add":{click:b.pairAdd},"pnlDynamicDetail gridDynamicDetailPairs #delete":{click:b.pairDel},"pnlDynamicDetail gridDynamicDetailPairs #edit":{click:b.pairEdit},"winPairAdd #save":{click:b.pairAddSave},"winPairEdit #save":{click:b.pairEditSave},"pnlDynamicDetail #tabSettings":{activate:b.tabSettingsActivate},"pnlDynamicDetail #tabClickToConect":{activate:b.tabDetailActivate},"pnlDynamicDetail #tabSocialLogin":{activate:b.tabSocialLoginActivate},"pnlDynamicDetail pnlDynamicDetailSettings #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditSettings())}},"pnlDynamicDetail pnlDynamicDetailClickToConnect #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditClickToConnect())}},"pnlDynamicDetail pnlDynamicDetailSocialLogin #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditSocial())}}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sDynamicDetails").load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winDynamicDetailAddWizardId")){var h=Ext.widget("winDynamicDetailAddWizard",{id:"winDynamicDetailAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winDynamicDetailAddWizardId")){var h=Ext.widget("winDynamicDetailAddWizard",{id:"winDynamicDetailAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winDynamicDetailAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDynamicDetailDetailPrev:function(g){var e=this;var h=g.up("winDynamicDetailAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sDynamicDetails").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},chkUserLoginChange:function(j){var l=this;var m=j.up("form");var n=m.down("#chkAutoSuffix");var i=m.down("#txtSuffix");var k=j.getValue();if(k){n.setDisabled(false)}else{n.setDisabled(true);i.setDisabled(true)}},chkAutoSuffixChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtSuffix");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkTcChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtTcUrl");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkRedirectChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtRedirectUrl");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkUsageChange:function(i){var k=this;var l=i.up("form");var h=l.down("#nrUsageRefresh");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkClickToConnectChange:function(l){var q=this;var r=l.up("form");var k=r.down("#txtConnectUsername");var m=r.down("#txtConnectSuffix");var n=r.down("#nrConnectDelay");var o=r.down("#chkConnectOnly");var p=l.getValue();if(p){k.setDisabled(false);m.setDisabled(false);n.setDisabled(false);o.setDisabled(false)}else{k.setDisabled(true);m.setDisabled(true);n.setDisabled(true);o.setDisabled(true)}},del:function(e){var d=this;if(d.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var h=d.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(h,function(j){var g=j.getId();Ext.Array.push(b,{id:g})});Ext.Ajax.request({url:d.getUrlDelete(),method:"POST",jsonData:b,success:function(g,j){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);d.reload()},failure:function(g,j){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);d.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=o.getGrid().up("tabpanel");var t=o.getGrid().getSelectionModel().getLastSelected();var s=t.getId();var l=t.get("user_id");var r="dynamicDetailTab_"+s;var n=m.down("#"+r);if(n){m.setActiveTab(r);return}var p=o.selectedRecord.get("name");m.add({title:p,itemId:r,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDynamicDetail",dynamic_detail_id:s,user_id:l}});m.setActiveTab(r)}},editSubmit:function(g,h){var i=this;var j=g.up("form");j.submit({clientValidation:true,url:h,success:function(b,a){i.getStore("sDynamicDetails").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectDynamicDetails")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectDynamicDetails",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDynamicDetails"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDynamicDetails"+m.getId(),noteForId:m.getId(),noteForGrid:"dynamicDetails",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDynamicDetailsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicDetailsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDynamicDetailsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicDetailsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;j.load({url:i.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:h}})},tabSettingsActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;j.load({url:i.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:h},success:function(n,o,a){if(o.result.data.realm_id!=null){var p=j.down("#realm");var e=Ext.create("Rd.model.mRealm",{name:o.result.data.realm,id:o.result.data.realm_id});p.getStore().loadData([e],false);p.setValue(o.result.data.realm_id)}if(o.result.data.profile_id!=null){var d=j.down("#profile");var b=Ext.create("Rd.model.mProfile",{name:o.result.data.profile,id:o.result.data.profile_id});d.getStore().loadData([b],false);d.setValue(o.result.data.profile_id)}}})},tabLogoActivate:function(k){var j=this;var i=k.up("pnlNas");var l=k.up("pnlDynamicDetail").dynamic_detail_id;var h=k.down("#pnlImg");Ext.Ajax.request({url:j.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:l},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=j.getUrlLogoBase()+b.data.icon_file_name;h.update({image:a})}},scope:j})},logoSave:function(n){var l=this;var m=n.up("form");var k=m.up("pnlDynamicDetail");var i=m.up("panel");var j=i.down("#pnlImg");m.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:l.getUrlUploadLogo(),params:{id:k.dynamic_detail_id},success:function(d,b){if(b.result.success){var e=b.result.icon_file_name;var a=l.getUrlLogoBase()+e;j.update({image:a})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},logoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabPhotoActivate:function(e){var d=this;e.down("dataview").getStore().load()},photoReload:function(b){var e=this;b.up("#tabPhoto").down("dataview").getStore().load()},photoAdd:function(b){var i=this;var j=b.up("pnlDynamicDetail").dynamic_detail_id;var k=b.up("#tabPhoto").down("dataview");if(!Ext.WindowManager.get("winPhotoAddId")){var l=Ext.widget("winPhotoAdd",{id:"winPhotoAddId",dynamic_detail_id:j,data_view:k});l.show()}},photoAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:i.getUrlUploadPhoto(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},photoAddCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},photoDel:function(e){var h=this;var g=e.up("#tabPhoto").down("dataview");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},photoEdit:function(j){var i=this;var h=j.up("#tabPhoto").down("dataview");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPhotoEditId")){var g=Ext.widget("winPhotoEdit",{id:"winPhotoEditId",data_view:h});g.down("form").loadRecord(h.getSelectionModel().getLastSelected());g.show()}}}},photoEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Updating your photo...",url:i.getUrlEditPhoto(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},photoEditCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabPagesActivate:function(d){var e=this;d.getStore().load()},pageReload:function(b){var e=this;b.up("pnlDynamicDetail").down("#tabPages").getStore().load()},pageAdd:function(b){var i=this;var k=b.up("pnlDynamicDetail").dynamic_detail_id;var j=b.up("pnlDynamicDetail").down("#tabPages");if(!Ext.WindowManager.get("winPageAddId")){var l=Ext.widget("winPageAdd",{id:"winPageAddId",dynamic_detail_id:k,grid:j});l.show()}},pageAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlAddPage(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pageEdit:function(b){var h=this;var i=b.up("pnlDynamicDetail").down("#tabPages");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPageEditId")){var j=Ext.widget("winPageEdit",{id:"winPageEditId",grid:i});j.down("form").loadRecord(i.getSelectionModel().getLastSelected());j.show()}}}},pageEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlEditPage(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pageDel:function(b){var g=this;var h=b.up("pnlDynamicDetail").down("#tabPages");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},tabPairsActivate:function(d){var e=this;d.getStore().load()},pairReload:function(b){var e=this;b.up("pnlDynamicDetail").down("#tabPairs").getStore().load()},pairAdd:function(b){var i=this;var k=b.up("pnlDynamicDetail").dynamic_detail_id;var j=b.up("pnlDynamicDetail").down("#tabPairs");if(!Ext.WindowManager.get("winPairAddId")){var l=Ext.widget("winPairAdd",{id:"winPairAddId",dynamic_detail_id:k,grid:j});l.show()}},pairAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlAddPair(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pairEdit:function(b){var h=this;var i=b.up("pnlDynamicDetail").down("#tabPairs");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPairEditId")){var j=Ext.widget("winPairEdit",{id:"winPairEditId",grid:i});j.down("form").loadRecord(i.getSelectionModel().getLastSelected());j.show()}}}},pairEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlEditPair(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pairDel:function(b){var g=this;var h=b.up("pnlDynamicDetail").down("#tabPairs");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},previewMobile:function(b){var g=this;if(g.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g.getGrid().getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var h=g.getGrid().getSelectionModel().getLastSelected();window.open(g.getUrlPreviewMobile()+"?dynamic_id="+h.getId())}}},previewDesktop:function(b){var g=this;if(g.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g.getGrid().getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var h=g.getGrid().getSelectionModel().getLastSelected();window.open(g.getUrlPreviewDesktop()+"?dynamic_id="+h.getId())}}},tabSocialLoginActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;if(i.modelInited==undefined){Ext.define("SocialForm",{extend:"Ext.data.Model",fields:[{name:"id",type:"int"},{name:"social_temp_permanent_user_id",type:"int"},{name:"social_temp_permanent_user_name",type:"string"},{name:"social_enable",type:"boolean",defaultValue:false},{name:"fb_enable",type:"boolean",defaultValue:false},{name:"fb_record_info",type:"boolean",defaultValue:false},{name:"fb_id",type:"string"},{name:"fb_secret",type:"string"},{name:"fb_profile",type:"int"},{name:"fb_profile_name",type:"string"},{name:"fb_realm",type:"int"},{name:"fb_realm_name",type:"string"},{name:"fb_voucher_or_user",type:"string"},{name:"gp_enable",type:"boolean",defaultValue:false},{name:"gp_record_info",type:"boolean",defaultValue:false},{name:"gp_id",type:"string"},{name:"gp_secret",type:"string"},{name:"gp_profile",type:"int"},{name:"gp_profile_name",type:"string"},{name:"gp_realm",type:"int"},{name:"gp_realm_name",type:"string"},{name:"gp_voucher_or_user",type:"string"},{name:"tw_enable",type:"boolean",defaultValue:false},{name:"tw_record_info",type:"boolean",defaultValue:false},{name:"tw_id",type:"string"},{name:"tw_secret",type:"string"},{name:"tw_profile",type:"int"},{name:"tw_profile_name",type:"string"},{name:"tw_realm",type:"int"},{name:"tw_realm_name",type:"string"},{name:"tw_voucher_or_user",type:"string"}]});i.modelInited=true}Ext.Ajax.request({url:i.getUrlViewSocial(),method:"GET",params:{dynamic_detail_id:h},success:function(X){var R=Ext.JSON.decode(X.responseText);if(R.success){var d=Ext.create("SocialForm",R.data);j.loadRecord(d);var S=d.get("social_temp_permanent_user_id");var H=d.get("social_temp_permanent_user_name");var M=Ext.create("Rd.model.mPermanentUser",{username:H,id:S});j.down("#socialTempUser").getStore().loadData([M],false);j.down("#socialTempUser").setValue(S);var e=d.get("fb_profile");var F=d.get("fb_profile_name");var P=Ext.create("Rd.model.mProfile",{name:F,id:e});j.down("#fbProfile").getStore().loadData([P],false);j.down("#fbProfile").setValue(e);var V=d.get("fb_realm");var J=d.get("fb_realm_name");var I=Ext.create("Rd.model.mRealm",{name:J,id:V});j.down("#fbRealm").getStore().loadData([I],false);j.down("#fbRealm").setValue(V);var Y=d.get("gp_profile");var T=d.get("gp_profile_name");var b=Ext.create("Rd.model.mProfile",{name:T,id:Y});j.down("#gpProfile").getStore().loadData([b],false);j.down("#gpProfile").setValue(Y);var N=d.get("gp_realm");var L=d.get("gp_realm_name");var W=Ext.create("Rd.model.mRealm",{name:L,id:N});j.down("#gpRealm").getStore().loadData([I],false);j.down("#gpRealm").setValue(N);var G=d.get("tw_profile");var K=d.get("tw_profile_name");var O=Ext.create("Rd.model.mProfile",{name:K,id:G});j.down("#twProfile").getStore().loadData([O],false);j.down("#twProfile").setValue(G);var a=d.get("tw_realm");var Q=d.get("tw_realm_name");var U=Ext.create("Rd.model.mRealm",{name:Q,id:a});j.down("#twRealm").getStore().loadData([U],false);j.down("#twRealm").setValue(a)}},scope:i})}},0,0,0,0,0,0,[Rd.controller,"cDynamicDetails"],0));(Ext.cmd.derive("Rd.view.filters.gridFilters",Ext.grid.Panel,{multiSelect:true,store:"sFilters",stateful:true,stateId:"StateGridF",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/filters/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridF1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridF3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridF6"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "low"\'><div class="fieldGreen">Low</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "high"\'><div class="fieldOrange">High</div></tpl>','<tpl if=\'protection_level == "custom"\'><div class="fieldBlue">Custom</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridF7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridFilters"],["component","box","container","panel","tablepanel","gridpanel","grid","gridFilters"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridFilters:true},["widget.gridFilters"],0,[Rd.view.filters,"gridFilters"],0));(Ext.cmd.derive("Rd.model.mFilter",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFilter"],0));(Ext.cmd.derive("Rd.view.filters.vcFilterEdit",Ext.app.ViewController,{init:function(){},url:"/cake3/rd_cake/filters/filter-detail-for.json",load_done:false,onFilterLevelChange:function(k){var n=this;var m=k.getValue();var i=k.up("form");var j=i.down("#cgrpCategories");var l=m.filter_level;Ext.Array.each(j.getBoxes(),function(a){if(l=="low"){if(a.level=="low"){a.setValue(true)}else{a.setValue(false)}}if(l=="medium"){if((a.level=="low")||(a.level=="medium")){a.setValue(true)}else{a.setValue(false)}}if(l=="high"){if((a.level=="low")||(a.level=="medium")||(a.level=="high")){a.setValue(true)}else{a.setValue(false)}}})},onCustomChange:function(g){var i=this;var j=g.up("form");var h=j.down("#cgrpCategories");if(g.getValue()){Ext.Array.each(h.getBoxes(),function(a){a.setReadOnly(false)})}else{Ext.Array.each(h.getBoxes(),function(a){a.setReadOnly(true)})}},onAfterEditRender:function(j){var g=this;var h=j.down("form");var i=j.record.getId();Ext.Ajax.request({url:g.url,method:"GET",params:{filter_id:i},success:g.buildFilter,scope:g})},buildFilter:function(q){var n=this;var m=Ext.JSON.decode(q.responseText);var o=n.getView();var l=o.down("#rgrpFilterLevel");var p=o.down("#custom");if(m.success){Ext.each(m.categories,function(a){o.down("#cgrpCategories").add(a)});var s={filter_level:m.protection_level};l.setValue(s);if(m.custom){p.setValue(true);var t=o.down("#cgrpCategories");var r=m.custom_categories;t.setValue({"categories[]":r})}else{p.setValue(false)}}}},0,0,0,0,["controller.vcFilterEdit"],0,[Rd.view.filters,"vcFilterEdit"],0));(Ext.cmd.derive("Rd.view.filters.winFilterEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Filter",width:600,height:500,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},listeners:{afterrender:"onAfterEditRender"},controller:"vcFilterEdit",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",autoScroll:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Settings",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"Filter Level",columns:3,vertical:true,itemId:"rgrpFilterLevel",items:[{boxLabel:"Low",name:"filter_level",inputValue:"low"},{boxLabel:"Medium",name:"filter_level",inputValue:"medium"},{boxLabel:"High",name:"filter_level",inputValue:"high"}],listeners:{change:"onFilterLevelChange"}},{xtype:"checkbox",boxLabel:"Customise",name:"custom",inputValue:"custom",itemId:"custom",checked:true,cls:"lblRd",listeners:{change:"onCustomChange"},autoEl:{tag:"div","data-qtip":"To Customise Your Choice Click Here"}},{xtype:"checkboxgroup",fieldLabel:"Categories",columns:3,vertical:false,itemId:"cgrpCategories",items:[]}]},{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabBasic",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]}]}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winFilterEdit"],["component","box","container","panel","window","winFilterEdit"],{component:true,box:true,container:true,panel:true,window:true,winFilterEdit:true},["widget.winFilterEdit"],0,[Rd.view.filters,"winFilterEdit"],0));(Ext.cmd.derive("Rd.store.sFilters",Ext.data.Store,{model:"Rd.model.mFilter",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/filters/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sFilters"],0));(Ext.cmd.derive("Rd.view.filters.winFilterAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Filter",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winFilterAddWizard"],["component","box","container","panel","window","winFilterAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winFilterAddWizard:true},["widget.winFilterAddWizard"],0,[Rd.view.filters,"winFilterAddWizard"],0));(Ext.cmd.derive("Rd.controller.cFilters",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridFilters",border:true,itemId:"tabFilters",plain:true});d.populated=true},views:["filters.gridFilters","filters.winFilterEdit","filters.winFilterAddWizard"],stores:["sAccessProvidersTree","sFilters"],models:["mAccessProviderTree","mFilter"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/filters/add.json",urlDelete:"/cake3/rd_cake/filters/delete.json",urlEdit:"/cake3/rd_cake/filters/edit.json"},refs:[{ref:"grid",selector:"gridFilters"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabFilters":{destroy:b.appClose},"gridFilters #reload":{click:b.reload},"gridFilters #add":{click:b.add},"gridFilters #delete":{click:b.del},"gridFilters #edit":{click:b.edit},gridFilters:{select:b.select},"winFilterAddWizard #btnTreeNext":{click:b.btnTreeNext},"winFilterAddWizard #btnDataPrev":{click:b.btnDataPrev},"winFilterAddWizard #btnDataNext":{click:b.btnDataNext},"winFilterEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winFilterAddWizardId")){var h=Ext.widget("winFilterAddWizard",{id:"winFilterAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winFilterAddWizardId")){var h=Ext.widget("winFilterAddWizard",{id:"winFilterAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winFilterAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winFilterAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sFilters").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winFilterEditId")){var i=Ext.widget("winFilterEdit",{id:"winFilterEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winFilterEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cFilters"],0));(Ext.cmd.derive("Rd.view.globalDomains.gridGlobalDomains",Ext.grid.Panel,{multiSelect:true,store:"sGlobalDomains",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-domains/menu-for-grid.json",plugins:"gridfilters",urlCategoryFilter:"/cake3/rd_cake/categories/index-for-filter.json",initComponent:function(){var e=this;var d=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:e.urlCategoryFilter,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD6"},{text:"Categories",sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(categories)"><div"></div></tpl>','<tpl for="categories">','<div class="fieldGreen">{name}</div>',"</tpl>"),dataIndex:"categories",stateId:"StateGridGD7",filter:{type:"list",store:d}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridGlobalDomains"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalDomains"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalDomains:true},["widget.gridGlobalDomains"],0,[Rd.view.globalDomains,"gridGlobalDomains"],0));(Ext.cmd.derive("Rd.model.mGlobalDomain",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"tags"]},0,0,0,0,0,0,[Rd.model,"mGlobalDomain"],0));(Ext.cmd.derive("Rd.model.mGenericList",Ext.data.Model,{fields:["id","text"]},0,0,0,0,0,0,[Rd.model,"mGenericList"],0));(Ext.cmd.derive("Rd.view.globalDomains.winGlobalDomainEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Global Domain",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winGlobalDomainEdit"],["component","box","container","panel","window","winGlobalDomainEdit"],{component:true,box:true,container:true,panel:true,window:true,winGlobalDomainEdit:true},["widget.winGlobalDomainEdit"],0,[Rd.view.globalDomains,"winGlobalDomainEdit"],0));(Ext.cmd.derive("Rd.store.sGlobalDomains",Ext.data.Store,{model:"Rd.model.mGlobalDomain",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-domains/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/global-domains/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sGlobalDomains"],0));(Ext.cmd.derive("Rd.view.globalDomains.winGlobalDomainAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Global Domain",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winGlobalDomainAddWizard"],["component","box","container","panel","window","winGlobalDomainAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winGlobalDomainAddWizard:true},["widget.winGlobalDomainAddWizard"],0,[Rd.view.globalDomains,"winGlobalDomainAddWizard"],0));(Ext.cmd.derive("Rd.controller.cGlobalDomains",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridGlobalDomains",border:true,itemId:"tabGlobalDomains",plain:true});d.populated=true},views:["globalDomains.gridGlobalDomains","globalDomains.winGlobalDomainEdit","globalDomains.winGlobalDomainAddWizard"],stores:["sAccessProvidersTree","sGlobalDomains","sCategories"],models:["mAccessProviderTree","mGlobalDomain","mCategory","mGenericList"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/global-domains/export-csv",urlAdd:"/cake3/rd_cake/global-domains/add.json",urlDelete:"/cake3/rd_cake/global-domains/delete.json",urlEdit:"/cake3/rd_cake/global-domains/edit.json"},refs:[{ref:"grid",selector:"gridGlobalDomains"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabGlobalDomains":{destroy:b.appClose},"gridGlobalDomains #reload":{click:b.reload},"gridGlobalDomains #add":{click:b.add},"gridGlobalDomains #delete":{click:b.del},"gridGlobalDomains #edit":{click:b.edit},gridGlobalDomains:{select:b.select},"winGlobalDomainAddWizard #btnTreeNext":{click:b.btnTreeNext},"winGlobalDomainAddWizard #btnDataPrev":{click:b.btnDataPrev},"winGlobalDomainAddWizard #btnDataNext":{click:b.btnDataNext},"winGlobalDomainEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winGlobalDomainAddWizardId")){var h=Ext.widget("winGlobalDomainAddWizard",{id:"winGlobalDomainAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winGlobalDomainAddWizardId")){var h=Ext.widget("winGlobalDomainAddWizard",{id:"winGlobalDomainAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winGlobalDomainAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winGlobalDomainAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sGlobalDomains").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winGlobalDomainEditId")){var i=Ext.widget("winGlobalDomainEdit",{id:"winGlobalDomainEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winGlobalDomainEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cGlobalDomains"],0));(Ext.cmd.derive("Rd.view.globalTags.gridGlobalTags",Ext.grid.Panel,{multiSelect:true,store:"sGlobalTags",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD5"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">Basic</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">Full</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridGD6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridGlobalTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalTags:true},["widget.gridGlobalTags"],0,[Rd.view.globalTags,"gridGlobalTags"],0));(Ext.cmd.derive("Rd.model.mGlobalTag",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mGlobalTag"],0));(Ext.cmd.derive("Rd.view.globalTags.winGlobalTagEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Global Tag",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winGlobalTagEdit"],["component","box","container","panel","window","winGlobalTagEdit"],{component:true,box:true,container:true,panel:true,window:true,winGlobalTagEdit:true},["widget.winGlobalTagEdit"],0,[Rd.view.globalTags,"winGlobalTagEdit"],0));(Ext.cmd.derive("Rd.store.sGlobalTags",Ext.data.Store,{model:"Rd.model.mGlobalTag",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-tags/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sGlobalTags"],0));(Ext.cmd.derive("Rd.view.globalTags.winGlobalTagAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Global Tag",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winGlobalTagAddWizard"],["component","box","container","panel","window","winGlobalTagAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winGlobalTagAddWizard:true},["widget.winGlobalTagAddWizard"],0,[Rd.view.globalTags,"winGlobalTagAddWizard"],0));(Ext.cmd.derive("Rd.view.globalTags.cmbProtectionLevel",Ext.form.ComboBox,{fieldLabel:"Protection Level",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"protection_level",labelClsExtra:"lblRd",value:"medium",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProtectionLevel"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProtectionLevel"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProtectionLevel:true},["widget.cmbProtectionLevel"],0,[Rd.view.globalTags,"cmbProtectionLevel"],0));(Ext.cmd.derive("Rd.controller.cGlobalTags",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridGlobalTags",border:true,itemId:"tabGlobalTags",plain:true});d.populated=true},views:["globalTags.gridGlobalTags","globalTags.winGlobalTagEdit","globalTags.winGlobalTagAddWizard","globalTags.cmbProtectionLevel"],stores:["sAccessProvidersTree","sGlobalTags"],models:["mAccessProviderTree","mGlobalTag"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/global-tags/add.json",urlDelete:"/cake3/rd_cake/global-tags/delete.json",urlEdit:"/cake3/rd_cake/global-tags/edit.json"},refs:[{ref:"grid",selector:"gridGlobalTags"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabGlobalTags":{destroy:b.appClose},"gridGlobalTags #reload":{click:b.reload},"gridGlobalTags #add":{click:b.add},"gridGlobalTags #delete":{click:b.del},"gridGlobalTags #edit":{click:b.edit},gridGlobalTags:{select:b.select},"winGlobalTagAddWizard #btnTreeNext":{click:b.btnTreeNext},"winGlobalTagAddWizard #btnDataPrev":{click:b.btnDataPrev},"winGlobalTagAddWizard #btnDataNext":{click:b.btnDataNext},"winGlobalTagEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winGlobalTagAddWizardId")){var h=Ext.widget("winGlobalTagAddWizard",{id:"winGlobalTagAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winGlobalTagAddWizardId")){var h=Ext.widget("winGlobalTagAddWizard",{id:"winGlobalTagAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winGlobalTagAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winGlobalTagAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sGlobalTags").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winGlobalTagEditId")){var i=Ext.widget("winGlobalTagEdit",{id:"winGlobalTagEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winGlobalTagEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cGlobalTags"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpAdd",Ext.window.Window,{title:i18n("sAdd_Msgid"),layout:"fit",autoShow:true,width:300,iconCls:"add",glyph:Rd.config.icnAdd,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sMsgid"),name:"msgid",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please")},{xtype:"textfield",fieldLabel:i18n("sMsgstr"),name:"msgstr",allowBlank:true},{xtype:"textfield",name:"comment",fieldLabel:i18n("sOptional_Comment")}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpAdd"],["component","box","container","panel","window","winPhpAdd"],{component:true,box:true,container:true,panel:true,window:true,winPhpAdd:true},["widget.winPhpAdd"],0,[Rd.view.i18n,"winPhpAdd"],0));(Ext.cmd.derive("Rd.view.components.pnlBanner",Ext.panel.Panel,{margins:"0 0 0 0",height:52,layout:"fit",border:false,heading:"",image:"",initComponent:function(){var b=this;b.html="<div class='banner'><img style='float:left; margin-left:4px;' src='"+b.image+"'><h1>"+b.heading+"</h1></div>";Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlBanner"],["component","box","container","panel","pnlBanner"],{component:true,box:true,container:true,panel:true,pnlBanner:true},["widget.pnlBanner"],0,[Rd.view.components,"pnlBanner"],0));(Ext.cmd.derive("Rd.view.i18n.vPanI18n",Ext.tab.Panel,{defaults:{layout:"fit"},items:[{title:i18n("sJavascript_Phrases"),itemId:"JsPhrases",xtype:"gridJavascriptPhrases"},{title:i18n("sPHP_Phrases"),itemId:"PhpPhrases",xtype:"gridPhpPhrases"}],initComponent:function(){Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["i18nP"],["component","box","container","panel","tabpanel","i18nP"],{component:true,box:true,container:true,panel:true,tabpanel:true,i18nP:true},["widget.i18nP"],0,[Rd.view.i18n,"vPanI18n"],0));(Ext.cmd.derive("Rd.view.i18n.gridJavascriptPhrases",Ext.grid.Panel,{store:"sI18nJsPhrases",stateful:true,stateId:"StateGridJavascriptPhrases",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},border:false,columns:[{xtype:"rownumberer"},{text:i18n("sKey"),dataIndex:"key",tdCls:"grdBold"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"grdGrey"},{text:i18n("sEnglish_use_as_reference"),dataIndex:"english",tdCls:"grdItalic"},{text:i18n("sTranslated"),dataIndex:"translated",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:false},renderer:function(b){if((b=="(modify me)")||(b=="(new addition)")){return"<span class='new'>"+b+"</span"}else{return b}}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],tbar:[{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbLanguages",width:350}]},{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"splitbutton",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuNewKey"},{text:i18n("sLanguage_of_country"),iconCls:"language16",glyph:Rd.config.icnFlag,itemId:"mnuLanguageNew"}]}},{xtype:"splitbutton",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuDelKey"},{text:i18n("sCountry"),iconCls:"country16",glyph:Rd.config.icnCountry,itemId:"mnuDelCountry"},{text:i18n("sLanguage"),iconCls:"language16",glyph:Rd.config.icnLanguage,itemId:"mnuLanguageDel"}]}},{xtype:"splitbutton",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuEditKey"},{text:i18n("sCountry"),iconCls:"country16",glyph:Rd.config.icnCountry,itemId:"mnuCountryEdit"},{text:i18n("sLanguage"),iconCls:"language16",glyph:Rd.config.icnLanguage,itemId:"mnuLanguageEdit"},{text:i18n("sCopy_phrases_from_language"),iconCls:"copy16",glyph:Rd.config.icnCopy,itemId:"mnuLanguageCopy"}]}}]}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]},0,["gridJavascriptPhrases"],["component","box","container","panel","tablepanel","gridpanel","grid","gridJavascriptPhrases"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridJavascriptPhrases:true},["widget.gridJavascriptPhrases"],0,[Rd.view.i18n,"gridJavascriptPhrases"],0));(Ext.cmd.derive("Rd.view.i18n.gridPhpPhrases",Ext.grid.Panel,{store:"sI18nPhpPhrases",stateful:true,stateId:"StateGridPhpPhrases",stateEvents:["groupclick","columnhide"],border:false,multiSelect:true,viewConfig:{preserveScrollOnRefresh:true},columns:[{xtype:"rownumberer"},{text:"Comments",dataIndex:"comment",tdCls:"grdGrey"},{text:"Msgid",dataIndex:"msgid",tdCls:"grdBold"},{text:"Msgstr",dataIndex:"msgstr",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:true}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],tbar:[{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbLanguages",width:350}]},{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")}]},{xtype:"buttongroup",title:i18n("sPHP_Phrases"),items:[{xtype:"button",iconCls:"b-copy",glyph:Rd.config.icnCopy,scale:"large",itemId:"copy",tooltip:i18n("sCopy")},{xtype:"button",iconCls:"b-meta_edit",glyph:Rd.config.icnMeta,scale:"large",itemId:"meta",tooltip:i18n("sEdit_meta_info")},{xtype:"button",iconCls:"b-comment",glyph:Rd.config.icnNote,scale:"large",itemId:"comment",tooltip:i18n("sAdd_comment")}]}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]},0,["gridPhpPhrases"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPhpPhrases"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPhpPhrases:true},["widget.gridPhpPhrases"],0,[Rd.view.i18n,"gridPhpPhrases"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpMeta",Ext.window.Window,{title:i18n("sSpecify_Meta_data"),layout:"fit",autoShow:true,width:400,height:450,resizable:false,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,autoScroll:true,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:"Project-Id-Version",name:"Project-Id-Version",allowBlank:false,blankText:i18n("sEnter")+" Enter Project-Id-Version"},{xtype:"textfield",fieldLabel:"POT-Creation-Date",name:"POT-Creation-Date",allowBlank:false,blankText:i18n("sEnter")+" POT-Creation-Date"},{xtype:"textfield",fieldLabel:"PO-Revision-Date",name:"PO-Revision-Date",allowBlank:false,blankText:i18n("sEnter")+" PO-Revision-Date"},{xtype:"textfield",fieldLabel:"Last-Translator",name:"Last-Translator",allowBlank:false,blankText:i18n("sEnter")+" Last-Translator"},{xtype:"textfield",fieldLabel:"Language-Team",name:"Language-Team",allowBlank:false,blankText:i18n("sEnter")+" Language-Team"},{xtype:"textfield",fieldLabel:"MIME-Version",name:"MIME-Version",allowBlank:false,blankText:i18n("sEnter")+"  MIME-Version"},{xtype:"textfield",fieldLabel:"Content-Type",name:"Content-Type",allowBlank:false,blankText:i18n("sEnter")+" Content-Type"},{xtype:"textfield",fieldLabel:"Content-Transfer-Encoding",name:"Content-Transfer-Encoding",allowBlank:false,blankText:i18n("sEnter")+" Content-Transfer-Encoding"},{xtype:"textfield",fieldLabel:"Plural-Forms",name:"Plural-Forms",allowBlank:false,blankText:i18n("sEnter")+" Plural-Forms"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpMeta"],["component","box","container","panel","window","winPhpMeta"],{component:true,box:true,container:true,panel:true,window:true,winPhpMeta:true},["widget.winPhpMeta"],0,[Rd.view.i18n,"winPhpMeta"],0));(Ext.cmd.derive("Rd.model.mI18nMeta",Ext.data.Model,{fields:["Project-Id-Version","POT-Creation-Date","PO-Revision-Date","Last-Translator","Language-Team","MIME-Version","Content-Type","Content-Transfer-Encoding","Plural-Forms"],idProperty:"Project-Id-Version",proxy:{type:"ajax",url:"/cake2/rd_cake/php_phrases/get_metadata.json",format:"json",batchActions:false,reader:{type:"json",rootProperty:"items",messageProperty:"message"}}},0,0,0,0,0,0,[Rd.model,"mI18nMeta"],0));(Ext.cmd.derive("Rd.view.components.vCmbCountries",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_country"),labelSeparator:"",store:"sCountries",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbCountry",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name} ({iso_code})"><div class="combo-wrapper"><img src="{icon_file}" /><div class="combo-country">{name}</div><div class="combo-language"> {iso_code}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["vCmbCountries"],["component","box","field","textfield","pickerfield","combobox","combo","vCmbCountries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,vCmbCountries:true},["widget.vCmbCountries"],0,[Rd.view.components,"vCmbCountries"],0));(Ext.cmd.derive("Rd.view.i18n.vWinCountryEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Countries"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var e=h.mkScrnCountryEdit();var g=h.mkScrnCountryEditDo();this.items=[e,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnCountryEdit:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_country_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"vCmbCountries"}],buttons:[{itemId:"btnCountryEditNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",glyph:Rd.config.icnNext,iconCls:"b-next"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnCountryEdit",items:[g,h]});return e},mkScrnCountryEditDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sCountry_name"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sCountry_name"),blankText:i18n("sSpecify_a_valid_name_please")},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_ZA_or_DE"),blankText:i18n("sSpecify_a_valid_iso_country_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:uppercase"},{xtype:"filefield",name:"icon",fieldLabel:i18n("sFlag_icon"),allowBlank:false,buttonText:i18n("sSelect_Icon")+"..."}],buttons:[{itemId:"btnCountryEditDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnCountryEditDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnCountryEditDo",items:[g,h]});return e}},0,["vWinCountryEdit"],["component","box","container","panel","window","vWinCountryEdit"],{component:true,box:true,container:true,panel:true,window:true,vWinCountryEdit:true},["widget.vWinCountryEdit"],0,[Rd.view.i18n,"vWinCountryEdit"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Language"),width:380,height:420,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var j=this;var h=j.mkScrnIntro();var g=j.mkScrnNewCountry();var i=j.mkScrnNewLanguage();this.items=[h,g,i];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnIntro:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_an_existing_country_to_add_a_language_to_fs")+" "+i18n("sAlternatively_choose_to_create_a_new_country_fs"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"vCmbCountries"},{xtype:"fieldcontainer",defaultType:"checkboxfield",defaults:{flex:1},layout:"vbox",items:[{boxLabel:i18n("sCreate_new_country"),name:"chkNewCountry",inputValue:"1",itemId:"chkNewCountry",checked:true}]}],buttons:[{itemId:"btnIntroNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnIntro",items:[g,h]});return e},mkScrnNewCountry:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,overflowY:"auto",bodyPadding:10,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sCountry_name"),itemId:"inpNewCountry",allowBlank:false,emptyText:"country name",blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_ZA_or_DE"),blankText:i18n("sSpecify_a_valid_iso_country_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:uppercase",textValid:true,validator:function(){return this.textValid}},{xtype:"filefield",name:"icon",fieldLabel:i18n("sFlag_icon"),allowBlank:false,buttonText:i18n("sSelect_Icon")+"..."}],buttons:[{itemId:"btnNewCountryPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnNewCountryNext",text:i18n("sNext"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{itemId:"scrnNewCountry",layout:"vbox",border:false,items:[g,h]});return e},mkScrnNewLanguage:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,overflowY:"auto",bodyPadding:10,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sLanguage"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sLanguage"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_pt_or_de"),blankText:i18n("sSpecify_a_valid_iso_language_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:lowercase",textValid:true,validator:function(){return this.textValid}},{xtype:"checkbox",boxLabel:i18n("sRight_to_left"),name:"rtl",inputValue:"rtl",checked:false}],buttons:[{itemId:"btnNewLanguagePrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack},{itemId:"btnNewLanguageNext",text:i18n("sNext"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{itemId:"scrnNewLanguage",layout:"vbox",border:false,items:[g,h]});return e}},0,["addLanguageW"],["component","box","container","panel","window","addLanguageW"],{component:true,box:true,container:true,panel:true,window:true,addLanguageW:true},["widget.addLanguageW"],0,[Rd.view.i18n,"vWinLanguageAdd"],0));(Ext.cmd.derive("Rd.model.mI18nJsPhrase",Ext.data.Model,{fields:["id","key","comment","english","translated","key_id"]},0,0,0,0,0,0,[Rd.model,"mI18nJsPhrase"],0));(Ext.cmd.derive("Rd.store.sI18nJsPhrases",Ext.data.Store,{model:"Rd.model.mI18nJsPhrase",proxy:{type:"rest",url:"/cake2/rd_cake/phrase_values/list_phrases_for",format:"json",api:{update:"/cake2/rd_cake/phrase_values/update_phrase",destroy:"/cake2/rd_cake/phrase_values/delete_keys"},reader:{type:"json",rootProperty:"items"}},listeners:{update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nJsPhrases"],0));(Ext.cmd.derive("Rd.model.mI18nCountry",Ext.data.Model,{fields:["id","name","iso_code","icon_file"]},0,0,0,0,0,0,[Rd.model,"mI18nCountry"],0));(Ext.cmd.derive("Rd.store.sCountries",Ext.data.Store,{model:"Rd.model.mI18nCountry",proxy:{type:"rest",url:"/cake2/rd_cake/countries",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sCountries"],0));(Ext.cmd.derive("Rd.model.mI18nLanguage",Ext.data.Model,{fields:["id","name","iso_code","rtl"]},0,0,0,0,0,0,[Rd.model,"mI18nLanguage"],0));(Ext.cmd.derive("Rd.store.sJustLanguages",Ext.data.Store,{model:"Rd.model.mI18nLanguage",proxy:{type:"rest",url:"/cake2/rd_cake/languages",format:"json",reader:{type:"json",rootProperty:"items"}},listeners:{update:function(g,h,i,j){g.sync({success:function(a,b){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sJustLanguages"],0));(Ext.cmd.derive("Rd.model.mI18nKey",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"comment",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mI18nKey"],0));(Ext.cmd.derive("Rd.store.sI18nPhraseKeys",Ext.data.Store,{model:"Rd.model.mI18nKey",proxy:{type:"rest",url:"/cake2/rd_cake/phrase_keys",format:"json",reader:{type:"json",rootProperty:"items"}},listeners:{update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("Database could not be updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nPhraseKeys"],0));(Ext.cmd.derive("Rd.model.mI18nPhpPhrase",Ext.data.Model,{fields:["id","comment","msgid","msgstr"]},0,0,0,0,0,0,[Rd.model,"mI18nPhpPhrase"],0));(Ext.cmd.derive("Rd.store.sI18nPhpPhrases",Ext.data.Store,{model:"Rd.model.mI18nPhpPhrase",proxy:{type:"rest",url:"/cake2/rd_cake/php_phrases",format:"json",api:{},reader:{type:"json",rootProperty:"items"}},listeners:{load:function(e,g,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nPhpPhrases"],0));(Ext.cmd.derive("Rd.view.components.winHelp",Ext.window.Window,{title:i18n("sOnline_help"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"help",glyph:Rd.config.icnHelp,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true,stateful:true,stateId:"winHelpWin",srcUrl:"https://sourceforge.net/p/radiusdesk/wiki/",initComponent:function(){var b=this;b.items=[{xtype:"component",itemId:"ifrm",autoEl:{tag:"iframe",src:b.srcUrl}}];Ext.window.Window.prototype.initComponent.apply(this,arguments)},setSrc:function(d){console.log("change");me=this;var e=me.down("#ifrm");console.log(e);e.getEl().dom.src=d}},0,["winHelp"],["component","box","container","panel","window","winHelp"],{component:true,box:true,container:true,panel:true,window:true,winHelp:true},["widget.winHelp"],0,[Rd.view.components,"winHelp"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpCopy",Ext.window.Window,{title:i18n("sCopy_from_another_language"),layout:"fit",autoShow:true,width:300,iconCls:"copy",glyph:Rd.config.icnCopy,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sSource"),itemId:"source",name:"source",allowBlank:false},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sDestination"),itemId:"destination",name:"destination",allowBlank:false},{xtype:"checkbox",boxLabel:i18n("sMaintain_existing_translations"),name:"maintain_existing",inputValue:"remove",checked:true}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpCopy"],["component","box","container","panel","window","winPhpCopy"],{component:true,box:true,container:true,panel:true,window:true,winPhpCopy:true},["widget.winPhpCopy"],0,[Rd.view.i18n,"winPhpCopy"],0));(Ext.cmd.derive("Rd.view.i18n.vWinI18n",Ext.window.Window,{width:600,height:400,layout:"fit",title:i18n("si18n_Manager"),stateful:true,stateId:"stateWin",icon:"resources/images/16x16/i18n.png",items:[{xtype:"i18nP"}],initComponent:function(){Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["i18nW"],["component","box","container","panel","window","i18nW"],{component:true,box:true,container:true,panel:true,window:true,i18nW:true},["widget.i18nW"],0,[Rd.view.i18n,"vWinI18n"],0));(Ext.cmd.derive("Rd.view.components.vCmbJustLanguages",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sJustLanguages",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbJustLanguage",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name}"><div class="combo-wrapper"><div class="combo-country"> {name}</div><div class="combo-language"> {iso_code}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbJustLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbJustLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbJustLanguages:true},["widget.cmbJustLanguages"],0,[Rd.view.components,"vCmbJustLanguages"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageDel",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sDelete_language"),width:380,height:300,plain:true,border:false,layout:"vbox",bodyCls:"bodyCls",iconCls:"delete",glyph:Rd.config.icnDelete,items:[{xtype:"panel",border:false,baseCls:"regMsg",html:i18n("sSelect_the_language_to_delete_fs")+" "+i18n("sMake_sure_you_know_what_you_are_doing_fs"),width:"100%"},{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},items:[{xtype:"cmbJustLanguages",name:"id"}],buttons:[{itemId:"btnLanguageDelNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0",formBind:true}]}],defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["delLanguageW"],["component","box","container","panel","window","delLanguageW"],{component:true,box:true,container:true,panel:true,window:true,delLanguageW:true},["widget.delLanguageW"],0,[Rd.view.i18n,"vWinLanguageDel"],0));(Ext.cmd.derive("Rd.view.i18n.vCmbPhraseKeys",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_key"),labelSeparator:"",store:"sI18nPhraseKeys",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbPhraseKey",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name}"><div class="combo-wrapper"><div class="combo-country">{name}</div><div class="combo-language"> {comment}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPhraseKeys"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPhraseKeys"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPhraseKeys:true},["widget.cmbPhraseKeys"],0,[Rd.view.i18n,"vCmbPhraseKeys"],0));(Ext.cmd.derive("Rd.view.i18n.vWinKeyEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Key"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var e=this;var h=e.mkScrnEditKey();var g=e.mkScrnEditKeyDo();this.items=[h,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnEditKey:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_key_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbPhraseKeys"}],buttons:[{itemId:"btnEditKeyNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditKey",items:[g,h]});return e},mkScrnEditKeyDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",id:"name",fieldLabel:i18n("sKey_name"),itemId:"inpNewKey",allowBlank:false,emptyText:i18n("sKey_name"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{xtype:"textareafield",grow:true,name:"comment",id:"comment",fieldLabel:i18n("sComment"),anchor:"100%"}],buttons:[{itemId:"btnEditKeyDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnEditKeyDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditKeyDo",items:[g,h]});return e}},0,["editKeyW"],["component","box","container","panel","window","editKeyW"],{component:true,box:true,container:true,panel:true,window:true,editKeyW:true},["widget.editKeyW"],0,[Rd.view.i18n,"vWinKeyEdit"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpComment",Ext.window.Window,{title:i18n("sAdd_comment_to_msgid"),layout:"fit",autoShow:true,width:300,iconCls:"edit",glyph:Rd.config.icnEdit,msgid:"",initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"msgid",value:b.msgid,hidden:true},{xtype:"checkbox",boxLabel:i18n("sRemove_existing_comments"),name:"remove_existing",inputValue:"remove",checked:true},{xtype:"textfield",name:"comment",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please"),fieldLabel:i18n("sComment")}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpComment"],["component","box","container","panel","window","winPhpComment"],{component:true,box:true,container:true,panel:true,window:true,winPhpComment:true},["widget.winPhpComment"],0,[Rd.view.i18n,"winPhpComment"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageCopy",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sCopy_phrases_from_language"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"copy",glyph:Rd.config.icnCopy,defaults:{border:false},initComponent:function(){var e=this;var d=e.mkScrnLanguageCopy();this.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnLanguageCopy:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sChoose_an_existing_language_to_copy_the_phrases_from"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbLanguages",fieldLabel:i18n("sAvailable_languages"),allowBlank:false}],buttons:[{itemId:"btnLanguageCopyNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageCopy",items:[g,h]});return e}},0,["vWinLanguageCopy"],["component","box","container","panel","window","vWinLanguageCopy"],{component:true,box:true,container:true,panel:true,window:true,vWinLanguageCopy:true},["widget.vWinLanguageCopy"],0,[Rd.view.i18n,"vWinLanguageCopy"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Languages"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var g=h.mkScrnLanguageEdit();var e=h.mkScrnLanguageEditDo();this.items=[g,e];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnLanguageEdit:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_language_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbJustLanguages"}],buttons:[{itemId:"btnLanguageEditNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageEdit",items:[g,h]});return e},mkScrnLanguageEditDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sLanguage"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sLanguage"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_pt_or_de"),blankText:i18n("sSpecify_a_valid_iso_language_code"),textValid:true,maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:lowercase",validator:function(){return this.textValid}},{xtype:"checkbox",boxLabel:i18n("sRight_to_left"),name:"rtl",inputValue:"rtl",checked:false}],buttons:[{itemId:"btnLanguageEditDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnLanguageEditDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageEditDo",items:[g,h]});return e}},0,["vWinLanguageEdit"],["component","box","container","panel","window","vWinLanguageEdit"],{component:true,box:true,container:true,panel:true,window:true,vWinLanguageEdit:true},["widget.vWinLanguageEdit"],0,[Rd.view.i18n,"vWinLanguageEdit"],0));(Ext.cmd.derive("Rd.view.i18n.vWinKeyAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Key"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var d=this;var e=d.mkScrnNewKey();this.items=[e];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnNewKey:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sKey_name"),itemId:"inpNewKey",allowBlank:false,emptyText:i18n("sKey_name"),blankText:i18n("sSpecify_a_valid_name_for_the_key"),textValid:true,validator:function(){return this.textValid}},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sComment"),anchor:"100%"}],buttons:[{itemId:"btnNewKeyNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnNewKey",items:[g,h]});return e}},0,["addKeyW"],["component","box","container","panel","window","addKeyW"],{component:true,box:true,container:true,panel:true,window:true,addKeyW:true},["widget.addKeyW"],0,[Rd.view.i18n,"vWinKeyAdd"],0));(Ext.cmd.derive("Rd.view.i18n.vWinCountryDel",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sDelete_country"),width:380,height:300,plain:true,border:false,layout:"vbox",bodyCls:"bodyCls",iconCls:"delete",glyph:Rd.config.icnDelete,items:[{xtype:"panel",border:false,baseCls:"regMsg",html:i18n("sSelect_the_country_to_delete_fs_Make_sure_you_know_what_you_are_doing"),width:"100%"},{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},items:[{xtype:"vCmbCountries",name:"id"}],buttons:[{itemId:"btnCountryDelNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0",formBind:true}]}],defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["delCountryW"],["component","box","container","panel","window","delCountryW"],{component:true,box:true,container:true,panel:true,window:true,delCountryW:true},["widget.delCountryW"],0,[Rd.view.i18n,"vWinCountryDel"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpEdit",Ext.window.Window,{title:i18n("sEdit_Msgid"),layout:"fit",autoShow:true,width:300,iconCls:"edit",glyph:Rd.config.icnEdit,old_msgid:"",initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"old_msgid",value:b.old_msgid,hidden:true},{xtype:"displayfield",fieldLabel:i18n("sPrevious_value"),value:b.old_msgid},{xtype:"textfield",fieldLabel:i18n("sMsgid"),name:"msgid",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please")}],buttons:[{itemId:"save",text:i18n("OK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpEdit"],["component","box","container","panel","window","winPhpEdit"],{component:true,box:true,container:true,panel:true,window:true,winPhpEdit:true},["widget.winPhpEdit"],0,[Rd.view.i18n,"winPhpEdit"],0));(Ext.cmd.derive("Rd.controller.cI18n",Ext.app.Controller,{actionIndex:function(){var g=this;var h=this.application.getController("cDesktop");var e=h.getWindow("i18nWin");if(!e){e=h.createWindow({id:"i18nWin",btnText:i18n("si18n_Manager"),width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"translate",glyph:Rd.config.icnTranslate,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"i18nWin",tools:[{type:"help",tooltip:i18n("sGet_Help")}],items:[{region:"north",xtype:"pnlBanner",heading:i18n("sTranslation_management"),image:"resources/images/48x48/i18n.png"},{xtype:"i18nP",region:"center"}]})}h.restoreWindow(e);return e},views:["components.pnlBanner","i18n.vPanI18n","i18n.vWinLanguageAdd","i18n.vWinKeyAdd","i18n.vWinCountryDel","i18n.vWinLanguageDel","i18n.vWinKeyEdit","i18n.vWinLanguageEdit","i18n.vWinCountryEdit","i18n.vWinLanguageCopy","i18n.gridPhpPhrases","i18n.gridJavascriptPhrases","i18n.winPhpAdd","i18n.winPhpEdit","i18n.winPhpComment","i18n.winPhpCopy","i18n.winPhpMeta","components.winHelp"],stores:["sI18nJsPhrases","sLanguages","sCountries","sJustLanguages","sI18nPhraseKeys","sI18nPhpPhrases"],models:["mI18nMeta"],config:{urlCountryAdd:"/cake2/rd_cake/countries/add",urlLanguageAdd:"/cake2/rd_cake/phrase_values/add_language.json",urlKeyAdd:"/cake2/rd_cake/phrase_values/add_key.json",urlCountryDel:"/cake2/rd_cake/countries/delete.json",urlLanguageDel:"/cake2/rd_cake/languages/delete.json",urlLanguageCopy:"/cake2/rd_cake/phrase_values/copy_phrases.json",urlPhpDel:"/cake2/rd_cake/php_phrases/delete.json",urlPhpAdd:"/cake2/rd_cake/php_phrases/add.json",urlPhpEditMsgid:"/cake2/rd_cake/php_phrases/update_msgid.json",urlPhpComment:"/cake2/rd_cake/php_phrases/comment.json",urlPhpCopy:"/cake2/rd_cake/php_phrases/copy.json",urlPhpMeta:"/cake2/rd_cake/php_phrases/save_meta.json",urlHelp:"http://sourceforge.net/p/radiusdesk/wiki/i18n/"},refs:[{ref:"vp",selector:"",xtype:"vp",autoCreate:true},{ref:"i18nW",selector:"",xtype:"i18nW",autoCreate:true},{ref:"i18nP",selector:"",xtype:"i18nP",autoCreate:true},{ref:"jsGrid",selector:"#JsPhrases",xtype:"grid",autoCreate:true},{ref:"phpGrid",selector:"#PhpPhrases",xtype:""}],selCountry:null,selLanguage:null,selPhpLanguage:null,init:function(){var b=this;if(b.inited){return}b.inited=true;b.getStore("sI18nPhpPhrases").addListener("load",b.onStorePhpPhrasesSizeChange,b);b.getStore("sI18nJsPhrases").addListener("load",b.onStoreJsPhrasesSizeChange,b);b.control({"#JsPhrases  #reload":{click:b.jsGridReload},"#JsPhrases cmbLanguages":{change:b.onCmbLanguagesChange},"#JsPhrases  #mnuLanguageNew":{click:b.newLanguageWin},"#JsPhrases  #mnuNewKey":{click:b.newKeyWin},"addLanguageW #btnIntroNext":{click:b.btnIntroNext},"addLanguageW #btnNewCountryPrev":{click:b.btnNewCountryPrev},"addLanguageW #btnNewCountryNext":{click:b.btnNewCountryNext},"addLanguageW #btnNewLanguagePrev":{click:b.btnNewLanguagePrev},"addLanguageW #btnNewLanguageNext":{click:b.btnNewLanguageNext},"addLanguageW vCmbCountries":{change:b.onCmbCountriesChange},"addKeyW #btnNewKeyNext":{click:b.btnNewKeyNext},"#JsPhrases  #mnuLanguageDel":{click:b.languageDel},"#JsPhrases  #mnuDelCountry":{click:b.delCountry},"#JsPhrases  #mnuDelKey":{click:b.delKey},"delCountryW #btnCountryDelNext":{click:b.btnCountryDelNext},"delLanguageW #btnLanguageDelNext":{click:b.btnLanguageDelNext},"#JsPhrases  #mnuLanguageEdit":{click:b.editLanguage},"#JsPhrases  #mnuCountryEdit":{click:b.countryEdit},"#JsPhrases  #mnuEditKey":{click:b.editKey},"editKeyW #btnEditKeyNext":{click:b.btnEditKeyNext},"editKeyW #btnEditKeyDoPrev":{click:b.btnEditKeyDoPrev},"editKeyW #btnEditKeyDoNext":{click:b.btnEditKeyDoNext},"vWinLanguageEdit #btnLanguageEditNext":{click:b.btnLanguageEditNext},"vWinLanguageEdit #btnLanguageEditDoPrev":{click:b.btnLanguageEditDoPrev},"vWinLanguageEdit #btnLanguageEditDoNext":{click:b.btnLanguageEditDoNext},"vWinCountryEdit #btnCountryEditNext":{click:b.btnCountryEditNext},"vWinCountryEdit #btnCountryEditDoPrev":{click:b.btnCountryEditDoPrev},"vWinCountryEdit #btnCountryEditDoNext":{click:b.btnCountryEditDoNext},"#JsPhrases  #mnuLanguageCopy":{click:b.languageCopy},"vWinLanguageCopy #btnLanguageCopyNext":{click:b.btnLanguageCopyNext},"#PhpPhrases  #reload":{click:b.phpGridReload},"#PhpPhrases cmbLanguages":{change:b.onPhpCmbLanguagesChange},"#PhpPhrases #delete":{click:b.phpDelete},"#PhpPhrases #add":{click:b.phpAdd},"winPhpAdd #save":{click:b.phpAddSubmit},"#PhpPhrases #edit":{click:b.phpEdit},"#PhpPhrases":{itemclick:b.phpGridClick},"winPhpEdit #save":{click:b.phpEditSubmit},"#PhpPhrases #comment":{click:b.phpComment},"winPhpComment #save":{click:b.phpCommentSubmit},"#PhpPhrases #copy":{click:b.phpCopy},"winPhpCopy #save":{click:b.phpCopySubmit},"#PhpPhrases #meta":{click:b.phpMeta},"winPhpMeta #save":{click:b.phpMetaSubmit},"#i18nWin tool[type=help]":{click:b.help}})},help:function(){var g=this;var j=g.application.runAction("cDesktop","AlreadyExist","winHelpId");var i=i18n("sOnline_help_for_Translation_Manager");if(!j){var h=Ext.widget("winHelp",{id:"winHelpId",title:i,srcUrl:g.getUrlHelp()});g.application.runAction("cDesktop","Add",h)}else{j.setSrc(g.getUrlHelp());j.setTitle(i)}},jsGridReload:function(){var b=this;this.getJsGrid().getStore().getProxy().setExtraParam("language",b.selLanguage);this.getJsGrid().getStore().load()},newLanguageWin:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","addLanguageWId")){var e=Ext.widget("addLanguageW",{id:"addLanguageWId"});d.application.runAction("cDesktop","Add",e)}},newKeyWin:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","addKeyWId")){var e=Ext.widget("addKeyW",{id:"addKeyWId"});d.application.runAction("cDesktop","Add",e)}},btnIntroNext:function(b){var h=this;var i=b.up("form");var j=b.up("addLanguageW");if(i.down("#chkNewCountry").getValue()){j.getLayout().setActiveItem("scrnNewCountry")}else{h.selCountry=i.down("vCmbCountries").getValue();if(h.selCountry==null){Ext.ux.Toaster.msg(i18n("sSelect_a_country"),i18n("sYou_are_required_to_select_a_country"),Ext.ux.Constants.clsError,Ext.ux.Constants.msgError)}else{j.getLayout().setActiveItem("scrnNewLanguage")}}},btnNewCountryPrev:function(b){var g=this;var h=b.up("addLanguageW");h.getLayout().setActiveItem("scrnIntro")},btnNewCountryNext:function(b){var h=this;var j=b.up("addLanguageW");var i=b.up("form");i.submit({url:h.getUrlCountryAdd(),waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){h.selCountry=d.result.id;Ext.ux.Toaster.msg(i18n("sCountry_added"),i18n("sNew_country_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore("sCountries").load();j.getLayout().setActiveItem("scrnNewLanguage")},failure:Ext.ux.formFail})},btnNewLanguagePrev:function(b){var g=this;var h=b.up("addLanguageW");h.getLayout().setActiveItem("scrnIntro")},btnNewLanguageNext:function(b){var i=this;var h=b.up("addLanguageW");var j=b.up("form");j.submit({url:i.getUrlLanguageAdd(),params:{country_id:i.selCountry},waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.completeReload();h.close()}})},onCmbCountriesChange:function(j,k,i){var l=this;var h=j.up("form");h.down("#chkNewCountry").setValue(false)},onCmbLanguagesChange:function(i,j,h){var g=this;g.selLanguage=j;g.jsGridReload()},btnNewKeyNext:function(b){var i=this;var j=b.up("form");var h=b.up("addKeyW");j.submit({url:i.getUrlKeyAdd(),waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.jsGridReload();h.close()},failure:Ext.ux.formFail})},delKey:function(){var b=this;if(b.getJsGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_a_key"),i18n("sYou_are_required_to_select_a_key_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){b.getJsGrid().getStore().remove(b.getJsGrid().getSelectionModel().getSelection());b.getJsGrid().getStore().sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_deleting_key"),i18n("sThere_were_some_problems_experienced_during_the_deleting_of_the_key"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}})}},languageDel:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","delLanguageWId")){var e=Ext.widget("delLanguageW",{id:"delLanguageWId"});d.application.runAction("cDesktop","Add",e)}},delCountry:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","delCountryWId")){var e=Ext.widget("delCountryW",{id:"delCountryWId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageDelNext:function(b){var h=this;var g=b.up("delLanguageW");Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=b.up("form");a.submit({url:h.getUrlLanguageDel(),waitMsg:i18n("sSending_the_info")+"...",success:function(j,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.completeReload();g.close()}})}})},btnCountryDelNext:function(b){var h=this;var g=b.up("delCountryW");Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=b.up("form");a.submit({url:h.getUrlCountryDel(),waitMsg:i18n("sSending_the_info")+"...",success:function(j,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.completeReload();g.close()}})}})},editKey:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","editKeyWId")){var e=Ext.widget("editKeyW",{id:"editKeyWId"});d.application.runAction("cDesktop","Add",e)}},btnEditKeyDoPrev:function(b){var g=this;var h=b.up("editKeyW");h.getLayout().setActiveItem("scrnEditKey")},btnEditKeyNext:function(m){var n=this;var s=m.up("form");var q=s.down("cmbPhraseKeys");var r=q.getValue();var t=q.findRecord("id",r);var b=m.up("editKeyW");var p=b.down("#scrnEditKeyDo");var o=p.down("form");o.loadRecord(t);b.getLayout().setActiveItem("scrnEditKeyDo")},btnEditKeyDoNext:function(b){var j=this;var m=b.up("editKeyW");var k=b.up("form");var n=k.getRecord();var l=k.getValues();n.set(l);j.completeReload();m.close()},editLanguage:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinLanguageEditId")){var e=Ext.widget("vWinLanguageEdit",{id:"vWinLanguageEditId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageEditNext:function(m){var n=this;var s=m.up("form");var r=s.down("cmbJustLanguages");var p=r.getValue();var t=r.findRecord("id",p);var b=m.up("vWinLanguageEdit");var q=b.down("#scrnLanguageEditDo");var o=q.down("form");o.loadRecord(t);b.getLayout().setActiveItem("scrnLanguageEditDo")},btnLanguageEditDoPrev:function(b){var g=this;var h=b.up("vWinLanguageEdit");h.getLayout().setActiveItem("scrnLanguageEdit")},btnLanguageEditDoNext:function(b){var j=this;var m=b.up("vWinLanguageEdit");var k=b.up("form");var n=k.getRecord();var l=k.getValues();if(l.rtl==undefined){l.rtl=false}n.set(l);j.completeReload();m.close()},countryEdit:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinCountryEditId")){var e=Ext.widget("vWinCountryEdit",{id:"vWinCountryEditId"});d.application.runAction("cDesktop","Add",e)}},btnCountryEditNext:function(n){var o=this;var s=n.up("form");var r=s.down("vCmbCountries");var b=r.getValue();var t=r.findRecord("id",b);var m=n.up("vWinCountryEdit");var q=m.down("#scrnCountryEditDo");var p=q.down("form");p.loadRecord(t);m.getLayout().setActiveItem("scrnCountryEditDo")},btnCountryEditDoPrev:function(b){var g=this;var h=b.up("vWinCountryEdit");h.getLayout().setActiveItem("scrnCountryEdit")},btnCountryEditDoNext:function(b){var k=this;var n=b.up("vWinCountryEdit");var l=b.up("form");var j=n.down("vCmbCountries");var m=j.getValue();l.submit({url:k.getUrlCountryAdd()+"/"+m,waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){k.selCountry=d.result.id;Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.completeReload();n.close()}})},languageCopy:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinLanguageCopyId")){var e=Ext.widget("vWinLanguageCopy",{id:"vWinLanguageCopyId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageCopyNext:function(b){var k=this;var n=b.up("vWinLanguageCopy");var l=b.up("form");var j=l.down("cmbLanguages");var m=j.getValue();if(k.selLanguage==null){Ext.ux.Toaster.msg(i18n("sNo_target_language"),i18n("sFirst_select_a_language_that_you_want_to_use_as_destination"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}if(k.selLanguage==m){Ext.ux.Toaster.msg(i18n("sFruitless_action"),i18n("sRefusing_this_action_since_source_and_destination_is_the_same"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}l.submit({url:k.getUrlLanguageCopy(),params:{source_id:m,destination_id:k.selLanguage},waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sKey_added"),i18n("sNew_Key_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.jsGridReload();n.close()}})},completeReload:function(){var b=this;b.getStore("sJustLanguages").load();b.getStore("sCountries").load();b.getStore("sLanguages").load();b.jsGridReload()},phpGridReload:function(){var b=this;b.getPhpGrid().getStore().getProxy().setExtraParam("language",b.selPhpLanguage);this.getPhpGrid().getStore().load()},onPhpCmbLanguagesChange:function(i,j,h){var g=this;g.selPhpLanguage=j;g.phpGridReload()},phpAdd:function(){var d=this;if(d.selPhpLanguage==null){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!d.application.runAction("cDesktop","AlreadyExist","winPhpAddId")){var e=Ext.widget("winPhpAdd",{id:"winPhpAddId"});d.application.runAction("cDesktop","Add",e)}}},phpAddSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpAdd()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpDelete:function(){var b=this;if(b.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(j){if(j=="yes"){var m=b.getPhpGrid().getSelectionModel().getSelection();var k={};var l;var n;Ext.each(m,function(e,d){l=e.get("msgid");n="item_"+d;k[n]=l});var a=b.getUrlPhpDel()+"?language="+b.selPhpLanguage;Ext.Ajax.request({url:a,params:k,success:function(e){var d=Ext.JSON.decode(e.responseText);b.getPhpGrid().getStore().load();if(d.success){Ext.ux.Toaster.msg(i18n("sItem_br_s_br_removed"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}else{Ext.ux.Toaster.msg(i18n("sProblem_deleting"),i18n("sItems_could_not_be_deleted"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}})}},phpEdit:function(){var h=this;if(h.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getPhpGrid().getSelectionModel().getCount()<1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=h.phpSelectedRecord.get("msgid");if(!h.application.runAction("cDesktop","AlreadyExist","winPhpEditId")){var g=Ext.widget("winPhpEdit",{id:"winPhpEditId",old_msgid:e});h.application.runAction("cDesktop","Add",g)}}}},phpEditSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpEditMsgid()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpComment:function(){var h=this;if(h.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getPhpGrid().getSelectionModel().getCount()<1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=h.phpSelectedRecord.get("msgid");if(!h.application.runAction("cDesktop","AlreadyExist","winPhpCommentId")){var g=Ext.widget("winPhpComment",{id:"winPhpCommentId",msgid:e});h.application.runAction("cDesktop","Add",g)}}}},phpCommentSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpComment()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpCopy:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","winPhpCopyId")){var e=Ext.widget("winPhpCopy",{id:"winPhpCopyId"});d.application.runAction("cDesktop","Add",e)}},phpCopySubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpCopy(),success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sLanguage_copied"),i18n("sLanguage_copied_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpMeta:function(){var d=this;if(d.selPhpLanguage==null){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=Ext.ModelManager.getModel("Rd.model.mI18nMeta");e.load(d.selPhpLanguage,{scope:d,failure:Ext.ux.formFail,success:function(h,b){var a=d.application.runAction("cDesktop","AlreadyExist","winPhpMetaId");if(!a){a=Ext.widget("winPhpMeta",{id:"winPhpMetaId"});d.application.runAction("cDesktop","Add",a)}form=a.down("form");form.loadRecord(h)}})}},phpMetaSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpMeta()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStorePhpPhrasesSizeChange:function(){var d=this;var e=d.getStore("sI18nPhpPhrases").getTotalCount();d.getPhpGrid().down("#count").update({count:e})},phpGridClick:function(n,j,k,i,l){var m=this;m.phpSelectedRecord=j},onStoreJsPhrasesSizeChange:function(){var d=this;var e=d.getStore("sI18nJsPhrases").getTotalCount();d.getJsGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cI18n"],0));(Ext.cmd.derive("Rd.view.iPPools.gridIpPools",Ext.grid.Panel,{multiSelect:true,store:"sIpPools",stateful:true,stateId:"StateGridIpPools",stateEvents:["groupclick","columnhide"],border:true,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ip_pools/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridIpPools1",width:Rd.config.buttonMargin},{text:"Name",dataIndex:"pool_name",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools2"},{text:"IP Address",dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools3"},{text:"Last NAS IP",dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools4"},{text:"Called ID (NAS MAC)",dataIndex:"calledstationid",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools5"},{text:"Calling ID (Client MAC)",dataIndex:"callingstationid",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools6"},{text:"Expiry time",dataIndex:"expiry_time",tdCls:"gridTree",flex:1,hidden:false,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools7"},{text:"Username",dataIndex:"username",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools8"},{text:"Pool key",dataIndex:"pool_key",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools9"},{text:"NAS ID",dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools10"},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools11"},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools12"},{text:"Active",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='active == true'><div class=\"hasRight\">"+i18n("sYes")+"</div></tpl>","<tpl if='active == false'><div class=\"noRight\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridIpPools13"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools14"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridIpPools"],["component","box","container","panel","tablepanel","gridpanel","grid","gridIpPools"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridIpPools:true},["widget.gridIpPools"],0,[Rd.view.iPPools,"gridIpPools"],0));(Ext.cmd.derive("Rd.model.mIpPool",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"pool_name",type:"string"},{name:"framedipaddress",type:"string"},{name:"nasipaddress",type:"string"},{name:"calledstationid",type:"string"},{name:"callingstationid",type:"string"},{name:"expiry_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"username",type:"string"},{name:"pool_key",type:"string"},{name:"nasidentifier",type:"string"},{name:"extra_value",type:"string"},{name:"active",type:"bool"},{name:"permanent_user_id",type:"int"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mIpPool"],0));(Ext.cmd.derive("Rd.view.iPPools.winIpPoolEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit IP Pool entry",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,poolId:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",name:"id",hidden:true,value:e.poolId},{xtype:"textfield",name:"framedipaddress",hidden:true,value:e.record.get("framedipaddress")},{xtype:"displayfield",fieldLabel:"IP Address",value:e.record.get("framedipaddress"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Client MAC",name:"callingstationid",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",vtype:"MacAddress",value:e.record.get("callingstationid")},{xtype:"cmbPermanentUser",allowBlank:true,labelClsExtra:"lblRd",itemId:"permanent_user_id",fieldLabel:"Permanent user",name:"permanent_user_id"},{xtype:"checkbox",fieldLabel:i18n("sActive"),name:"active",inputValue:"active",checked:e.record.get("active"),cls:"lblRd"},{xtype:"checkbox",fieldLabel:"Clean other fields",name:"clean_up",inputValue:"clean_up",checked:true,cls:"lblRd"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winIpPoolEdit"],["component","box","container","panel","window","winIpPoolEdit"],{component:true,box:true,container:true,panel:true,window:true,winIpPoolEdit:true},["widget.winIpPoolEdit"],0,[Rd.view.iPPools,"winIpPoolEdit"],0));(Ext.cmd.derive("Rd.store.sIpPools",Ext.data.Store,{model:"Rd.model.mIpPool",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ip_pools/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sIpPools"],0));(Ext.cmd.derive("Rd.view.iPPools.cmbPool",Ext.form.ComboBox,{fieldLabel:"Pool",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"name",name:"name",value:"",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ip_pools/list_of_pools.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPool"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPool"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPool:true},["widget.cmbPool"],0,[Rd.view.iPPools,"cmbPool"],0));(Ext.cmd.derive("Rd.view.iPPools.winIpPoolsAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New IP Pool",width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var g=this;var i=g.mkScrnChoice();var h=g.mkScrnNewPool();var j=g.mkScrnExistingPool();g.items=[i,h,j];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnChoice:function(){var e=this;var g=[{itemId:"btnScrnChoiceNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnChoice",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:"Choose one",columns:1,vertical:true,items:[{boxLabel:"New IP pool",name:"rb",inputValue:"new_pool",checked:true},{boxLabel:"Add IP to pool",name:"rb",inputValue:"new_ip"}]}],buttons:g});return h},mkScrnNewPool:function(){var e=this;var g=[{itemId:"btnNewPoolPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnNewPoolNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnNewPool",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"New IP Pool",cls:"lblWizard"}],items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",value:"Test"},{xtype:"textfield",fieldLabel:"Start IP",name:"pool_start",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.1"},{xtype:"textfield",fieldLabel:"End IP",name:"pool_end",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.254"}],buttons:g});return h},mkScrnExistingPool:function(){var e=this;var g=[{itemId:"btnExistingPoolPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnExistingPoolNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnExistingPool",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Add IP to pool",cls:"lblWizard"}],items:[{xtype:"cmbPool",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"IP Address",name:"ip",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.255"}],buttons:g});return h}},0,["winIpPoolsAddWizard"],["component","box","container","panel","window","winIpPoolsAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winIpPoolsAddWizard:true},["widget.winIpPoolsAddWizard"],0,[Rd.view.iPPools,"winIpPoolsAddWizard"],0));(Ext.cmd.derive("Rd.controller.cIpPools",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridIpPools",border:true,itemId:"tabIpPools",plain:true});d.populated=true},views:["iPPools.gridIpPools","iPPools.winIpPoolsAddWizard","iPPools.winIpPoolEdit","components.cmbPermanentUser"],stores:["sIpPools","sPermanentUsers"],models:["mIpPool","mPermanentUser"],selectedRecord:null,config:{urlExportCsv:"/cake2/rd_cake/ip_pools/export_csv",urlAddPool:"/cake2/rd_cake/ip_pools/add_pool.json",urlAddIp:"/cake2/rd_cake/ip_pools/add_ip.json",urlDelete:"/cake2/rd_cake/ip_pools/delete.json",urlEdit:"/cake2/rd_cake/ip_pools/edit.json",urlView:"/cake2/rd_cake/ip_pools/view.json"},refs:[{ref:"grid",selector:"gridIpPools"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabIpPools":{destroy:b.appClose},"gridIpPools #reload":{click:b.reload},"gridIpPools #add":{click:b.add},"winIpPoolsAddWizard #btnScrnChoiceNext":{click:b.btnScrnChoiceNext},"winIpPoolsAddWizard #btnNewPoolPrev":{click:b.btnScrnBackToStart},"winIpPoolsAddWizard #btnExistingPoolPrev":{click:b.btnScrnBackToStart},"winIpPoolsAddWizard #btnNewPoolNext":{click:b.btnNewPoolNext},"winIpPoolsAddWizard #btnExistingPoolNext":{click:b.btnExistingPoolNext},"gridIpPools #edit":{click:b.edit},"gridIpPools #delete":{click:b.del},"gridIpPools #csv":{},"winIpPoolEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},onStoreIpPoolsLoaded:function(){var d=this;var e=d.getStore("sIpPools").getTotalCount();d.getGrid().down("#count").update({count:e})},add:function(d){if(!Ext.WindowManager.get("winIpPoolsAddWizardId")){var e=Ext.widget("winIpPoolsAddWizard",{id:"winIpPoolsAddWizardId"});e.show()}},btnScrnChoiceNext:function(i){var l=this;var k=i.up("winIpPoolsAddWizard");var h=i.up("form");var j=h.down("radiogroup");if(j.getValue().rb=="new_pool"){k.getLayout().setActiveItem("scrnNewPool")}if(j.getValue().rb=="new_ip"){k.getLayout().setActiveItem("scrnExistingPool")}},btnScrnBackToStart:function(g){var e=this;var h=g.up("winIpPoolsAddWizard");h.getLayout().setActiveItem("scrnChoice")},btnNewPoolNext:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlAddPool(),success:function(b,a){i.close();j.getStore("sIpPools").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},btnExistingPoolNext:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlAddIp(),success:function(b,a){i.close();j.getStore("sIpPools").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(n){var l=this;var i=l.getGrid().getStore();if(l.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();var k=m.getId();if(!Ext.WindowManager.get("winIpPoolEditId")){var j=Ext.widget("winIpPoolEdit",{id:"winIpPoolEditId",store:i,poolId:k,record:m});j.show()}else{var j=l.getEditWin();j.poolId=k;j.record=m;l.load(j)}}},btnEditSave:function(h){var j=this;var i=h.up("winIpPoolEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cIpPools"],0));(Ext.cmd.derive("Rd.view.logViewer.winRadiusInfo",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:i18n("sFreeRADIUS_info"),width:380,height:380,plain:true,border:false,layout:"fit",iconCls:"infoWin",glyph:Rd.config.icnInfo,defaults:{border:false},initComponent:function(){var l=this;var k=Ext.create("Ext.data.Store",{storeId:"frClientsStore",fields:["name"],data:{items:l.info.clients},proxy:{type:"memory",reader:{type:"json",root:"items"}}});var i=Ext.create("Ext.grid.Panel",{title:i18n("sClients"),store:Ext.data.StoreManager.lookup("frClientsStore"),columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",flex:1}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]});var m=k.getTotalCount();i.down("#count").update({count:m});var j=Ext.create("Ext.data.Store",{storeId:"frModulesStore",fields:["name"],data:{items:l.info.modules},proxy:{type:"memory",reader:{type:"json",rootProperty:"items"}}});var n=Ext.create("Ext.grid.Panel",{title:i18n("sModules"),store:Ext.data.StoreManager.lookup("frModulesStore"),columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",flex:1}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]});var m=j.getTotalCount();n.down("#count").update({count:m});l.items={xtype:"tabpanel",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:i18n("sGeneral"),xtype:"panel",tpl:new Ext.XTemplate("<tpl>","<div style='padding:5px; margin: 5px;'>",'<div class="lblYfi">'+i18n("sUptime")+'</div><div class="txtGrey">{uptime}</div>','<div class="lblYfi">'+i18n("sVersion")+'</div><div class="txtGrey">{version}</div>',"</div>","</tpl>"),data:{uptime:l.info.uptime,version:l.info.version}},i,n]};Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winRadiusInfo"],["component","box","container","panel","window","winRadiusInfo"],{component:true,box:true,container:true,panel:true,window:true,winRadiusInfo:true},["widget.winRadiusInfo"],0,[Rd.view.logViewer,"winRadiusInfo"],0));(Ext.cmd.derive("Rd.controller.cLogViewer",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add([{xtype:"panel",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),width:200,items:[{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],layout:"fit",margins:"0 0 0 0",border:false,html:"",autoScroll:true,border:"5 5 5 5",bodyCls:"fileViewer",itemId:"pnlViewFile"}]);d.populated=true},views:["logViewer.winRadiusInfo"],stores:[],models:[],socket:undefined,showFirstTime:undefined,showDiv:undefined,htmlToAdd:"",renderFlag:undefined,config:{urlFrStatus:"/cake2/rd_cake/free_radius/status.json",urlFrStart:"/cake2/rd_cake/free_radius/start.json",urlFrStop:"/cake2/rd_cake/free_radius/stop.json",urlFrInfo:"/cake2/rd_cake/free_radius/info.json",portWebSocket:"8000"},refs:[{ref:"file",selector:"#pnlViewFile"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#pnlViewFile #clear":{click:b.clear},"#pnlViewFile #start":{click:b.start},"#pnlViewFile #stop":{click:b.stop},"#pnlViewFile #info":{click:b.info},"#pnlViewFile":{afterrender:b.onShow,render:b.onRender,destroy:b.onDestroy}})},clear:function(b){var e=this;e.showDiv.innerHTML=""},start:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStart(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){b.up("#pnlViewFile").down("#info").setDisabled(false);Ext.ux.Toaster.msg("FreeRADIUS service started","FreeRADIUS service started fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},stop:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStop(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){b.up("#pnlViewFile").down("#info").setDisabled(true);Ext.ux.Toaster.msg("FreeRADIUS service stopped","FreeRADIUS service stopped fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},info:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrInfo(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){e.showInfo(d.data)}},scope:e})},showInfo:function(h){var e=this;if(!Ext.WindowManager.get("winRadiusInfo")){var g=Ext.widget("winRadiusInfo",{id:"winRadiusInfoId",info:h});g.show()}},ioLoaded:function(g){var i=this;var h=i.application.getDashboardData().token;var j=document.location.host;i.socket=io.connect("http://"+j+":"+i.getPortWebSocket()+"?token="+h);i.socket.on("connect",function(){});i.socket.on("message",function(l){if(Ext.isString(l)){var b=i18n("sReceiving_new_logfile_data");i.getFile().down("#feedback").update({message:b});var a=l.split("\n");var e=a.length-1;var d=false;a.forEach(function(k,o,p){if(o==e){d=true}i.newText(k,d)})}});i.socket.on("error",function(a){console.error("Unable to connect Socket.IO",a)})},onShow:function(g){var h=this;if(h.showFirstTime==undefined){h.showFirstTime=true;h.showDiv=h.getFile().body.dom;var e=document.location.host;Ext.Loader.loadScript({url:"http://"+e+":"+h.getPortWebSocket()+"/socket.io/socket.io.js",scope:this,onLoad:h.ioLoaded,onError:function(){console.log("Error loading Socket ")}})}else{if(h.renderFlag==true){h.showDiv=h.getFile().body.dom;h.socket.socket.reconnect();h.renderFlag=false}}},onRender:function(e){var d=this;if(d.showFirstTime==true){d.renderFlag=true}Ext.Ajax.request({url:d.getUrlFrStatus(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.data.running==true){d.getFile().down("#start").toggle(true);d.getFile().down("#info").setDisabled(false)}else{d.getFile().down("#stop").toggle(true);d.getFile().down("#info").setDisabled(true)}}},scope:d})},onDestroy:function(e){var d=this;d.populated=false;d.renderFlag=false;d.socket.disconnect()},newText:function(d,r){var t=this;var y="<br />";if(r==true){y=""}var w=d.split(": ");if(w.length>=3){var x="<span class='txtGrey'>"+w[0]+"</span> : ";var s=w[1];var C="txtGrey";var A=/Info/i;if(s.search(A)!=-1){C="txtBlue"}var u=/Error/i;if(s.search(u)!=-1){C="txtRed"}var q="<span class='"+C+"'>"+w[1]+"</span> : ";w.shift();w.shift();var B=w.toString();if(C=="txtRed"){B="<span class='txtBold'>"+B+"</span>"}t.htmlToAdd=t.htmlToAdd+x+q+B+y}else{t.htmlToAdd=t.htmlToAdd+d+y}if(r==true){t.showDiv.innerHTML=t.showDiv.innerHTML+t.htmlToAdd;t.htmlToAdd="";t.getFile().body.scrollTo("top",99999,true);var z=i18n("sAwaiting_new_logfile_data");t.getFile().down("#feedback").update({message:z})}}},0,0,0,0,0,0,[Rd.controller,"cLogViewer"],0));(Ext.cmd.derive("Rd.view.components.compWallpaper",Ext.Component,{cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',afterRender:function(){var b=this;b.setWallpaper();Ext.Component.prototype.afterRender.apply(this,arguments)},setWallpaper:function(){var e=this,d;if(e.rendered){d=e.el.dom.firstChild;d.src=e.url;Ext.fly(d).setStyle({width:"100%",height:"100%"}).show()}}},0,["compWallpaper"],["component","box","compWallpaper"],{component:true,box:true,compWallpaper:true},["widget.compWallpaper"],0,[Rd.view.components,"compWallpaper"],0));(Ext.cmd.derive("Rd.view.login.pnlLogin",Ext.panel.Panel,{border:false,autoCreate:false,layout:"fit",url:null,title:Rd.config.headerName,dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:["->","<b>"+Rd.config.footerName+"</b> "+Rd.config.footerLicense]}],initComponent:function(){var b=this;b.items=[{xtype:"compWallpaper",url:b.url}];b.add(b.loginWindow());Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},loginWindow:function(){var b=Ext.create("Ext.window.Window",{itemId:"winLogin",layout:"fit",autoShow:true,closable:false,draggable:false,resizable:false,title:i18n("sAuthenticate_please"),glyph:Rd.config.icnLock,width:300,height:310,plain:true,border:false,items:[{xtype:"form",border:false,layout:"anchor",height:"100%",bodyPadding:20,fieldDefaults:{msgTarget:"under",labelAlign:"top",anchor:"100%",labelSeparator:"",labelClsExtra:"lblRd"},defaultType:"textfield",items:[{itemId:"inpUsername",name:"username",fieldLabel:i18n("sUsername"),allowBlank:false,blankText:i18n("sEnter_username")},{itemId:"inpPassword",name:"password",fieldLabel:i18n("sPassword"),inputType:"password",allowBlank:false,blankText:i18n("sEnter_password")}],dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",padding:0,items:["->",{text:i18n("sOK"),margin:Rd.config.buttonMargin,action:"ok",type:"submit",formBind:true,scale:"large",glyph:Rd.config.icnYes}]}]}]})}},0,["pnlLogin"],["component","box","container","panel","pnlLogin"],{component:true,box:true,container:true,panel:true,pnlLogin:true},["widget.pnlLogin"],0,[Rd.view.login,"pnlLogin"],0));(Ext.cmd.derive("Rd.controller.cLogin",Ext.app.Controller,{views:["login.pnlLogin"],config:{urlLogin:"/cake3/rd_cake/dashboard/authenticate.json",urlWallpaper:"resources/images/wallpapers/3.jpg"},refs:[{ref:"viewP",selector:"viewP",xtype:"viewP",autoCreate:true},{ref:"pnlLogin",selector:"pnlLogin",xtype:"pnlLogin",autoCreate:false}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({'#winLogin button[type="submit"]':{click:me.login},"pnlLogin #cmbLanguage":{select:me.onLanguageSelect},"#inpPassword":{specialkey:function(i,j){if(j.getKey()==j.ENTER){var e=i.up("form");var h=e.down('button[type="submit"]');h.fireEvent("click",h)}}}})},actionIndex:function(){var h=this;var g=h.getView("login.pnlLogin").create({url:h.getUrlWallpaper()});var e=h.getViewP();e.removeAll(true);e.add([g])},login:function(i){var m=this;var k=i.up("window"),n=k.down("form");var j=Ext.getBody().getViewSize().width;var l=false;if(j<1000){l=true}n.submit({clientValidation:true,url:m.getUrlLogin(),params:{auto_compact:l},success:function(b,a){m.application.setDashboardData(a.result.data);var d=new Date();d.setDate(d.getDate()+1);Ext.util.Cookies.set("Token",a.result.data.token,d,"/",null,false);Ext.Ajax.setExtraParams({token:a.result.data.token,sel_language:m.application.getSelLanguage()});m.getViewP().removeAll(true);k.close();m.application.runAction("cDashboard","Index")},failure:Ext.ux.formFail})},actionExit:function(){var b=this;b.getViewP().removeAll(true);Ext.util.Cookies.clear("Token");b.actionIndex()}},0,0,0,0,0,0,[Rd.controller,"cLogin"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshEdit",Ext.tab.Panel,{border:true,meshId:undefined,meshName:undefined,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;console.log("Mesh ID is "+b.meshId);b.items=[{title:i18n("sEntry_points"),itemId:"tabEntryPoints",xtype:"gridMeshEntries",meshId:b.meshId},{title:i18n("sMesh_settings"),itemId:"tabMeshSettings",xtype:"pnlMeshSettings",meshId:b.meshId},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridMeshExits",meshId:b.meshId},{title:i18n("sNode_settings"),itemId:"tabNodeCommonSettings",xtype:"pnlNodeCommonSettings",meshId:b.meshId},{title:i18n("sNodes"),itemId:"tabNodes",xtype:"gridNodes",meshId:b.meshId}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshEdit"],["component","box","container","panel","tabpanel","pnlMeshEdit"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlMeshEdit:true},["widget.pnlMeshEdit"],0,[Rd.view.meshes,"pnlMeshEdit"],0));(Ext.cmd.derive("Rd.model.mMeshEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"encryption",type:"string"},{name:"hidden",type:"bool"},{name:"isolate",type:"bool"},{name:"apply_to_all",type:"bool"},{name:"connected_to_exit",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMeshEntry"],0));(Ext.cmd.derive("Rd.model.mMeshExit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"type",type:"string"},"connects_with",{name:"auto_detect",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMeshExit"],0));(Ext.cmd.derive("Rd.model.mMeshEntryPoint",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mMeshEntryPoint"],0));(Ext.cmd.derive("Rd.model.mNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},"static_entries","static_exits"]},0,0,0,0,0,0,[Rd.model,"mNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshMapPreferences",Ext.window.Window,{title:i18n("sPreferences"),layout:"fit",autoShow:false,width:350,height:350,glyph:Rd.config.icnSpanner,meshId:"",mapPanel:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"HYBRID",text:i18n("sHybrid")},{id:"ROADMAP",text:i18n("sRoadmap")},{id:"SATELLITE",text:i18n("sSatellite")},{id:"TERRAIN",text:i18n("sTerrain")}]});d.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"numberfield",name:"lng",itemId:"lng",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"lat",itemId:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"zoom",itemId:"zoom",fieldLabel:"Zoom level",value:17,maxValue:22,minValue:0,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"type",itemId:"type",fieldLabel:i18n("sType"),store:e,queryMode:"local",displayField:"text",valueField:"id",allowBlank:false,forceSelection:true,labelClsExtra:"lblRdReq"}],buttons:[{itemId:"snapshot",text:i18n("sSnapshot"),scale:"large",iconCls:"b-snapshot",glyph:Rd.config.icnSnapshot,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshMapPreferences"],["component","box","container","panel","window","winMeshMapPreferences"],{component:true,box:true,container:true,panel:true,window:true,winMeshMapPreferences:true},["widget.winMeshMapPreferences"],0,[Rd.view.meshes,"winMeshMapPreferences"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEncryptionOptions",Ext.form.ComboBox,{fieldLabel:i18n("sEncryption"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"encryption",name:"encryption",value:"none",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEncryptionOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEncryptionOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEncryptionOptions:true},["widget.cmbEncryptionOptions"],0,[Rd.view.meshes,"cmbEncryptionOptions"],0));(Ext.cmd.derive("Rd.model.mEncryptionOption",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mEncryptionOption"],0));(Ext.cmd.derive("Rd.store.sEncryptionOptions",Ext.data.Store,{model:"Rd.model.mEncryptionOption",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sEncryptionOptions"],0));(Ext.cmd.derive("Rd.view.meshes.vcMeshExitPoint",Ext.app.ViewController,{config:{urlCheckExperimental:"/cake2/rd_cake/meshes/mesh_experimental_check.json"},init:function(){var b=this},onChkDnsOverrideChange:function(i){var l=this;var m=i.up("form");var k=m.down("#txtDns1");var n=m.down("#txtDns2");var j=m.down("#chkDnsDesk");if(i.getValue()){k.enable();n.enable();j.setValue(false);j.disable()}else{k.disable();n.disable();j.enable()}},onChkDnsDeskChange:function(i){var k=this;var l=i.up("form");var h=l.down("#chkDnsOverride");var j=l.down("#chkAnyDns");if(i.getValue()){j.setValue(false);j.disable();h.setValue(false);h.disable()}else{j.enable();h.enable()}},onDnsDeskBeforeRender:function(e){var d=this;Ext.Ajax.request({url:d.getUrlCheckExperimental(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.active){e.show();e.enable()}else{e.hide();e.disable()}}},scope:d})}},0,0,0,0,["controller.vcMeshExitPoint"],0,[Rd.view.meshes,"vcMeshExitPoint"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sEdit_mesh_exit_point"),width:530,height:530,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,meshId:"",exitId:"",store:undefined,defaults:{border:false},controller:"vcMeshExitPoint",initComponent:function(){var k=this;var i=Ext.create("Rd.view.meshes.cmbMeshEntryPoints",{labelClsExtra:"lblRdReq"});var l=true;if(k.type=="captive_portal"){l=false}i.getStore().getProxy().setExtraParam("mesh_id",k.meshId);i.getStore().getProxy().setExtraParam("exit_id",k.exitId);i.getStore().load();var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:k.meshId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"checkbox",fieldLabel:i18n("sAuto_detect"),name:"auto_detect",inputValue:"auto_detect",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},i,{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",hidden:l,items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",cls:"subTab",border:false,items:[{title:"Basic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_NASID"),name:"radius_nasid",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:"Proxy",itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:"Enable",name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Upstream proxy",name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Upstream port",name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Auth name",name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:"Auth password",name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Coova Specific",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:"Optional config items",name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});var h=j.down("#tabCaptivePortal");if(k.type=="captive_portal"){h.setDisabled(false)}else{h.setDisabled(true)}k.items=j;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditExit"],["component","box","container","panel","window","winMeshEditExit"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditExit:true},["widget.winMeshEditExit"],0,[Rd.view.meshes,"winMeshEditExit"],0));(Ext.cmd.derive("Rd.view.meshes.cmbHardwareOptions",Ext.form.ComboBox,{fieldLabel:i18n("sHardware_model"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"hardware",name:"hardware",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name","radios"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/hardware_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbHardwareOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbHardwareOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbHardwareOptions:true},["widget.cmbHardwareOptions"],0,[Rd.view.meshes,"cmbHardwareOptions"],0));(Ext.cmd.derive("Rd.view.components.cmbMesh",Ext.form.ComboBox,{fieldLabel:"Mesh",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"mesh_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMesh"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMesh"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMesh:true},["widget.cmbMesh"],0,[Rd.view.components,"cmbMesh"],0));(Ext.cmd.derive("Rd.view.meshes.vcMeshNodeGeneric",Ext.app.ViewController,{config:{urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json"},init:function(){var b=this},onCmbHardwareOptionsChange:function(x){var r=this;var C=x.up("form");var q=C.down("#key");var p=C.down("#tabVoip");var A=C.down("#tabVoipAdvanced");var B=C.down("#tabRadio");var z=x.getValue();var t=1;var w=x.getSelection();if(w!=null){t=w.get("radios")}var u=C.down("#tabAdvWifiRadio1");var s=x.up("window");if(s.getItemId()!="winMeshEditNodeMain"){var y={model:z}}else{var y={model:z,node_id:s.nodeId}}C.load({url:r.getUrlAdvancedSettingsForModel(),method:"GET",params:y,success:function(b,d,a){if(d.result.data.device_type=="ac"){if(d.result.data.radio0_band==5){r.addAcHtMode(0);r.removeAcHtMode(1)}if(d.result.data.radio1_band==5){r.addAcHtMode(1);r.removeAcHtMode(0)}}else{r.removeAcHtMode(0);r.removeAcHtMode(1)}},listeners:{actioncomplete:function(){console.log("Action is complete")}}});if(t==2){B.setDisabled(false);B.tab.show();u.setDisabled(false);u.tab.show()}else{B.setDisabled(true);B.tab.hide();u.setDisabled(true);u.tab.hide()}},onChkRadioEnableChange:function(h){var k=this;var i=h.up("panel");var j=h.getValue();var l=Ext.ComponentQuery.query("field",i);Ext.Array.forEach(l,function(a){if(a!=h){a.setDisabled(!j)}})},onChkRadioMeshChange:function(i){var l=this;var j=i.up("panel");var n=j.down("#radio24");var k=j.down("#numRadioTwoChan");var m=j.down("#numRadioFiveChan");if(i.getValue()==false){if(n.getValue()){k.setVisible(true);k.setDisabled(false);m.setVisible(false);m.setDisabled(true)}else{k.setVisible(false);k.setDisabled(true);m.setVisible(true);m.setDisabled(false)}}else{k.setVisible(false);k.setDisabled(true);m.setVisible(false);m.setDisabled(true)}},onRadio_0_BandChange:function(o){var q=this;var n=o.getValue();var l=o.up("panel");var m=l.down("#chkRadio0Mesh");var k=l.down("#radio24");var p=l.down("#numRadioTwoChan");var r=l.down("#numRadioFiveChan");if(m.getValue()==false){if(k.getValue()){p.setVisible(true);p.setDisabled(false);r.setVisible(false);r.setDisabled(true)}else{p.setVisible(false);p.setDisabled(true);r.setVisible(true);r.setDisabled(false)}}},onRadio_1_BandChange:function(o){var q=this;var n=o.getValue();var l=o.up("panel");var m=l.down("#chkRadio1Mesh");var k=l.down("#radio24");var p=l.down("#numRadioTwoChan");var r=l.down("#numRadioFiveChan");if(m.getValue()==false){if(k.getValue()){p.setVisible(true);p.setDisabled(false);r.setVisible(false);r.setDisabled(true)}else{p.setVisible(false);p.setDisabled(true);r.setVisible(true);r.setDisabled(false)}}},addAcHtMode:function(e){var h=this;var g=h.getView();if(e==0){g.down("#radio0_htmode_vht20").setVisible(true);g.down("#radio0_htmode_vht40").setVisible(true);g.down("#radio0_htmode_vht80").setVisible(true);g.down("#radio0_htmode_vht160").setVisible(true)}if(e==1){g.down("#radio1_htmode_vht20").setVisible(true);g.down("#radio1_htmode_vht40").setVisible(true);g.down("#radio1_htmode_vht80").setVisible(true);g.down("#radio1_htmode_vht160").setVisible(true)}},removeAcHtMode:function(e){var h=this;var g=h.getView();if(e==0){g.down("#radio0_htmode_vht20").setVisible(false);g.down("#radio0_htmode_vht40").setVisible(false);g.down("#radio0_htmode_vht80").setVisible(false);g.down("#radio0_htmode_vht160").setVisible(false)}if(e==1){g.down("#radio1_htmode_vht20").setVisible(false);g.down("#radio1_htmode_vht40").setVisible(false);g.down("#radio1_htmode_vht80").setVisible(false);g.down("#radio1_htmode_vht160").setVisible(false)}}},0,0,0,0,["controller.vcMeshNodeGeneric"],0,[Rd.view.meshes,"vcMeshNodeGeneric"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit mesh node",width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnEdit,autoShow:false,nodeId:"",meshName:"",meshId:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;console.log(g.meshName);console.log(g.meshId);var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"node_id",xtype:"textfield",name:"id",hidden:true,value:g.nodeId},{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:"A8-40-41-13-60-E3"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId,nodeId:g.nodeId},{xtype:"cmbStaticExits",meshId:g.meshId,nodeId:g.nodeId}]},{title:"Radios",disabled:true,layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,hidden:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditNode"],["component","box","container","panel","window","winMeshEditNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditNode:true},["widget.winMeshEditNode"],0,[Rd.view.meshes,"winMeshEditNode"],0));(Ext.cmd.derive("Rd.store.sMeshEntries",Ext.data.Store,{model:"Rd.model.mMeshEntry",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entries_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_entry_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshEntries"],0));(Ext.cmd.derive("Rd.store.sMeshExits",Ext.data.Store,{model:"Rd.model.mMeshExit",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_exits_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/meshes/mesh_exit_delete.json"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshExits"],0));(Ext.cmd.derive("Rd.store.sMeshEntryPoints",Ext.data.Store,{model:"Rd.model.mMeshEntryPoint",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshEntryPoints"],0));(Ext.cmd.derive("Rd.store.sNodes",Ext.data.Store,{model:"Rd.model.mNode",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_nodes_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodes"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshEditGMap",Ext.ux.GMapPanel,{markers:[],infoWindows:[],infowindow:undefined,editwindow:undefined,addwindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,meshId:"",mapPanel:"",e_pnl:false,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-settings",glyph:Rd.config.icnConfigure,scale:"large",itemId:"preferences",tooltip:i18n("sPreferences")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")}]}],initComponent:function(){var j=this;var g=j.centerLatLng.lat;var i=j.centerLatLng.lng;j.center=new google.maps.LatLng(g,i);j.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapEditDiv";j.editwindow=new google.maps.InfoWindow({content:h});j.infoWindows.push(j.editwindow);google.maps.event.addListener(j.editwindow,"domready",function(){var a=j.editwindow.getContent();if(j.e_pnl){j.e_pnl.destroy()}var b=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sNew_position")+"</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLatitude")+"  </label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLongitude")+"  </label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","</div>"]);j.e_pnl=Ext.create("Ext.panel.Panel",{title:i18n("sAction_required"),itemId:"pnlMapsEdit",height:170,tpl:b,layout:"fit",mapPanel:j,buttonAlign:"center",buttons:[{xtype:"button",itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes},{xtype:"button",itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose},{xtype:"button",itemId:"delete",text:i18n("sDelete"),scale:"large",glyph:Rd.config.icnDelete}],renderTo:a});j.e_pnl.update({lng:j.new_lng,lat:j.new_lat})});j.addwindow=new google.maps.InfoWindow({content:"<div style='padding:5px;margin:5px; height:100px; width:200px;'><div class='lblRdReq'>"+i18n("sAction_required")+"</div><div class='lblRd'>Drag and drop marker to required position</div></div>"});j.infoWindows.push(j.addwindow);Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}}},0,["pnlMeshEditGMap"],["component","box","container","panel","gmappanel","pnlMeshEditGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlMeshEditGMap:true},["widget.pnlMeshEditGMap"],0,[Rd.view.meshes,"pnlMeshEditGMap"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New mesh entry point",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,mesh_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:e.meshId},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sApply_to_all_nodes"),name:"apply_to_all",inputValue:"apply_to_all",checked:true,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddEntry"],["component","box","container","panel","window","winMeshAddEntry"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddEntry:true},["widget.winMeshAddEntry"],0,[Rd.view.meshes,"winMeshAddEntry"],0));(Ext.cmd.derive("Rd.view.meshes.cmbMeshAddMapNodes",Ext.form.ComboBox,{fieldLabel:"Available",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,meshId:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId},url:"/cake2/rd_cake/meshes/nodes_avail_for_map.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMeshAddMapNodes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMeshAddMapNodes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMeshAddMapNodes:true},["widget.cmbMeshAddMapNodes"],0,[Rd.view.meshes,"cmbMeshAddMapNodes"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshMapNodeAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnNote,meshId:"",mapPanel:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Select a node to add",cls:"lblWizard"}],items:[{xtype:"cmbMeshAddMapNodes",meshId:b.meshId}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshMapNodeAdd"],["component","box","container","panel","window","winMeshMapNodeAdd"],{component:true,box:true,container:true,panel:true,window:true,winMeshMapNodeAdd:true},["widget.winMeshMapNodeAdd"],0,[Rd.view.meshes,"winMeshMapNodeAdd"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_mesh_node"),width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,meshId:"",meshName:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);h.setValue(g.meshId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId},{xtype:"cmbStaticExits",meshId:g.meshId}]},{title:"Radios",layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddNode"],["component","box","container","panel","window","winMeshAddNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddNode:true},["widget.winMeshAddNode"],0,[Rd.view.meshes,"winMeshAddNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_mesh_exit_point"),width:530,height:530,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,store:undefined,defaults:{border:false},startScreen:"scrnType",controller:"vcMeshExitPoint",initComponent:function(){var e=this;var g=e.mkScrnType();var h=e.mkScrnData();e.items=[g,h];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnType:function(){var l=this;var h=[{itemId:"btnTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var i=false;l.store.each(function(a,e,b){var d=a.get("type");if(d=="bridge"){i=true;return false}});if(i==true){var j=[{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge",checked:true},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}else{var j=[{boxLabel:i18n("sEthernet_bridge"),name:"exit_type",inputValue:"bridge",checked:true},{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge"},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}var k=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSpecify_exit_point_type"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sExit_point_type"),columns:1,vertical:true,items:j}],buttons:h});return k},mkScrnData:function(){var e=this;var g=Ext.create("Rd.view.meshes.cmbMeshEntryPoints",{labelClsExtra:"lblRdReq"});g.getStore().getProxy().setExtraParam("mesh_id",e.meshId);g.getStore().load();var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:e.meshId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{xtype:"checkbox",fieldLabel:i18n("sAuto_detect"),name:"auto_detect",inputValue:"auto_detect",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},g,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",plain:true,tabPosition:"top",cls:"subTab",border:false,items:[{title:"Basic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_NASID"),name:"radius_nasid",itemId:"radius_nasid",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:"Proxy",itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:"Enable",name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Upstream proxy",name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Upstream port",name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Auth name",name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:"Auth password",name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Coova Specific",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:"Optional config items",name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});return h}},0,["winMeshAddExit"],["component","box","container","panel","window","winMeshAddExit"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddExit:true},["widget.winMeshAddExit"],0,[Rd.view.meshes,"winMeshAddExit"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sEdit_mesh_entry_point"),width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,mesh_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sApply_to_all_nodes"),name:"apply_to_all",inputValue:"apply_to_all",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",allowBlank:false,minLength:8,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditEntry"],["component","box","container","panel","window","winMeshEditEntry"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditEntry:true},["widget.winMeshEditEntry"],0,[Rd.view.meshes,"winMeshEditEntry"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_entries_grid.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshEntries,{listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshEntries2"},{text:i18n("sEncryption"),dataIndex:"encryption",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="encryption==\'none\'"><div class="fieldGreyWhite"><i class="fa fa-unlock"></i>  '+i18n("sNone")+"</div></tpl>",'<tpl if="encryption==\'wep\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWEP")+"</div></tpl>",'<tpl if="encryption==\'psk\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Personal")+"</div></tpl>",'<tpl if="encryption==\'psk2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Personal")+"</div></tpl>",'<tpl if="encryption==\'wpa\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Enterprise")+"</div></tpl>",'<tpl if="encryption==\'wpa2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Enterprise")+"</div></tpl>"),stateId:"StateGridMeshEntries3"},{text:i18n("sHidden"),dataIndex:"hidden",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries4",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="hidden"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sClient_isolation"),dataIndex:"isolate",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="isolate"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sApply_to_all_nodes"),dataIndex:"apply_to_all",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries6",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="apply_to_all"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sConnected_to_Exit"),dataIndex:"connected_to_exit",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries7",renderer:function(h,a,g){if(h==true){return'<div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>'}if(h==false){a.tdAttr="data-qtip=\"<div><label class='lblTipItem'>Go to Exit Points and connect this SSID to an Exit Point</label></div>\"";return'<div class="fieldRedWhite"><i class="fa  fa-exclamation-circle"></i> No</div>'}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshEntries:true},["widget.gridMeshEntries"],0,[Rd.view.meshes,"gridMeshEntries"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshSettings",Ext.panel.Panel,{border:false,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"anchor",autoScroll:true,frame:true,bodyPadding:10,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"fieldset",title:"Connectivity",defaultType:"textfield",defaults:{anchor:"100%"},items:[{xtype:"radio",fieldLabel:"Ad-hoc",name:"connectivity",inputValue:"IBSS",itemId:"con_ibss",labelClsExtra:"lblRdReq"},{xtype:"radio",fieldLabel:"802.11s",name:"connectivity",inputValue:"mesh_point",itemId:"con_mesh_point",labelClsExtra:"lblRdReq",checked:true,afterRender:function(e,a){new Ext.ToolTip({target:this.id,trackMouse:false,maxWidth:250,minWidth:100,html:"<label class='lblTipItem'>Recommended</label>"})}},{xtype:"checkbox",fieldLabel:"Encryption",name:"encryption",inputValue:"encryption",itemId:"encryption",checked:false,labelClsExtra:"lblRdReq",afterRender:function(e,a){new Ext.ToolTip({target:this.id,trackMouse:false,maxWidth:250,minWidth:100,html:"<label class='lblTipItem'>Does not work on devices with 4M Flash (entry level)</label>"})}},{xtype:"textfield",fieldLabel:"Key",name:"encryption_key",itemId:"encryption_key",allowBlank:false,minLength:8,hidden:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{xtype:"fieldset",title:"Batman-adv Settings",defaultType:"textfield",defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sAP_isolation"),name:"ap_isolation",inputValue:"ap_isolation",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sBridge_Loop_Avoidance"),name:"bridge_loop_avoidance",inputValue:"bridge_loop_avoidance",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sAggregation"),name:"aggregated_ogms",inputValue:"aggregated_ogms",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sBonding"),name:"bonding",inputValue:"bonding",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sFragmentation"),name:"fragmentation",inputValue:"fragmentation",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Distributed ARP table",name:"distributed_arp_table",inputValue:"distributed_arp_table",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"orig_interval",fieldLabel:i18n("sOGM_interval_br_ms_br"),value:1000,maxValue:20000,step:100,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},{xtype:"numberfield",name:"gw_sel_class",fieldLabel:i18n("sGateway_switching"),value:20,maxValue:255,step:1,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshSettings"],["component","box","container","panel","pnlMeshSettings"],{component:true,box:true,container:true,panel:true,pnlMeshSettings:true},["widget.pnlMeshSettings"],0,[Rd.view.meshes,"pnlMeshSettings"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshExits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshExitsId",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_exits_grid.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshExits,{listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshExitsId1"},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'bridge\'"><div class="fieldGreyWhite"><i class="fa fa-bars"></i>  Bridge</div></tpl>','<tpl if="type==\'captive_portal\'"><div class="fieldPurpleWhite"><i class="fa fa-key"></i>  Captive Portal</div></tpl>','<tpl if="type==\'nat\'"><div class="fieldGreenWhite"><i class="fa fa-arrows-alt"></i>  NAT+DHCP</div></tpl>','<tpl if="type==\'tagged_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-tag"></i>  Tagged Ethernet Bridge</div></tpl>','<tpl if="type==\'openvpn_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-quote-right"></i>  OpenVPN Bridge</div></tpl>'),stateId:"StateGridMeshExitsId3"},{text:i18n("sConnects_with"),sortable:false,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(connects_with)"><div class="fieldRedWhite"><i class="fa fa-exclamation-circle"></i> '+i18n("sNo_one")+"</div></tpl>",'<tpl for="connects_with">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"connects_with",stateId:"StateGridMeshExitsId4"},{text:i18n("sAuto_detect"),dataIndex:"auto_detect",tdCls:"gridTree",flex:1,stateId:"StateGridMeshExitsId5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="auto_detect"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshExits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshExits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshExits:true},["widget.gridMeshExits"],0,[Rd.view.meshes,"gridMeshExits"],0));(Ext.cmd.derive("Rd.view.meshes.cmbMeshEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:true,labelClsExtra:"lblRdReq",allowBlank:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMeshEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMeshEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMeshEntryPoints:true},["widget.cmbMeshEntryPoints"],0,[Rd.view.meshes,"cmbMeshEntryPoints"],0));(Ext.cmd.derive("Rd.view.meshes.pnlNodeCommonSettings",Ext.panel.Panel,{border:false,layout:"hbox",align:"stretch",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:400,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"System",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"}]},{title:"WiFi",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",anchor:"100%",name:"two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,labelClsExtra:"lblRdReq"},{xtype:"cmbFiveGigChannels",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Client Key",name:"client_key",allowBlank:false,blankText:i18n.sSupply_a_value,labelClsExtra:"lblRdReq",minLength:8}]},{title:"Bridge",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Bridge Ethernet port",name:"eth_br_chk",inputValue:"eth_br_chk",itemId:"eth_br_chk",checked:true,labelClsExtra:"lblRd"},{xtype:"cmbEthBridgeOptions",meshId:b.meshId,disabled:true},{xtype:"checkbox",fieldLabel:"Apply bridge to all nodes",name:"eth_br_for_all",inputValue:"eth_br_for_all",itemId:"eth_br_for_all",checked:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Monitor",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",name:"heartbeat_interval",itemId:"heartbeat_interval",fieldLabel:i18n("sHeartbeat_interval"),value:60,maxValue:21600,minValue:60},{xtype:"numberfield",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:600,maxValue:21600,minValue:300}]},{title:"Gateway",layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{labelWidth:300},autoScroll:true,items:[{xtype:"numberfield",name:"gw_dhcp_timeout",itemId:"gw_dhcp_timeout",fieldLabel:"Wait time for DHCP IP",value:120,maxValue:600,minValue:120,labelWidth:280},{xtype:"checkbox",fieldLabel:"Use previous settings when DHCP fails",name:"gw_use_previous",inputValue:"gw_use_previous",itemId:"gw_use_previous",checked:true,labelClsExtra:"lblRd",labelWidth:280},{xtype:"checkbox",fieldLabel:"Reboot node if gateway is unreachable",name:"gw_auto_reboot",inputValue:"gw_auto_reboot",itemId:"gw_auto_reboot",checked:true,labelClsExtra:"lblRd",labelWidth:280},{xtype:"numberfield",name:"gw_auto_reboot_time",itemId:"gw_auto_reboot_time",fieldLabel:"Reboot trigger time",value:600,maxValue:3600,minValue:240,labelWidth:280}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNodeCommonSettings"],["component","box","container","panel","pnlNodeCommonSettings"],{component:true,box:true,container:true,panel:true,pnlNodeCommonSettings:true},["widget.pnlNodeCommonSettings"],0,[Rd.view.meshes,"pnlNodeCommonSettings"],0));(Ext.cmd.derive("Rd.view.meshes.gridNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_nodes_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodes,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridNodes2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGridNodes3"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridNodes4"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,stateId:"StateGridNodes5"},{text:i18n("sPower"),dataIndex:"power",tdCls:"gridTree",flex:1,stateId:"StateGridNodes6"},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",flex:1,stateId:"StateGridNodes7"},{text:i18n("sStatic_entries"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(static_entries)"><div class="fieldBlue">'+i18n("sNone")+"</div></tpl>",'<tpl for="static_entries">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"static_entries",stateId:"StateGridNodes8"},{text:i18n("sStatic_exits"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(static_exits)"><div class="fieldBlue">'+i18n("sNone")+"</div></tpl>",'<tpl for="static_exits">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"static_exits",stateId:"StateGridNodes9"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNodes:true},["widget.gridNodes"],0,[Rd.view.meshes,"gridNodes"],0));(Ext.cmd.derive("Rd.view.meshes.cmbStaticEntries",Ext.form.ComboBox,{fieldLabel:i18n("sStatic_entry_points"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",itemId:"static_entries",name:"static_entries[]",labelClsExtra:"lblRd",meshId:"",nodeId:"",multiSelect:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId,node_id:d.nodeId},url:"/cake2/rd_cake/meshes/static_entry_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbStaticEntries"],["component","box","field","textfield","pickerfield","combobox","combo","cmbStaticEntries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbStaticEntries:true},["widget.cmbStaticEntries"],0,[Rd.view.meshes,"cmbStaticEntries"],0));(Ext.cmd.derive("Rd.view.meshes.cmbStaticExits",Ext.form.ComboBox,{fieldLabel:i18n("sStatic_exit_points"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",itemId:"static_exits",name:"static_exits[]",labelClsExtra:"lblRd",meshId:"",nodeId:"",multiSelect:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId,node_id:d.nodeId},url:"/cake2/rd_cake/meshes/static_exit_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbStaticExits"],["component","box","field","textfield","pickerfield","combobox","combo","cmbStaticExits"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbStaticExits:true},["widget.cmbStaticExits"],0,[Rd.view.meshes,"cmbStaticExits"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEthBridgeOptions",Ext.form.ComboBox,{fieldLabel:"Bridge with",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"eth_br_with",name:"eth_br_with",value:"0",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId},url:"/cake2/rd_cake/meshes/mesh_exit_view_eth_br.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEthBridgeOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEthBridgeOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEthBridgeOptions:true},["widget.cmbEthBridgeOptions"],0,[Rd.view.meshes,"cmbEthBridgeOptions"],0));(Ext.cmd.derive("Rd.controller.cMeshEdits",Ext.app.Controller,{views:["meshes.pnlMeshEdit","meshes.gridMeshEntries","meshes.winMeshAddEntry","meshes.cmbEncryptionOptions","meshes.winMeshEditEntry","meshes.pnlMeshSettings","meshes.gridMeshExits","meshes.winMeshAddExit","meshes.cmbMeshEntryPoints","meshes.winMeshEditExit","meshes.pnlNodeCommonSettings","meshes.gridNodes","meshes.winMeshAddNode","meshes.cmbHardwareOptions","meshes.cmbStaticEntries","meshes.cmbStaticExits","meshes.winMeshEditNode","meshes.pnlMeshEditGMap","meshes.winMeshMapPreferences","meshes.winMeshMapNodeAdd","meshes.cmbEthBridgeOptions","components.cmbFiveGigChannels","components.cmbTimezones","components.cmbCountries","components.cmbRealm"],stores:["sMeshEntries","sMeshExits","sMeshEntryPoints","sNodes","sRealms"],models:["mMeshEntry","mMeshExit","mMeshEntryPoint","mNode","mRealm","mDynamicDetail","mPermanentUser"],config:{urlAddEntry:"/cake2/rd_cake/meshes/mesh_entry_add.json",urlViewEntry:"/cake2/rd_cake/meshes/mesh_entry_view.json",urlEditEntry:"/cake2/rd_cake/meshes/mesh_entry_edit.json",urlViewMeshSettings:"/cake2/rd_cake/meshes/mesh_settings_view.json",urlEditMeshSettings:"/cake2/rd_cake/meshes/mesh_settings_edit.json",urlExitAddDefaults:"/cake2/rd_cake/meshes/mesh_exit_add_defaults.json",urlAddExit:"/cake2/rd_cake/meshes/mesh_exit_add.json",urlViewExit:"/cake2/rd_cake/meshes/mesh_exit_view.json",urlEditExit:"/cake2/rd_cake/meshes/mesh_exit_edit.json",urlViewNodeCommonSettings:"/cake2/rd_cake/meshes/node_common_settings_view.json",urlEditNodeCommonSettings:"/cake2/rd_cake/meshes/node_common_settings_edit.json",urlAddNode:"/cake2/rd_cake/meshes/mesh_node_add.json",urlViewNode:"/cake2/rd_cake/meshes/mesh_node_view.json",urlEditNode:"/cake2/rd_cake/meshes/mesh_node_edit.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlMapPrefEdit:"/cake2/rd_cake/meshes/map_pref_edit.json",urlMapSave:"/cake2/rd_cake/meshes/map_node_save.json",urlMapDelete:"/cake2/rd_cake/meshes/map_node_delete.json",urlMeshNodes:"/cake2/rd_cake/meshes/mesh_nodes_index.json",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json"},refs:[{ref:"editEntryWin",selector:"winMeshEditEntry"},{ref:"editExitWin",selector:"winMeshEditExit"},{ref:"tabMeshes",selector:"#tabMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({gridMeshEntries:{activate:b.gridActivate},"gridMeshEntries #reload":{click:b.reloadEntry},"gridMeshEntries #add":{click:b.addEntry},"gridMeshEntries #edit":{click:b.editEntry},"winMeshAddEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winMeshAddEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winMeshAddEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winMeshAddEntry #save":{click:b.btnAddEntrySave},"gridMeshEntries #delete":{click:b.delEntry},winMeshEditEntry:{beforeshow:b.loadEntry},"winMeshEditEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winMeshEditEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winMeshEditEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winMeshEditEntry #save":{click:b.btnEditEntrySave},"pnlMeshEdit #tabMeshSettings":{activate:b.frmMeshSettingsLoad},"pnlMeshSettings  #con_mesh_point":{change:b.radioMeshPointChange},"pnlMeshSettings  #encryption":{change:b.chkMeshEncryptionChange},"pnlMeshSettings #save":{click:b.btnMeshSettingsSave},gridMeshExits:{activate:b.gridActivate},"gridMeshExits #reload":{click:b.reloadExit},"gridMeshExits #add":{click:b.addExit},winMeshAddExit:{beforeshow:b.loadAddExit},"winMeshAddExit #btnTypeNext":{click:b.btnExitTypeNext},"winMeshAddExit #btnDataPrev":{click:b.btnExitDataPrev},"winMeshAddExit #save":{click:b.btnAddExitSave},"gridMeshExits #delete":{click:b.delExit},"gridMeshExits #edit":{click:b.editExit},winMeshEditExit:{beforeshow:b.loadExit},"winMeshEditExit #save":{click:b.btnEditExitSave},"#chkProxyEnable":{change:b.chkProxyEnableChange},"pnlMeshEdit #tabNodeCommonSettings":{activate:b.frmNodeCommonSettingsLoad},"pnlNodeCommonSettings #save":{click:b.btnNodeCommonSettingsSave},"pnlNodeCommonSettings  #eth_br_chk":{change:b.chkEthBrChange},"gridNodes #reload":{click:b.reloadNodes},"gridNodes #add":{click:b.addNode},"#winMeshAddNodeEdit #save":{click:b.btnAddNodeSave},"gridNodes #delete":{click:b.delNode},"gridNodes #edit":{click:b.editNode},"gridNodes #map":{click:b.mapLoadApi},"#winMeshEditNodeEdit":{beforeshow:b.loadNode},"#winMeshEditNodeEdit #save":{click:b.btnEditNodeSave},"pnlMeshEdit #mapTab":{activate:function(a){b.reloadMap(a)}},"pnlMeshEditGMap #reload":{click:function(g){var a=this;a.reloadMap(g.up("pnlMeshEditGMap"))}},"pnlMeshEditGMap #preferences":{click:b.mapPreferences},"winMeshMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMeshMapPreferences #save":{click:b.mapPreferencesSave},"pnlMeshEditGMap #add":{click:b.mapNodeAdd},"winMeshMapNodeAdd #save":{click:b.meshMapNodeAddSubmit},"pnlMeshEditGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlMeshEditGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave},"winMeshAddExit #chkNasClient":{change:b.chkNasClientChange},"winMeshAddExit #chkLoginPage":{change:b.chkLoginPageChange}})},actionIndex:function(m,j){var n=this;var k="tabMeshEdit"+m;var i=n.getTabMeshes();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnEdit,title:j,closable:true,layout:"fit",xtype:"pnlMeshEdit",itemId:k,border:false,meshId:m,meshName:j})}i.setActiveTab(l)},gridActivate:function(e){var d=this;e.getStore().reload()},reloadEntry:function(h){var j=this;var i=h.up("pnlMeshEdit");var g=i.down("gridMeshEntries");g.getStore().reload()},addEntry:function(l){var k=this;var j=l.up("pnlMeshEdit");var h=j.down("gridMeshEntries").getStore();if(!Ext.WindowManager.get("winMeshAddEntryId")){var i=Ext.widget("winMeshAddEntry",{id:"winMeshAddEntryId",store:h,meshId:j.meshId});i.show()}},cmbEncryptionChange:function(l){var o=this;var p=l.up("form");var j=p.down("#key");var k=p.down("#auth_server");var n=p.down("#auth_secret");var m=l.getValue();if(m=="none"){j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wep")|(m=="psk")|(m=="psk2")){j.setVisible(true);j.setDisabled(false);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wpa")|(m=="wpa2")){j.setVisible(false);j.setDisabled(true);k.setVisible(true);k.setDisabled(false);n.setVisible(true);n.setDisabled(false)}},chkMaxassocChange:function(i){var k=this;var l=i.up("form");var h=l.down("#maxassoc");var j=i.getValue();if(j){h.setVisible(true);h.setDisabled(false)}else{h.setVisible(false);h.setDisabled(true)}},cmbMacFilterChange:function(j){var h=this;var i=j.up("form");var l=i.down("cmbPermanentUser");var k=j.getValue();if(k=="disable"){l.setVisible(false);l.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false)}},btnAddEntrySave:function(h){var j=this;var i=h.up("winMeshAddEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sNew_mesh_entry_point_added"),i18n("sNew_mesh_enty_point_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},editEntry:function(p){var n=this;var m=p.up("pnlMeshEdit");var j=m.down("gridMeshEntries").getStore();if(m.down("gridMeshEntries").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var o=m.down("gridMeshEntries").getSelectionModel().getLastSelected();var l=o.getId();if(!Ext.WindowManager.get("winMeshEditEntryId")){var k=Ext.widget("winMeshEditEntry",{id:"winMeshEditEntryId",store:j,entryId:l});k.show()}else{var k=n.getEditEntryWin();k.entryId=l;n.loadEntry(k)}}},loadEntry:function(i){var j=this;var g=i.down("form");var h=i.entryId;g.load({url:j.getUrlViewEntry(),method:"GET",params:{entry_id:h},success:function(o,p,a){var n=g.down("cmbMacFilter");var b=n.getValue();if(b!="disable"){var d=g.down("cmbPermanentUser");var e=Ext.create("Rd.model.mPermanentUser",{username:p.result.data.username,id:p.result.data.permanent_user_id});d.getStore().loadData([e],false);d.setValue(p.result.data.permanent_user_id)}}})},btnEditEntrySave:function(h){var j=this;var i=h.up("winMeshEditEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delEntry:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshEntries");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},frmMeshSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.meshId;j.load({url:i.getUrlViewMeshSettings(),method:"GET",params:{mesh_id:h}})},radioMeshPointChange:function(h){var k=this;var l=h.up("form");var i=l.down("#encryption");var j=l.down("#encryption_key");if(h.getValue()){i.setVisible(true);i.setDisabled(false);if(i.getValue()){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}}else{i.setVisible(false);i.setDisabled(true);j.setVisible(false);j.setDisabled(true)}},chkMeshEncryptionChange:function(h){var j=this;var g=h.up("form");var i=g.down("#encryption_key");if(h.getValue()){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},btnMeshSettingsSave:function(h){var j=this;var k=h.up("form");var l=h.up("#tabMeshSettings");var i=l.meshId;k.submit({clientValidation:true,url:j.getUrlEditMeshSettings(),params:{mesh_id:i},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},chkNasClientChange:function(i){var m=this;var n=i.up("form");var k=i.up("window");var j=k.down("#radius_nasid");var l=n.down("#cmbRealm");if(i.getValue()){j.setVisible(false);j.setDisabled(true);l.setVisible(true);l.setDisabled(false)}else{j.setVisible(true);j.setDisabled(false);l.setVisible(false);l.setDisabled(true)}},chkLoginPageChange:function(h){var i=this;var j=h.up("form");var g=j.down("#cmbDynamicDetail");if(h.getValue()){g.setVisible(true);g.setDisabled(false)}else{g.setVisible(false);g.setDisabled(true)}},reloadExit:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshExits");h.getStore().reload()},loadAddExit:function(h){var e=this;var g=h.down("#scrnData");g.load({url:e.getUrlExitAddDefaults(),method:"GET"})},addExit:function(m){var l=this;var k=m.up("pnlMeshEdit");var i=k.down("gridMeshEntries").getStore().count();if(i==0){Ext.ux.Toaster.msg(i18n("sNo_entry_points_defined"),i18n("sDefine_some_entry_points_first"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}var n=k.down("gridMeshExits").getStore();if(!Ext.WindowManager.get("winMeshAddExitId")){var j=Ext.widget("winMeshAddExit",{id:"winMeshAddExitId",store:n,meshId:k.meshId});j.show()}},btnExitTypeNext:function(y){var u=this;var x=y.up("winMeshAddExit");var t=x.down("radiogroup").getValue().exit_type;var z=x.down("#vlan");var r=x.down("#tabCaptivePortal");var w=x.down("#type");var q=x.down("#cmbOpenVpnServers");var o=x.down("#chkNasClient");var p=x.down("#cmbRealm");var A=x.down("#chkLoginPage");var s=x.down("cmbDynamicDetail");w.setValue(t);if(t=="openvpn_bridge"){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}if(t=="tagged_bridge"){z.setVisible(true);z.setDisabled(false)}else{z.setVisible(false);z.setDisabled(true)}if(t=="captive_portal"){r.setDisabled(false);r.tab.show();o.setVisible(true);o.setDisabled(false);A.setVisible(true);A.setDisabled(false);s.setVisible(true);s.setDisabled(false);p.setVisible(true);p.setDisabled(false)}else{r.setDisabled(true);r.tab.hide();o.setVisible(false);o.setDisabled(true);A.setVisible(false);A.setDisabled(true);s.setVisible(false);s.setDisabled(true);p.setVisible(false);p.setDisabled(true)}x.getLayout().setActiveItem("scrnData")},btnExitDataPrev:function(g){var e=this;var h=g.up("winMeshAddExit");h.getLayout().setActiveItem("scrnType")},btnAddExitSave:function(h){var j=this;var i=h.up("winMeshAddExit");var g=i.down("#scrnData");g.submit({clientValidation:true,url:j.getUrlAddExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delExit:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshExits");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editExit:function(x){var t=this;var u=x.up("pnlMeshEdit");var p=u.down("gridMeshExits").getStore();if(u.down("gridMeshExits").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var A=u.down("gridMeshExits").getSelectionModel().getLastSelected();var z=A.getId();var w=A.get("mesh_id");var s=A.get("type");if(!Ext.WindowManager.get("winMeshEditExitId")){var q=Ext.widget("winMeshEditExit",{id:"winMeshEditExitId",store:p,exitId:z,meshId:w,type:s});q.show()}else{var q=t.getEditExitWin();var y=q.down("#vlan");var o=u.down("#cmbOpenVpnServers");var r=q.down("#tabCaptivePortal");q.exitId=z;q.meshId=w;if(s=="openvpn_bridge"){o.setVisible(true);o.setDisabled(false);y.setVisible(false);y.setDisabled(true)}else{o.setVisible(false);o.setDisabled(true)}if(s=="tagged_bridge"){y.setVisible(true);y.setDisabled(false);o.setVisible(false);o.setDisabled(true)}else{y.setVisible(false);y.setDisabled(true)}if(s=="captive_portal"){r.setDisabled(false);r.tab.show()}else{r.setDisabled(true);r.tab.hide()}t.loadExit(q)}}},loadExit:function(i){var g=this;var h=i.down("form");var j=i.exitId;h.load({url:g.getUrlViewExit(),method:"GET",params:{exit_id:j},success:function(d,e,q){var a=h.down("#type");var s=a.getValue();var w=h.down("#vlan");var b=h.down("#cmbOpenVpnServers");if(s=="openvpn_bridge"){b.setVisible(true);b.setDisabled(false);w.setVisible(false);w.setDisabled(true)}else{b.setVisible(false);b.setDisabled(true)}if(s=="tagged_bridge"){w.setVisible(true);w.setDisabled(false);b.setVisible(false);b.setDisabled(true)}else{w.setVisible(false);w.setDisabled(true)}var r=h.down("cmbMeshEntryPoints");r.setValue(e.result.data.entry_points);if(e.result.data.type=="captive_portal"){if((e.result.data.auto_login_page==true)&&(e.result.data.dynamic_detail!=null)){var t=h.down("cmbDynamicDetail");var u=Ext.create("Rd.model.mDynamicDetail",{name:e.result.data.dynamic_detail,id:e.result.data.dynamic_detail_id});t.getStore().loadData([u],false);t.setValue(e.result.data.dynamic_detail_id)}else{}}}})},btnEditExitSave:function(h){var j=this;var i=h.up("winMeshEditExit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},frmNodeCommonSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.meshId;j.load({url:i.getUrlViewNodeCommonSettings(),method:"GET",params:{mesh_id:h}})},chkProxyEnableChange:function(g){var i=this;var h=g.up("panel");var j=Ext.ComponentQuery.query("textfield",h);if(g.getValue()){Ext.Array.each(j,function(a,d,b){a.setDisabled(false);a.setVisible(true)})}else{Ext.Array.each(j,function(a,d,b){a.setDisabled(true);a.setVisible(false)})}},chkEthBrChange:function(i){var k=this;var l=i.up("form");var h=l.down("#eth_br_with");var j=l.down("#eth_br_for_all");if(i.getValue()){h.setDisabled(false);j.setDisabled(false)}else{h.setDisabled(true);j.setDisabled(true)}},btnNodeCommonSettingsSave:function(h){var j=this;var k=h.up("form");var l=h.up("#tabNodeCommonSettings");var i=l.meshId;k.submit({clientValidation:true,url:j.getUrlEditNodeCommonSettings(),params:{mesh_id:i},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadNodes:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridNodes");h.getStore().reload()},addNode:function(l){var k=this;var j=l.up("pnlMeshEdit");var h=j.down("gridNodes").getStore();if(!Ext.WindowManager.get("winMeshAddNodeId")){var i=Ext.widget("winMeshAddNode",{id:"winMeshAddNodeId",store:h,meshId:j.meshId,meshName:j.meshName,itemId:"winMeshAddNodeEdit"});i.show()}},btnAddNodeSave:function(h){var j=this;var i=h.up("winMeshAddNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delNode:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridNodes");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editNode:function(q){var o=this;var m=q.up("pnlMeshEdit");var k=m.down("gridNodes").getStore();if(m.down("gridNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=m.down("gridNodes").getSelectionModel().getLastSelected();var n=p.getId();var r=p.get("mesh_id");if(!Ext.WindowManager.get("winMeshEditNodeId")){var l=Ext.widget("winMeshEditNode",{id:"winMeshEditNodeId",store:k,nodeId:n,meshId:m.meshId,meshName:m.meshName,itemId:"winMeshEditNodeEdit"});l.show()}}},loadNode:function(k){var h=this;var i=k.down("form");var j=k.nodeId;i.load({url:h.getUrlViewNode(),method:"GET",params:{node_id:j}});var l=i.down("#tabAdvWifiRadio1");l.setDisabled(true);l.tab.hide()},btnEditNodeSave:function(h){var j=this;var i=h.up("winMeshEditNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(k){var r=this;var o=k.up("tabpanel");var m="mapTab";var l=o.down("#"+m);if(l){o.setActiveTab(m);return}var p=i18n("sGoogle_Maps");var n=o.up("pnlMeshEdit");var q=o.meshId;Ext.Ajax.request({url:r.getUrlMapPrefView(),method:"GET",params:{mesh_id:q},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){o.add({title:p,itemId:m,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshEditGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:q});o.setActiveTab(m)}},failure:function(a,b){Ext.ux.Toaster.msg("Problems getting the map preferences","Map preferences could not be fetched",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:r})},dragStart:function(i,g,h){var j=this;j.lastMovedMarker=h;j.lastOrigPosition=h.getPosition();j.editWindow=g.editwindow},dragEnd:function(j,l,i){var k=this;var h=i.getPosition();l.new_lng=h.lng();l.new_lat=h.lat();l.editwindow.open(l.gmap,i);k.lastLng=h.lng();k.lastLat=h.lat();k.lastDragId=j},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapDelete(),method:"GET",params:{id:j.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},btnMapSave:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapSave(),method:"GET",params:{id:j.lastDragId,lat:j.lastLat,lon:j.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},mapPreferences:function(o){var n=this;var l=o.up("pnlMeshEdit");var m=l.meshId;var j="winMeshMapPreferences_"+m;var p=l.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(j)){var k=Ext.widget("winMeshMapPreferences",{id:j,mapPanel:p,meshId:m});k.show();k.down("form").load({url:n.getUrlMapPrefView(),method:"GET",params:{mesh_id:m}})}},mapNodeAdd:function(o){var n=this;var l=o.up("pnlMeshEdit");var m=l.meshId;var k="winMeshMapNodeAdd_"+m;var p=l.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(k)){var j=Ext.widget("winMeshMapNodeAdd",{id:k,mapPanel:p,meshId:m});j.show()}},meshMapNodeAddSubmit:function(r){var p=this;var n=r.up("winMeshMapNodeAdd");var q=n.down("cmbMeshAddMapNodes");var m=q.getValue();var k=n.mapPanel;n.close();var o=k.gmap.getCenter();var l=k.addMarker({lat:o.lat(),lng:o.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){p.dragEnd(m,k,l)},dragstart:function(){k.addwindow.close();p.dragStart(m,k,l)}}});k.addwindow.open(k.gmap,l)},mapPreferencesSnapshot:function(t){var r=this;var w=t.up("form");var n=t.up("winMeshMapPreferences");var u=n.mapPanel;var m=u.gmap.getZoom();var q=u.gmap.getMapTypeId();var o=u.gmap.getCenter();var s=o.lat();var p=o.lng();w.down("#lat").setValue(s);w.down("#lng").setValue(p);w.down("#zoom").setValue(m);w.down("#type").setValue(q.toUpperCase())},mapPreferencesSave:function(i){var l=this;var h=i.up("form");var j=i.up("winMeshMapPreferences");var k=j.meshId;h.submit({clientValidation:true,url:l.getUrlMapPrefEdit(),params:{mesh_id:k},success:function(b,a){j.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();var h=g.meshId;Ext.Ajax.request({url:e.getUrlMeshNodes(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var l=g.addMarker({lat:i.lat,lng:i.lng,icon:d,draggable:true,title:i.name,listeners:{dragend:function(){e.dragEnd(i.id,g,l)},dragstart:function(){e.dragStart(i.id,g,l)}}})});g.setLoading(false)}},scope:e})}},0,0,0,0,0,0,[Rd.controller,"cMeshEdits"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshView",Ext.tab.Panel,{meshId:undefined,meshName:undefined,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sOverview"),itemId:"tabMeshViewOverwiew",xtype:"pnlMeshViewNodes",meshId:b.mesh_id},{title:"SSID &#8660; Device",itemId:"tabMeshViewEntries",xtype:"gridMeshViewEntries",meshId:b.mesh_id},{title:"Node &#8660; Device",itemId:"tabMeshViewNodes",xtype:"gridMeshViewNodes",meshId:b.mesh_id},{title:"Node &#8660; Nodes",itemId:"tabMeshViewNodeNodes",xtype:"gridMeshViewNodeNodes",meshId:b.mesh_id},{title:i18n("sNodes"),itemId:"tabMeshViewNodeDetails",xtype:"gridMeshViewNodeDetails",meshId:b.mesh_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshView"],["component","box","container","panel","tabpanel","pnlMeshView"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlMeshView:true},["widget.pnlMeshView"],0,[Rd.view.meshes,"pnlMeshView"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddNodeAction",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:220,glyph:Rd.config.icnAdd,nodeId:null,grid:null,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",name:"node_id",hidden:true,value:b.nodeId},{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddNodeAction"],["component","box","container","panel","window","winMeshAddNodeAction"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddNodeAction:true},["widget.winMeshAddNodeAction"],0,[Rd.view.meshes,"winMeshAddNodeAction"],0));(Ext.cmd.derive("Rd.model.mMeshViewEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mesh_entry_id"},{name:"mac"},{name:"vendor"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_node"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewEntry"],0));(Ext.cmd.derive("Rd.store.sMeshViewEntries",Ext.data.Store,{model:"Rd.model.mMeshViewEntry",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_entries.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewEntries"],0));(Ext.cmd.derive("Rd.model.mMeshViewNodeNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mac"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_entry"},{name:"l_contact"},{name:"l_contact_human"},{name:"state"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNodeNode"],0));(Ext.cmd.derive("Rd.store.sMeshViewNodeNodes",Ext.data.Store,{model:"Rd.model.mMeshViewNodeNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_node_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewNodeNodes"],0));(Ext.cmd.derive("Rd.model.mMeshViewNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mesh_entry_id"},{name:"mac"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_entry"},{name:"l_contact"},{name:"l_contact_human"},{name:"state"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNode"],0));(Ext.cmd.derive("Rd.store.sMeshViewNodes",Ext.data.Store,{model:"Rd.model.mMeshViewNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewNodes"],0));(Ext.cmd.derive("Rd.model.mNodeDetail",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},"last_contact","state","hw_human","mem_free","mem_total","uptime","system_time","load_1","load_2","load_3","release","cpu","last_cmd","last_cmd_status","last_contact_human","gateway","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mNodeDetail"],0));(Ext.cmd.derive("Rd.store.sNodeDetails",Ext.data.Store,{model:"Rd.model.mNodeDetail",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_node_details.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodeDetails"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshViewGMap",Ext.ux.GMapPanel,{markers:[],infoWindows:[],polyLines:[],infowindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,meshId:"",mapPanel:"",e_pnl:false,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var j=this;var g=j.centerLatLng.lat;var i=j.centerLatLng.lng;j.center=new google.maps.LatLng(g,i);j.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapInfoDiv";j.infowindow=new google.maps.InfoWindow({content:h});j.infoWindows.push(j.infowindow);google.maps.event.addListener(j.infowindow,"domready",function(){var a=j.infowindow.getContent();if(j.i_pnl){j.i_pnl.destroy()}var d=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sName")+"  </label><label class='lblValue'>{name}</label>","<div style='clear:both;'></div>","<label class='lblMap'>MAC </label><label class='lblValue'> {mac}</label>","<div style='clear:both;'></div>","<label class='lblMap'>IP Address</label><label class='lblValue'> {ip}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Lat</label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Lng</label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Last contact</label><label class='lblValue'> {last_contact}</label><br>","</div>"]);var e=false;if(j.marker_data.state=="down"){e=true}var b=j.marker_data.id;j.i_pnl=Ext.create("Ext.tab.Panel",{itemId:"pnlMapsNodeInfo",width:350,height:250,layout:"fit",activeTab:0,nodeId:b,meshId:j.meshId,items:[{title:"Info",itemId:"tabMapsNodeInfo",bodyPadding:2,tpl:d,autoScroll:true,data:j.marker_data,buttonAlign:"center",buttons:[{xtype:"button",itemId:"restart",text:"Restart",scale:"large",glyph:Rd.config.icnPower,disabled:e}]}],renderTo:a});j.i_pnl.doLayout()});Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}},addPolyLine:function(h){var j=this;var g=[new google.maps.LatLng(h.from.lat,h.from.lng),new google.maps.LatLng(h.to.lat,h.to.lng)];var i=new google.maps.Polyline({path:g,geodesic:true,strokeColor:h.color,strokeOpacity:h.opacity,strokeWeight:h.weight});i.setMap(j.gmap);j.polyLines.push(i);return i},clearPolyLines:function(){var b=this;while(b.polyLines[0]){b.polyLines.pop().setMap(null)}}},0,["pnlMeshViewGMap"],["component","box","container","panel","gmappanel","pnlMeshViewGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlMeshViewGMap:true},["widget.pnlMeshViewGMap"],0,[Rd.view.meshes,"pnlMeshViewGMap"],0));(Ext.cmd.derive("Rd.model.mMeshViewNodeAction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"action"},{name:"command",type:"string"},{name:"status",type:"string"},{name:"created"},{name:"modified"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNodeAction"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeActions",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGMVNA",nodeId:"",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/node_actions/menu_for_grid.json",urlIndex:"/cake2/rd_cake/node_actions/index.json",columns:[{xtype:"rownumberer",stateId:"StateGMVNA1"},{text:i18n("sAction"),dataIndex:"action",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA2"},{text:i18n("sCommand"),dataIndex:"command",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA3"},{text:i18n("sStatus"),flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> '+i18n("sAwaiting")+"</div></tpl>",'<tpl if=\'status == "fetched"\'><div class="fieldGreenWhite"><i class="fa fa-check-circle"></i> '+i18n("sFetched")+"</div></tpl>"),dataIndex:"status",stateId:"StateGMVNA4"},{text:i18n("sCreated"),dataIndex:"created",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA5"},{text:i18n("sModified"),dataIndex:"modified",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA6"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mMeshViewNodeAction",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/node_actions/delete.json"},simpleSortMode:true},autoLoad:false});b.store.getProxy().setExtraParam("node_id",b.nodeId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeActions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeActions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeActions:true},["widget.gridMeshViewNodeActions"],0,[Rd.view.meshes,"gridMeshViewNodeActions"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:"{name}",hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewEntries,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){if(a.firstRun==undefined){a.firstRun=true}if(a.firstRun){return}var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var t=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var B=k.get("l_tx_bitrate");var h=k.get("l_rx_bitrate");var y=k.get("l_modified_human");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var e=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var g=k.get("l_tx_failed");var A=k.get("l_tx_retries");var i=k.get("l_authenticated");var d=k.get("l_authorized");var p=k.get("l_node");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Node</label><label class='lblTipValue'>"+p+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+B+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+h+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewEntries:true},["widget.gridMeshViewEntries"],0,[Rd.view.meshes,"gridMeshViewEntries"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:['<span class="{children:this.formatColor}">{name}</span><span class="grpInfo"> {children:this.getLastContact}</span>',{formatColor:function(g){var e=g[0];var h=e.get("state");if(h=="never"){return"grpNever"}if(h=="down"){return"grpDown"}if(h=="up"){return"grpUp"}}},{getLastContact:function(g){var e=g[0];var h=e.get("l_contact_human");if(h==null){return"(never)"}return h}}],hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewNodes,{groupField:"name",listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store=Ext.create(Rd.store.sMeshViewNodes,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodes2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodes3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewNodes7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewNodes8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var x=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var d=k.get("l_tx_bitrate");var p=k.get("l_rx_bitrate");var y=k.get("l_modified_human");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var g=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var i=k.get("l_tx_failed");var A=k.get("l_tx_retries");var t=k.get("l_authenticated");var e=k.get("l_authorized");var h=k.get("l_entry");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>SSID</label><label class='lblTipValue'>"+h+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+d+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+p+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+t+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodes:true},["widget.gridMeshViewNodes"],0,[Rd.view.meshes,"gridMeshViewNodes"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshViewNodes",Ext.panel.Panel,{border:false,urlOverview:"/cake2/rd_cake/mesh_reports/overview.json",meshId:"",config:{displayBugFix:false},viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var b=this;b.html="<div id='n_t_n_"+b.meshId+"' style='width:100%;height:100%;background-color:#aaf6be;'></div>";b.buffered=Ext.Function.createBuffered(function(){b.fd.computeIncremental({iter:40,property:["end"],onStep:function(a){},onComplete:function(){b.fd.animate({modes:["linear"],transition:$jit.Trans.Elastic.easeOut,duration:2500})}})},1000,b);b.listeners={afterrender:function(h,i,a){b.initCanvas()},afterlayout:function(m,o,a){var h=this;var n=h.getWidth();var l=h.getHeight()-90;h.fd.canvas.resize(n,l);h.buffered()},scope:b};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},getData:function(){var b=this;b.setLoading(true);Ext.Ajax.request({url:b.urlOverview,method:"GET",params:{mesh_id:b.meshId},success:function(a){var e=Ext.JSON.decode(a.responseText);if(e.success){b.fd.loadJSON(e.data);b.buffered();b.setLoading(false)}},scope:b})},initCanvas:function(){var n=this;var r,l,m,i;(function(){var b=navigator.userAgent,e=b.match(/iPhone/i)||b.match(/iPad/i),a=typeof HTMLCanvasElement,g=(a=="object"||a=="function"),d=g&&(typeof document.createElement("canvas").getContext("2d").fillText=="function");r=(!g||(d&&!e))?"Native":"HTML";m=r=="Native";l=g;i=!(e||!g)})();var o="n_t_n_"+n.meshId;var p=new $jit.ForceDirected({Canvas:{height:500,width:200},injectInto:o,Navigation:{enable:true,panning:"avoid nodes",zooming:10},Node:{overridable:true},Edge:{overridable:true,color:"red",lineWidth:0.4},Label:{type:r,size:15,style:"bold",color:"#434446"},Tips:{enable:true,onShow:function(a,b){var d=0;b.eachAdjacency(function(g,h,e){console.log(g);console.log(h);console.log(e);d++});a.innerHTML="<div class='divTip'><h2>"+b.name+"</h2><label class='lblTipItem'>MAC</label><label class='lblTipValue'>"+b.data.mac+"</label><div style='clear:both;'></div><label class='lblTipItem'>Description</label><label class='lblTipValue'>"+b.data.description+"</label><div style='clear:both;'></div><label class='lblTipItem'>Hardware</label><label class='lblTipValue'>"+b.data.hw_human+"</label><div style='clear:both;'></div><label class='lblTipItem'>IP Address</label><label class='lblTipValue'>"+b.data.ip+"</label><div style='clear:both;'></div><label class='lblTipItem'>Last contact</label><label class='lblTipValue'>"+b.data.last_contact_human+"</label><div style='clear:both;'></div></div>"}},Events:{enable:true,type:"Native",onMouseEnter:function(){p.canvas.getElement().style.cursor="move"},onMouseLeave:function(){p.canvas.getElement().style.cursor=""},onDragMove:function(d,b,a){var e=b.getPos();d.pos.setc(e.x,e.y);p.plot()},onTouchMove:function(d,b,a){$jit.util.event.stop(a);this.onDragMove(d,b,a)},onClick:function(a){if(!a){return}console.log(a);a.data["$color"]="#FF0000";p.plot()}},iterations:50,levelDistance:130,onCreateLabel:function(a,b){a.innerHTML=b.name;var d=a.style;d.fontSize="1.8em";d.color="black"}});var q=[{id:"graphnode1",name:".",data:{$color:"#117c25",$type:"circle",$dim:1}}];p.loadJSON(q);n.fd=p}},0,["pnlMeshViewNodes"],["component","box","container","panel","pnlMeshViewNodes"],{component:true,box:true,container:true,panel:true,pnlMeshViewNodes:true},["widget.pnlMeshViewNodes"],0,[Rd.view.meshes,"pnlMeshViewNodes"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewNodeNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:['<span class="{children:this.formatColor}">{name}</span><span class="grpInfo"> {children:this.getLastContact}</span>',{formatColor:function(g){var e=g[0];var h=e.get("state");if(h=="never"){return"grpNever"}if(h=="down"){return"grpDown"}if(h=="up"){return"grpUp"}}},{getLastContact:function(g){var e=g[0];var h=e.get("l_contact_human");if(h==null){return"(never)"}return h}}],hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewNodeNodes,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewNodeNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodeNodes2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodeNodes3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No peers"}else{return((g===0||g>1)?"("+g+" Peers)":"(1 Peer)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var w=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var e=k.get("l_tx_bitrate");var p=k.get("l_rx_bitrate");var x=k.get("l_modified_human");var y=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var h=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var i=k.get("l_tx_failed");var d=k.get("l_tx_retries");var t=k.get("l_authenticated");var g=k.get("l_authorized");var x=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+x+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+e+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+p+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+h+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+t+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeNodes:true},["widget.gridMeshViewNodeNodes"],0,[Rd.view.meshes,"gridMeshViewNodeNodes"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeDetails",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGMVND",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_node_details_grid.json",plugins:[{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{hardware}.png" alt="{hardware}" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{hw_human}</span>","</div>",'<div class="sectionHeader">',"<h2>DEVICE INFORMATION</h2>","</div>","<div style='background-color:white; padding:5px;'>","<label class='lblMap'>MESH IP  </label><label class='lblValue'>{ip}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Main MAC </label><label class='lblValue'> {mac}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Description </label><label class='lblValue'> {description}</label>","<div style='clear:both;'></div>","<label class='lblMap'>On public maps </label><label class='lblValue'> {on_public_maps}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Status </label>","<tpl if='state == \"down\"'><label class='lblValue txtRed'><i class='fa fa-exclamation-circle'></i> Last contact {last_contact_human}</label></tpl>","<tpl if='state == \"up\"'><label class='lblValue txtGreen'><i class='fa fa-check-circle'></i> Last contact {last_contact_human}</label></tpl>","<div style='clear:both;'></div>","<label class='lblMap'>Uptime </label><label class='lblValue'> {uptime}</label><br>","</div>")}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodeDetails,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGMVND1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",width:130,renderer:function(i,j,a){var h=a.get("gateway");if(h=="yes"){return'<div class="fieldGreen" style="text-align:left;"> '+i+"</div>"}if(h=="no"){return'<div class="fieldGrey" style="text-align:left;"> '+i+"</div>"}},stateId:"StateGMVND2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGMVND3",hidden:true},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",width:130,stateId:"StateGMVND4"},{text:i18n("sHardware"),dataIndex:"hw_human",tdCls:"gridTree",flex:1,stateId:"StateGMVND5",hidden:true},{text:i18n("sPower"),dataIndex:"power",tdCls:"gridTree",flex:1,stateId:"StateGMVND6",hidden:true},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",width:110,stateId:"StateGMVND7"},{text:i18n("sUptime"),dataIndex:"uptime",tdCls:"gridTree",width:110,stateId:"StateGMVND8"},{text:i18n("sSystem_time"),dataIndex:"system_time",tdCls:"gridTree",width:110,stateId:"StateGMVND9"},{text:i18n("sSystem_load"),dataIndex:"mem_total",tdCls:"gridTree",width:130,renderer:function(i,k,l){var a=l.get("mem_free");var j=l.get("load_1")+" "+l.get("load_2")+" "+l.get("load_3");return Ext.ux.bytesToHuman(a)+"/"+Ext.ux.bytesToHuman(i)+"<br>("+j+")"},stateId:"StateGMVND10",hidden:true},{text:i18n("sFirmware"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(release)"><div class="gridRealm noRight">Not available</div></tpl>','<tpl for="release">',"<tpl>{value}<br></tpl>","</tpl>"),dataIndex:"release",stateId:"StateGMVND11",hidden:true},{text:i18n("sCPU"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(cpu)"><div class="gridRealm noRight">Not available</div></tpl>','<tpl for="cpu">',"<tpl>{value}<br></tpl>","</tpl>"),dataIndex:"cpu",stateId:"StateGMVND12",hidden:true},{text:i18n("sLast_contact"),dataIndex:"state",tdCls:"gridTree",flex:1,renderer:function(i,j,a){if(i!="never"){var h=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreen">'+h+"</div>"}if(i=="down"){return'<div class="fieldRed">'+h+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGMVND13"},{text:i18n("sLast_command"),sortable:false,tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'last_cmd_status == ""\'><div class="fieldBlue">(nothing)</div></tpl>','<tpl if=\'last_cmd_status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> {last_cmd}</div></tpl>','<tpl if=\'last_cmd_status == "fetched"\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> {last_cmd}</div></tpl>'),stateId:"StateGMVND14",hidden:false},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGMVND15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeDetails"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeDetails"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeDetails:true},["widget.gridMeshViewNodeDetails"],0,[Rd.view.meshes,"gridMeshViewNodeDetails"],0));(Ext.cmd.derive("Rd.controller.cMeshViews",Ext.app.Controller,{views:["meshes.pnlMeshView","meshes.gridMeshViewEntries","meshes.gridMeshViewNodes","meshes.pnlMeshViewNodes","meshes.gridMeshViewNodeNodes","meshes.gridMeshViewNodeDetails","meshes.pnlMeshViewGMap","meshes.gridMeshViewNodeActions","meshes.winMeshAddNodeAction"],stores:["sMeshViewEntries","sMeshViewNodeNodes","sMeshViewNodes","sNodeDetails"],models:[],config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlOverviewGoogleMap:"/cake2/rd_cake/mesh_reports/overview_google_map.json",urlRestartNodes:"/cake2/rd_cake/mesh_reports/restart_nodes.json",urlMeshAddNodeAction:"/cake2/rd_cake/node_actions/add.json",urlBlueMark:"resources/images/map_markers/mesh_blue_node.png",urlRedNode:"resources/images/map_markers/mesh_red_node.png",urlRedGw:"resources/images/map_markers/mesh_red_gw.png",urlGreenNode:"resources/images/map_markers/mesh_green_node.png",urlGreenGw:"resources/images/map_markers/mesh_green_gw.png",urlPhoneGreenGw:"resources/images/map_markers/phone_green_gw.png",urlPhoneGreenNode:"resources/images/map_markers/phone_green.png",urlPhoneRedGw:"resources/images/map_markers/phone_red_gw.png",urlPhoneRedNode:"resources/images/map_markers/phone_red.png",urlPhoneBlueGw:"resources/images/map_markers/phone_blue_gw.png",urlPhoneBlueNode:"resources/images/map_markers/phone_blue.png"},refs:[{ref:"tabMeshes",selector:"#tabMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlMeshView gridMeshViewEntries #reload":{click:b.reloadViewEntry},"pnlMeshView gridMeshViewEntries button":{toggle:b.viewEntryTimeToggle},"pnlMeshView gridMeshViewNodes #reload":{click:b.reloadViewNode},"pnlMeshView gridMeshViewNodes button":{toggle:b.viewNodeTimeToggle},"pnlMeshView #tabMeshViewEntries":{activate:b.tabMeshViewEntriesActivate},"pnlMeshView #tabMeshViewNodes":{activate:b.tabMeshViewNodesActivate},"pnlMeshView #tabMeshViewNodeNodes":{activate:b.tabMeshViewNodeNodesActivate},"pnlMeshView #tabMeshViewNodeDetails":{activate:b.tabMeshViewNodeDetailsActivate},"pnlMeshView gridMeshViewEntries #reload menuitem[group=refresh]":{click:function(e){var a=this;a.autoRefresh(e,"entries")}},"pnlMeshView gridMeshViewNodes #reload menuitem[group=refresh]":{click:function(a){b.autoRefresh(a,"nodes")}},"pnlMeshView gridMeshViewNodeNodes #reload menuitem[group=refresh]":{click:function(a){b.autoRefresh(a,"node_nodes")}},pnlMeshView:{beforeshow:b.winViewClose,destroy:b.winViewClose},"pnlMeshView pnlMeshViewNodes":{activate:function(a){a.getData()}},"#pnlMapsNodeInfo #restart":{click:b.mapRestart},"pnlMeshView pnlMeshViewNodes #reload":{click:function(h){var g=this;var a=h.up("pnlMeshViewNodes");a.getData()}},"pnlMeshView gridMeshViewNodeNodes #reload":{click:b.reloadViewNodeNodes},"pnlMeshView gridMeshViewNodeNodes button":{toggle:b.viewNodeNodesTimeToggle},"gridMeshViewNodeDetails #map":{click:b.mapLoadApi},"pnlMeshView #mapTab":{activate:function(a){b.reloadMap(a)}},"pnlMeshViewGMap #reload":{click:function(g){var a=this;a.reloadMap(g.up("pnlMeshViewGMap"))}},"pnlMeshView gridMeshViewNodeDetails #reload":{click:b.reloadViewNodeDetails},"pnlMeshView gridMeshViewNodeDetails #execute":{click:b.execute},"pnlMeshView gridMeshViewNodeDetails #history":{click:b.history},"pnlMeshView gridMeshViewNodeDetails #restart":{click:b.restart},"winMeshAddNodeAction #save":{click:b.commitExecute},"pnlMeshView gridMeshViewNodeActions #reload":{click:b.reloadNodeActions},"pnlMeshView gridMeshViewNodeActions #add":{click:b.addNodeActions},"pnlMeshView gridMeshViewNodeActions #delete":{click:b.deleteNodeActions},"pnlMeshView gridMeshViewNodeActions":{activate:b.activateNodeActions}})},actionIndex:function(m,j){var n=this;var k="tabMeshView"+m;var i=n.getTabMeshes();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnView,title:j,closable:true,layout:"fit",xtype:"pnlMeshView",itemId:k,mesh_id:m})}i.setActiveTab(l)},viewEntryTimeToggle:function(g,h){var e=this;if(h){e.reloadViewEntry(g)}},reloadViewEntry:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewEntries");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},viewNodeTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNode(g)}},reloadViewNode:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewNodes");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},viewNodeNodesTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNodeNodes(g)}},reloadViewNodeNodes:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewNodeNodes");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},tabMeshViewNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNode(b)},tabMeshViewEntriesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewEntry(b)},tabMeshViewNodeNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeNodes(b)},tabMeshViewNodeDetailsActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeDetails(b)},autoRefresh:function(n,k){var l=this;var j=n.getItemId();var b=n.up("button");var m=30000;clearInterval(l.autoRefresInterval);b.setGlyph(Rd.config.icnTime);if(j=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(j=="mnuRefresh1m"){m=60000}if(j=="mnuRefresh5m"){m=360000}l.autoRefresInterval=setInterval(function(){if(k=="nodes"){l.reloadViewNode(b)}if(k=="node_nodes"){l.reloadViewNodeNodes(b)}if(k=="entries"){l.reloadViewEntry(b)}},m)},winViewClose:function(){var b=this;if(b.autoRefresInterval!=undefined){clearInterval(b.autoRefresInterval)}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(r){var q=this;var n=r.up("tabpanel");var m="mapTab";var k=n.down("#"+m);if(k){n.setActiveTab(m);return}var o=i18n("sGoogle_Maps");var l=n.up("pnlMeshView");var p=n.meshId;Ext.Ajax.request({url:q.getUrlMapPrefView(),method:"GET",params:{mesh_id:p},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){n.add({title:o,itemId:m,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshViewGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:p});n.setActiveTab(m)}},failure:function(a,b){Ext.ux.Toaster.msg("Problems getting the map preferences","Map preferences could not be fetched",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:q})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();g.clearPolyLines();var h=g.meshId;Ext.Ajax.request({url:e.getUrlOverviewGoogleMap(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var m=false;if((i.hardware=="mp2_basic")||(i.hardware=="mp2_phone")){m=true}if(m){d=e.getUrlPhoneBlueNode()}if(i.state=="down"){if(m){d=e.getUrlPhoneRedNode()}else{d=e.getUrlRedNode()}}if((i.state=="down")&(i.gateway=="yes")){if(m){d=e.getUrlPhoneRedGw()}else{d=e.getUrlRedGw()}}if(i.state=="up"){if(m){d=e.getUrlPhoneGreenNode()}else{d=e.getUrlGreenNode()}}if((i.state=="up")&(i.gateway=="yes")){if(m){d=e.getUrlPhoneGreenGw()}else{d=e.getUrlGreenGw()}}var n=g.addMarker({lat:i.lat,lng:i.lng,icon:d,title:i.name,listeners:{click:function(j,k){e.markerClick(i,g,n)}}})});Ext.each(a.connections,function(d){var j=g.addPolyLine(d)});g.setLoading(false)}},scope:e})},reloadViewNodeDetails:function(g){var i=this;var j=g.up("pnlMeshView");var h=j.down("gridMeshViewNodeDetails");h.getStore().reload()},markerClick:function(i,g,h){var j=this;g.marker_data=i;g.infowindow.open(g.gmap,h)},execute:function(n){var l=this;var m=n.up("pnlMeshView");var i=m.down("gridMeshViewNodeDetails");var k=i.meshId;if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"Select an item on which to execute the command",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winMeshAddNodeActionId")){var j=Ext.widget("winMeshAddNodeAction",{id:"winMeshAddNodeActionId",grid:i});j.show()}}},commitExecute:function(j){var m=this;var k=j.up("winMeshAddNodeAction");var n=k.down("form");var i=k.grid.getSelectionModel().getSelection();var l=[];Ext.Array.forEach(i,function(b){var a=b.getId();Ext.Array.push(l,{id:a})});n.submit({clientValidation:true,url:m.getUrlMeshAddNodeAction(),params:l,success:function(b,a){k.grid.getStore().reload();k.close();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},history:function(i){var l=this;var m=i.up("pnlMeshView");var k=i.up("tabpanel");var j=m.down("gridMeshViewNodeDetails");if(j.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"Select an item to view the history",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=j.getSelectionModel().getSelection();Ext.Array.forEach(n,function(b){var h=b.getId();var a=b.get("name");var g="hTab_"+h;var e="History for "+a;var d=k.down("#"+g);if(d){k.setActiveTab(g)}else{k.add({title:e,itemId:g,closable:true,glyph:Rd.config.icnWatch,layout:"fit",xtype:"gridMeshViewNodeActions",nodeId:h});k.setActiveTab(g)}})}},restart:function(h){var k=this;var l=h.up("pnlMeshView");var i=l.down("gridMeshViewNodeDetails");var j=i.meshId;if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"First select an item to restart",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=i.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(g){var e=g.getId();Ext.Array.push(b,{id:e})});Ext.Ajax.request({url:k.getUrlRestartNodes(),method:"POST",jsonData:{nodes:b,mesh_id:j},success:function(e,g){Ext.ux.Toaster.msg("Restart command queued","Command queued for execution",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.getStore().reload()},failure:function(e,g){Ext.ux.Toaster.msg("Problems restarting device",e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);i.getStore().reload()}})}})}},mapRestart:function(b){var k=this;var l=b.up("#pnlMapsNodeInfo");var j=l.nodeId;var i=l.meshId;Ext.Ajax.request({url:k.getUrlRestartNodes(),method:"POST",jsonData:{nodes:[{id:j}],mesh_id:i},success:function(d,a){Ext.ux.Toaster.msg("Restart command queued","Command queued for execution",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);c},failure:function(d,a){Ext.ux.Toaster.msg("Problems restarting device",d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},activateNodeActions:function(e){var d=this;e.getStore().reload()},reloadNodeActions:function(b){var g=this;var h=b.up("gridMeshViewNodeActions");h.getStore().reload()},addNodeActions:function(b){var j=this;var k=b.up("gridMeshViewNodeActions");var i=k.nodeId;if(!Ext.WindowManager.get("winMeshAddNodeAction_"+i)){var l=Ext.widget("winMeshAddNodeAction",{id:"winMeshAddNodeAction_"+i,grid:k,nodeId:i});l.show()}},deleteNodeActions:function(b){var i=this;var j=b.up("gridMeshViewNodeActions");var h=j.nodeId;if(j.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){j.getStore().remove(j.getSelectionModel().getSelection());j.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.getStore().load()},failure:function(g,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);j.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cMeshViews"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAttachNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach node to mesh",width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAttach,autoShow:false,nodeId:"",meshName:"",meshId:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;console.log(g.meshName);console.log(g.meshId);var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",glyph:Rd.config.icnStar,defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:g.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId,nodeId:g.nodeId},{xtype:"cmbStaticExits",meshId:g.meshId,nodeId:g.nodeId}]},{title:"Radios",disabled:true,layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,hidden:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAttachNode"],["component","box","container","panel","window","winMeshAttachNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshAttachNode:true},["widget.winMeshAttachNode"],0,[Rd.view.meshes,"winMeshAttachNode"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshes",Ext.grid.Panel,{multiSelect:true,store:"sMeshes",stateful:true,stateId:"StateGridMeshes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshes1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridMeshes2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridMeshes3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSsids4"},{text:i18n("sSSID"),dataIndex:"ssid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridMeshes5"},{text:i18n("sBSSID"),dataIndex:"bssid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridMeshes6"},{text:i18n("sNode_count"),dataIndex:"node_count",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl><div class="fieldGreyWhite">{node_count}</div></tpl>'),stateId:"StateGridMeshes7",width:Rd.config.gridNumberCol},{text:i18n("sNodes_up"),dataIndex:"nodes_up",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='nodes_up &gt; 0'><div class=\"fieldGreenWhite\">{nodes_up}</div>",'<tpl else><div class="fieldBlue">{nodes_up}</div></tpl>'),stateId:"StateGridMeshes8",width:Rd.config.gridNumberCol},{text:i18n("sNodes_down"),dataIndex:"nodes_down",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='nodes_down &gt; 0'><div class=\"fieldRedWhite\">{nodes_down}</div>",'<tpl else><div class="fieldBlue">{nodes_down}</div></tpl>'),stateId:"StateGridMeshes9",width:Rd.config.gridNumberCol},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridMeshes10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshes:true},["widget.gridMeshes"],0,[Rd.view.meshes,"gridMeshes"],0));(Ext.cmd.derive("Rd.view.meshes.gridNodeLists",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridNodeLists",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_nodes_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodeLists,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridNodeLists1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,stateId:"StateGridNodeLists2",sortable:false,hidden:true},{text:"Mesh",dataIndex:"mesh",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",width:130,renderer:function(i,j,a){var h=a.get("gateway");if(h=="yes"){return'<div class="fieldGreen" style="text-align:left;"> '+i+"</div>"}if(h=="no"){return'<div class="fieldGrey" style="text-align:left;"> '+i+"</div>"}},stateId:"StateGridNodeLists4",flex:1,filter:{type:"string"}},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists5"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists6"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists7"},{text:"Last contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(k,l,a){var i=a.get("state");if(i!="never"){var j=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreenWhite">'+j+"</div>"}if(i=="down"){return'<div class="fieldRedWhite">'+j+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGridNodeLists8"},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists9"},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGridNodeLists10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNodeLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNodeLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNodeLists:true},["widget.gridNodeLists"],0,[Rd.view.meshes,"gridNodeLists"],0));(Ext.cmd.derive("Rd.view.meshes.gridUnknownNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUnknownNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/node_lists/menu_for_unknown_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sUnknownNodes,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridUnknownNodes1"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUnknownNodes2"},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUnknownNodes3"},{text:"Last contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUnknownNodes4"},{text:"From IP",dataIndex:"from_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUnknownNodes5"},{text:"Gateway",flex:1,hidden:false,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='gateway == true'><div class=\"fieldGreenWhite\">"+i18n("sYes")+"</div></tpl>","<tpl if='gateway == false'><div class=\"fieldRedWhite\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"gateway",filter:{type:"boolean"},stateId:"StateGridUnknownNodes6"},{text:"Redirect To",flex:1,hidden:false,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='new_server'>",'<tpl if=\'new_server_status == "awaiting"\'><div class="fieldBlueWhite">{new_server}</div></tpl>','<tpl if=\'new_server_status == "fetched"\'><div class="fieldGreenWhite">{new_server}</div></tpl>',"</tpl>"),dataIndex:"new_server",filter:{type:"boolean"},stateId:"StateGridUnknownNodes7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownNodes:true},["widget.gridUnknownNodes"],0,[Rd.view.meshes,"gridUnknownNodes"],0));(Ext.cmd.derive("Rd.model.mMesh",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"ssid",type:"string"},{name:"bssid",type:"string"},{name:"owner",type:"string"},{name:"node_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"nodes_up",type:"int"},{name:"nodes_down",type:"int"},{name:"connected_users",type:"int"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"view",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMesh"],0));(Ext.cmd.derive("Rd.model.mNodeList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"mesh",type:"string"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"last_contact_human","state","gateway","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mNodeList"],0));(Ext.cmd.derive("Rd.model.mUnknownNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"},{name:"vendor",type:"string"},{name:"from_ip",type:"string"},{name:"vendor",type:"string"},{name:"gateway",type:"bool"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},"last_contact_human","new_server","new_server_status","country_code","country_name","city","postal_code"]},0,0,0,0,0,0,[Rd.model,"mUnknownNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshUnknownRedirect",Ext.window.Window,{title:"Redirect To Another Server",layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnRedirect,unknownNodeId:"",new_server:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"unknown_node_id",xtype:"textfield",name:"id",hidden:true,value:b.unknownNodeId},{xtype:"textfield",fieldLabel:"IP Address / FQDN",name:"new_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",value:b.new_server}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshUnknownRedirect"],["component","box","container","panel","window","winMeshUnknownRedirect"],{component:true,box:true,container:true,panel:true,window:true,winMeshUnknownRedirect:true},["widget.winMeshUnknownRedirect"],0,[Rd.view.meshes,"winMeshUnknownRedirect"],0));(Ext.cmd.derive("Rd.store.sMeshes",Ext.data.Store,{model:"Rd.model.mMesh",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sMeshes"],0));(Ext.cmd.derive("Rd.store.sNodeLists",Ext.data.Store,{model:"Rd.model.mNodeList",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/node_lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodeLists"],0));(Ext.cmd.derive("Rd.store.sUnknownNodes",Ext.data.Store,{model:"Rd.model.mUnknownNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/node_lists/unknown_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/node_lists/unknown_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownNodes"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_mesh"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winMeshAddWizard"],["component","box","container","panel","window","winMeshAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddWizard:true},["widget.winMeshAddWizard"],0,[Rd.view.meshes,"winMeshAddWizard"],0));(Ext.cmd.derive("Rd.controller.cMeshes",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:true,itemId:"tabMeshes",items:[{title:i18n("sMeshes"),xtype:"gridMeshes",glyph:Rd.config.icnMesh},{title:i18n("sKnown_Nodes"),xtype:"gridNodeLists",glyph:Rd.config.icnCheck},{title:i18n("sUnknown_Nodes"),xtype:"gridUnknownNodes",glyph:Rd.config.icnQuestion}]});d.populated=true},views:["meshes.gridMeshes","meshes.winMeshAddWizard","meshes.gridNodeLists","meshes.winMeshEditNode","meshes.gridUnknownNodes","meshes.winMeshAttachNode","meshes.winMeshUnknownRedirect","meshes.cmbHardwareOptions","meshes.cmbStaticEntries","meshes.cmbStaticExits"],stores:["sMeshes","sAccessProvidersTree","sNodeLists","sUnknownNodes","sMeshEntries","sMeshExits","sMeshEntryPoints"],models:["mMesh","mAccessProviderTree","mNodeList","mUnknownNode"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/meshes/add.json",urlDelete:"/cake2/rd_cake/meshes/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlNoteAdd:"/cake2/rd_cake/meshes/note_add.json",urlAddNode:"/cake2/rd_cake/meshes/mesh_node_add.json",urlViewNode:"/cake2/rd_cake/meshes/mesh_node_view.json",urlEditNode:"/cake2/rd_cake/meshes/mesh_node_edit.json",urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json",urlRedirectNode:"/cake2/rd_cake/nodes/redirect_unknown.json"},refs:[{ref:"grid",selector:"gridMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabMeshes":{destroy:b.appClose},"#tabMeshes gridMeshes":{activate:b.gridActivate},"#tabMeshes gridNodeLists":{activate:b.gridActivate},"#tabMeshes gridUnknownNodes":{activate:b.gridActivate},"gridMeshes #reload":{click:b.reload},"gridMeshes #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridMeshes #add":{click:b.add},"gridMeshes #delete":{click:b.del},"gridMeshes #edit":{click:b.edit},"gridMeshes #view":{click:b.view},"gridMeshes #note":{click:b.note},gridMeshes:{select:b.select},"gridNote[noteForGrid=meshes] #reload":{click:b.noteReload},"gridNote[noteForGrid=meshes] #add":{click:b.noteAdd},"gridNote[noteForGrid=meshes] #delete":{click:b.noteDelete},"gridNote[noteForGrid=meshes]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=meshes] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=meshes] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=meshes] #btnNoteAddNext":{click:b.btnNoteAddNext},"winMeshAddWizard #btnTreeNext":{click:b.btnTreeNext},"winMeshAddWizard #btnDataPrev":{click:b.btnDataPrev},"winMeshAddWizard #btnDataNext":{click:b.btnDataNext},"gridNodeLists #reload":{click:b.gridNodeListsReload},"gridNodeLists #reload menuitem[group=refresh]":{click:b.reloadNodeListsOptionClick},"gridNodeLists #add":{click:b.addNode},"#winMeshAddNodeMain #save":{click:b.btnAddNodeSave},"gridNodeLists #delete":{click:b.delNode},"gridNodeLists #edit":{click:b.editNode},"#winMeshEditNodeMain":{beforeshow:b.loadNode},"#winMeshEditNodeMain #save":{click:b.btnEditNodeSave},"gridUnknownNodes #reload":{click:b.gridUnknownNodesReload},"gridUnknownNodes #reload menuitem[group=refresh]":{click:b.reloadUnknownNodesOptionClick},"gridUnknownNodes #attach":{click:b.attachNode},"winMeshAttachNode #save":{click:b.btnAttachNodeSave},"gridUnknownNodes #delete":{click:b.delUnknownNode},"gridUnknownNodes #redirect":{click:b.redirectNode},"winMeshUnknownRedirect #save":{click:b.btnRedirectNodeSave}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadNodeLists!=undefined){clearInterval(b.autoReloadNodeLists)}if(b.autoReloadUnknownNodes!=undefined){clearInterval(b.autoReloadUnknownNodes)}},gridActivate:function(d){var e=this;d.getStore().load()},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winMeshAddWizardId")){var h=Ext.widget("winMeshAddWizard",{id:"winMeshAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winMeshAddWizardId")){var h=Ext.widget("winMeshAddWizard",{id:"winMeshAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winMeshAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winMeshAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sMeshes").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(m,n){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=n.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=n.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var j=n.get("view");if(j==true){if(tb.down("#view")!=null){tb.down("#view").setDisabled(false)}}else{if(tb.down("#view")!=null){tb.down("#view").setDisabled(true)}}},view:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cMeshViews","Index",k,j)}}},edit:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cMeshEdits","Index",k,j)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteMeshes"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteMeshes"+m.getId(),noteForId:m.getId(),noteForGrid:"meshes",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteMeshesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteMeshesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteMeshesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteMeshesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},gridNodeListsReload:function(g){var h=this;var e=g.up("gridNodeLists");e.getStore().load()},reloadNodeListsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadNodeLists);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadNodeLists=setInterval(function(){j.gridNodeListsReload(b)},k)},addNode:function(n){var m=this;var k=n.up("#tabMeshes");var i=k.down("gridNodeLists").getStore();var l=true;if(!Ext.WindowManager.get("winMeshAddNodeId")){var j=Ext.widget("winMeshAddNode",{id:"winMeshAddNodeId",store:i,meshId:"",meshName:"",itemId:"winMeshAddNodeMain"});j.show()}},btnAddNodeSave:function(h){var j=this;var i=h.up("winMeshAddNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delNode:function(g){var i=this;var j=g.up("#tabMeshes");var h=j.down("gridNodeLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editNode:function(s){var p=this;var q=s.up("#tabMeshes");var m=q.down("gridNodeLists").getStore();if(q.down("gridNodeLists").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var w=q.down("gridNodeLists").getSelectionModel().getLastSelected();var u=w.getId();var r=w.get("mesh_id");var n=w.get("mesh");var t=true;if(!Ext.WindowManager.get("winMeshEditNodeId")){var o=Ext.widget("winMeshEditNode",{id:"winMeshEditNodeId",store:m,nodeId:u,meshId:r,meshName:n,hidePower:t,itemId:"winMeshEditNodeMain"});o.show()}}},loadNode:function(k){var h=this;var i=k.down("form");var j=k.nodeId;i.load({url:h.getUrlViewNode(),method:"GET",params:{node_id:j}});var l=i.down("#tabAdvWifiRadio1");l.setDisabled(true);l.tab.hide()},btnEditNodeSave:function(h){var j=this;var i=h.up("winMeshEditNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridUnknownNodesReload:function(g){var h=this;var e=g.up("gridUnknownNodes");e.getStore().load()},reloadUnknownNodesOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownNodes);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownNodes=setInterval(function(){j.gridUnknownNodesReload(b)},k)},attachNode:function(u){var q=this;var s=u.up("#tabMeshes");var n=s.down("gridUnknownNodes").getStore();if(s.down("gridUnknownNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var y=s.down("gridUnknownNodes").getSelectionModel().getLastSelected();var x=y.getId();var t="";var o="";var r=y.get("mac");var w=true;if(!Ext.WindowManager.get("winMeshAttachNodeId")){var p=Ext.widget("winMeshAttachNode",{id:"winMeshAttachNodeId",store:n,mac:r});p.show()}}},btnAttachNodeSave:function(h){var j=this;var i=h.up("winMeshAttachNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delUnknownNode:function(g){var i=this;var j=g.up("#tabMeshes");var h=j.down("gridUnknownNodes");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},redirectNode:function(q){var o=this;var n=q.up("#tabMeshes");var r=n.down("gridUnknownNodes").getStore();if(n.down("gridUnknownNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=n.down("gridUnknownNodes").getSelectionModel().getLastSelected();var m=p.getId();var l=p.get("new_server");if(!Ext.WindowManager.get("winMeshUnknownRedirectId")){var k=Ext.widget("winMeshUnknownRedirect",{id:"winMeshUnknownRedirectId",unknownNodeId:m,new_server:l,store:r});k.show()}}},btnRedirectNodeSave:function(h){var j=this;var i=h.up("winMeshUnknownRedirect");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlRedirectNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cMeshes"],0));(Ext.cmd.derive("Rd.model.mRealmForNasOwner",Ext.data.Model,{fields:["id","name","selected"]},0,0,0,0,0,0,[Rd.model,"mRealmForNasOwner"],0));(Ext.cmd.derive("Rd.model.mTag",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTag"],0));(Ext.cmd.derive("Rd.model.mDynamicAttribute",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicAttribute"],0));(Ext.cmd.derive("Rd.model.mNasType",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNasType"],0));(Ext.cmd.derive("Rd.model.mNaState",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"state",type:"bool"},{name:"time",type:"string"},{name:"start",type:"string"},{name:"end",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mNaState"],0));(Ext.cmd.derive("Rd.model.mAction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"action"},{name:"command",type:"string"},{name:"status",type:"string"},{name:"created"},{name:"modified"}]},0,0,0,0,0,0,[Rd.model,"mAction"],0));(Ext.cmd.derive("Rd.view.nas.pnlNas",Ext.tab.Panel,{border:false,nas_id:null,url:null,plain:true,cls:"subTab",initComponent:function(){var b=this;Ext.Ajax.request({url:b.url+"?nas_id="+b.nas_id,method:"GET",success:b.buildPanel,scope:b});Ext.tab.Panel.prototype.initComponent.apply(this,arguments)},buildPanel:function(p){var l=this;var j=[];var n=Ext.JSON.decode(p.responseText);if(n.success){l.add(n.items);l.setActiveTab(0);var m=l.down("gridRealmsForNasOwner");m.getStore().getProxy().setExtraParam("nas_id",l.nas_id);m.getStore().getProxy().setExtraParam("owner_id",l.record.get("user_id"));m.getStore().getProxy().setExtraParam("available_to_siblings",l.record.get("available_to_siblings"));var k=l.down("gridNasAvailability");k.getStore().getProxy().setExtraParam("nas_id",l.nas_id);var o=l.down("gridNasActions");if(o!=undefined){o.getStore().getProxy().setExtraParam("nas_id",l.nas_id)}}}},0,["pnlNas"],["component","box","container","panel","tabpanel","pnlNas"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlNas:true},["widget.pnlNas"],0,[Rd.view.nas,"pnlNas"],0));(Ext.cmd.derive("Rd.store.sDynamicAttributes",Ext.data.Store,{model:"Rd.model.mDynamicAttribute",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/dynamic_attributes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sDynamicAttributes"],0));(Ext.cmd.derive("Rd.view.nas.winNasAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sAdd_NAS_device"),width:500,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",urlConnTypes:"/cake2/rd_cake/nas/conn_types_available.json",defaults:{border:false},initComponent:function(){var o=this;var l=o.mkScrnApTree();var m=o.mkScrnConType();var k=o.mkScrnOpenvpn();var n=o.mkScrnDynamic();var p=o.mkScrnDirect();var j=o.mkScrnPptp();this.items=[l,m,k,n,p,j];Ext.window.Window.prototype.initComponent.apply(this,arguments);Ext.Ajax.request({url:o.urlConnTypes,method:"GET",success:o.addConnTypes,scope:o});o.getLayout().setActiveItem(o.startScreen)},addConnTypes:function(h){var i=this;var j=Ext.JSON.decode(h.responseText);var g=i.down("radiogroup");if(j.success){Ext.Array.each(j.items,function(a,b){if(b==0){g.add({boxLabel:a.name,name:"rb",inputValue:a.id,checked:true})}else{g.add({boxLabel:a.name,name:"rb",inputValue:a.id})}})}},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnConType:function(){var h=this;var e=[{itemId:"btnConTypePrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnConTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(h.no_tree){e=[{itemId:"btnConTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var g=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnConType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:"15 10 15 10"},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sChoose_a_connection_type"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sConnection_type"),columns:1,vertical:true}],buttons:e});return g},mkScrnOpenvpn:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnOpenvpn",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",buttons:[{itemId:"btnOpenvpnPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnOpenvpnNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sOpenVPN"),layout:"anchor",itemId:"tabVpn",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sOpenVPN_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",labelClsExtra:"lblRd"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}]});return d},mkScrnPptp:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnPptp",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",buttons:[{itemId:"btnPptpPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnPptpNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sPPTP"),layout:"anchor",itemId:"tabVpn",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sPPTP_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}]});return d},mkScrnDynamic:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnDynamic",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sDynamic_AVP_detail"),layout:"anchor",itemId:"tabDynamic",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sUnique_AVP_combination"),cls:"lblWizard"}],items:[{xtype:"combo",fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sDynamicAttributes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"dynamic_attribute",name:"dynamic_attribute"},{itemId:"dynamic_value",xtype:"textfield",fieldLabel:i18n("sValue"),name:"dynamic_value",allowBlank:false,blankText:i18n("sValue_to_identify_the_NAS_with"),labelClsExtra:"lblRdReq"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}],buttons:[{itemId:"btnDynamicPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDynamicNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]});return d},mkScrnDirect:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnDirect",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}],buttons:[{itemId:"btnDirectPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDirectNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]});return d}},0,["winNasAddWizard"],["component","box","container","panel","window","winNasAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winNasAddWizard:true},["widget.winNasAddWizard"],0,[Rd.view.nas,"winNasAddWizard"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",nas_id:undefined,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.nas_id,type:"nas"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.nas_id,type:"nas"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.nas_id,type:"nas"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasGraphs"],["component","box","container","panel","tabpanel","pnlNasGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlNasGraphs:true},["widget.pnlNasGraphs"],0,[Rd.view.nas,"pnlNasGraphs"],0));(Ext.cmd.derive("Rd.view.nas.winNasActionAdd",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:200,iconCls:"add",glyph:Rd.config.icnAdd,nas_id:null,grid:null,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",name:"na_id",hidden:true,value:b.nas_id},{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winNasActionAdd"],["component","box","container","panel","window","winNasActionAdd"],{component:true,box:true,container:true,panel:true,window:true,winNasActionAdd:true},["widget.winNasActionAdd"],0,[Rd.view.nas,"winNasActionAdd"],0));(Ext.cmd.derive("Rd.view.nas.gridNas",Ext.grid.Panel,{store:"sNas",stateful:true,multiSelect:true,stateId:"StateGridNas",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},border:false,urlMenu:"/cake2/rd_cake/nas/menu_for_grid.json",urlTagFilter:"/cake3/rd_cake/tags/index-for-filter.json",urlRealmFilter:"/cake3/rd_cake/realms/index-for-filter.json",plugins:"gridfilters",initComponent:function(){var g=this;g.bbar=[{xtype:"pagingtoolbar",store:g.store,dock:"bottom",displayInfo:true}];g.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:g.urlMenu});var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"direct",text:"Direct"},{id:"openvpn",text:"OpenVPN"},{id:"pptp",text:"PPTP"},{id:"dynamic",text:"Dynamic"}]});options:["direct","openvpn","pptp","dynamic"];var j=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:g.urlTagFilter,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});var i=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:g.urlRealmFilter,reader:{type:"json",keepRawData:true,rootProperty:"items",messageProperty:"message"}},autoLoad:true});g.columns=[{xtype:"rownumberer",stateId:"StateGridNas1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNas2",hidden:true},{text:i18n("sIP_Address"),dataIndex:"nasname",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridNas3"},{text:i18n("sName"),dataIndex:"shortname",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridNas4"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridMain",flex:1,filter:{type:"string"},hidden:false,stateId:"StateGridNas5"},{text:i18n("sConnection_type"),dataIndex:"connection_type",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"list",store:h},stateId:"StateGridNas6"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridNas7"},{text:i18n("sRealms"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(realms)"><div class="fieldBlueWhite">Available to all!</div></tpl>','<tpl for="realms">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"realms",filter:{type:"list",store:i},stateId:"StateGridNas8"},{text:i18n("sTags"),sortable:false,flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(tags)"><div"></div></tpl>','<tpl for="tags">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"tags",filter:{type:"list",store:j},stateId:"StateGridNas9"},{text:i18n("sStatus"),dataIndex:"status",flex:1,renderer:function(a,d,e){if(a!="unknown"){var b=e.get("status_time");if(a=="up"){return'<div class="fieldGreen">'+i18n("sUp")+" "+Ext.ux.secondsToHuman(b)+"</div>"}if(a=="down"){return'<div class="fieldRed">'+i18n("sDown")+" "+Ext.ux.secondsToHuman(b)+"</div>"}}else{return'<div class="fieldBlue">'+i18n("sUnknown")+"</div>"}},stateId:"StateGridNas10"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridNas11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNas"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNas"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNas:true},["widget.gridNas"],0,[Rd.view.nas,"gridNas"],0));(Ext.cmd.derive("Rd.view.nas.gridRealmsForNasOwner",Ext.grid.Panel,{border:false,realFlag:false,columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",flex:1},{xtype:"advCheckColumn",text:"Include",dataIndex:"selected",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;if(b.realFlag){urlUpdate="/cake3/rd_cake/realms/update-na-realm.json";b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbseparator"},{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_sub_providers"),cls:"lblRd",itemId:"chkAvailSub",name:"available_to_siblings",inputValue:true}]}else{b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRealmForNasOwner",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/list_realms-for-nas-owner.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/list_realms-for-nas-owner.json",update:"/cake3/rd_cake/realms/update-na-realm.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg("Updated Realm","Updated Realm",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg("Problems Updating Realm","Problems Updating Realm",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealmsForNasOwner"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealmsForNasOwner"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealmsForNasOwner:true},["widget.gridRealmsForNasOwner"],0,[Rd.view.nas,"gridRealmsForNasOwner"],0));(Ext.cmd.derive("Rd.view.nas.winTagManage",Ext.window.Window,{title:i18n("sAdd_or_remove_tags"),layout:"fit",autoShow:false,width:350,height:300,iconCls:"tags",glyph:Rd.config.icnTags,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSelect_an_action_and_a_tag"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sAction"),columns:1,vertical:true,items:[{boxLabel:i18n("sAdd"),name:"rb",inputValue:"add",checked:true},{boxLabel:i18n("sRemove"),name:"rb",inputValue:"remove"}]},{xtype:"combo",fieldLabel:i18n("sTags"),store:"sTags",queryMode:"local",editable:false,allowBlank:false,name:"tag_id",displayField:"name",valueField:"id"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winTagManage"],["component","box","container","panel","window","winTagManage"],{component:true,box:true,container:true,panel:true,window:true,winTagManage:true},["widget.winTagManage"],0,[Rd.view.nas,"winTagManage"],0));(Ext.cmd.derive("Rd.view.nas.pnlRealmsForNasOwner",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"fit",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll"}],initComponent:function(){var d=this;var e=Ext.create("Rd.view.nas.gridRealmsForNasOwner",{realFlag:true});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmsForNasOwner"],["component","box","container","panel","pnlRealmsForNasOwner"],{component:true,box:true,container:true,panel:true,pnlRealmsForNasOwner:true},["widget.pnlRealmsForNasOwner"],0,[Rd.view.nas,"pnlRealmsForNasOwner"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasOpenVpn",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sOpenVPN_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",labelClsExtra:"lblRd"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasOpenVpn"],["component","box","container","panel","pnlNasOpenVpn"],{component:true,box:true,container:true,panel:true,pnlNasOpenVpn:true},["widget.pnlNasOpenVpn"],0,[Rd.view.nas,"pnlNasOpenVpn"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasNas",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",nn_disabled:true,bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"ping",text:i18n("sPing")},{id:"heartbeat",text:i18n("sHeartbeat")}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:e,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id"});h.items={xtype:"form",height:"100%",width:500,layout:"fit",autoScroll:true,frame:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",disabled:h.nn_disabled,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sOptional_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sNAS-Identifier"),name:"nasidentifier",labelClsExtra:"lblRd"},{xtype:"cmbNasTypes"},{xtype:"textfield",fieldLabel:i18n("sPorts"),name:"ports",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sCommunity"),name:"community",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sServer"),name:"server",labelClsExtra:"lblRd"},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRd"}]},{title:i18n("sMonitor_settings"),layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true},{xtype:"numberfield",anchor:"100%",name:"ping_interval",itemId:"ping_interval",fieldLabel:i18n("sPing_interval"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:i18n("sMaps_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:i18n("sEnhancements"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sRecord_authentication_requests"),name:"record_auth",inputValue:"record_auth",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"checkbox",boxLabel:i18n("sIgnore_accounting_requests"),name:"ignore_acct",inputValue:"ignore_acct",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",inputValue:"session_auto_close",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasNas"],["component","box","container","panel","pnlNasNas"],{component:true,box:true,container:true,panel:true,pnlNasNas:true},["widget.pnlNasNas"],0,[Rd.view.nas,"pnlNasNas"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasPptp",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sPPTP_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasPptp"],["component","box","container","panel","pnlNasPptp"],{component:true,box:true,container:true,panel:true,pnlNasPptp:true},["widget.pnlNasPptp"],0,[Rd.view.nas,"pnlNasPptp"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasDynamic",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sUnique_AVP_combination"),cls:"lblWizard"}],items:[{xtype:"combo",fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sDynamicAttributes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"dynamic_attribute",name:"dynamic_attribute"},{itemId:"dynamic_value",xtype:"textfield",fieldLabel:i18n("sValue"),name:"dynamic_value",allowBlank:false,blankText:i18n("sValue_to_identify_the_NAS_with"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasDynamic"],["component","box","container","panel","pnlNasDynamic"],{component:true,box:true,container:true,panel:true,pnlNasDynamic:true},["widget.pnlNasDynamic"],0,[Rd.view.nas,"pnlNasDynamic"],0));(Ext.cmd.derive("Rd.view.nas.cmbNasTypes",Ext.form.ComboBox,{fieldLabel:i18n("sType"),labelSeparator:"",store:"sNasTypes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"type",name:"type",labelClsExtra:"lblRd",initComponent:function(){var b=this;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbNasTypes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbNasTypes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbNasTypes:true},["widget.cmbNasTypes"],0,[Rd.view.nas,"cmbNasTypes"],0));(Ext.cmd.derive("Rd.view.nas.winMapNasAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:500,height:300,iconCls:"note",glyph:Rd.config.icnNote,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSelect_a_NAS_device"),cls:"lblWizard"}],items:[{xtype:"cmbNas"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapNasAdd"],["component","box","container","panel","window","winMapNasAdd"],{component:true,box:true,container:true,panel:true,window:true,winMapNasAdd:true},["widget.winMapNasAdd"],0,[Rd.view.nas,"winMapNasAdd"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasPhoto",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:"Current Photo",flex:1,border:false,items:[{xtype:"cmpImg"}]},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:"Select an image",fieldLabel:"New photo",allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasPhoto"],["component","box","container","panel","pnlNasPhoto"],{component:true,box:true,container:true,panel:true,pnlNasPhoto:true},["widget.pnlNasPhoto"],0,[Rd.view.nas,"pnlNasPhoto"],0));(Ext.cmd.derive("Rd.view.nas.gridNasAvailability",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridNasAvailability",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/na_states/menu_for_grid.json",urlIndex:"/cake2/rd_cake/na_states/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridNasAvailability1"},{text:i18n("sState"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='state == true'><div class=\"fieldGreen\">"+i18n("sUp")+"</div></tpl>","<tpl if='state == false'><div class=\"fieldRed\">"+i18n("sDown")+"</div></tpl>"),dataIndex:"state",stateId:"StateGridNasAvailability2"},{text:i18n("sDuration"),dataIndex:"time",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability3"},{text:i18n("sStarted"),dataIndex:"start",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability4"},{text:i18n("sEnded"),dataIndex:"end",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability5"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mNaState",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/na_states/delete.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNasAvailability"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNasAvailability"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNasAvailability:true},["widget.gridNasAvailability"],0,[Rd.view.nas,"gridNasAvailability"],0));(Ext.cmd.derive("Rd.view.nas.gridNasActions",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridNasActions",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/actions/menu_for_grid.json",urlIndex:"/cake2/rd_cake/actions/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridNasActions1"},{text:i18n("sAction"),dataIndex:"action",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions2"},{text:i18n("sCommand"),dataIndex:"command",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions3"},{text:i18n("sStatus"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "awaiting"\'><div class="fieldBlue">'+i18n("sAwaiting")+"</div></tpl>",'<tpl if=\'status == "fetched"\'><div class="fieldGreen">'+i18n("sFetched")+"</div></tpl>"),dataIndex:"status",stateId:"StateGridNasActions4"},{text:i18n("sCreated"),dataIndex:"created",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions5"},{text:i18n("sModified"),dataIndex:"modified",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions6"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mAction",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/actions/delete.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNasActions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNasActions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNasActions:true},["widget.gridNasActions"],0,[Rd.view.nas,"gridNasActions"],0));(Ext.cmd.derive("Rd.store.sNas",Ext.data.Store,{model:"Rd.model.mNas",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/nas/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNas"],0));(Ext.cmd.derive("Rd.store.sTags",Ext.data.Store,{model:"Rd.model.mTag",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/tags/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTags"],0));(Ext.cmd.derive("Rd.store.sNasTypes",Ext.data.Store,{model:"Rd.model.mNasType",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/nas_types.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sNasTypes"],0));(Ext.cmd.derive("Rd.controller.cNas",Ext.app.Controller,{owner:undefined,user_id:undefined,actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabNas",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridNas",glyph:Rd.config.icnHome}]});d.populated=true},views:["nas.gridNas","nas.winNasAddWizard","nas.gridRealmsForNasOwner","nas.winTagManage","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","nas.pnlNas","nas.pnlRealmsForNasOwner","nas.pnlNasOpenVpn","nas.pnlNasNas","nas.pnlNasPptp","nas.pnlNasDynamic","nas.cmbNasTypes","components.pnlGMap","components.cmbNas","nas.winMapNasAdd","nas.pnlNasPhoto","nas.winMapPreferences","nas.gridNasAvailability","nas.gridNasActions","nas.winNasActionAdd","components.pnlUsageGraph","nas.pnlNasGraphs"],stores:["sNas","sTags","sDynamicAttributes","sAccessProvidersTree","sTags","sNasTypes"],models:["mNas","mRealmForNasOwner","mApRealms","mTag","mDynamicAttribute","mGenericList","mAccessProviderTree","mTag","mNasType","mNaState","mAction","mUserStat"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/nas/add.json",urlAddDirect:"/cake2/rd_cake/nas/add_direct.json",urlAddOpenVpn:"/cake2/rd_cake/nas/add_open_vpn.json",urlAddDynamic:"/cake2/rd_cake/nas/add_dynamic.json",urlAddPptp:"/cake2/rd_cake/nas/add_pptp.json",urlDelete:"/cake2/rd_cake/nas/delete.json",urlEditPanelCfg:"/cake2/rd_cake/nas/edit_panel_cfg.json",urlManageTags:"/cake2/rd_cake/nas/manage_tags.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/nas/export_csv",urlNoteAdd:"/cake2/rd_cake/nas/note_add.json",urlViewOpenVpn:"/cake2/rd_cake/nas/view_openvpn.json",urlEditOpenVpn:"/cake2/rd_cake/nas/edit_openvpn.json",urlViewDynamic:"/cake2/rd_cake/nas/view_dynamic.json",urlEditDynamic:"/cake2/rd_cake/nas/edit_dynamic.json",urlViewPptp:"/cake2/rd_cake/nas/view_pptp.json",urlEditPptp:"/cake2/rd_cake/nas/edit_pptp.json",urlViewNas:"/cake2/rd_cake/nas/view_nas.json",urlEditNas:"/cake2/rd_cake/nas/edit_nas.json",urlMapDelete:"/cake2/rd_cake/nas/delete_map.json",urlMapSave:"/cake2/rd_cake/nas/edit_map.json",urlViewPhoto:"/cake2/rd_cake/nas/view_photo.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",urlUploadPhoto:"/cake2/rd_cake/nas/upload_photo/",urlGreenMark:"resources/images/map_markers/green-dot.png",urlRedMark:"resources/images/map_markers/red-dot.png",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlYellowMark:"resources/images/map_markers/yellow-dot.png",urlViewMapPref:"/cake2/rd_cake/nas/view_map_pref.json",urlEditMapPref:"/cake2/rd_cake/nas/edit_map_pref.json",urlNasActionsAdd:"/cake2/rd_cake/actions/add.json"},refs:[{ref:"gridNas",selector:"gridNas"},{ref:"pnlGMap",selector:"pnlGMap"},{ref:"grid",selector:"gridNas"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabNas":{destroy:b.appClose},"gridNas #reload":{click:b.reload},"gridNas #add":{click:b.add},"gridNas #delete":{click:b.del},"gridNas #edit":{click:b.edit},"gridNas #note":{click:b.note},"gridNas #csv":{click:b.csvExport},"gridNas #tag":{click:b.tag},"gridNas #map":{click:b.mapLoadApi},"gridNas #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridNas #graph":{click:b.graph},gridNas:{select:b.select,activate:b.gridActivate},"winNasAddWizard #btnTreeNext":{click:b.btnTreeNext},"winNasAddWizard #btnConTypePrev":{click:b.btnConTypePrev},"winNasAddWizard #btnConTypeNext":{click:b.btnConTypeNext},"winNasAddWizard #btnOpenvpnPrev":{click:b.btnOpenvpnPrev},"winNasAddWizard #btnOpenvpnNext":{click:b.btnOpenvpnNext},"winNasAddWizard #btnPptpPrev":{click:b.btnPptpPrev},"winNasAddWizard #btnPptpNext":{click:b.btnPptpNext},"winNasAddWizard #btnDynamicPrev":{click:b.btnDynamicPrev},"winNasAddWizard #btnDynamicNext":{click:b.btnDynamicNext},"winNasAddWizard #btnDirectPrev":{click:b.btnDirectPrev},"winNasAddWizard #btnDirectNext":{click:b.btnDirectNext},"winNasAddWizard gridRealmsForNasOwner #reload":{click:b.gridRealmsForNasOwnerReload},"winNasAddWizard #tabRealms":{activate:b.gridRealmsForNasOwnerActivate},"winNasAddWizard #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winNasAddWizard gridRealmsForNasOwner #chkAvailSub":{change:b.gridRealmsForNasOwnerChkAvailSub},"winTagManage #save":{click:b.btnTagManageSave},"#winCsvColumnSelectNas #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=nas] #reload":{click:b.noteReload},"gridNote[noteForGrid=nas] #add":{click:b.noteAdd},"gridNote[noteForGrid=nas] #delete":{click:b.noteDelete},"gridNote[noteForGrid=nas]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=nas] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=nas] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=nas] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlNasNas #save":{click:b.pnlNasNasSave},"pnlNasNas #monitorType":{change:b.monitorTypeChange},"pnlRealmsForNasOwner #chkAvailForAll":{change:b.chkAvailForAllChangeTab},"pnlRealmsForNasOwner gridRealmsForNasOwner #reload":{click:b.gridRealmsForNasOwnerReload},"pnlRealmsForNasOwner #chkAvailSub":{change:b.chkAvailSubTab},"pnlNas #tabOpenVpn":{beforerender:b.tabOpenVpnRender,activate:b.tabOpenVpnActivate},"pnlNas #tabOpenVpn #save":{click:b.saveOpenVpn},"pnlNas #tabPptp":{beforerender:b.tabPptpActivate,activate:b.tabPptpActivate},"pnlNas #tabPptp #save":{click:b.savePptp},"pnlNas #tabDynamic":{beforerender:b.tabDynamicActivate,activate:b.tabDynamicActivate},"pnlNas #tabDynamic #save":{click:b.saveDynamic},"pnlNas #tabNas":{beforerender:b.tabNasActivate,activate:b.tabNasActivate},"pnlNas #tabRealms":{activate:b.tabRealmsActivate},"pnlGMap #preferences":{click:b.mapPreferences},"pnlGMap #add":{click:b.mapNasAdd},"winMapNasAdd #save":{click:b.mapNasAddSubmit},"pnlGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave},"pnlNas #tabPhoto":{activate:b.tabPhotoActivate},"pnlNas #tabPhoto #save":{click:b.photoSave},"pnlNas #tabPhoto #cancel":{click:b.photoCancel},"winMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMapPreferences #save":{click:b.mapPreferencesSave},"pnlNas #tabAvailability":{activate:b.tabAvailabilityActivate},"gridNasAvailability #reload":{click:b.gridNasAvailabilityReload},"gridNasAvailability #delete":{click:b.gridNasAvailabilityDelete},"pnlNas #tabActions":{activate:b.tabActionsActivate},"gridNasActions #reload":{click:b.gridNasActionsReload},"gridNasActions #add":{click:b.gridNasActionsAdd},"gridNasActions #delete":{click:b.gridNasActionsDelete},"winNasActionAdd #save":{click:b.gridNasActionsAddSubmit},"#tabNas pnlNasGraphs #daily":{activate:b.loadGraph},"#tabNas pnlNasGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabNas pnlNasGraphs #daily #day":{change:b.changeDailyGraph},"#tabNas pnlNasGraphs #weekly":{activate:b.loadGraph},"#tabNas pnlNasGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabNas pnlNasGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabNas pnlNasGraphs #monthly":{activate:b.loadGraph},"#tabNas pnlNasGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabNas pnlNasGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;if(b.getGrid()==undefined){clearInterval(b.autoReload);return}b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNasAddWizardId")){var h=Ext.widget("winNasAddWizard",{id:"winNasAddWizardId",startScreen:"scrnApTree"});h.show()}}else{if(!Ext.WindowManager.get("winNasAddWizardId")){d.user_id=0;var h=Ext.widget("winNasAddWizard",{id:"winNasAddWizardId",startScreen:"scrnConType",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNasAddWizard");k.username=l.get("username");k.user_id=l.getId();j.getLayout().setActiveItem("scrnConType")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnConTypePrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnConTypeNext:function(i){var m=this;var l=i.up("winNasAddWizard");var n=i.up("form");var k=n.down("radiogroup");if(k.getValue().rb=="direct"){var j=l.down("#scrnDirect");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnDirect")}if(k.getValue().rb=="openvpn"){var j=l.down("#scrnOpenvpn");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnOpenvpn")}if(k.getValue().rb=="dynamic"){var j=l.down("#scrnDynamic");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnDynamic")}if(k.getValue().rb=="pptp"){var j=l.down("#scrnPptp");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnPptp")}},btnOpenvpnPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnOpenvpnNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddOpenVpn())},btnDynamicPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnDynamicNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddDynamic())},btnPptpPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnPptpNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddPptp())},btnDirectPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnDirectNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddDirect())},chkAvailForAllChange:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForNasOwner");if(h.getValue()==true){g.hide()}else{g.show()}},chkAvailForAllChangeTab:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForNasOwner");if(h.getValue()==true){g.hide()}else{g.show()}g.getStore().getProxy().setExtraParam("clear_flag",true);g.getStore().load();g.getStore().getProxy().setExtraParam("clear_flag",false)},gridRealmsForNasOwnerReload:function(e){var h=this;var g=e.up("gridRealmsForNasOwner");g.getStore().load()},gridRealmsForNasOwnerActivate:function(g){var j=this;var i=g.down("#chkAvailSub").getValue();var h=g.down("gridRealmsForNasOwner");h.getStore().getProxy().setExtraParam("owner_id",j.owner_id);h.getStore().getProxy().setExtraParam("available_to_siblings",i);h.getStore().load()},gridRealmsForNasOwnerChkAvailSub:function(h){var j=this;var i=h.getValue();var g=h.up("gridRealmsForNasOwner");g.getStore().getProxy().setExtraParam("owner_id",j.owner_id);g.getStore().getProxy().setExtraParam("available_to_siblings",i);g.getStore().load()},addSubmit:function(r,u){var o=this;var q=r.up("winNasAddWizard");var t=r.up("form");var m=t.down("tabpanel");var w=t.down("gridRealmsForNasOwner");var s={};var n=false;var p=t.down("#chkAvailForAll");if(p.getValue()==true){s.avail_for_all=true}else{w.getStore().each(function(a){if(a.get("selected")==true){n=true;s[a.getId()]=a.get("selected")}},o)}if(s.avail_for_all==undefined){if(n!=true){var m=t.down("tabpanel");m.setActiveTab("tabRealms");Ext.ux.Toaster.msg(i18n("sSelect_at_least_one_realm"),i18n("sSelect_one_or_more_realms"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}t.submit({clientValidation:true,url:u,params:s,success:function(a,b){q.close();o.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d,a,b){if(d.result.errors.username!=undefined){m.setActiveTab(0)}else{m.setActiveTab("tabNas")}Ext.ux.formFail(e,d)}})},tag:function(e){var h=this;if(h.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_tag"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winNasAddWizardId")){var g=Ext.widget("winTagManage",{id:"winTagManageId"});g.show()}}},btnTagManageSave:function(l){var p=this;var o=l.up("window");var q=o.down("form");var n=q.down("combo");var m=q.down("radiogroup");if(n.getValue()==null){Ext.ux.Toaster.msg(i18n("sSelect_a_tag"),i18n("sSelect_a_tag_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var r={};var k=p.getGrid().getSelectionModel().getSelection();Ext.Array.each(k,function(b){var a=b.getId();r[a]=a});q.submit({clientValidation:true,url:p.getUrlManageTags(),params:r,success:function(b,a){o.close();p.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sTags_modified"),i18n("sTags_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},select:function(n,i){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=i.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var j=i.get("delete");if(j==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var m=i.get("manage_tags");if(j==true){if(tb.down("#tag")!=null){tb.down("#tag").setDisabled(false)}}else{if(tb.down("#tag")!=null){tb.down("#tag").setDisabled(true)}}},onStoreNasLoaded:function(o,t,n,m){var p=this;var s=p.getStore("sNas").getTotalCount();p.getGrid().down("#count").update({count:s});var l=p.getGrid().up("tabpanel");var r=l.down("#mapTab");if(r!=null){var q=r.down("gmappanel");q.clearMarkers();Ext.each(t,function(j){var g=j.get("lat");var i=j.get("lon");var a=j.get("status");if((g!=null)&(i!=null)){var h=p.getUrlBlueMark();if(a=="up"){h=p.getUrlGreenMark()}if(a=="down"){h=p.getUrlRedMark()}var e=j.get("nasname");var d=j.get("shortname");var b=q.addMarker({lat:g,lng:i,icon:h,draggable:true,title:e,listeners:{click:function(k,w){p.markerClick(j,q,b)},dragend:function(){p.dragEnd(j,q,b)},dragstart:function(){p.dragStart(j,q,b)}}})}},p)}},markerClick:function(w,s,x){var q=this;var u=w.get("nasname");var y=w.get("shortname");s.marker_record=w;var p=Ext.ComponentQuery.query("#pnlMapsInfo");if(p[0]){var n="N/A";if(w.get("status")!="unknown"){if(w.get("status")=="up"){var d=i18n("sUp")}if(w.get("status")=="down"){var d=i18n("sDown")}n=d+" "+Ext.ux.secondsToHuman(w.get("status_time"))}var t=Ext.apply({time_in_state:n},w.data);p[0].down("#tabMapInfo").update(t);var r=q.getUrlPhotoBase()+w.get("photo_file_name");p[0].down("#tabMapPhoto").update({image:r})}s.infowindow.open(s.gmap,x)},dragStart:function(g,j,h){var i=this;i.lastMovedMarker=h;i.lastOrigPosition=h.getPosition();i.editWindow=j.editwindow},dragEnd:function(l,k,i){var j=this;var h=i.getPosition();k.new_lng=h.lng();k.new_lat=h.lat();k.editwindow.open(k.gmap,i);j.lastLng=h.lng();j.lastLat=h.lat();j.lastDragId=l.getId()},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapDelete(),method:"GET",params:{id:d.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},btnMapSave:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapSave(),method:"GET",params:{id:d.lastDragId,lat:d.lastLat,lon:d.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},mapPreferences:function(e){var h=this;if(!Ext.WindowManager.get("winMapPreferencesId")){var g=Ext.widget("winMapPreferences",{id:"winMapPreferencesId"});g.show();g.down("form").load({url:h.getUrlViewMapPref(),method:"GET"})}},mapNasAdd:function(e){var h=this;if(!Ext.WindowManager.get("winMapNasAddId")){var g=Ext.widget("winMapNasAdd",{id:"winMapNasAddId"});g.show()}},mapNasAddSubmit:function(t){var o=this;var r=t.up("window");var w=r.down("cmbNas");var x=w.getValue();var s=w.getStore().getById(x);r.close();var n=o.getGrid().up("tabpanel");var q=n.down("#mapTab");if(q!=null){var p=q.down("gmappanel");var y=p.gmap.getCenter();var u=p.addMarker({lat:y.lat(),lng:y.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){o.dragEnd(s,p,u)},dragstart:function(){p.addwindow.close();o.dragStart(s,p,u)}}});p.addwindow.open(p.gmap,u)}},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectNas")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectNas",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){console.log(y.getAt(G).serialize());A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteNas"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteNas"+m.getId(),noteForId:m.getId(),noteForGrid:"nas",noteForName:m.get("nasname")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteNasAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteNasAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteNasAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteNasAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},edit:function(h){var j=this;var i=h.up("gridNas");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(b,g){var p=i.up("tabpanel");var o=b.getId();var a="nasTab_"+o;var e=p.down("#"+a);if(e){p.setActiveTab(a);return}var d=b.get("nasname");p.add({title:d,itemId:a,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlNas",nas_id:o,url:j.getUrlEditPanelCfg(),record:b}});p.setActiveTab(a)})}},tabOpenVpnRender:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewOpenVpn(),method:"GET",params:{nas_id:h}})},tabOpenVpnActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewOpenVpn(),method:"GET",params:{nas_id:h}})},saveOpenVpn:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditOpenVpn(),params:{nas_id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabPptpActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewPptp(),method:"GET",params:{nas_id:h}})},savePptp:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditPptp(),params:{nas_id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabDynamicActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewDynamic(),method:"GET",params:{nas_id:h}})},saveDynamic:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditDynamic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabNasActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewNas(),method:"GET",params:{nas_id:h}})},tabAvailabilityActivate:function(e){var d=this;e.getStore().load()},pnlNasNasSave:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas");j.submit({clientValidation:true,url:i.getUrlEditNas(),params:{id:h.nas_id},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},monitorTypeChange:function(k){var n=this;var i=k.up("form");var m=i.down("#ping_interval");var j=i.down("#heartbeat_dead_after");var l=k.getValue();if(l=="off"){m.setVisible(false);j.setVisible(false)}if(l=="ping"){m.setVisible(true);j.setVisible(false)}if(l=="heartbeat"){m.setVisible(false);j.setVisible(true)}},chkAvailSubTab:function(g){var h=this;var e=g.up("gridRealmsForNasOwner");if(g.getValue()==true){e.getStore().getProxy().setExtraParam("available_to_siblings",true)}else{e.getStore().getProxy().setExtraParam("available_to_siblings",false)}e.getStore().getProxy().setExtraParam("clear_flag",true);e.getStore().load();e.getStore().getProxy().setExtraParam("clear_flag",false)},tabPhotoActivate:function(e){var h=this;var g=e.up("pnlNas");Ext.Ajax.request({url:h.getUrlViewPhoto(),method:"GET",params:{id:g.nas_id},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var j=e.down("cmpImg");var a=h.getUrlPhotoBase()+b.data.photo_file_name;j.setImage(a)}},scope:h})},photoSave:function(l){var j=this;var k=l.up("form");var i=k.up("pnlNas");var h=i.down("pnlNasPhoto");k.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:j.getUrlUploadPhoto(),params:{id:i.nas_id},success:function(d,b){if(b.result.success){var e=b.result.photo_file_name;var g=h.down("cmpImg");var a=j.getUrlPhotoBase()+e;g.setImage(a)}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},photoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},del:function(e){var h=this;var g=e.up("gridNas");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=h.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDelete(),method:"POST",jsonData:b,success:function(k,l){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.reload()}})}})}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("gridNas");var m=j.up("tabpanel");var l="mapTab";var k=m.down("#"+l);if(k){m.setActiveTab(l);return}var n=i18n("sGoogle_Maps");Ext.Ajax.request({url:o.getUrlViewMapPref(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){m.add({title:n,itemId:l,closable:true,iconCls:"map",glyph:Rd.config.icnMap,layout:"fit",items:{xtype:"pnlGMap",store:o.getStore("sNas"),mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[]}});m.setActiveTab(l)}},scope:o})},mapPreferencesSnapshot:function(r){var p=this;var t=r.up("form");var s=p.getPnlGMap();var l=s.gmap.getZoom();var o=s.gmap.getMapTypeId();var m=s.gmap.getCenter();var q=m.lat();var n=m.lng();t.down("#lat").setValue(q);t.down("#lng").setValue(n);t.down("#zoom").setValue(l);t.down("#type").setValue(o.toUpperCase())},mapPreferencesSave:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlEditMapPref(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridNasAvailabilityReload:function(e){var h=this;var g=e.up("gridNasAvailability");g.getStore().load()},tabRealmsActivate:function(g){var h=this;var e=g.down("gridRealmsForNasOwner");e.getStore().load()},gridNasAvailabilityDelete:function(e){var h=this;var g=e.up("gridNasAvailability");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},gridNasActionsReload:function(e){var h=this;var g=e.up("gridNasActions");g.getStore().load()},tabActionsActivate:function(e){var d=this;e.getStore().load()},gridNasActionsAdd:function(l){var k=this;var j=l.up("pnlNas");var m=l.up("gridNasActions");var n=j.nas_id;if(!Ext.WindowManager.get("winNasActionAddId")){var i=Ext.widget("winNasActionAdd",{id:"winNasActionAddId",nas_id:n,grid:m});i.show()}},gridNasActionsAddSubmit:function(h){var j=this;var g=h.up("form");var i=h.up("winNasActionAdd");g.submit({clientValidation:true,url:j.getUrlNasActionsAdd(),success:function(b,a){i.grid.getStore().load();i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridNasActionsDelete:function(e){var h=this;var g=e.up("gridNasActions");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="nasTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("nasname");console.log(l);n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlNasGraphs",nas_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;console.log("Reload hom");tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;console.log("Gooi hom");var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cNas"],0));(Ext.cmd.derive("Rd.view.openvpnServers.gridOpenvpnServers",Ext.grid.Panel,{multiSelect:true,store:"sOpenvpnServers",stateful:true,stateId:"StateGridOpenvpnServers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/openvpn_servers/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridOpenvpnServers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers4"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridOpenvpnServers5",tdCls:"gridTree"},{text:i18n("sLocal_slash_Remote"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="local_remote ==\'local\'"><div class="fieldGreen">'+i18n("sLocal")+"</div></tpl>",'<tpl if="local_remote ==\'remote\'"><div class="fieldBlue">'+i18n("sRemote")+"</div></tpl>"),dataIndex:"local_remote",stateId:"StateGridOpenvpnServers6",tdCls:"gridTree"},{text:"Protocol",dataIndex:"protocol",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers7",hidden:true},{text:"IP Address",dataIndex:"ip_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers8",hidden:false},{text:"Port",dataIndex:"port",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers9",hidden:false},{text:"Gateway IP",dataIndex:"vpn_gateway_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers10",hidden:true},{text:"Bridge Start IP",dataIndex:"vpn_bridge_start_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers11",hidden:true},{text:"Bridge Mask",dataIndex:"vpn_mask",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers12",hidden:true},{text:"Config Preset",dataIndex:"config_preset",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers13",hidden:true},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers14",hidden:true},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers15",hidden:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridOpenvpnServers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridOpenvpnServers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridOpenvpnServers:true},["widget.gridOpenvpnServers"],0,[Rd.view.openvpnServers,"gridOpenvpnServers"],0));(Ext.cmd.derive("Rd.model.mOpenvpnServer",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"local_remote",type:"string"},{name:"protocol",type:"string"},{name:"ip_address",type:"string"},{name:"port",type:"int"},{name:"vpn_gateway_address",type:"string"},{name:"vpn_bridge_start_address",type:"string"},{name:"vpn_mask",type:"string"},{name:"config_preset",type:"string"},{name:"ca_crt",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mOpenvpnServer"],0));(Ext.cmd.derive("Rd.view.openvpnServers.winOpenvpnServerEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit OpenVPN Server",width:450,height:500,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"General",layout:"anchor",itemId:"tabGeneral",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]},{title:"VPN Basic",layout:"anchor",itemId:"tabVpnBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Local/Remote",value:"local",name:"local_remote",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"local",name:"Local"},{id:"remote",name:"Remote"}]}},{xtype:"combobox",name:"protocol",value:"udp",fieldLabel:"Protocol",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"udp",name:"UDP"},{id:"tcp",name:"TCP"}]}},{xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"ip_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"port",fieldLabel:"Port",value:1194,maxValue:64000,minValue:1025,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"config_preset",value:"default",fieldLabel:"Config Preset",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"default",name:"Default"}]}}]},{title:"VPN IPs",layout:"anchor",itemId:"tabVpnIp",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Gateway IP",name:"vpn_gateway_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Start IP",name:"vpn_bridge_start_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Mask",name:"vpn_mask",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Certs etc",layout:"anchor",itemId:"tabVpnCerts",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textareafield",grow:true,fieldLabel:"ca.crt",name:"ca_crt",anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}]}]}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winOpenvpnServerEdit"],["component","box","container","panel","window","winOpenvpnServerEdit"],{component:true,box:true,container:true,panel:true,window:true,winOpenvpnServerEdit:true},["widget.winOpenvpnServerEdit"],0,[Rd.view.openvpnServers,"winOpenvpnServerEdit"],0));(Ext.cmd.derive("Rd.store.sOpenvpnServers",Ext.data.Store,{model:"Rd.model.mOpenvpnServer",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/openvpn_servers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/openvpn_servers/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sOpenvpnServers"],0));(Ext.cmd.derive("Rd.view.openvpnServers.winOpenvpnServerAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New OpenVPN Server",width:450,height:500,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"General",layout:"anchor",itemId:"tabGeneral",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]},{title:"VPN Basic",layout:"anchor",itemId:"tabVpnBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Local/Remote",value:"local",name:"local_remote",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"local",name:"Local"},{id:"remote",name:"Remote"}]}},{xtype:"combobox",name:"protocol",value:"udp",fieldLabel:"Protocol",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"udp",name:"UDP"},{id:"tcp",name:"TCP"}]}},{xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"ip_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"port",fieldLabel:"Port",value:1194,maxValue:64000,minValue:1025,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"config_preset",value:"default",fieldLabel:"Config Preset",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"default",name:"Default"}]}}]},{title:"VPN IPs",layout:"anchor",itemId:"tabVpnIp",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Gateway IP",name:"vpn_gateway_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Start IP",name:"vpn_bridge_start_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Mask",name:"vpn_mask",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Certs etc",layout:"anchor",itemId:"tabVpnCerts",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textareafield",grow:true,fieldLabel:"ca.crt",name:"ca_crt",anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}]}]}],buttons:g});return h}},0,["winOpenvpnServerAddWizard"],["component","box","container","panel","window","winOpenvpnServerAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winOpenvpnServerAddWizard:true},["widget.winOpenvpnServerAddWizard"],0,[Rd.view.openvpnServers,"winOpenvpnServerAddWizard"],0));(Ext.cmd.derive("Rd.controller.cOpenvpnServers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridOpenvpnServers",border:true,itemId:"tabOpenvpnServers",plain:true});d.populated=true},views:["openvpnServers.gridOpenvpnServers","openvpnServers.winOpenvpnServerEdit","openvpnServers.winOpenvpnServerAddWizard"],stores:["sAccessProvidersTree","sOpenvpnServers"],models:["mAccessProviderTree","mOpenvpnServer"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/openvpn_servers/export_csv",urlAdd:"/cake2/rd_cake/openvpn_servers/add.json",urlDelete:"/cake2/rd_cake/openvpn_servers/delete.json",urlEdit:"/cake2/rd_cake/openvpn_servers/edit.json"},refs:[{ref:"grid",selector:"gridOpenvpnServers"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabOpenvpnServers":{destroy:b.appClose},"gridOpenvpnServers #reload":{click:b.reload},"gridOpenvpnServers #add":{click:b.add},"gridOpenvpnServers #delete":{click:b.del},"gridOpenvpnServers #edit":{click:b.edit},gridOpenvpnServers:{select:b.select},"winOpenvpnServerAddWizard #btnTreeNext":{click:b.btnTreeNext},"winOpenvpnServerAddWizard #btnDataPrev":{click:b.btnDataPrev},"winOpenvpnServerAddWizard #btnDataNext":{click:b.btnDataNext},"winOpenvpnServerEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winOpenvpnServerAddWizardId")){var h=Ext.widget("winOpenvpnServerAddWizard",{id:"winOpenvpnServerAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winOpenvpnServerAddWizardId")){var h=Ext.widget("winOpenvpnServerAddWizard",{id:"winOpenvpnServerAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winOpenvpnServerAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winOpenvpnServerAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sOpenvpnServers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winOpenvpnServerEditId")){var i=Ext.widget("winOpenvpnServerEdit",{id:"winOpenvpnServerEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winOpenvpnServerEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreOpenvpnServersLoaded:function(){var d=this;var e=d.getStore("sOpenvpnServers").getTotalCount();d.getGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cOpenvpnServers"],0));(Ext.cmd.derive("Rd.view.password.frmPassword",Ext.form.Panel,{autoScroll:true,autoCreate:true,border:false,layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},buttons:[{itemId:"save",formBind:true,text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],initComponent:function(){var e=this;var g=new Date();var h=new Date();h.setDate(h.getDate()+7);e.items=[{xtype:"cmbPermanentUser",fieldLabel:i18n("sUsername")},{xtype:"displayfield",value:i18n("s_br_select_user_first_br"),fieldLabel:i18n("sCurrent_password"),fieldCls:"green_round",itemId:"currentPwd"},{xtype:"textfield",name:"password",fieldLabel:i18n("sNew_password"),allowBlank:false,minLength:4},{xtype:"checkbox",fieldLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:g},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:h}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmPassword"],["component","box","container","panel","form","frmPassword"],{component:true,box:true,container:true,panel:true,form:true,frmPassword:true},["widget.frmPassword"],0,[Rd.view.password,"frmPassword"],0));(Ext.cmd.derive("Rd.controller.cPassword",Ext.app.Controller,{actionIndex:function(){var e=this;if(!Ext.WindowManager.get("passwordWin")){var d=Ext.widget({xtype:"window",id:"passwordWin",title:"Password manager",width:600,height:450,resizable:true,iconCls:"rights",glyph:Rd.config.icnKey,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"passwordWin",items:[{region:"center",layout:{type:"hbox",align:"stretch"},margins:"0 0 0 0",border:false,items:[{flex:1,xtype:"frmPassword"}]}]});d.show()}},views:["password.frmPassword"],stores:[],models:["mPermanentUser"],selectedRecord:null,config:{urlGetPwd:"/cake3/rd_cake/permanent-users/view-password.json",urlChangePassword:"/cake3/rd_cake/permanent-users/change-password.json"},refs:[],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"frmPassword cmbPermanentUser":{change:b.userChanged},"frmPassword #always_active":{change:b.chkAlwaysActiveChange},"frmPassword #save":{click:b.changePasswordSubmit}})},userChanged:function(o){var q=this;var p=o.getValue();var r=o.up("form");var k=r.down("#currentPwd");var m=r.down("#from_date");var n=r.down("#to_date");var l=r.down("checkbox");Ext.Ajax.request({url:q.getUrlGetPwd(),method:"GET",params:{user_id:p},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){k.setValue(a.value);if((a.activate==false)&&(a.expire==false)){l.setValue(true)}else{n.setValue(a.expire);m.setValue(a.activate);l.setValue(false)}Ext.ux.Toaster.msg(i18n("sFetched password"),i18n("sPassword_fetched_for_selected_user"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:q})},changePasswordSubmit:function(j){var l=this;var m=j.up("window");var n=j.up("form");var k=n.down("cmbPermanentUser");var i={};i.user_id=k.getValue();m.setLoading(true);n.submit({clientValidation:true,url:l.getUrlChangePassword(),params:i,success:function(b,a){l.userChanged(k);m.setLoading(false);Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}}},0,0,0,0,0,0,[Rd.controller,"cPassword"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridPermanentUsers",Ext.grid.Panel,{multiSelect:true,store:"sPermanentUsers",stateful:true,stateId:"StateGridPermanentUsers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridPermanentUsers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers2",hidden:true},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers3"},{text:i18n("sAuth_type"),dataIndex:"auth_type",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers4",hidden:true},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridPermanentUsers5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridPermanentUsers6"},{text:i18n("sName"),flex:1,dataIndex:"name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers7"},{text:i18n("sSurname"),flex:1,dataIndex:"surname",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers8"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers9"},{text:i18n("s_email"),flex:1,dataIndex:"email",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers10"},{text:i18n("sAddress"),flex:1,dataIndex:"address",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers11"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridPermanentUsers12"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers13"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers14"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers15"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers16"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers17"},{header:i18n("sData_used"),hidden:true,dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_data_used");i.toggleCls("wifigreen",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridPermanentUsers18"},{header:i18n("sTime_used"),hidden:true,dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_time_used");i.toggleCls("wifired",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridPermanentUsers19"},{text:"Static IP",flex:1,dataIndex:"static_ip",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers20"},{text:"Extra name",flex:1,dataIndex:"extra_name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers21"},{text:"Extra value",flex:1,dataIndex:"extra_value",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers22"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridPermanentUsers23",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers24"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridPermanentUsers25"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPermanentUsers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPermanentUsers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPermanentUsers:true},["widget.gridPermanentUsers"],0,[Rd.view.permanentUsers,"gridPermanentUsers"],0));(Ext.cmd.derive("Rd.view.permanentUsers.pnlPermanentUser",Ext.tab.Panel,{border:false,pu_id:null,pu_name:null,record:null,plain:true,cls:"subTab",initComponent:function(){var g=this;var h=new Date();var j=new Date();j.setYear(j.getFullYear()+1);var i=g.record.get("owner_id");g.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:i},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:i},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"time_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"data_cap_type"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date("May 20, 2013 00:00:00"),hidden:true,disabled:true,value:h},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date("May 21, 2013 00:00:00"),hidden:true,disabled:true,value:j},{xtype:"textfield",fieldLabel:"Static IP",name:"static_ip",allowBlank:true},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.ap_id}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},{title:i18n("sPersonal_info"),layout:"hbox",itemId:"tabPersonalInfo",items:{xtype:"form",height:"100%",width:400,autoScroll:true,layout:"anchor",frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname",allowBlank:true},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",value:g.selLanguage,allowBlank:false,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},{title:i18n("sDevices"),layout:"fit",xtype:"gridUserDevices",user_id:g.pu_id,username:g.pu_name},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridUserPrivate",username:g.pu_name},{title:i18n("sAuthentication_data"),layout:"fit",xtype:"gridUserRadpostauths",username:g.pu_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridUserRadaccts",username:g.pu_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPermanentUser"],["component","box","container","panel","tabpanel","pnlPermanentUser"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPermanentUser:true},["widget.pnlPermanentUser"],0,[Rd.view.permanentUsers,"pnlPermanentUser"],0));(Ext.cmd.derive("Rd.view.permanentUsers.winPermanentUserAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_permanent_user"),width:500,height:550,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",selLanguage:null,initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];console.log(g.selLanguage);Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var l=this;var i=new Date();var k=new Date();k.setYear(k.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(l.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:15},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",cls:"subTab",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true},{xtype:"checkbox",boxLabel:"Create multiple users",name:"multiple",inputValue:"multiple",checked:false,cls:"lblRd",itemId:"multiple"},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:l.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:l.user_id},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:l.user_id},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"}]},{title:i18n("sPersonal_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname",allowBlank:true},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",value:l.selLanguage,allowBlank:false,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:i},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:k}]},{title:"SSIDs",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:l.user_id}]},{title:"Optional fields",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Static IP",name:"static_ip",allowBlank:true},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Auto-add device after authentication",name:"auto_add",inputValue:"auto_add",checked:false,cls:"lblRd",itemId:"auto_add"}]}]}],buttons:h});return j}},0,["winPermanentUserAddWizard"],["component","box","container","panel","window","winPermanentUserAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winPermanentUserAddWizard:true},["widget.winPermanentUserAddWizard"],0,[Rd.view.permanentUsers,"winPermanentUserAddWizard"],0));(Ext.cmd.derive("Rd.view.permanentUsers.pnlPermanentUserGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",pu_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.pu_name,type:"permanent"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.pu_name,type:"permanent"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.pu_name,type:"permanent"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPermanentUserGraphs"],["component","box","container","panel","tabpanel","pnlPermanentUserGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPermanentUserGraphs:true},["widget.pnlPermanentUserGraphs"],0,[Rd.view.permanentUsers,"pnlPermanentUserGraphs"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-accounting-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StateGridUserRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StateGridUserRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridUserRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridUserRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:100,remoteSort:true,proxy:{type:"ajax",keepRawData:true,format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(n,a,j){if(!j){Ext.ux.Toaster.msg("Error encountered",n.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var k=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#totals").update({"in":l,out:m,total:k})}},scope:this}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserRadaccts:true},["widget.gridUserRadaccts"],0,[Rd.view.permanentUsers,"gridUserRadaccts"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserRadpostauths",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-authentication-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths3"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridUserRadpostauths4"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths5"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadpostauths6"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadpostauth",buffered:false,leadingBufferZone:450,pageSize:150,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",extraParams:{username:b.username},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radpostauths/delete.json"},simpleSortMode:true},listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg("Error encountered",h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserRadpostauths:true},["widget.gridUserRadpostauths"],0,[Rd.view.permanentUsers,"gridUserRadpostauths"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserPrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserPrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridUserPrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridUserPrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridUserPrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridUserPrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridUserPrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/permanent-users/private-attr-add.json",read:"/cake3/rd_cake/permanent-users/private-attr-index.json",update:"/cake3/rd_cake/permanent-users/private-attr-edit.json",destroy:"/cake3/rd_cake/permanent-users/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserPrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserPrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserPrivate:true},["widget.gridUserPrivate"],0,[Rd.view.permanentUsers,"gridUserPrivate"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserDevices",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-user-devices.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadaccts1"},{text:i18n("sOwner"),dataIndex:"permanent_user",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts2"},{text:i18n("sMAC_address"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridUserRadaccts5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridUserRadaccts6"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean"},stateId:"StateGridUserRadaccts7"},{text:i18n("sLast_accept_time"),flex:1,dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,filter:{type:"date",dateFormat:"Y-m-d"}},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts8"},{text:i18n("sLast_reject_time"),flex:1,dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadaccts9"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts10"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts11"},{header:i18n("sData_used"),dataIndex:"perc_data_used",width:110,hidden:true,renderer:function(g,h,j){if(g!=null){var i=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:i,value:g/100,width:100,text:g+" %"})},50);return Ext.String.format('<div id="{0}"></div>',i)}else{return"N/A"}},stateId:"StateGridUserRadaccts12"},{header:i18n("sTime_used"),dataIndex:"perc_time_used",width:110,hidden:true,renderer:function(g,h,j){if(g!=null){var i=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:i,value:g/100,width:100,text:g+" %"})},50);return Ext.String.format('<div id="{0}"></div>',i)}else{return"N/A"}},stateId:"StateGridUserRadaccts13"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><div class=\"note\">"+i18n("sExisting_Notes")+"</div></tpl>"),dataIndex:"notes",stateId:"StateGridUserRadaccts14"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu+"?user_id="+b.user_id+"&username="+b.username});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDevice",pageSize:100,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",extraParams:{permanent_user_id:b.user_id},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserDevices:true},["widget.gridUserDevices"],0,[Rd.view.permanentUsers,"gridUserDevices"],0));(Ext.cmd.derive("Rd.view.components.cmbSsid",Ext.form.ComboBox,{fieldLabel:"SSIDs",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",allowBlank:false,multiSelect:true,mode:"local",name:"ssid_list[]",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/ssids/index-ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbSsid"],["component","box","field","textfield","pickerfield","combobox","combo","cmbSsid"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbSsid:true},["widget.cmbSsid"],0,[Rd.view.components,"cmbSsid"],0));(Ext.cmd.derive("Rd.controller.cPermanentUsers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabPermanentUsers",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridPermanentUsers",glyph:Rd.config.icnHome}]});d.populated=true},views:["permanentUsers.gridPermanentUsers","permanentUsers.winPermanentUserAddWizard","components.cmbRealm","components.cmbProfile","components.cmbCap","components.winNote","components.winNoteAdd","components.winCsvColumnSelect","permanentUsers.pnlPermanentUser","permanentUsers.gridUserRadaccts","permanentUsers.gridUserRadpostauths","permanentUsers.winPermanentUserPassword","components.winEnableDisable","permanentUsers.gridUserPrivate","components.cmbVendor","components.cmbAttribute","permanentUsers.gridUserDevices","components.pnlUsageGraph","components.cmbSsid","permanentUsers.pnlPermanentUserGraphs"],stores:["sLanguages","sAccessProvidersTree","sPermanentUsers","sRealms","sProfiles","sAttributes","sVendors"],models:["mAccessProviderTree","mPermanentUser","mRealm","mProfile","mUserStat","mRadacct","mRadpostauth","mAttribute","mVendor","mPrivateAttribute","mDevice"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/permanent-users/add.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/permanent-users/export-csv",urlNoteAdd:"/cake3/rd_cake/permanent-users/note-add.json",urlViewBasic:"/cake3/rd_cake/permanent-users/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/permanent-users/edit-basic-info.json",urlViewPersonal:"/cake3/rd_cake/permanent-users/view-personal-info.json",urlEditPersonal:"/cake3/rd_cake/permanent-users/edit-personal-info.json",urlEnableDisable:"/cake3/rd_cake/permanent-users/enable-disable.json",urlChangePassword:"/cake3/rd_cake/permanent-users/change-password.json",urlDelete:"/cake3/rd_cake/permanent-users/delete.json",urlDevicesListedOnly:"/cake3/rd_cake/permanent-users/restrict-list-of-devices.json",urlAutoAddMac:"/cake3/rd_cake/permanent-users/auto-mac-on-off.json",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridPermanentUsers"},{ref:"privateGrid",selector:"gridUserPrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabPermanentUsers":{destroy:b.appClose},"gridPermanentUsers #reload":{click:b.reload},"gridPermanentUsers #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridPermanentUsers #add":{click:b.add},"gridPermanentUsers #delete":{click:b.del},"gridPermanentUsers #edit":{click:b.edit},"gridPermanentUsers #note":{click:b.note},"gridPermanentUsers #csv":{click:b.csvExport},"gridPermanentUsers #password":{click:b.changePassword},"gridPermanentUsers #enable_disable":{click:b.enableDisable},"gridPermanentUsers #test_radius":{click:b.testRadius},"gridPermanentUsers #graph":{click:b.graph},gridPermanentUsers:{select:b.select,activate:b.gridActivate},"winPermanentUserAddWizard #btnTreeNext":{click:b.btnTreeNext},"winPermanentUserAddWizard #btnDataPrev":{click:b.btnDataPrev},"winPermanentUserAddWizard #btnDataNext":{click:b.btnDataNext},"winPermanentUserAddWizard #profile":{change:b.cmbProfileChange},"winPermanentUserAddWizard #always_active":{change:b.chkAlwaysActiveChange},"winPermanentUserAddWizard #to_date":{change:b.toDateChange},"winPermanentUserAddWizard #from_date":{change:b.fromDateChange},"winPermanentUserAddWizard #ssid_only":{change:b.chkSsidOnlyChange},"#winCsvColumnSelectPermanentUsers #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=permanentUsers] #reload":{click:b.noteReload},"gridNote[noteForGrid=permanentUsers] #add":{click:b.noteAdd},"gridNote[noteForGrid=permanentUsers] #delete":{click:b.noteDelete},"gridNote[noteForGrid=permanentUsers]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=permanentUsers] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=permanentUsers] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=permanentUsers] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlPermanentUser gridUserRadpostauths #reload":{click:b.gridUserRadpostauthsReload},"pnlPermanentUser gridUserRadpostauths #delete":{click:b.deletePostAuths},"pnlPermanentUser gridUserRadpostauths":{activate:b.gridActivate},"pnlPermanentUser gridUserRadaccts #reload":{click:b.gridUserRadacctsReload},"pnlPermanentUser gridUserRadaccts #delete":{click:b.deleteRadaccts},"pnlPermanentUser gridUserRadaccts":{activate:b.gridActivate},"pnlPermanentUser gridUserDevices":{activate:b.gridActivate},"pnlPermanentUser gridUserDevices #reload":{click:b.gridUserDevicesReload},"pnlPermanentUser gridUserDevices #chkListedOnly":{change:b.gridUserDevicesListedOnly},"pnlPermanentUser gridUserDevices #chkAutoAddMac":{change:b.gridUserDevicesAutoAddMac},"pnlPermanentUser gridUserPrivate":{select:b.selectUserPrivate,activate:b.gridActivate},"pnlPermanentUser #profile":{change:b.cmbProfileChange,render:b.renderEventProfile},"pnlPermanentUser #realm":{render:b.renderEventRealm},"pnlPermanentUser #always_active":{change:b.chkAlwaysActiveChange},"pnlPermanentUser #to_date":{change:b.toDateChange},"pnlPermanentUser #from_date":{change:b.fromDateChange},"pnlPermanentUser #ssid_only":{change:b.chkSsidOnlyChange},"pnlPermanentUser #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlPermanentUser #tabBasicInfo #save":{click:b.saveBasicInfo},"pnlPermanentUser #tabPersonalInfo":{activate:b.onTabPersonalInfoActive},"pnlPermanentUser #tabPersonalInfo #save":{click:b.savePersonalInfo},"#tabPermanentUsers pnlPermanentUserGraphs #daily":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #daily #day":{change:b.changeDailyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly #day":{change:b.changeMonthlyGraph},"#winEnableDisablePermanentUser #save":{click:b.enableDisableSubmit},"winPermanentUserPassword #save":{click:b.changePasswordSubmit},gridUserPrivate:{beforeedit:b.onBeforeEditUserPrivate},"gridUserPrivate  #cmbVendor":{change:b.cmbVendorChange},"gridUserPrivate  #add":{click:b.attrAdd},"gridUserPrivate  #reload":{click:b.attrReload},"gridUserPrivate  #delete":{click:b.attrDelete}})},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winPermanentUserAddWizardId")){var h=Ext.widget("winPermanentUserAddWizard",{id:"winPermanentUserAddWizardId",selLanguage:d.application.getSelLanguage()});h.show()}}else{if(!Ext.WindowManager.get("winPermanentUserAddWizardId")){var h=Ext.widget("winPermanentUserAddWizard",{id:"winPermanentUserAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,selLanguage:d.application.getSelLanguage()});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winPermanentUserAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#realm").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#realm").getStore().load();j.down("#profile").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#profile").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winPermanentUserAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(i){var l=this;var j=i.up("window");var h=j.down("form");var k=j.down("#multiple").getValue();h.submit({clientValidation:true,url:l.getUrlAdd(),success:function(b,a){if(k!=true){j.close()}l.getStore("sPermanentUsers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=j.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},cmbProfileChange:function(r){var p=this;var s=r.up("form");var q=s.down("#cmbDataCap");var t=s.down("#cmbTimeCap");var o=r.getValue();var m=r.getStore();var u=m.getById(o);if(u!=null){var n=u.get("data_cap_in_profile");if(n){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}var w=u.get("time_cap_in_profile");if(w){t.setVisible(true);t.setDisabled(false)}else{t.setVisible(false);t.setDisabled(true)}}},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}},toDateChange:function(k,l,j){var n=this;var d=k.up("form");var m=d.down("#from_date");if(l<=m.getValue()){Ext.ux.Toaster.msg(i18n("sEnd_date_wrong"),i18n("sThe_end_date_should_be_after_the_start_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},fromDateChange:function(k,l,d){var m=this;var n=k.up("form");var j=n.down("#to_date");if(l>=j.getValue()){Ext.ux.Toaster.msg(i18n("sStart_date_wrong"),i18n("sThe_start_date_should_be_before_the_end_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},chkSsidOnlyChange:function(i){var l=this;var h=i.up("form");var j=h.down("#ssid_list");var k=i.getValue();if(k){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}},select:function(q,k,m,r,n){var o=this;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false);tb.down("#password").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true);tb.down("#password").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var d=e.getId();var b="puTab_"+d;var n=a.down("#"+b);if(n){a.setActiveTab(b);return}var p=e.get("username");a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlPermanentUser",pu_id:d,pu_name:p,record:e}});a.setActiveTab(b)})}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});k.push({boxLabel:"Cleartext Password",name:"cleartext_password",checked:false});if(!Ext.WindowManager.get("winCsvColumnSelectPermanentUsers")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectPermanentUsers",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNotePermananetUsers"+m.getId())){var j=Ext.widget("winNote",{id:"winNotePermananetUsers"+m.getId(),noteForId:m.getId(),noteForGrid:"permanentUsers",noteForName:m.get("username")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNotePermananetUsersAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNotePermananetUsersAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNotePermananetUsersAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNotePermananetUsersAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPermanentUsersPassword"+j.getId())){var h=Ext.widget("winPermanentUserPassword",{id:"winPermanentUsersPassword"+j.getId(),user_id:j.getId(),username:j.get("username"),title:i18n("sChange_password_for")+" "+j.get("username")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.user_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisablePermanentUser")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisablePermanentUser"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestPermanent",j)}},gridUserRadpostauthsReload:function(g){var h=this;var e=g.up("gridUserRadpostauths");e.getStore().load()},gridUserDevicesReload:function(g){var h=this;var e=g.up("gridUserDevices");e.getStore().load()},gridUserRadacctsReload:function(g){var h=this;var e=g.up("gridUserRadaccts");e.getStore().load()},gridUserDevicesListedOnly:function(j){var n=this;var k=j.up("gridUserDevices").username;var m=j.up("gridUserDevices");var i=m.down("#chkAutoAddMac");var l=j.getValue();if(l){if(i.getValue()){console.log("Disable auto add check");i.setValue(false)}}Ext.Ajax.request({url:n.getUrlDevicesListedOnly(),method:"GET",params:{username:k,restrict:j.getValue()},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:n})},gridUserDevicesAutoAddMac:function(j){var n=this;var k=j.up("gridUserDevices").username;var m=j.up("gridUserDevices");var l=m.down("#chkListedOnly");var i=j.getValue();if(i){if(l.getValue()){console.log("Disable only listed check");l.setValue(false)}}Ext.Ajax.request({url:n.getUrlAutoAddMac(),method:"GET",params:{username:k,auto_mac:j.getValue()},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:n})},deletePostAuths:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeletePostAuths(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},onTabBasicInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlPermanentUser").pu_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{user_id:h},success:function(e,m){if(m.result.data.data_cap_type!=undefined){var a=j.down("#cmbDataCap");a.setVisible(true);a.setDisabled(false);a.setValue(m.result.data.data_cap_type)}if(m.result.data.time_cap_type!=undefined){var d=j.down("#cmbTimeCap");d.setVisible(true);d.setDisabled(false);d.setValue(m.result.data.time_cap_type)}if(m.result.data.ssid_list!=undefined){var b=j.down("#ssid_list");var n=[];b.getStore().loadData([],false);Ext.Array.forEach(m.result.data.ssid_list,function(k){var l=k.id;n.push(l);b.getStore().loadData([k],true)});b.setValue(n)}}})},saveBasicInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlPermanentUser").pu_id;j.submit({clientValidation:true,url:i.getUrlEditBasic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onTabPersonalInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlPermanentUser").pu_id;j.load({url:i.getUrlViewPersonal(),method:"GET",params:{user_id:h}})},savePersonalInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlPermanentUser").pu_id;j.submit({clientValidation:true,url:i.getUrlEditPersonal(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},selectUserPrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditUserPrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridUserPrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridUserPrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridUserPrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridUserPrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},renderEventRealm:function(k){var i=this;var m=k.up("pnlPermanentUser");m.cmbRealmRendered=true;if(m.record!=undefined){var n=m.record.get("realm");var j=m.record.get("realm_id");var l=Ext.create("Rd.model.mRealm",{name:n,id:j});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var i=this;var n=k.up("pnlPermanentUser");n.cmbProfileRendered=true;if(n.record!=undefined){var j=n.record.get("profile");var l=n.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="permanentUserTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("username");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlPermanentUserGraphs",pu_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cPermanentUsers"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicies",Ext.grid.Panel,{multiSelect:true,store:"sPolicies",stateful:true,stateId:"StateGridPol",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/policies/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridPol1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridPol3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridPol6",tdCls:"gridTree"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicies"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicies"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicies:true},["widget.gridPolicies"],0,[Rd.view.policies,"gridPolicies"],0));(Ext.cmd.derive("Rd.model.mPolicy",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPolicy"],0));(Ext.cmd.derive("Rd.model.mPolicyEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"type",type:"string"},{name:"name",type:"string"},{name:"schedule",type:"string"},{name:"schedule_id",type:"int"},{name:"filter_id",type:"int"},{name:"white_list_id",type:"int"},{name:"black_list_id",type:"int"},{name:"policy_id",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mPolicyEntry"],0));(Ext.cmd.derive("Rd.model.mGenericCombo",Ext.data.Model,{fields:["id","text"]},0,0,0,0,0,0,[Rd.model,"mGenericCombo"],0));(Ext.cmd.derive("Rd.view.policies.pnlPolicyDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",policy_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Policy Entries",layout:"fit",xtype:"gridPolicyEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPolicyDetail"],["component","box","container","panel","tabpanel","pnlPolicyDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPolicyDetail:true},["widget.pnlPolicyDetail"],0,[Rd.view.policies,"pnlPolicyDetail"],0));(Ext.cmd.derive("Rd.store.sPolicies",Ext.data.Store,{model:"Rd.model.mPolicy",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/policies/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sPolicies"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Policy",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winPolicyAddWizard"],["component","box","container","panel","window","winPolicyAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winPolicyAddWizard:true},["widget.winPolicyAddWizard"],0,[Rd.view.policies,"winPolicyAddWizard"],0));(Ext.cmd.derive("Rd.view.policies.vcPolicyEntry",Ext.app.ViewController,{init:function(){},onSelectedTypeChange:function(j){var n=this;var m=j.getValue();var o=j.up("form");var l=o.down("#cmbPolicyFilter");var p=o.down("#cmbPolicyWhiteList");var k=o.down("#cmbPolicyBlackList");if(m.type=="filter"){l.setHidden(false);l.setDisabled(false);p.setHidden(true);p.setDisabled(true);k.setHidden(true);k.setDisabled(true)}if(m.type=="white_list"){l.setHidden(true);l.setDisabled(true);p.setHidden(false);p.setDisabled(false);k.setHidden(true);k.setDisabled(true)}if(m.type=="black_list"){l.setHidden(true);l.setDisabled(true);p.setHidden(true);p.setDisabled(true);k.setHidden(false);k.setDisabled(false)}},onAfterEditRender:function(A){var z=this;var H=A.down("form");var I=A.record;var y=I.get("type");var s=H.down("#rgType");var D={type:y};s.setValue(D);var F=H.down("#cmbPolicySchedule");var x=H.down("#cmbPolicyFilter");var J=H.down("#cmbPolicyWhiteList");var r=H.down("#cmbPolicyBlackList");var w=I.get("schedule_id");var K=I.get("schedule");var B=Ext.create("Rd.model.mGenericCombo",{name:K,id:w});F.getStore().loadData([B],false);F.setValue(w);if(y=="filter"){var G=I.get("filter_id");var C=I.get("name");var E=Ext.create("Rd.model.mGenericCombo",{name:C,id:G});x.getStore().loadData([E],false);x.setValue(G)}}},0,0,0,0,["controller.vcPolicyEntry"],0,[Rd.view.policies,"vcPolicyEntry"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Schedule Entry",width:400,height:400,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},controller:"vcPolicyEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:15},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:3,vertical:false,items:[{boxLabel:"Filter",name:"type",inputValue:"filter",checked:true},{boxLabel:"White List",name:"type",inputValue:"white_list"},{boxLabel:"Black List",name:"type",inputValue:"black_list"}],listeners:{change:"onSelectedTypeChange"}},{xtype:"cmbPolicyGenericList",fieldLabel:"Filter",itemId:"cmbPolicyFilter",name:"filter_id",url:"/cake3/rd_cake/filters/index-for-list.json"},{xtype:"cmbPolicyGenericList",fieldLabel:"White List",itemId:"cmbPolicyWhiteList",name:"white_list_id",url:"/cake3/rd_cake/white-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Black List",itemId:"cmbPolicyBlackList",name:"black_list_id",url:"/cake3/rd_cake/black-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Schedule",itemId:"cmbPolicySchedule",name:"schedule_id",url:"/cake3/rd_cake/schedules/index-for-list.json"},{itemId:"policy_id",xtype:"textfield",name:"policy_id",hidden:true,value:e.policy_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEntryAdd"],["component","box","container","panel","window","winPolicyEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEntryAdd:true},["widget.winPolicyEntryAdd"],0,[Rd.view.policies,"winPolicyEntryAdd"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Policy Entry",width:400,height:400,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},listeners:{afterrender:"onAfterEditRender"},controller:"vcPolicyEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:15},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:3,vertical:false,itemId:"rgType",items:[{boxLabel:"Filter",name:"type",inputValue:"filter",checked:true},{boxLabel:"White List",name:"type",inputValue:"white_list"},{boxLabel:"Black List",name:"type",inputValue:"black_list"}],listeners:{change:"onSelectedTypeChange"}},{xtype:"cmbPolicyGenericList",fieldLabel:"Filter",itemId:"cmbPolicyFilter",name:"filter_id",url:"/cake3/rd_cake/filters/index-for-list.json"},{xtype:"cmbPolicyGenericList",fieldLabel:"White List",itemId:"cmbPolicyWhiteList",name:"white_list_id",url:"/cake3/rd_cake/white-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Black List",itemId:"cmbPolicyBlackList",name:"black_list_id",url:"/cake3/rd_cake/black-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Schedule",itemId:"cmbPolicySchedule",name:"schedule_id",url:"/cake3/rd_cake/schedules/index-for-list.json"},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEntryEdit"],["component","box","container","panel","window","winPolicyEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEntryEdit:true},["widget.winPolicyEntryEdit"],0,[Rd.view.policies,"winPolicyEntryEdit"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Policy",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEdit"],["component","box","container","panel","window","winPolicyEdit"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEdit:true},["widget.winPolicyEdit"],0,[Rd.view.policies,"winPolicyEdit"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicyEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"PE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/policies/menu-for-policy-entries.json",initComponent:function(){var e=this;var d=e.record.getId();e.columns=[{xtype:"rownumberer",stateId:"PE1"},{text:"Entry",dataIndex:"name",tdCls:"gridTree",flex:1,renderer:function(a,i,j){var b=j.get("type");if(b=="white_list"){return'<div class="fieldGreenWhite"><i class="fa  fa-check-circle"></i>  '+a+"</div>"}if(b=="black_list"){return'<div class="fieldGreyWhite"><i class="fa fa-ban"></i>  '+a+"</div>"}if(b=="filter"){return'<div class="fieldBlueWhite"><i class="fa fa-filter"></i>  '+a+"</div>"}return a},stateId:"PE2"},{text:"Schedule",dataIndex:"schedule",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"PE3"}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPolicyEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/policies/index-policy-entry.json",extraParams:{policy_id:d},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicyEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicyEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicyEntries:true},["widget.gridPolicyEntries"],0,[Rd.view.policies,"gridPolicyEntries"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicyGenericList",Ext.form.ComboBox,{labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:d.url,reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicyGenericList"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicyGenericList"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicyGenericList:true},["widget.cmbPolicyGenericList"],0,[Rd.view.policies,"cmbPolicyGenericList"],0));(Ext.cmd.derive("Rd.controller.cPolicies",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabPolicies",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridPolicies",glyph:Rd.config.icnHome}]});d.populated=true},views:["policies.gridPolicies","policies.winPolicyEdit","policies.winPolicyAddWizard","policies.pnlPolicyDetail","policies.gridPolicyEntries","policies.winPolicyEntryAdd","policies.winPolicyEntryEdit","policies.cmbPolicyGenericList"],stores:["sAccessProvidersTree","sPolicies"],models:["mAccessProviderTree","mPolicy","mPolicyEntry","mGenericCombo"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/policies/add.json",urlDelete:"/cake3/rd_cake/policies/delete.json",urlEdit:"/cake3/rd_cake/policies/edit.json",urlAddEntry:"/cake3/rd_cake/policies/add-policy-entry.json",urlEditEntry:"/cake3/rd_cake/policies/edit-policy-entry.json",urlDeleteEntry:"/cake3/rd_cake/policies/delete-policy-entry.json"},refs:[{ref:"grid",selector:"gridPolicies"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabPolicies":{destroy:b.appClose},"gridPolicies #reload":{click:b.reload},"gridPolicies #add":{click:b.add},"gridPolicies #delete":{click:b.del},"gridPolicies #edit":{click:b.edit},gridPolicies:{select:b.select},"winPolicyAddWizard #btnTreeNext":{click:b.btnTreeNext},"winPolicyAddWizard #btnDataPrev":{click:b.btnDataPrev},"winPolicyAddWizard #btnDataNext":{click:b.btnDataNext},"pnlPolicyDetail gridPolicyEntries":{activate:b.gridActivate},"#tabPolicies gridPolicies":{activate:b.gridActivate},"pnlPolicyDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridPolicyEntries #reload":{click:b.reloadEntries},"gridPolicyEntries #add":{click:b.addEntry},"gridPolicyEntries #edit":{click:b.editEntry},"gridPolicyEntries #delete":{click:b.deleteEntry},"winPolicyEntryAdd  #save":{click:b.savePolicyEntryAdd},"winPolicyEntryEdit  #save":{click:b.savePolicyEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winPolicyAddWizardId")){var h=Ext.widget("winPolicyAddWizard",{id:"winPolicyAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winPolicyAddWizardId")){var h=Ext.widget("winPolicyAddWizard",{id:"winPolicyAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winPolicyAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winPolicyAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sPolicies").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(n,p){var a=i.getGrid().up("tabpanel");var b=n.getId();var d="pTab_"+b;var o=a.down("#"+d);if(o){a.setActiveTab(d);return}var e=n.get("name");a.add({title:e,itemId:d,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlPolicyDetail",policy_id:b,record:n}});a.setActiveTab(d)})}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlPolicyDetail").policy_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winPolicyEntryAdd"+k)){var j=Ext.widget("winPolicyEntryAdd",{id:"winPolicyEntryAdd"+k,policy_id:k,store:i});j.show()}},savePolicyEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winPolicyEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPolicyEntryEditId")){var j=Ext.widget("winPolicyEntryEdit",{id:"winPolicyEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},savePolicyEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winPolicyEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cPolicies"],0));(Ext.cmd.derive("Rd.view.profileComponents.gridProfileComponents",Ext.grid.Panel,{multiSelect:true,store:"sProfileComponents",stateful:true,stateId:"StateGridProfileComponents",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/profile_components/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridProfileComponents1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridProfileComponents2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridProfileComponents3"},{text:i18n("sCheck_attribute_count"),dataIndex:"check_attribute_count",tdCls:"gridTree",flex:1,stateId:"StateGridProfileComponents4"},{text:i18n("sReply_attribute_count"),dataIndex:"reply_attribute_count",tdCls:"gridTree",flex:1,stateId:"StateGridProfileComponents5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridProfileComponents6"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridProfileComponents7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfileComponents"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfileComponents"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfileComponents:true},["widget.gridProfileComponents"],0,[Rd.view.profileComponents,"gridProfileComponents"],0));(Ext.cmd.derive("Rd.model.mProfileComponent",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"check_attribute_count",type:"int"},{name:"reply_attribute_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mProfileComponent"],0));(Ext.cmd.derive("Rd.model.mProfileComponentEdit",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"type",type:"string"},{name:"groupname",type:"string"},{name:"attribute",type:"string"},{name:"op",type:"string"},{name:"value",type:"string"},{name:"comment",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mProfileComponentEdit"],0));(Ext.cmd.derive("Rd.view.profileComponents.gridProfileComponent",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridProfileComponent",stateEvents:["groupclick","columnhide"],border:false,comp_id:null,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mProfileComponentEdit",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{comp_id:b.comp_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake2/rd_cake/profile_components/add_comp.json",read:"/cake2/rd_cake/profile_components/index_comp.json",update:"/cake2/rd_cake/profile_components/edit_comp.json",destroy:"/cake2/rd_cake/profile_components/delete_comp.json"}},listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg("Error encountered",h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:true,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridProfileComponent1"},{header:i18n("sType"),dataIndex:"type",width:130,tdCls:"grdEditable",editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridProfileComponent2"},{text:i18n("sAttribute_name"),dataIndex:"attribute",tdCls:"gridMain",flex:1,stateId:"StateGridProfileComponent3"},{header:i18n("sOperator"),dataIndex:"op",width:100,tdCls:"grdEditable",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"},stateId:"StateGridProfileComponent4"},{text:i18n("sValue"),dataIndex:"value",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridProfileComponent5"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:true},stateId:"StateGridProfileComponent6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfileComponent"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfileComponent"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfileComponent:true},["widget.gridProfileComponent"],0,[Rd.view.profileComponents,"gridProfileComponent"],0));(Ext.cmd.derive("Rd.store.sProfileComponents",Ext.data.Store,{model:"Rd.model.mProfileComponent",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/profile_components/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/profile_components/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sProfileComponents"],0));(Ext.cmd.derive("Rd.view.profileComponents.winProfileComponentAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_profile_component"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winProfileComponentAddWizard"],["component","box","container","panel","window","winProfileComponentAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winProfileComponentAddWizard:true},["widget.winProfileComponentAddWizard"],0,[Rd.view.profileComponents,"winProfileComponentAddWizard"],0));(Ext.cmd.derive("Rd.controller.cProfileComponents",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabProfileComponents",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridProfileComponents",glyph:Rd.config.icnHome}]});d.populated=true},views:["profileComponents.gridProfileComponents","profileComponents.winProfileComponentAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","profileComponents.gridProfileComponent","components.cmbVendor","components.cmbAttribute"],stores:["sProfileComponents","sAccessProvidersTree","sAttributes","sVendors"],models:["mProfileComponent","mAccessProviderTree","mAttribute","mVendor","mProfileComponentEdit"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/profile_components/add.json",urlEdit:"/cake2/rd_cake/profile_components/edit.json",urlDelete:"/cake2/rd_cake/profile_components/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/profile_components/export_csv",urlNoteAdd:"/cake2/rd_cake/profile_components/note_add.json"},refs:[{ref:"grid",selector:"gridProfileComponents"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabProfileComponents":{destroy:b.appClose},"gridProfileComponents #reload":{click:b.reload},"gridProfileComponents #add":{click:b.add},"gridProfileComponents #delete":{click:b.del},"gridProfileComponents #edit":{click:b.edit},"gridProfileComponents #note":{click:b.note},"gridProfileComponents #csv":{click:b.csvExport},gridProfileComponents:{select:b.select},"winProfileComponentAddWizard #btnTreeNext":{click:b.btnTreeNext},"winProfileComponentAddWizard #btnDataPrev":{click:b.btnDataPrev},"winProfileComponentAddWizard #btnDataNext":{click:b.btnDataNext},"#winCsvColumnSelectProfileComponents #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=profile_components] #reload":{click:b.noteReload},"gridNote[noteForGrid=profile_components] #add":{click:b.noteAdd},"gridNote[noteForGrid=profile_components] #delete":{click:b.noteDelete},"gridNote[noteForGrid=profile_components]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=profile_components] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=profile_components] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=profile_components] #btnNoteAddNext":{click:b.btnNoteAddNext},"gridProfileComponent  #cmbVendor":{change:b.cmbVendorChange},"gridProfileComponent  #add":{click:b.attrAdd},"gridProfileComponent  #reload":{click:b.attrReload},"gridProfileComponent  #delete":{click:b.attrDelete}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winProfileComponentAddWizardId")){var h=Ext.widget("winProfileComponentAddWizard",{id:"winProfileComponentAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winProfileComponentAddWizardId")){var h=Ext.widget("winProfileComponentAddWizard",{id:"winProfileComponentAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winProfileComponentAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winProfileComponentAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sProfileComponents").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){console.log("Edit node");var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var b=e.getId();var p="compTab_"+b;var n=a.down("#"+p);if(n){a.setActiveTab(p);return}var d=e.get("name");a.add({title:d,itemId:p,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"gridProfileComponent",comp_id:b}});a.setActiveTab(p)})}},onStoreProfileComponentsLoaded:function(){var d=this;var e=d.getStore("sProfileComponents").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectProfileComponents")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectProfileComponents",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteProfileComponents"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteProfileComponents"+m.getId(),noteForId:m.getId(),noteForGrid:"profile_components",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteProfileComponentsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfileComponentsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteProfileComponentsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfileComponentsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},cmbVendorChange:function(j){var l=this;console.log("Combo thing changed");var k=j.getValue();var h=j.up("gridProfileComponent");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;console.log("Add to specific template");var m=n.up("gridProfileComponent");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mProfileComponentEdit",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value")}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridProfileComponent");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridProfileComponent");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cProfileComponents"],0));(Ext.cmd.derive("Rd.view.profiles.gridProfiles",Ext.grid.Panel,{multiSelect:true,store:"sProfiles",stateful:true,stateId:"StateGridProfiles",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/profiles/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridProfiles1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridProfiles2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridProfiles3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate('<tpl if=\'available_to_siblings == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'available_to_siblings == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridProfiles4"},{text:i18n("sProfile_components"),sortable:false,flex:1,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(profile_components)"><div"></div></tpl>','<tpl for="profile_components">','<div class="fieldGreyWhite">{groupname} <small><i>(priority => {priority})</i></small></div>',"</tpl>"),dataIndex:"profile_components",stateId:"StateGridProfiles5"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridProfiles6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfiles"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfiles"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfiles:true},["widget.gridProfiles"],0,[Rd.view.profiles,"gridProfiles"],0));(Ext.cmd.derive("Rd.view.profiles.winComponentManage",Ext.window.Window,{title:i18n("sEdit_profile"),layout:"fit",autoShow:false,width:450,height:410,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:i18n("sAdd_component"),name:"rb",inputValue:"add",checked:true},{boxLabel:i18n("sRemove_component"),name:"rb",inputValue:"remove"},{boxLabel:i18n("sAvailable_to_sub_providers"),name:"rb",inputValue:"sub"},{boxLabel:i18n("sPrivate"),name:"rb",inputValue:"no_sub"}]},{xtype:"combo",fieldLabel:i18n("sProfile_component"),store:"sProfileComponents",queryMode:"local",editable:false,allowBlank:false,disabled:false,name:"component_id",displayField:"name",valueField:"id"},{xtype:"numberfield",anchor:"100%",name:"priority",fieldLabel:"Priority <br><small><i>(Higher takes priority)</i></small>",value:5,maxValue:5,minValue:1,itemId:"priority"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winComponentManage"],["component","box","container","panel","window","winComponentManage"],{component:true,box:true,container:true,panel:true,window:true,winComponentManage:true},["widget.winComponentManage"],0,[Rd.view.profiles,"winComponentManage"],0));(Ext.cmd.derive("Rd.view.profiles.winProfileAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_profile"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winProfileAddWizard"],["component","box","container","panel","window","winProfileAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winProfileAddWizard:true},["widget.winProfileAddWizard"],0,[Rd.view.profiles,"winProfileAddWizard"],0));(Ext.cmd.derive("Rd.controller.cProfiles",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridProfiles",border:true,itemId:"tabProfiles",plain:true});d.populated=true},views:["profiles.gridProfiles","profiles.winProfileAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","profiles.winComponentManage"],stores:["sProfiles","sAccessProvidersTree","sProfileComponents"],models:["mProfile","mAccessProviderTree"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/profiles/add.json",urlDelete:"/cake3/rd_cake/profiles/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/profiles/export-csv",urlNoteAdd:"/cake3/rd_cake/profiles/note_add.json",urlManageComponents:"/cake3/rd_cake/profiles/manage-components.json"},refs:[{ref:"grid",selector:"gridProfiles"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabProfiles":{destroy:b.appClose},"gridProfiles #reload":{click:b.reload},"gridProfiles #add":{click:b.add},"gridProfiles #delete":{click:b.del},"gridProfiles #edit":{click:b.edit},"gridProfiles #note":{click:b.note},"gridProfiles #csv":{click:b.csvExport},gridProfiles:{select:b.select},"winProfileAddWizard #btnTreeNext":{click:b.btnTreeNext},"winProfileAddWizard #btnDataPrev":{click:b.btnDataPrev},"winProfileAddWizard #btnDataNext":{click:b.btnDataNext},"#winCsvColumnSelectProfiles #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=profiles] #reload":{click:b.noteReload},"gridNote[noteForGrid=profiles] #add":{click:b.noteAdd},"gridNote[noteForGrid=profiles] #delete":{click:b.noteDelete},"gridNote[noteForGrid=profiles]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=profiles] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=profiles] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=profiles] #btnNoteAddNext":{click:b.btnNoteAddNext},"winComponentManage #save":{click:b.btnComponentManageSave},"winComponentManage radiogroup":{change:b.radioComponentManage}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winProfileAddWizardId")){var h=Ext.widget("winProfileAddWizard",{id:"winProfileAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winProfileAddWizardId")){var h=Ext.widget("winProfileAddWizard",{id:"winProfileAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winProfileAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winProfileAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sProfiles").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winComponentManageId")){var h=Ext.widget("winComponentManage",{id:"winComponentManageId"});h.show()}}},radioComponentManage:function(j){var l=this;var h=j.up("form");var k=h.down("combo");var i=h.down("numberfield");if((j.getValue().rb=="add")||(j.getValue().rb=="remove")){k.setVisible(true);k.setDisabled(false)}else{k.setVisible(false);k.setDisabled(true)}if(j.getValue().rb=="add"){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},btnComponentManageSave:function(l){var p=this;var o=l.up("window");var q=o.down("form");var n=q.down("combo");var m=q.down("radiogroup");if((m.getValue().rb=="add")||(m.getValue().rb=="remove")){if(n.getValue()==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sSelect_a_component_to_add_or_remove"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}var r={};var k=p.getGrid().getSelectionModel().getSelection();Ext.Array.each(k,function(b){var a=b.getId();r[a]=a});q.submit({clientValidation:true,url:p.getUrlManageComponents(),params:r,success:function(b,a){o.close();p.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sProfiles_modified"),i18n("sProfiles_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectProfiles")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectProfiles",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteProfiles"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteProfiles"+m.getId(),noteForId:m.getId(),noteForGrid:"profiles",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cProfiles"],0));(Ext.cmd.derive("Rd.view.radiusClient.cmbRequestType",Ext.form.ComboBox,{fieldLabel:i18n("sRequest_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"request_type",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"auth",text:i18n("sAuthentication")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbRequestType"],["component","box","field","textfield","pickerfield","combobox","combo","cmbRequestType"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbRequestType:true},["widget.cmbRequestType"],0,[Rd.view.radiusClient,"cmbRequestType"],0));(Ext.cmd.derive("Rd.view.radiusClient.cmbUserType",Ext.form.ComboBox,{fieldLabel:i18n("sUser_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"user_type",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"voucher",text:i18n("sVoucher")},{id:"permanent",text:i18n("sPermanent_user")},{id:"device",text:i18n("sDevice")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbUserType"],["component","box","field","textfield","pickerfield","combobox","combo","cmbUserType"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbUserType:true},["widget.cmbUserType"],0,[Rd.view.radiusClient,"cmbUserType"],0));(Ext.cmd.derive("Rd.view.components.cmbDevice",Ext.form.ComboBox,{fieldLabel:"Device",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"device_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mDevice",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDevice"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDevice"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDevice:true},["widget.cmbDevice"],0,[Rd.view.components,"cmbDevice"],0));(Ext.cmd.derive("Rd.view.components.cmbVoucher",Ext.form.ComboBox,{fieldLabel:i18n("sVoucher"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"voucher_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mVoucher",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/vouchers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbVoucher"],["component","box","field","textfield","pickerfield","combobox","combo","cmbVoucher"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbVoucher:true},["widget.cmbVoucher"],0,[Rd.view.components,"cmbVoucher"],0));(Ext.cmd.derive("Rd.view.radiusClient.frmRadiusRequest",Ext.form.Panel,{autoScroll:true,autoCreate:true,frame:true,layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},buttons:[{itemId:"send",formBind:true,text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],initComponent:function(){var b=this;b.items=[{xtype:"cmbRequestType",value:"auth"},{xtype:"cmbUserType",value:"permanent"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sUsername")},{xtype:"cmbDevice",hidden:true,disabled:true},{xtype:"cmbVoucher",hidden:true,disabled:true}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmRadiusRequest"],["component","box","container","panel","form","frmRadiusRequest"],{component:true,box:true,container:true,panel:true,form:true,frmRadiusRequest:true},["widget.frmRadiusRequest"],0,[Rd.view.radiusClient,"frmRadiusRequest"],0));(Ext.cmd.derive("Rd.view.radiusClient.pnlRadiusReply",Ext.form.Panel,{autoScroll:true,autoCreate:true,frame:true,initComponent:function(){var b=this;b.tpl=new Ext.XTemplate("<div class='blue_round'>","<h1>"+i18n("sRequest_Attributes")+"</h1>","<ul>",'<tpl for="send">',"<li>{.}</li>","</tpl>","</ul>","</div>","<tpl if='failed'>","<div class='red_round'>","<tpl else>","<div class='green_round'>","</tpl>","<h1>"+i18n("sReply_Attributes")+"</h1>","<ul>",'<tpl for="received">',"<li>{.}</li>","</tpl>","</ul>","</div>");Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRadiusReply"],["component","box","container","panel","form","pnlRadiusReply"],{component:true,box:true,container:true,panel:true,form:true,pnlRadiusReply:true},["widget.pnlRadiusReply"],0,[Rd.view.radiusClient,"pnlRadiusReply"],0));(Ext.cmd.derive("Rd.model.mVoucher",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"user_id",type:"int"},{name:"realm",type:"string"},{name:"realm_id"},{name:"profile",type:"string"},{name:"profile_id"},"name","password",{name:"batch",type:"string"},"perc_time_used","perc_data_used",{name:"status",type:"string"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage",{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mVoucher"],0));(Ext.cmd.derive("Rd.controller.cRadiusClient",Ext.app.Controller,{cmbVRendered:false,vRecord:undefined,cmbPuRendered:false,puRecord:undefined,cmbDRendered:false,dRecord:undefined,views:["radiusClient.frmRadiusRequest","radiusClient.pnlRadiusReply"],stores:[],models:["mPermanentUser","mDevice","mVoucher"],config:{urlRequest:"/cake2/rd_cake/free_radius/test_radius.json"},refs:[{ref:"cmbVoucher",selector:"cmbVoucher"},{ref:"cmbPermanent",selector:"cmbPermanentUser"},{ref:"cmbDevice",selector:"cmbDevice"},{ref:"cmbUserType",selector:"cmbUserType"},{ref:"pnlRadiusReply",selector:"pnlRadiusReply"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"frmRadiusRequest cmbUserType":{change:b.userTypeChange},"frmRadiusRequest cmbPermanentUser":{afterrender:b.renderEventPu},"frmRadiusRequest cmbDevice":{afterrender:b.renderEventD},"frmRadiusRequest cmbVoucher":{afterrender:b.renderEventV},"frmRadiusRequest #send":{click:b.submitRequest},"#radiusClientWin":{destroy:b.onDestroy}})},actionIndex:function(){var e=this;if(!Ext.WindowManager.get("radiusClientWin")){var d=Ext.widget("window",{id:"radiusClientWin",title:i18n("sRADIUS_client"),width:700,height:450,glyph:Rd.config.icnRadius,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"radiusClientWin",items:[{region:"center",layout:{type:"hbox",align:"stretch"},margins:"0 0 0 0",border:false,items:[{title:i18n("sRequest"),flex:1,xtype:"frmRadiusRequest",ui:"light",glyph:Rd.config.icnQuestion,margin:5},{title:i18n("sReply"),flex:1,xtype:"pnlRadiusReply",ui:"light",glyph:Rd.config.icnBullhorn,margin:5}]}]});d.show()}},actionTestVoucher:function(e){var d=this;d.vRecord=e;if(d.cmbVRendered==true){console.log("Combo already rendered... set it");d.getCmbUserType().setValue("voucher");d.getCmbVoucher().getStore().loadData([d.vRecord],false);d.getCmbVoucher().setValue(d.vRecord.getId())}d.actionIndex()},actionTestPermanent:function(d){var e=this;e.puRecord=d;if(e.cmbPuRendered==true){console.log("Combo already rendered... set it");e.getCmbUserType().setValue("permanent");e.getCmbPermanent().getStore().loadData([e.puRecord],false);e.getCmbPermanent().setValue(e.puRecord.getId())}e.actionIndex()},actionTestDevice:function(e){var d=this;d.dRecord=e;if(d.cmbDRendered==true){console.log("Combo already rendered... set it");d.getCmbUserType().setValue("device");d.getCmbDevice().getStore().loadData([d.dRecord],false);d.getCmbDevice().setValue(d.dRecord.getId())}d.actionIndex()},renderEventV:function(d){var e=this;e.cmbVRendered=true;if(e.vRecord!=undefined){console.log("Voucher detail present first time combo render");e.getCmbUserType().setValue("voucher");e.getCmbVoucher().getStore().loadData([e.vRecord],false);e.getCmbVoucher().setValue(e.vRecord.getId())}},renderEventPu:function(d){var e=this;e.cmbPuRendered=true;if(e.puRecord!=undefined){console.log("Permanent detail present first time combo render");e.getCmbUserType().setValue("permanent");e.getCmbPermanent().getStore().loadData([e.puRecord],false);e.getCmbPermanent().setValue(e.puRecord.getId())}},renderEventD:function(d){var e=this;e.cmbDRendered=true;if(e.dRecord!=undefined){console.log("Permanent detail present first time combo render");e.getCmbUserType().setValue("device");e.getCmbDevice().getStore().loadData([e.dRecord],false);e.getCmbDevice().setValue(e.dRecord.getId())}},onDestroy:function(e){var d=this;d.puRecord=undefined;d.cmbPuRendered=false;d.dRecord=undefined;d.cmbDRendered=false;d.vRecord=undefined;d.cmbVRendered=false},userTypeChange:function(l,k,p){var o=this;var n=l.up("form").down("cmbPermanentUser");var m=l.up("form").down("cmbDevice");var d=l.up("form").down("cmbVoucher");if(k=="voucher"){d.setVisible(true);d.setDisabled(false);m.setVisible(false);m.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if(k=="device"){m.setVisible(true);m.setDisabled(false);d.setVisible(false);d.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if(k=="permanent"){n.setVisible(true);n.setDisabled(false);d.setVisible(false);d.setDisabled(true);m.setVisible(false);m.setDisabled(true)}},submitRequest:function(b){me=this;var e=b.up("form");me.getPnlRadiusReply().setLoading(true,true);e.submit({clientValidation:true,url:me.getUrlRequest(),success:function(j,d,k,a){me.getPnlRadiusReply().setLoading(false);me.getPnlRadiusReply().update(d.result.data);console.log(d.result)},failure:function(a,d){me.getPnlRadiusReply().setLoading(false);console.log(a);console.log(d)}})}},0,0,0,0,0,0,[Rd.controller,"cRadiusClient"],0));(Ext.cmd.derive("Rd.view.realms.gridRealms",Ext.grid.Panel,{multiSelect:true,store:"sRealms",stateful:true,stateId:"StateGridRealms",stateEvents:["groupclick","columnhide"],border:false,urlMenu:"/cake3/rd_cake/realms/menu-for-grid.json",plugins:"gridfilters",viewConfig:{loadMask:true},bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridRealms1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRealms2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridRealms3"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms4"},{text:i18n("sFax"),dataIndex:"fax",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms5"},{text:i18n("sCell"),dataIndex:"cell",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms6"},{text:i18n("s_email"),dataIndex:"email",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms7"},{text:i18n("sURL"),dataIndex:"url",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms8"},{text:"Twitter",dataIndex:"twitter",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR9"},{text:"Facebook",dataIndex:"facebook",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR10"},{text:"Youtube",dataIndex:"youtube",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR11"},{text:"Google+",dataIndex:"google_plus",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR12"},{text:"LinkedIn",dataIndex:"linkedin",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR13"},{text:"T&C Title",dataIndex:"t_c_title",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR14"},{text:"T&C Content",dataIndex:"t_c_content",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR15"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean"},stateId:"StateGR16"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGR17",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGR18"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGR19"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealms"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealms"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealms:true},["widget.gridRealms"],0,[Rd.view.realms,"gridRealms"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmDetail",Ext.panel.Panel,{border:false,realm_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sSuffix"),name:"suffix",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",regex:/^[\w\-_\.]+$/,regexText:"Only words, underscores, dashes and full stops allowed"},{xtype:"checkbox",boxLabel:i18n("sAdd_suffix_when_creating_Permanent_Users"),name:"suffix_permanent_users",inputValue:"suffix_permanent_users",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAdd_suffix_when_creating_Vouchers"),name:"suffix_vouchers",inputValue:"suffix_vouchers",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Add suffix when creating BYOD",name:"suffix_devices",inputValue:"suffix_devices",checked:false,cls:"lblRd"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]},{title:"Social media",layout:"anchor",itemId:"tabSocial",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:"Twitter",name:"twitter",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Facebook",name:"facebook",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Youtube",name:"youtube",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Google+",name:"google_plus",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"LinkedIn",name:"linkedin",allowBlank:true,vtype:"url"}]},{title:"T&C",layout:"anchor",itemId:"tabTandC",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:"Title",name:"t_c_title",allowBlank:true},{xtype:"textareafield",grow:true,name:"t_c_content",allowBlank:true,fieldLabel:"Content",anchor:"100%"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmDetail"],["component","box","container","panel","pnlRealmDetail"],{component:true,box:true,container:true,panel:true,pnlRealmDetail:true},["widget.pnlRealmDetail"],0,[Rd.view.realms,"pnlRealmDetail"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmLogo",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var d=this;var e=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='Realm logo'>","</div>"]);d.items={xtype:"panel",frame:false,padding:5,height:"100%",width:450,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:i18n("sCurrent_logo"),flex:1,border:false,itemId:"pnlImg",tpl:e,data:{img:d.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmLogo"],["component","box","container","panel","pnlRealmLogo"],{component:true,box:true,container:true,panel:true,pnlRealmLogo:true},["widget.pnlRealmLogo"],0,[Rd.view.realms,"pnlRealmLogo"],0));(Ext.cmd.derive("Rd.view.realms.frmDetail",Ext.form.Panel,{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",owner:"",user_id:"",no_tree:false,initComponent:function(){var d=this;var e=[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}];if(d.no_tree){e=[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}d.buttons=e;d.items=[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:d.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:d.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"fieldset",title:i18n("sOptional_Info"),collapsible:true,border:false,collapsed:true,defaults:{anchor:"100%"},items:[{xtype:"displayfield",fieldLabel:i18n("sContact_detail"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sAddress"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sLocation"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",allowBlank:true}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmRealmDetail"],["component","box","container","panel","form","frmRealmDetail"],{component:true,box:true,container:true,panel:true,form:true,frmRealmDetail:true},["widget.frmRealmDetail"],0,[Rd.view.realms,"frmDetail"],0));(Ext.cmd.derive("Rd.view.realms.winRealmAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_realm"),width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",owner:"",user_id:"",no_tree:false,defaults:{border:false},initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var d=this;var e=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return e},mkScrnRealmDetail:function(){me=this;var b=Ext.create("Rd.view.realms.frmDetail",{itemId:"scrnRealmDetail",user_id:me.user_id,owner:me.owner,no_tree:true});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]}]}]});return d}},0,["winRealmAddWizard"],["component","box","container","panel","window","winRealmAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winRealmAddWizard:true},["widget.winRealmAddWizard"],0,[Rd.view.realms,"winRealmAddWizard"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.realm_id,type:"realm"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmGraphs"],["component","box","container","panel","tabpanel","pnlRealmGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlRealmGraphs:true},["widget.pnlRealmGraphs"],0,[Rd.view.realms,"pnlRealmGraphs"],0));(Ext.cmd.derive("Rd.view.realms.winRealmAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_realm"),width:300,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winRealmAdd"],["component","box","container","panel","window","winRealmAdd"],{component:true,box:true,container:true,panel:true,window:true,winRealmAdd:true},["widget.winRealmAdd"],0,[Rd.view.realms,"winRealmAdd"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealm",Ext.tab.Panel,{border:false,realm_id:null,plain:true,initComponent:function(){var b=this;b.items=[{title:i18n("sDetail"),xtype:"pnlRealmDetail",itemId:"tabDetail"},{title:i18n("sLogo"),itemId:"tabLogo",xtype:"pnlRealmLogo"},{title:i18n("sUsage_graphs"),layout:"fit",xtype:"tabpanel",itemId:"pnlUsageGraphs",margins:"0 0 0 0",plain:true,border:true,tabPosition:"bottom",items:[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.realm_id,type:"realm"}]}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealm"],["component","box","container","panel","tabpanel","pnlRealm"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlRealm:true},["widget.pnlRealm"],0,[Rd.view.realms,"pnlRealm"],0));(Ext.cmd.derive("Rd.controller.cRealms",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabRealms",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridRealms",glyph:Rd.config.icnHome}]});d.populated=true},views:["realms.gridRealms","realms.winRealmAddWizard","realms.winRealmAdd","realms.pnlRealm","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","realms.pnlRealmDetail","realms.pnlRealmLogo","components.pnlUsageGraph","realms.pnlRealmGraphs"],stores:["sRealms","sAccessProvidersTree"],models:["mRealm","mAccessProviderTree","mUserStat"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/realms/add.json",urlEdit:"/cake3/rd_cake/realms/edit.json",urlDelete:"/cake3/rd_cake/realms/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/realms/export-csv",urlNoteAdd:"/cake3/rd_cake/realms/note-add.json",urlViewRealmDetail:"/cake3/rd_cake/realms/view.json",urlLogoBase:"/cake3/rd_cake/img/realms/",urlUploadLogo:"/cake3/rd_cake/realms/upload-logo/"},refs:[{ref:"gridRealms",selector:"gridRealms"},{ref:"gridAdvancedRealms",selector:"gridAdvancedRealms"},{ref:"grid",selector:"gridRealms"}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({"#tabRealms":{destroy:me.appClose},"gridRealms #reload":{click:me.reload},"gridRealms #add":{click:me.add},"gridRealms #delete":{click:me.del},"gridRealms #edit":{click:me.edit},"gridRealms #note":{click:me.note},"gridRealms #csv":{click:me.csvExport},"gridRealms #logo":{click:me.logo},"gridRealms #graph":{click:me.graph},gridRealms:{itemclick:me.gridClick},"winRealmAddWizard #btnTreeNext":{click:me.btnTreeNext},"winRealmAddWizard #btnRealmDetailPrev":{click:me.btnRealmDetailPrev},"winRealmAddWizard #save":{click:me.addSubmit},"#tabRealms pnlRealmDetail #save":{click:me.editSubmit},"#winCsvColumnSelectRealms #save":{click:me.csvExportSubmit},"gridNote[noteForGrid=realms] #reload":{click:me.noteReload},"gridNote[noteForGrid=realms] #add":{click:me.noteAdd},"gridNote[noteForGrid=realms] #delete":{click:me.noteDelete},"gridNote[noteForGrid=realms]":{itemclick:me.gridNoteClick},"winNoteAdd[noteForGrid=realms] #btnTreeNext":{click:me.btnNoteTreeNext},"winNoteAdd[noteForGrid=realms] #btnNoteAddPrev":{click:me.btnNoteAddPrev},"winNoteAdd[noteForGrid=realms] #btnNoteAddNext":{click:me.btnNoteAddNext},"#tabRealms pnlRealmDetail":{activate:me.tabDetailActivate},"#tabRealms pnlRealmLogo":{activate:me.tabLogoActivate},"#tabRealms pnlRealmLogo #save":{click:me.logoSave},"#tabRealms pnlRealmLogo #cancel":{click:me.logoCancel},"#tabRealms pnlRealmGraphs #daily":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #daily #reload":{click:me.reloadDailyGraph},"#tabRealms pnlRealmGraphs #daily #day":{change:me.changeDailyGraph},"#tabRealms pnlRealmGraphs #weekly":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #weekly #reload":{click:me.reloadWeeklyGraph},"#tabRealms pnlRealmGraphs #weekly #day":{change:me.changeWeeklyGraph},"#tabRealms pnlRealmGraphs #monthly":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #monthly #reload":{click:me.reloadMonthlyGraph},"#tabRealms pnlRealmGraphs #monthly #day":{change:me.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winApAddWizardId")){var h=Ext.widget("winRealmAddWizard",{id:"winRealmAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winApAddWizardId")){var h=Ext.widget("winRealmAddWizard",{id:"winRealmAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winRealmAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnRealmDetailPrev:function(g){var e=this;var h=g.up("winRealmAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sRealms").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},del:function(e){var d=this;if(d.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var h=d.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(h,function(j){var g=j.getId();Ext.Array.push(b,{id:g})});Ext.Ajax.request({url:d.getUrlDelete(),method:"POST",jsonData:b,success:function(g,j){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);d.reload()},failure:function(g,j){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);d.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=o.selectedRecord.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlRealmDetail",realm_id:m});n.setActiveTab(l)}},editSubmit:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.getStore("sRealms").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectRealms")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectRealms",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteRealms"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteRealms"+m.getId(),noteForId:m.getId(),noteForGrid:"realms",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteRealmsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteRealmsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteRealmsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteRealmsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(h){var j=this;var g=h.down("form");var i=h.realm_id;g.load({url:j.getUrlViewRealmDetail(),method:"GET",params:{realm_id:i}})},logo:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTabLogo_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=o.selectedRecord.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnCamera,xtype:"pnlRealmLogo",realm_id:m});n.setActiveTab(l)}},tabLogoActivate:function(g){var j=this;var i=g.realm_id;var h=g.down("#pnlImg");Ext.Ajax.request({url:j.getUrlViewRealmDetail(),method:"GET",params:{realm_id:i},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=j.getUrlLogoBase()+b.data.icon_file_name;h.update({image:a})}},scope:j})},logoSave:function(n){var l=this;var m=n.up("form");var k=m.up("pnlRealmLogo");var i=m.up("panel");var j=i.down("#pnlImg");m.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:l.getUrlUploadLogo(),params:{id:k.realm_id},success:function(d,b){if(b.result.success){var e=b.result.icon_file_name;var a=l.getUrlLogoBase()+e;j.update({image:a})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},logoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlRealmGraphs",realm_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cRealms"],0));(Ext.cmd.derive("Rd.view.schedules.gridSchedules",Ext.grid.Panel,{multiSelect:true,store:"sSchedules",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/schedules/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridSch1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridSch3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSch6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridSchedules"],["component","box","container","panel","tablepanel","gridpanel","grid","gridSchedules"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridSchedules:true},["widget.gridSchedules"],0,[Rd.view.schedules,"gridSchedules"],0));(Ext.cmd.derive("Rd.model.mSchedule",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mSchedule"],0));(Ext.cmd.derive("Rd.model.mScheduleEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"every_day",type:"bool"},{name:"monday",type:"bool"},{name:"tuesday",type:"bool"},{name:"wednesday",type:"bool"},{name:"thursday",type:"bool"},{name:"friday",type:"bool"},{name:"saturday",type:"bool"},{name:"sunday",type:"bool"},{name:"always",type:"bool"},{name:"start",type:"int"},{name:"stop",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mScheduleEntry"],0));(Ext.cmd.derive("Rd.view.schedules.pnlScheduleDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",schedule_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Schedule Entries",layout:"fit",xtype:"gridScheduleEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlScheduleDetail"],["component","box","container","panel","tabpanel","pnlScheduleDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlScheduleDetail:true},["widget.pnlScheduleDetail"],0,[Rd.view.schedules,"pnlScheduleDetail"],0));(Ext.cmd.derive("Rd.store.sSchedules",Ext.data.Store,{model:"Rd.model.mSchedule",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sSchedules"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Schedule",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winScheduleAddWizard"],["component","box","container","panel","window","winScheduleAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winScheduleAddWizard:true},["widget.winScheduleAddWizard"],0,[Rd.view.schedules,"winScheduleAddWizard"],0));(Ext.cmd.derive("Rd.view.schedules.vcScheduleEntry",Ext.app.ViewController,{init:function(){},onSelectedDaysChange:function(i){var l=this;var k=i.getValue();var h=i.up("form");var j=h.down("#chkGrpWeekDays");if(k.selected_days=="every_day"){j.disable()}if(k.selected_days=="specific_days"){j.enable()}},onSelectedTimeChange:function(j){var m=this;var l=j.getValue();var n=j.up("form");var k=n.down("#slideTime");var i=n.down("#cmpTimeDisplay");if(l.time_slot=="always"){k.disable();i.hide(true)}if(l.time_slot=="specific_time"){k.enable();i.show(true)}},onTimeSlideChange:function(t,u,w){var n=this;var s=t.up("form");var m=s.down("#cmpTimeDisplay");var q=n.timeFormat(u);if(w.index==0){var p=m.getData();var r=p.stop_time;m.setData({start_time:q,stop_time:r})}if(w.index==1){var p=m.getData();var o=p.start_time;m.setData({start_time:o,stop_time:q})}},onAfterEditRender:function(z){var y=this;var E=z.down("form");var G=z.record;var s=E.down("#rgDay");var B=E.down("#rgTime");var r=E.down("#chkGrpWeekDays");var A=E.down("multislider");var w=G.get("every_day");if(w){var D={selected_days:"every_day"};s.setValue(D)}else{var D={selected_days:"specific_days"};s.setValue(D);var u=[];var t=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];t.forEach(function(b,e,a){var d=G.get(b);if(d){u.push(b)}});r.setValue({"weekday[]":u})}var C=G.get("always");if(C){var D={time_slot:"always"};B.setValue(D)}else{var D={time_slot:"specific_time"};B.setValue(D);var F=G.get("start");var x=G.get("stop");A.setValue([F,x])}},onTipText:function(g){var h=this;var e=h.timeFormat(g.value);return Ext.String.format("<b>{0}</b>",e)},timeFormat:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,0,0,0,["controller.vcScheduleEntry"],0,[Rd.view.schedules,"vcScheduleEntry"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Schedule Entry",width:600,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},controller:"vcScheduleEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:"Every Day",name:"selected_days",inputValue:"every_day",checked:true},{boxLabel:"Selected Days",name:"selected_days",inputValue:"specific_days"}],listeners:{change:"onSelectedDaysChange"}},{xtype:"checkboxgroup",columns:4,vertical:false,itemId:"chkGrpWeekDays",items:[{boxLabel:"Monday",name:"weekday[]",inputValue:"monday",checked:true},{boxLabel:"Tuesday",name:"weekday[]",inputValue:"tuesday",checked:true},{boxLabel:"Wednesday",name:"weekday[]",inputValue:"wednesday",checked:true},{boxLabel:"Thursday",name:"weekday[]",inputValue:"thursday",checked:true},{boxLabel:"Friday",name:"weekday[]",inputValue:"friday",checked:true},{boxLabel:"Saturday",name:"weekday[]",inputValue:"saturday"},{boxLabel:"Sunday",name:"weekday[]",inputValue:"sunday"}],disabled:true},{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:"Always",name:"time_slot",inputValue:"always",checked:true},{boxLabel:"Specific Time Slot",name:"time_slot",inputValue:"specific_time"}],listeners:{change:"onSelectedTimeChange"}},{xtype:"multislider",width:500,itemId:"slideTime",values:[0,1440],increment:5,minValue:0,maxValue:1440,constrainThumbs:true,fieldLabel:"Time Slot",disabled:true,useTips:true,html:"<h1>Gooi Hom</h1>",name:"start_and_stop[]",listeners:{change:"onTimeSlideChange"},tipText:"onTipText"},{xtype:"component",itemId:"cmpTimeDisplay",hidden:true,tpl:'<div class="fieldBlue"><b>Start Time:</b> {start_time} <b>Stop Time:</b> {stop_time}</div>',data:{start_time:"00:00",stop_time:"24:00"}},{itemId:"schedule_id",xtype:"textfield",name:"schedule_id",hidden:true,value:e.schedule_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winScheduleEntryAdd"],["component","box","container","panel","window","winScheduleEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winScheduleEntryAdd:true},["widget.winScheduleEntryAdd"],0,[Rd.view.schedules,"winScheduleEntryAdd"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Schedule Entry",width:600,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},controller:"vcScheduleEntry",listeners:{afterrender:"onAfterEditRender"},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:2,vertical:false,itemId:"rgDay",items:[{boxLabel:"Every Day",name:"selected_days",inputValue:"every_day",checked:true},{boxLabel:"Selected Days",name:"selected_days",inputValue:"specific_days"}],listeners:{change:"onSelectedDaysChange"}},{xtype:"checkboxgroup",columns:4,vertical:false,itemId:"chkGrpWeekDays",items:[{boxLabel:"Monday",name:"weekday[]",inputValue:"monday",checked:true},{boxLabel:"Tuesday",name:"weekday[]",inputValue:"tuesday",checked:true},{boxLabel:"Wednesday",name:"weekday[]",inputValue:"wednesday",checked:true},{boxLabel:"Thursday",name:"weekday[]",inputValue:"thursday",checked:true},{boxLabel:"Friday",name:"weekday[]",inputValue:"friday",checked:true},{boxLabel:"Saturday",name:"weekday[]",inputValue:"saturday"},{boxLabel:"Sunday",name:"weekday[]",inputValue:"sunday"}],disabled:true},{xtype:"radiogroup",columns:2,vertical:false,itemId:"rgTime",items:[{boxLabel:"Always",name:"time_slot",inputValue:"always",checked:true},{boxLabel:"Specific Time Slot",name:"time_slot",inputValue:"specific_time"}],listeners:{change:"onSelectedTimeChange"}},{xtype:"multislider",width:500,itemId:"slideTime",values:[0,1440],increment:5,minValue:0,maxValue:1440,constrainThumbs:true,fieldLabel:"Time Slot",disabled:true,useTips:false,name:"start_and_stop[]",listeners:{change:"onTimeSlideChange"}},{xtype:"component",itemId:"cmpTimeDisplay",hidden:true,tpl:'<div class="fieldBlue"><b>Start Time:</b> {start_time} <b>Stop Time:</b> {stop_time}</div>',data:{start_time:"00:00",stop_time:"24:00"}},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winScheduleEntryEdit"],["component","box","container","panel","window","winScheduleEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winScheduleEntryEdit:true},["widget.winScheduleEntryEdit"],0,[Rd.view.schedules,"winScheduleEntryEdit"],0));(Ext.cmd.derive("Rd.view.schedules.gridScheduleEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/schedules/menu-for-schedule-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"SSE1"},{text:"Everyday",dataIndex:"every_day",tdCls:"gridTree",flex:1,stateId:"SSE2",xtype:"templatecolumn",hidden:true,tpl:new Ext.XTemplate("<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='every_day == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>")},{text:"Monday",dataIndex:"monday",tdCls:"gridTree",flex:1,stateId:"SSE3",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='monday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='monday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Tuesday",dataIndex:"tuesday",tdCls:"gridTree",flex:1,stateId:"SSE4",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='tuesday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='tuesday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Wednesday",dataIndex:"wednesday",tdCls:"gridTree",flex:1,stateId:"SSE5",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='wednesday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='wednesday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Thursday",dataIndex:"thursday",tdCls:"gridTree",flex:1,stateId:"SSE6",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='thursday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='thursday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Friday",dataIndex:"friday",tdCls:"gridTree",flex:1,stateId:"SSE7",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='friday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='friday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Saturday",dataIndex:"saturday",tdCls:"gridTree",flex:1,stateId:"SSE8",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='saturday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='saturday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Sunday",dataIndex:"sunday",tdCls:"gridTree",flex:1,stateId:"SSE9",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='sunday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='sunday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Start",dataIndex:"start",tdCls:"gridTree",flex:1,renderer:function(a,b,i){var j=i.get("always");if(j){return'<div class="fieldGreen"> (ALWAYS) </div>'}else{return'<div class="fieldBlue"> '+d.convertMinutesToTime(a)+"</div>"}},stateId:"SSE10"},{text:"Stop",dataIndex:"stop",tdCls:"gridTree",flex:1,renderer:function(a,b,i){var j=i.get("always");if(j){return'<div class="fieldGreen"> (ALWAYS) </div>'}else{return'<div class="fieldBlue"> '+d.convertMinutesToTime(a)+"</div>"}},stateId:"SSE11"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mScheduleEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index-schedule-entry.json",extraParams:{schedule_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridScheduleEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridScheduleEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridScheduleEntries:true},["widget.gridScheduleEntries"],0,[Rd.view.schedules,"gridScheduleEntries"],0));(Ext.cmd.derive("Rd.controller.cSchedules",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabSchedules",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridSchedules",glyph:Rd.config.icnHome}]});d.populated=true},views:["schedules.gridSchedules","schedules.winScheduleAddWizard","schedules.pnlScheduleDetail","schedules.gridScheduleEntries","schedules.winScheduleEntryAdd","schedules.winScheduleEntryEdit"],stores:["sAccessProvidersTree","sSchedules"],models:["mAccessProviderTree","mSchedule","mScheduleEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/schedules/add.json",urlDelete:"/cake3/rd_cake/schedules/delete.json",urlEdit:"/cake3/rd_cake/schedules/edit.json",urlAddEntry:"/cake3/rd_cake/schedules/add-schedule-entry.json",urlEditEntry:"/cake3/rd_cake/schedules/edit-schedule-entry.json",urlDeleteEntry:"/cake3/rd_cake/schedules/delete-schedule-entry.json"},refs:[{ref:"grid",selector:"gridSchedules"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabSchedules":{destroy:b.appClose},"gridSchedules #reload":{click:b.reload},"gridSchedules #add":{click:b.add},"gridSchedules #delete":{click:b.del},"gridSchedules #edit":{click:b.edit},gridSchedules:{select:b.select},"winScheduleAddWizard #btnTreeNext":{click:b.btnTreeNext},"winScheduleAddWizard #btnDataPrev":{click:b.btnDataPrev},"winScheduleAddWizard #btnDataNext":{click:b.btnDataNext},"winScheduleEdit #save":{click:b.btnEditSave},"pnlScheduleDetail gridScheduleEntries":{activate:b.gridActivate},"#tabSchedules gridSchedules":{activate:b.gridActivate},"pnlScheduleDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridScheduleEntries #reload":{click:b.reloadEntries},"gridScheduleEntries #add":{click:b.addEntry},"gridScheduleEntries #edit":{click:b.editEntry},"gridScheduleEntries #delete":{click:b.deleteEntry},"winScheduleEntryAdd  #save":{click:b.saveScheduleEntryAdd},"winScheduleEntryEdit  #save":{click:b.saveScheduleEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winScheduleAddWizardId")){var h=Ext.widget("winScheduleAddWizard",{id:"winScheduleAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winScheduleAddWizardId")){var h=Ext.widget("winScheduleAddWizard",{id:"winScheduleAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winScheduleAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winScheduleAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sSchedules").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="scheduleTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlScheduleDetail",schedule_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlScheduleDetail").schedule_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winScheduleEntryAdd",{id:"winScheduleEntryAdd"+k,schedule_id:k,store:i});j.show()}},saveScheduleEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winScheduleEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winScheduleEntryEditId")){var j=Ext.widget("winScheduleEntryEdit",{id:"winScheduleEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveScheduleEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winScheduleEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cSchedules"],0));(Ext.cmd.derive("Rd.view.wizard.vcWizardNewSite",Ext.app.ViewController,{config:{urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json",urlOneSubmit:"/cake2/rd_cake/wizards/new_site_step_one.json",urlTwoSubmit:"/cake2/rd_cake/wizards/new_site_step_two.json",urlViewDynamicDetail:"/cake2/rd_cake/wizards/view_logo.json",urlLogoBase:"/cake3/rd_cake/img/dynamic_details/",urlUploadLogo:"/cake2/rd_cake/wizards/upload_logo/",UrlPnlTwo:"/cake2/rd_cake/wizards/view_country_and_timezone.json",UrlChangeTheme:"/cake2/rd_cake/wizards/change_theme.json",UrlPreviewMobile:"/cake3/rd_cake/dynamic-details/preview-chilli-mobile",UrlPreviewDesktop:"/cake3/rd_cake/dynamic-details/preview-chilli-desktop",infoOne:'            <h2>Step 1 What does the Setup Wizard do?</h2>            <b>Step 1</b> contains the basic information needed to create an account.            When the wizard is complete you can simply add Access Points to your  account and you are good to go!            <p>            <font color="green"><big><b>Signing up a new business or property should take no longer than 5 minutes!</b></big>!</font>            </p>            <p>            <big><b>The wizard creates the following items automatically so you don\u2019t have to. The default values work out of the box but if you require something different you can always edit these items later.</b></big><br>            Let\u2019s assume you sign up a hotel called <big><b>The Hilton</b></big>. Then the following items will be created.            <ul>            <li><b>Operator</b> called <b>the_hilton</b> with password as <b>designated</b></li>            <li><b>Realm</b> called <b>The Hilton</b>.</li>            <li><b>Dynamic RADIUS Client</b> called <b>The Hilton</b>.</li>            <li><b>Dynamic Logn Page</b> called <b>The Hilton</b>.</li>            <li><b>Access Point Profile</b> called <b>The Hilton</b> (APdesk).</li>                <ul>                <li>Open SSID callled <b>The Hilton Guest</b> that has a login page (Captive Portal).</li>                <li>Secure SSID called <b>The Hilton Wireless</b> that is bridged to the LAN.</li>                </ul>            <li><b>Mesh network</b> called <b>The Hilton</b> (MESHdesk).</li>                <ul>                <li>Open SSID callled <b>The Hilton Guest</b> that has a login page (Captive Portal).</li>                <li>Secure SSID called <b>The Hilton Wireless</b> that is bridged to the LAN.</li>                </ul>            <li><b>Permanent User</b> called <b>the_hilton</b> with password as <b>designated</b></li>            <li><b>Permanent User</b> called <b>click_to_connect@the_hilton</b> with password <b>click_to_connect</b>.</li>            </ul>            </p>        ',infoTwo:'            <h2>Step 2 Location and Customer Options</h2>            <big><font color="green"><b>Here specify the location and decide how the customers access your Hotspot.</big></b></font><br>            Select one or more            <p>            <big><b>Vouchers</big></b><br>            Select this option if your require your customers to use an easy to remember voucher.            This option is for situations where customers are not likely to be regulars.            </p>            <p>            <big><b>Permanent Users</big></b><br>            Permanent users will use a username and password combination. Emails can be used as a username.            Permanent users are normally allowed where a customer will regularly use your hotspot.            Permanent user can self register if this option is configured on the login page.            </p>            <p>            <big><b>Click-To-Connect</big></b><br>            Allows customers to connect by just accepting terms and conditions.            </p>        ',infoThree:"            <h2>Step 3 Branding</h2>            <p>            Here you can upload a Logo to brand your account.<br>            A .png or .jpg file with a height of 100px is recommended.<br>            The width can vary from 100px to 200px.            </p>        ",infoFour:'            <h2>Step 4 Login Page Customisation</h2>            <p>            Here you can upload images that will appear on your login page.            We recommend .png or .jpeg format with file sizes of 400Kb or less each.            </p>            <p>            The first image will be the background image on your login page.            </p>            <p>            The first image and subsequent images will also appear in the gallery application which is built into the login page.            </p>            <p>            <big><b><font color="green">When you press Finish the wizard will be complete.            We recommend you follow the simple setup checklist available here to complete your account setup.</font></b></big>            </p>        ',infoFive:'            <h2>Step 5 Select a Theme</h2>            <p>            Here you can upload images that will appear on your login page.            We recommend .png or .jpeg format with file sizes of 400Kb or less each.            </p>            <p>            The first image will be the background image on your login page.            </p>            <p>            The first image and subsequent images will also appear in the gallery application which is built into the login page.            </p>            <p>            <big><b><font color="green">When you press Finish the wizard will be complete.            We recommend you follow the simple setup checklist available here to complete your account setup.</font></b></big>            </p>        ',realmId:undefined,dynamicDetailId:undefined},init:function(){var b=this},onTxtNameChange:function(n){var l=this;var k=n.up("form");var m=k.down("#ssid_guest");var j=k.down("#ssid_wireless");var g=n.getValue().trim();if(g==""){m.setValue("Guest");j.setValue("Wireless")}else{m.setValue(g+" Guest");j.setValue(g+" Wireless")}},onPnlInfoAfterrender:function(d){var e=this;d.setHtml(e.getInfoOne())},onBtnOneNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoTwo());i.setLoading(true);i.submit({clientValidation:true,url:k.getUrlOneSubmit(),success:function(a,d){i.setLoading(false);n.step_one_done=true;Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.setActiveItem(l.getLayout().getNext())},failure:function(){i.setLoading(false);Ext.ux.formFail}})},onBtnCancelClick:function(b){var g=this;var h=b.up("window");h.close()},onBtnTwoNextClick:function(i){var n=this;var s=i.up("#pnlCardNewSite");var b=i.up("window");var r=b.down("#pnlInfo");var q=i.up("form");var t=b.down("#txtName");var w=t.getValue();var u=b.down("#txtPassword");var p=u.getValue();r.setHtml(n.getInfoThree());q.setLoading(true);q.submit({clientValidation:true,url:n.getUrlTwoSubmit(),params:{name:w,password:p},success:function(a,d){q.setLoading(false);Ext.ux.Toaster.msg("User type adjustments made","User type adjustments completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);s.setActiveItem(s.getLayout().getNext())},failure:function(){q.setLoading(false);Ext.ux.formFail}})},pnlTwoActivate:function(e){var d=this;e.load({url:d.getUrlPnlTwo(),method:"GET"})},onBtnThreeNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoFour());l.setActiveItem(l.getLayout().getNext())},pnlThreeActivate:function(m){var l=this;var j=m.up("window");var k=j.down("#txtName");var i=k.getValue();var n=m.down("#pnlImg");Ext.Ajax.request({url:l.getUrlViewDynamicDetail(),method:"GET",params:{name:i},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=l.getUrlLogoBase()+b.data.icon_file_name;n.update({image:a})}},scope:l})},onBtnLogoSaveClick:function(o){var n=this;var r=o.up("form");var t=r.up("pnlDynamicDetail");var p=r.up("panel");var l=p.down("#pnlImg");var m=o.up("window");var q=m.down("#txtName");var s=q.getValue();r.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:n.getUrlUploadLogo(),params:{name:s},success:function(a,e){if(e.result.success){var b=e.result.icon_file_name;var d=n.getUrlLogoBase()+b;l.update({image:d})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},pnlFourActivate:function(l){var k=this;var i=l.up("window");var j=i.down("#txtName");var h=j.getValue();l.up("window").down("#dvPhotos").getStore().getProxy().setExtraParam("name",h);l.up("window").down("#dvPhotos").getStore().load()},onBtnPhotoReloadClick:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();b.up("window").down("#dvPhotos").getStore().getProxy().setExtraParam("name",k);b.up("window").down("#dvPhotos").getStore().load()},onBtnPhotoAddClick:function(b){var k=this;var m=b.up("window");var j=m.down("#txtName");var l=j.getValue();var n=b.up("window").down("#dvPhotos");if(!Rd.getApplication().runAction("cDesktop","AlreadyExist","winWizardPhotoAddId")){var m=Ext.widget("winWizardPhotoAdd",{id:"winWizardPhotoAddId",new_name:l,data_view:n});Rd.getApplication().runAction("cDesktop","Add",m)}},onBtnPhotoDeleteClick:function(b){console.log("Delete Click")},onBtnFourNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoFive());l.setActiveItem(l.getLayout().getNext())},onCmbThemesChange:function(l){var m=this;var n=l.getValue();var j=l.up("window");var k=j.down("#txtName");var i=k.getValue();Ext.Ajax.request({url:m.getUrlChangeTheme(),method:"POST",params:{name:i,theme:n},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg("Theme changed","Theme changed fine - Try the Preview",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:m})},previewMobile:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();window.open(j.getUrlPreviewMobile()+"?wizard_name="+k)},previewDesktop:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();window.open(j.getUrlPreviewDesktop()+"?wizard_name="+k)},onBtnFiveNextClick:function(b){var g=b.up("#pnlCardNewSite");var h=b.up("window");h.step_one_done=false;h.close()}},0,0,0,0,["controller.vcWizardNewSite"],0,[Rd.view.wizard,"vcWizardNewSite"],0));(Ext.cmd.derive("Rd.view.wizard.pnlWizardNewSite",Ext.panel.Panel,{border:false,layout:"border",controller:"vcWizardNewSite",initComponent:function(){var i=this;var h=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='DynamicDetail logo'>","</div>"]);var j=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap">',"<div>",'<img src="{img}" />',"</div>","</div>","</tpl>");i.store=Ext.create(Ext.data.Store,{fields:["id","img"],proxy:{type:"ajax",url:"/cake2/rd_cake/wizards/index_photo.json",format:"json",reader:{keepRawData:true,type:"json",rootProperty:"items"},api:{destroy:"/cake2/rd_cake/wizards/delete_photo.json"}},listeners:{load:function(b,d,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});var g=Ext.create("Ext.view.View",{store:i.store,multiSelect:true,tpl:j,itemId:"dvPhotos",width:450,itemSelector:"div.thumb-wrap",emptyText:i18n("sNo_images_available")});i.items=[{xtype:"panel",layout:"card",region:"center",itemId:"pnlCardNewSite",ui:"light",margin:5,items:[{xtype:"form",itemId:"pnlOne",title:"Step 1 of 5",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"textfield",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The business or property you are signing up"},{name:"name",itemId:"txtName",allowBlank:false,emptyText:"Specify a value to continue",regex:/^[\w\-\s]+$/,regexText:"Only words allowed",listeners:{change:"onTxtNameChange"}},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Password for Operator"},{name:"password",itemId:"txtPassword",allowBlank:false,emptyText:"Specify a value to continue",minLength:5},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The SSID used by guests (open)"},{name:"ssid_guest",itemId:"ssid_guest",value:"Guest",allowBlank:false,maxLength:31,regex:/^[\w\-\s]+$/,regexText:"Only words allowed",emptyText:"Specify a value to continue"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The SSID used by staff (secure)"},{name:"ssid_wireless",itemId:"ssid_wireless",value:"Wireless",maxLength:31,allowBlank:false,regex:/^[\w\-\s]+$/,regexText:"Only words allowed",emptyText:"Specify a value to continue"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Secure SSID passphrase"},{name:"key_wireless",itemId:"key_wireless",value:"12345678",minLength:8,allowBlank:false,emptyText:"Specify a value to continue"}],buttons:[{itemId:"btnOneNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnOneNextClick"}}]},{xtype:"form",itemId:"pnlTwo",title:"Step 2 of 5",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"checkbox",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},listeners:{activate:"pnlTwoActivate"},items:[{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Select the user types you want to use"},{boxLabel:"Vouchers",name:"voucher_login_check",cls:"lblRd",checked:true},{boxLabel:"Permanent Users",name:"user_login_check",cls:"lblRd",checked:true},{boxLabel:"Click to connect",name:"connect_check",cls:"lblRd",checked:true}],buttons:[{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnTwoNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnTwoNextClick"}}]},{xtype:"panel",frame:true,title:"Step 3 of 5 -> Select Logo",height:"100%",width:450,autoScroll:true,layout:{type:"vbox",align:"stretch"},listeners:{activate:"pnlThreeActivate"},items:[{xtype:"panel",flex:1,border:false,itemId:"pnlImg",tpl:h,data:{img:i.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{glyph:Rd.config.icnFolder}}],buttons:[{itemId:"btnLogoSave",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin,listeners:{click:"onBtnLogoSaveClick"}},{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnThreeNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,listeners:{click:"onBtnThreeNextClick"}}]}]},{xtype:"panel",itemId:"pnlFour",title:"Step 4 of 5 -> Upload Images",autoScroll:true,xtype:"panel",frame:false,height:"100%",width:550,layout:{type:"vbox",align:"begin"},listeners:{activate:"pnlFourActivate"},items:g,tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:"xf021@FontAwesome",scale:"large",tooltip:"Reload",listeners:{click:"onBtnPhotoReloadClick"}},{xtype:"button",glyph:"xf067@FontAwesome",scale:"large",tooltip:"Add",listeners:{click:"onBtnPhotoAddClick"}},{xtype:"button",glyph:"xf1f8@FontAwesome",scale:"large",tooltip:"Delete",itemId:"photoDelete",listeners:{click:"onBtnPhotoDeleteClick"}}]}],buttons:[{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnFourNext",text:"Next",scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnFourNextClick"}}]},{xtype:"form",itemId:"pnlFive",title:"Step 5 of 5 -> Select a Theme",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"checkbox",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"cmbThemes",anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false,excludeCustom:true,listeners:{change:"onCmbThemesChange"}}],buttons:[{text:"Preview Mobile",scale:"large",glyph:Rd.config.icnMobile,margin:Rd.config.buttonMargin,listeners:{click:"previewMobile"}},{text:"Preview Desktop",scale:"large",glyph:Rd.config.icnDesktop,margin:Rd.config.buttonMargin,listeners:{click:"previewDesktop"}},"->",{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnFiveNext",text:"Finish",scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnFiveNextClick"}}]}]},{xtype:"panel",title:"Info",itemId:"pnlInfo",glyph:Rd.config.icnInfo,autoScroll:true,width:400,margin:5,bodyPadding:10,region:"east",ui:"light",layout:{type:"fit"},collapsible:true,collapsed:false,collapseDirection:"right",listeners:{afterrender:"onPnlInfoAfterrender"}}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},mkScrnOne:function(){}},0,["pnlWizardNewSite"],["component","box","container","panel","pnlWizardNewSite"],{component:true,box:true,container:true,panel:true,pnlWizardNewSite:true},["widget.pnlWizardNewSite"],0,[Rd.view.wizard,"pnlWizardNewSite"],0));(Ext.cmd.derive("Rd.view.wizard.winWizardPhotoAdd",Ext.window.Window,{title:i18n("sAdd_photo"),layout:"fit",autoShow:false,width:400,height:250,glyph:Rd.config.icnAdd,data_view:undefined,new_name:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sPhoto"),allowBlank:false,labelClsExtra:"lblRdReq",name:"photo",buttonText:"",buttonConfig:{glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWizardPhotoAdd"],["component","box","container","panel","window","winWizardPhotoAdd"],{component:true,box:true,container:true,panel:true,window:true,winWizardPhotoAdd:true},["widget.winWizardPhotoAdd"],0,[Rd.view.wizard,"winWizardPhotoAdd"],0));(Ext.cmd.derive("Rd.controller.cSetupWizard",Ext.app.Controller,{actionIndex:function(){var e=this;if(!Ext.WindowManager.get("sSetupWizard")){var d=Ext.widget("window",{id:"sSetupWizard",title:"Setup Wizard",width:Rd.config.winWidth,height:Rd.config.winHeight,glyph:Rd.config.icnWizard,maximizable:true,maximized:true,animCollapse:false,border:false,constrainHeader:true,layout:"fit",items:[{xtype:"pnlWizardNewSite",ui:"light",border:false}]});d.show()}},views:["wizard.pnlWizardNewSite","wizard.winWizardPhotoAdd"],stores:[],models:[],selectedRecord:null,config:{urlCancel:"/cake2/rd_cake/wizards/cancel.json",urlUploadPhoto:"/cake2/rd_cake/wizards/upload_photo/"},refs:[{ref:"grid",selector:"gridSsids"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#sSetupWizard":{beforeclose:b.onBeforeClose},"winWizardPhotoAdd #save":{click:b.onBtnPhotoAddSaveClick},"winWizardPhotoAdd #cancel":{click:b.onBtnPhotoAddCancelClick},"#photoDelete":{click:b.onBtnPhotoDeleteClick}})},onBeforeClose:function(d){var e=this;if(d.step_one_done){if(d.closeMe){d.closeMe=false;return true}Ext.Msg.show({title:"Confirm this action please",msg:"Remove items created in <b>step One</b>?",buttons:Ext.Msg.YESNO,callback:function(b){if("yes"===b){var a=d.down("#txtName");var h=a.getValue();Ext.Ajax.request({url:e.getUrlCancel(),method:"POST",jsonData:{name:h},success:function(g,j){d.closeMe=true;d.close();Ext.ux.Toaster.msg("Clean up complete","Clean up completed fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}})}}});return false}else{return true}},onBtnPhotoAddSaveClick:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:i.getUrlUploadPhoto(),params:{name:g.new_name},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},onBtnPhotoAddCancelClick:function(g){var h=this;var e=g.up("form");e.getForm().reset()},onBtnPhotoDeleteClick:function(e){var h=this;var g=e.up("window").down("dataview");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cSetupWizard"],0));(Ext.cmd.derive("Rd.view.ssids.gridSsids",Ext.grid.Panel,{multiSelect:true,store:"sSids",stateful:true,stateId:"StateGridSsids",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/ssids/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridSsids1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridSsids3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSsids4"},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids5"},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridSsids"],["component","box","container","panel","tablepanel","gridpanel","grid","gridSsids"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridSsids:true},["widget.gridSsids"],0,[Rd.view.ssids,"gridSsids"],0));(Ext.cmd.derive("Rd.model.mSsid",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mSsid"],0));(Ext.cmd.derive("Rd.view.ssids.winSsidEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit SSID",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winSsidEdit"],["component","box","container","panel","window","winSsidEdit"],{component:true,box:true,container:true,panel:true,window:true,winSsidEdit:true},["widget.winSsidEdit"],0,[Rd.view.ssids,"winSsidEdit"],0));(Ext.cmd.derive("Rd.store.sSids",Ext.data.Store,{model:"Rd.model.mSsid",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/ssids/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/ssids/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sSids"],0));(Ext.cmd.derive("Rd.view.ssids.winSsidAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New SSID",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winSsidAddWizard"],["component","box","container","panel","window","winSsidAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winSsidAddWizard:true},["widget.winSsidAddWizard"],0,[Rd.view.ssids,"winSsidAddWizard"],0));(Ext.cmd.derive("Rd.controller.cSsids",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridSsids",border:true,itemId:"tabSsids",plain:true});d.populated=true},views:["ssids.gridSsids","ssids.winSsidEdit","ssids.winSsidAddWizard"],stores:["sAccessProvidersTree","sSids"],models:["mAccessProviderTree","mSsid"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/ssids/add.json",urlDelete:"/cake3/rd_cake/ssids/delete.json",urlEdit:"/cake3/rd_cake/ssids/edit.json"},refs:[{ref:"grid",selector:"gridSsids"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabSsids":{destroy:b.appClose},"gridSsids #reload":{click:b.reload},"gridSsids #add":{click:b.add},"gridSsids #delete":{click:b.del},"gridSsids #edit":{click:b.edit},gridSsids:{select:b.select},"winSsidAddWizard #btnTreeNext":{click:b.btnTreeNext},"winSsidAddWizard #btnDataPrev":{click:b.btnDataPrev},"winSsidAddWizard #btnDataNext":{click:b.btnDataNext},"winSsidEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winSsidAddWizardId")){var h=Ext.widget("winSsidAddWizard",{id:"winSsidAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winSsidAddWizardId")){var h=Ext.widget("winSsidAddWizard",{id:"winSsidAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winSsidAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winSsidAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sSids").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winSsidEditId")){var i=Ext.widget("winSsidEdit",{id:"winSsidEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winSsidEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreSsidsLoaded:function(){var d=this;var e=d.getStore("sSids").getTotalCount();d.getGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cSsids"],0));(Ext.cmd.derive("Rd.controller.cStartup",Ext.app.Controller,{config:{urlCheckToken:"/cake3/rd_cake/dashboard/check_token.json"},actionIndex:function(){var b=this;b.application.setSelLanguage(Rd.config.selLanguage);Ext.Ajax.setExtraParams({sel_language:b.application.getSelLanguage()});b.checkToken()},checkToken:function(){var j=this;var g=Ext.util.Cookies.get("Token");if(g==null){j.application.runAction("cLogin","Index")}else{var h=Ext.getBody().getViewSize().width;var i=false;if(h<1000){i=true}Ext.Ajax.request({url:j.getUrlCheckToken(),params:{token:g,auto_compact:i},method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.application.applyVtypes();Ext.Ajax.setExtraParams({token:g,sel_language:j.application.getSelLanguage()});j.application.setDashboardData(a.data);j.application.runAction("cDashboard","Index")}else{j.application.runAction("cLogin","Exit")}}})}}},0,0,0,0,0,0,[Rd.controller,"cStartup"],0));(Ext.cmd.derive("Rd.view.tags.gridTags",Ext.grid.Panel,{multiSelect:true,store:"sTags",stateful:true,stateId:"StateGridTags",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridTags1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridTags2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridTags3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridTags4"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridTags5"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTags:true},["widget.gridTags"],0,[Rd.view.tags,"gridTags"],0));(Ext.cmd.derive("Rd.view.tags.winTagEdit",Ext.window.Window,{title:i18n("sEdit_tag_for_NAS_device"),layout:"fit",autoShow:false,width:400,height:400,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",itemId:"scrnDirect",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winTagEdit"],["component","box","container","panel","window","winTagEdit"],{component:true,box:true,container:true,panel:true,window:true,winTagEdit:true},["widget.winTagEdit"],0,[Rd.view.tags,"winTagEdit"],0));(Ext.cmd.derive("Rd.view.tags.winTagAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_tag_for_NAS_devices"),width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRdCheck"}],buttons:g});return h}},0,["winTagAddWizard"],["component","box","container","panel","window","winTagAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winTagAddWizard:true},["widget.winTagAddWizard"],0,[Rd.view.tags,"winTagAddWizard"],0));(Ext.cmd.derive("Rd.controller.cTags",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridTags",border:true,itemId:"tabTags",plain:true});d.populated=true},views:["tags.gridTags","tags.winTagAddWizard","tags.winTagEdit","components.winCsvColumnSelect","components.winNote","components.winNoteAdd"],stores:["sTags","sAccessProvidersTree"],models:["mTag","mAccessProviderTree"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/tags/add.json",urlEdit:"/cake3/rd_cake/tags/edit.json",urlDelete:"/cake3/rd_cake/tags/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/tags/export_csv",urlNoteAdd:"/cake3/rd_cake/tags/note_add.json"},refs:[{ref:"grid",selector:"gridTags"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabTags":{destroy:b.appClose},"gridTags #reload":{click:b.reload},"gridTags #add":{click:b.add},"gridTags #delete":{click:b.del},"gridTags #edit":{click:b.edit},"gridTags #note":{click:b.note},"gridTags #csv":{click:b.csvExport},gridTags:{select:b.select},"winTagAddWizard #btnTreeNext":{click:b.btnTreeNext},"winTagAddWizard #btnDataPrev":{click:b.btnDataPrev},"winTagAddWizard #btnDataNext":{click:b.btnDataNext},"winTagEdit #save":{click:b.editSubmit},"#winCsvColumnSelectTags #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=tags] #reload":{click:b.noteReload},"gridNote[noteForGrid=tags] #add":{click:b.noteAdd},"gridNote[noteForGrid=tags] #delete":{click:b.noteDelete},"gridNote[noteForGrid=tags]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=tags] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=tags] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=tags] #btnNoteAddNext":{click:b.btnNoteAddNext}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winTagAddWizardId")){var h=Ext.widget("winTagAddWizard",{id:"winTagAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winTagAddWizardId")){var h=Ext.widget("winTagAddWizard",{id:"winTagAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winTagAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winTagAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sTags").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(h){var j=this;var k=j.getGrid().getSelectionModel().getCount();if(k==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(k>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winTagEditId")){var i=Ext.widget("winTagEdit",{id:"winTagEditId"});i.show();var l=j.getGrid().getSelectionModel().getLastSelected();i.down("form").loadRecord(l)}}}},editSubmit:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.getStore("sTags").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreTagsLoaded:function(){var d=this;var e=d.getStore("sTags").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectTags")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectTags",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteTags"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteTags"+m.getId(),noteForId:m.getId(),noteForGrid:"tags",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteTagsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteTagsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteTagsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteTagsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cTags"],0));(Ext.cmd.derive("Rd.view.topUps.gridTopUps",Ext.grid.Panel,{multiSelect:true,store:"sTopUps",stateful:true,stateId:"StateGridTopUps",stateEvents:["groupclick","columnhide"],border:true,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/top-ups/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"data",text:"Data"},{id:"time",text:"Time"},{id:"days_to_use",text:"Days To Use"}]});d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridTopUps1"},{text:"Owner",dataIndex:"user",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTopUps2",hidden:true},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'data\'"><div class="fieldGreyWhite"><i class="fa fa-database"></i>  Data</div></tpl>','<tpl if="type==\'days_to_use\'"><div class="fieldPurpleWhite"><i class="fa fa-clock-o"></i>  Days To Use</div></tpl>','<tpl if="type==\'time\'"><div class="fieldBlueWhite"><i class="fa fa-hourglass"></i>  Time</div></tpl>'),stateId:"StateGridTopUps3",filter:{type:"list",store:e}},{text:"Permanent user",dataIndex:"permanent_user",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTopUps4"},{text:"TopUp ID",dataIndex:"id",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"number"},stateId:"StateGridTopUps5"},{text:"Data",dataIndex:"data",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridTopUps6"},{text:"Time",dataIndex:"time",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.secondsToHuman(a)},stateId:"StateGridTopUps7"},{text:"Days to use",dataIndex:"days_to_use",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTopUps8"},{text:"Comment",dataIndex:"comment",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTopUps9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridTopUps10",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},width:200},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridTopUps11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTopUps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTopUps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTopUps:true},["widget.gridTopUps"],0,[Rd.view.topUps,"gridTopUps"],0));(Ext.cmd.derive("Rd.view.topUps.gridTopUpTransactions",Ext.grid.Panel,{multiSelect:true,store:"sTopUpTransactions",stateful:true,stateId:"StateGridTut",stateEvents:["groupclick","columnhide"],border:true,padding:10,viewConfig:{loadMask:true},plugins:"gridfilters",initComponent:function(){var e=this;e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];var g=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"data",text:"Data"},{id:"time",text:"Time"},{id:"days_to_use",text:"Days To Use"}]});var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"create",text:"Create"},{id:"update",text:"Update"},{id:"delete",text:"Delete"}]});e.columns=[{xtype:"rownumberer",stateId:"StateGridTut1"},{text:"Owner",dataIndex:"user",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTut2",hidden:true},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'data\'"><div class="fieldGreyWhite"><i class="fa fa-database"></i>  Data</div></tpl>','<tpl if="type==\'days_to_use\'"><div class="fieldPurpleWhite"><i class="fa fa-clock-o"></i>  Days To Use</div></tpl>','<tpl if="type==\'time\'"><div class="fieldBlueWhite"><i class="fa fa-hourglass"></i>  Time</div></tpl>'),stateId:"StateGridTut3",filter:{type:"list",store:g}},{text:"Permanent user",dataIndex:"permanent_user",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut4"},{text:"Action",dataIndex:"action",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="action==\'create\'"><div class="fieldGreenWhite"><i class="fa fa-star"></i>  Create</div></tpl>','<tpl if="action==\'update\'"><div class="fieldBlueWhite"><i class="fa fa-pencil"></i> Update</div></tpl>','<tpl if="action==\'delete\'"><div class="fieldRedWhite"><i class="fa fa-trash"></i> Delete</div></tpl>'),stateId:"StateGridTut5",filter:{type:"list",store:h}},{text:"RADIUS Attribute",dataIndex:"radius_attribute",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut6"},{text:"Old Value",dataIndex:"old_value",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut7"},{text:"New Value",dataIndex:"new_value",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut8"},{text:"TopUp ID",dataIndex:"top_up_id",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"number"},stateId:"StateGridTut9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridTut10",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},width:200},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridTut11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTopUpTransactions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTopUpTransactions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTopUpTransactions:true},["widget.gridTopUpTransactions"],0,[Rd.view.topUps,"gridTopUpTransactions"],0));(Ext.cmd.derive("Rd.model.mTopUp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user_id",type:"int"},{name:"user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"data",type:"int"},{name:"time",type:"int"},{name:"days_to_use",type:"int"},{name:"comment",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"type",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTopUp"],0));(Ext.cmd.derive("Rd.model.mTopUpTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user_id",type:"int"},{name:"user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"top_up_id",type:"int"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"type",type:"string"},{name:"radius_attribute",type:"string"},{name:"action",type:"string"},{name:"old_value",type:"string"},{name:"new_value",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTopUpTransaction"],0));(Ext.cmd.derive("Rd.view.topUps.winTopUpEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit TopUp",width:500,height:400,plain:true,border:false,layout:"card",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},comment:"",initComponent:function(){var e=this;var d=e.mkScrnData();e.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(d)},mkScrnData:function(){var t=this;var r=0;var p=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"mb",name:"MB"},{id:"gb",name:"GB"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:p,queryMode:"local",displayField:"name",valueField:"id",name:"data_unit",itemId:"cmbDataUnit",labelClsExtra:"lblRdReq",hidden:true,disabled:true,allowBlank:false,forceSelection:true});var A=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"minutes",name:"Minutes"},{id:"hours",name:"Hours"},{id:"days",name:"Days"}]});var q=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:A,queryMode:"local",displayField:"name",valueField:"id",name:"time_unit",itemId:"cmbTimeUnit",hidden:true,disabled:true,labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});var w=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"data",name:"Data"},{id:"time",name:"Time"},{id:"days_to_use",name:"Days to use"}]});var s=Ext.create("Ext.form.ComboBox",{fieldLabel:"Type",store:w,queryMode:"local",displayField:"name",valueField:"id",name:"type",itemId:"cmbType",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});if(t.data>0){s.select(s.getStore().getAt(0));var z=-1;fileSizeInBytes=t.data;do{fileSizeInBytes=fileSizeInBytes/1024;z++}while(fileSizeInBytes>=1024);var x=z-1;i.select(i.getStore().getAt(x));r=fileSizeInBytes;i.setVisible(true);i.setDisabled(false)}if(t.time>0){s.select(s.getStore().getAt(1));if(t.time>86400){r=t.time/86400;q.select(q.getStore().getAt(2))}else{if(t.time>3600){r=t.time/3600;q.select(q.getStore().getAt(1))}else{r=t.time/60;q.select(q.getStore().getAt(0))}}q.setVisible(true);q.setDisabled(false)}if(t.days_to_use>0){s.select(s.getStore().getAt(2));r=t.days_to_use}var u=[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}];var y=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"textfield",name:"id",itemId:"topUpId",hidden:true},{xtype:"textfield",fieldLabel:"Type",name:"type",itemId:"dispType",editable:false},{xtype:"displayfield",fieldLabel:"Permanet User",name:"permanent_user"},{xtype:"numberfield",name:"value",fieldLabel:"Amount",value:r,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,itemId:"txtAmount"},i,q,{xtype:"textfield",fieldLabel:"Comment",name:"comment",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",value:t.comment}],buttons:u});return y}},0,["winTopUpEdit"],["component","box","container","panel","window","winTopUpEdit"],{component:true,box:true,container:true,panel:true,window:true,winTopUpEdit:true},["widget.winTopUpEdit"],0,[Rd.view.topUps,"winTopUpEdit"],0));(Ext.cmd.derive("Rd.store.sTopUps",Ext.data.Store,{model:"Rd.model.mTopUp",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/top-ups/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTopUps"],0));(Ext.cmd.derive("Rd.store.sTopUpTransactions",Ext.data.Store,{model:"Rd.model.mTopUpTransaction",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/top-up-transactions/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTopUpTransactions"],0));(Ext.cmd.derive("Rd.view.topUps.winTopUpAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New TopUp",width:500,height:500,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var q=this;var r=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"data",name:"Data"},{id:"time",name:"Time"},{id:"days_to_use",name:"Days to use"}]});var o=Ext.create("Ext.form.ComboBox",{fieldLabel:"Type",store:r,queryMode:"local",displayField:"name",valueField:"id",name:"type",itemId:"cmbType",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});o.select(o.getStore().getAt(0));var m=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"mb",name:"MB"},{id:"gb",name:"GB"}]});var l=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:m,queryMode:"local",displayField:"name",valueField:"id",name:"data_unit",itemId:"cmbDataUnit",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});l.select(l.getStore().getAt(0));var t=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"minutes",name:"Minutes"},{id:"hours",name:"Hours"},{id:"days",name:"Days"}]});var n=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:t,queryMode:"local",displayField:"name",valueField:"id",name:"time_unit",itemId:"cmbTimeUnit",hidden:true,disabled:true,labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});n.select(n.getStore().getAt(0));var p=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(q.no_tree==true){var p=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var s=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:q.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:q.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"permanent_user_id",fieldLabel:"Permanent user",name:"permanent_user_id"},o,{xtype:"numberfield",name:"value",fieldLabel:"Amount",value:1,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,itemId:"txtAmount"},l,n,{xtype:"textfield",fieldLabel:"Comment",name:"comment",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}],buttons:p});return s}},0,["winTopUpAddWizard"],["component","box","container","panel","window","winTopUpAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winTopUpAddWizard:true},["widget.winTopUpAddWizard"],0,[Rd.view.topUps,"winTopUpAddWizard"],0));(Ext.cmd.derive("Rd.controller.cTopUps",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabTopUps",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridTopUps",border:false,plain:true,glyph:Rd.config.icnHome},{title:"Transaction History",xtype:"gridTopUpTransactions",glyph:Rd.config.icnHistory}]});d.populated=true},views:["topUps.gridTopUps","topUps.winTopUpAddWizard","components.cmbPermanentUser","topUps.winTopUpEdit","components.winCsvColumnSelect","topUps.gridTopUpTransactions"],stores:["sTopUps","sAccessProvidersTree","sPermanentUsers","sTopUpTransactions"],models:["mTopUp","mAccessProviderTree","mPermanentUser","mTopUpTransaction"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/top-ups/export_csv",urlAdd:"/cake3/rd_cake/top-ups/add.json",urlExportCsv:"/cake3/rd_cake/top-ups/export_csv",urlDelete:"/cake3/rd_cake/top-ups/delete.json",urlEdit:"/cake3/rd_cake/top-ups/edit.json"},refs:[{ref:"grid",selector:"gridTopUps"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabTopUps":{destroy:b.appClose},"gridTopUps #reload":{click:b.reload},"gridTopUps #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridTopUps #add":{click:b.add},"gridTopUps #edit":{click:b.edit},"gridTopUps #delete":{click:b.del},"gridTopUps #csv":{click:b.csvExport},gridTopUps:{select:b.select},"winTopUpAddWizard #btnTreeNext":{click:b.btnTreeNext},"winTopUpAddWizard #btnDataPrev":{click:b.btnDataPrev},"winTopUpAddWizard #btnDataNext":{click:b.btnDataNext},"winTopUpAddWizard #cmbType":{change:b.cmbTopUpTypeChanged},"#winCsvColumnSelectTopUps #save":{click:b.csvExportSubmit},"winTopUpEdit #dispType":{change:b.editDispTypeChanged},"winTopUpEdit #save":{click:b.btnEditSave},"#tabTopUps gridTopUpTransactions":{activate:b.gridActivate},"#tabTopUps gridTopUps":{activate:b.gridActivate}})},gridActivate:function(d){var e=this;d.getStore().load()},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},select:function(e,g){var h=this},onStoreTopUpsLoaded:function(){var d=this;var e=d.getStore("sTopUps").getTotalCount();d.getGrid().down("#count").update({count:e})},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winTopUpAddWizardId")){var h=Ext.widget("winTopUpAddWizard",{id:"winTopUpAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winTopUpAddWizardId")){var h=Ext.widget("winTopUpAddWizard",{id:"winTopUpAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winTopUpAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#permanent_user_id").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#permanent_user_id").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winTopUpAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sTopUps").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},cmbTopUpTypeChanged:function(l,j){var o=this;var p=l.up("form");var k=p.down("#cmbDataUnit");var m=p.down("#cmbTimeUnit");var n=p.down("#txtAmount");if(j=="data"){k.setVisible(true);k.setDisabled(false);m.setVisible(false);m.setDisabled(true);n.setFieldLabel("Amount")}if(j=="time"){k.setVisible(false);k.setDisabled(true);m.setVisible(true);m.setDisabled(false);n.setFieldLabel("Amount")}if(j=="days_to_use"){k.setVisible(false);k.setDisabled(true);m.setVisible(false);m.setDisabled(true);n.setFieldLabel("Days")}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(h){var j=this;var k=j.getGrid().getSelectionModel().getCount();if(k==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(k>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winTopUpEditId")){var i=Ext.widget("winTopUpEdit",{id:"winTopUpEditId",record:l});i.down("form").loadRecord(l);i.show()}}}},editDispTypeChanged:function(u,E,G){var w=this;var D=u.up("form");var z=u.up("window");new_value=u.getValue();var r=D.down("#cmbDataUnit");var t=D.down("#cmbTimeUnit");var F=D.down("#txtAmount");if(new_value=="data"){r.setVisible(true);r.setDisabled(false);t.setVisible(false);t.setDisabled(true);F.setFieldLabel("Amount");var A=z.record.get("data");var x=A/(1024*1024*1024);var C=A/(1024*1024);if(x<1){r.setValue("mb");F.setValue(C)}else{r.setValue("gb");F.setValue(x)}}if(new_value=="time"){r.setVisible(false);r.setDisabled(true);t.setVisible(true);t.setDisabled(false);F.setFieldLabel("Amount");var A=z.record.get("time");var y=A/(60);var B=A/(60*60);var s=A/(60*60*24);if(B<1){t.setValue("minutes");F.setValue(y)}if(s<1){t.setValue("hours");F.setValue(B)}else{t.setValue("days");F.setValue(s)}}if(new_value=="days_to_use"){r.setVisible(false);r.setDisabled(true);t.setVisible(false);t.setDisabled(true);F.setFieldLabel("Days");var A=z.record.get("days_to_use");F.setValue(A)}},btnEditSave:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectTopUps")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectTopUps",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}}},0,0,0,0,0,0,[Rd.controller,"cTopUps"],0));(Ext.cmd.derive("Rd.view.utilities.pnlUtilities",Ext.panel.Panel,{scrollable:true,border:false,ui:"light",frame:false,config:{urlUtilitiesItems:"/cake2/rd_cake/dashboard/utilities_items.json"},initComponent:function(){var b=this;Ext.Ajax.request({url:b.getUrlUtilitiesItems(),method:"GET",success:function(a){var e=Ext.JSON.decode(a.responseText);if(e.success){b.addDocked({dock:"left",xtype:"toolbar",border:false,frame:false,items:e.data})}}});Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlUtilities"],["component","box","container","panel","pnlUtilities"],{component:true,box:true,container:true,panel:true,pnlUtilities:true},["widget.pnlUtilities"],0,[Rd.view.utilities,"pnlUtilities"],0));(Ext.cmd.derive("Rd.controller.cUtilities",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"pnlUtilities",border:true,itemId:"tabUtilities",plain:true});d.populated=true},views:["utilities.pnlUtilities"],stores:[],models:[],config:{},refs:[{ref:"pnlUtilities",selector:"pnlUtilities"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabUtilities":{destroy:b.appClose},"pnlUtilities #btnRadiusClient":{click:function(a){b.application.runAction("cRadiusClient","Index")}},"pnlUtilities #btnPassword":{click:function(a){b.application.runAction("cPassword","Index")}},"pnlUtilities #btnActivityMonitor":{click:b.openActivityMonitor},"pnlUtilities #btnDataUsage":{click:b.openDataUsage},"pnlUtilities #btnSetupWizard":{click:function(a){b.application.runAction("cSetupWizard","Index")}}})},appClose:function(){var b=this;b.populated=false},openActivityMonitor:function(e){var h=this;var g=h.getPnlUtilities();h.application.runAction("cActivityMonitor","Index",g)},openDataUsage:function(h){var l=this;var i=l.getPnlUtilities();var k=i.up("tabpanel");var j=k.down("#cDataUsage");if(j){k.setActiveTab("cDataUsage");return}k.add({title:"Data Usage",glyph:Rd.config.icnData,id:"cDataUsage",layout:"fit"});k.setActiveTab("cDataUsage");l.application.runAction("cDataUsage","Index",k)}},0,0,0,0,0,0,[Rd.controller,"cUtilities"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVouchers",Ext.grid.Panel,{multiSelect:true,store:"sVouchers",stateful:true,stateId:"StateGridVouchers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/vouchers/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"new",text:"New"},{id:"used",text:"Used"},{id:"depleted",text:"Depleted"},{id:"expired",text:"Expired"}]});d.columns=[{xtype:"rownumberer",stateId:"StateGridVouchers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridVouchers2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridVouchers3"},{text:i18n("sPassword"),dataIndex:"password",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers4",hidden:true},{text:i18n("sBatch"),sortable:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(batch)"><div class="fieldBlue">'+i18n("s_br_Single_voucher_br")+"</div>",'<tpl else><div class="fieldGrey">',"{batch}","</div></tpl>"),dataIndex:"batch",filter:{type:"string"},stateId:"StateGridVouchers5"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers6"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers7"},{header:i18n("sData_used"),dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(b,a,k){var j=k.get("perc_data_used");a.toggleCls("wifigreen",true);if(j==null){a.setText("")}else{if(j<70){var l="wifigreen";a.toggleCls("wifiyellow",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=70&&j<90){l="wifiyellow";a.toggleCls("wifigreen",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=90){l="wifired";a.toggleCls("wifigreen",false);a.toggleCls("wifiyellow",false);a.toggleCls(l,true)}a.setValue(j/100);a.setText(j+" %")}},stateId:"StateGridVouchers8"},{header:i18n("sTime_used"),dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(b,a,k){var j=k.get("perc_time_used");a.toggleCls("wifired",true);if(j==null){a.setText("")}else{if(j<70){var l="wifigreen";a.toggleCls("wifiyellow",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=70&&j<90){l="wifiyellow";a.toggleCls("wifigreen",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=90){l="wifired";a.toggleCls("wifigreen",false);a.toggleCls("wifiyellow",false);a.toggleCls(l,true)}a.setValue(j/100);a.setText(j+" %");a.toggleCls(l,true)}},stateId:"StateGridVouchers9"},{text:i18n("sStatus"),flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "new"\'><div class="fieldGreen">'+i18n("sNew")+"</div></tpl>",'<tpl if=\'status == "used"\'><div class="fieldYellow">'+i18n("sUsed")+"</div></tpl>",'<tpl if=\'status == "depleted"\'><div class="fieldOrange">'+i18n("sDepleted")+"</div></tpl>",'<tpl if=\'status == "expired"\'><div class="fieldRed">'+i18n("sExpired")+"</div></tpl>"),dataIndex:"status",filter:{type:"list",store:e},stateId:"StateGridVouchers10"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers11"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers12"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers13"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers14"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers15"},{text:"Extra field name",flex:1,dataIndex:"extra_name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers16"},{text:"Extra field value",flex:1,dataIndex:"extra_value",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers17"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridVouchers18",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers19"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVouchers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVouchers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVouchers:true},["widget.gridVouchers"],0,[Rd.view.vouchers,"gridVouchers"],0));(Ext.cmd.derive("Rd.model.mPdfFormat",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPdfFormat"],0));(Ext.cmd.derive("Rd.model.mVoucherDevice",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mVoucherDevice"],0));(Ext.cmd.derive("Rd.view.vouchers.pnlVoucher",Ext.tab.Panel,{border:false,v_id:null,v_name:null,record:null,plain:true,cls:"subTab",initComponent:function(){var g=this;var h=new Date();var j=new Date();j.setYear(j.getFullYear()+1);var i=g.record.get("user_id");g.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:150},items:[{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:i},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:i},{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,cls:"lblRd"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:366,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.ap_id}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:"0 20 40 0"}]}},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridVoucherPrivate",username:g.v_name},{title:i18n("sDevices"),layout:"fit",xtype:"gridVoucherDevices",username:g.v_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridVoucherRadaccts",username:g.v_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlVoucher"],["component","box","container","panel","tabpanel","pnlVoucher"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlVoucher:true},["widget.pnlVoucher"],0,[Rd.view.vouchers,"pnlVoucher"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherEmailDetail",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"e-mail voucher detail",width:400,height:350,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEmail,autoShow:false,voucherId:undefined,paypalId:undefined,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"send",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"voucher_id",xtype:"textfield",name:"id",hidden:true,value:e.voucherId},{xtype:"displayfield",fieldLabel:"Voucher",name:"voucher",value:e.voucher_name},{xtype:"textfield",fieldLabel:"e-mail",name:"email",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"email",value:e.email},{xtype:"textareafield",grow:true,name:"message",fieldLabel:"Extra message"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherEmailDetail"],["component","box","container","panel","window","winVoucherEmailDetail"],{component:true,box:true,container:true,panel:true,window:true,winVoucherEmailDetail:true},["widget.winVoucherEmailDetail"],0,[Rd.view.vouchers,"winVoucherEmailDetail"],0));(Ext.cmd.derive("Rd.store.sVouchers",Ext.data.Store,{model:"Rd.model.mVoucher",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/vouchers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sVouchers"],0));(Ext.cmd.derive("Rd.store.sPdfFormats",Ext.data.Store,{model:"Rd.model.mPdfFormat",proxy:{type:"ajax",format:"json",url:"/cake3/rd_cake/vouchers/pdfVoucherFormats.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sPdfFormats"],0));(Ext.cmd.derive("Rd.view.vouchers.cmbPdfFormats",Ext.form.ComboBox,{fieldLabel:i18n("sOutput_format"),labelSeparator:"",store:"sPdfFormats",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"pdf_format",name:"pdf_format",value:"a4",labelClsExtra:"lblRd"},0,["cmbPdfFormats"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPdfFormats"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPdfFormats:true},["widget.cmbPdfFormats"],0,[Rd.view.vouchers,"cmbPdfFormats"],0));(Ext.cmd.derive("Rd.view.components.vLanguagesCmb",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sLanguages",queryMode:"local",valueField:"id",displayField:"text",typeAhead:true,mode:"local",itemId:"cmbLanguage",listConfig:{getInnerTpl:function(){return'<div data-qtip="{country} : {language}"><div class="combo-wrapper"><div class="combo-country">{country}<img src="{icon_file}" /></div><div class="combo-language"> {language}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbLanguage"],["component","box","field","textfield","pickerfield","combobox","combo","cmbLanguage"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbLanguage:true},["widget.cmbLanguage"],0,[Rd.view.components,"vLanguagesCmb"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherPdf",Ext.window.Window,{title:i18n("sGenerate_pdf"),layout:"fit",autoShow:false,width:450,height:350,iconCls:"pdf",glyph:Rd.config.icnPdf,initComponent:function(){var j=this;var g=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"P",name:"Portrait"},{id:"L",name:"Landscape"}]});var h=[{xtype:"cmbPdfFormats",name:"format",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"cmbLanguages",fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq",allowBlank:false}];if(j.selecteds==true){Ext.Array.push(h,{xtype:"checkbox",fieldLabel:i18n("sOnly_selected"),name:"selected_only",inputValue:"selected_only",itemId:"selected_only",checked:true,labelClsExtra:"lblRd"})}var i=[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",itemId:"tabBasic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:h},{title:"Advanced",itemId:"tabAdvanced",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"combobox",fieldLabel:"Orientation",store:g,queryMode:"local",displayField:"name",valueField:"id",name:"orientation"},{xtype:"checkbox",fieldLabel:"Include QR code",name:"q_r",inputValue:"q_r",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include date",name:"date",inputValue:"date",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include T&C",name:"t_and_c",inputValue:"t_and_c",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Social media links",name:"social_media",inputValue:"social_media",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Realm detail",name:"realm_detail",inputValue:"realm_detail",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Profile detail",name:"profile_detail",inputValue:"profile_detail",checked:true,labelClsExtra:"lblRd"}]}]}];j.items=[{xtype:"form",border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:170},defaultType:"textfield",items:i,buttons:[{itemId:"save",text:i18n("sOK"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 10 20 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherPdf"],["component","box","container","panel","window","winVoucherPdf"],{component:true,box:true,container:true,panel:true,window:true,winVoucherPdf:true},["widget.winVoucherPdf"],0,[Rd.view.vouchers,"winVoucherPdf"],0));(Ext.cmd.derive("Rd.view.components.pnlAccessProvidersTree",Ext.tree.Panel,{useArrows:true,store:"sAccessProvidersTree",rootVisible:true,rowLines:true,layout:"fit",stripeRows:true,border:false,tbar:[{xtype:"tbtext",text:i18n("sSelect_the_owner"),cls:"lblWizard"}],columns:[{xtype:"treecolumn",text:i18n("sOwner"),sortable:true,flex:1,dataIndex:"username",tdCls:"gridTree"}],buttons:[{itemId:"btnTreeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}],listeners:{beforerender:function(b){console.log(" Before render");b.getStore().load()}}},0,["pnlAccessProvidersTree"],["component","box","container","panel","tablepanel","treepanel","pnlAccessProvidersTree"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,pnlAccessProvidersTree:true},["widget.pnlAccessProvidersTree"],0,[Rd.view.components,"pnlAccessProvidersTree"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:i18n("sNew_voucher"),width:400,height:470,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,apId:false,singleField:true,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var g=this;var j=new Date();j.setYear(j.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(g.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var i=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:g.user_id},{itemId:"single_field",xtype:"textfield",name:"single_field",hidden:true,value:g.singleField},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:g.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"precede",fieldLabel:i18n("sPrecede_string"),allowBlank:true,labelClsExtra:"lblRd",hidden:g.singleField,disabled:g.singleField},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:g.apId},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:g.apId},{xtype:"numberfield",name:"quantity",fieldLabel:i18n("sHow_many_qm"),value:1,maxValue:5000,minValue:1,labelClsExtra:"lblRdReq",itemId:"quantity"},{xtype:"textfield",name:"batch",fieldLabel:i18n("sBatch_name"),allowBlank:false,labelClsExtra:"lblRdReq",itemId:"batch",disabled:true,hidden:true},{xtype:"slider",name:"pwd_length",fieldLabel:i18n("sPassword_length"),width:200,value:3,increment:1,minValue:3,maxValue:15,hidden:g.singleField,disabled:g.singleField}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,cls:"lblRd"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:366,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j}]},{title:"SSIDs",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.user_id}]},{title:"Extra field",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"}]}]}],buttons:h});return i}},0,["winVoucherAddWizard"],["component","box","container","panel","window","winVoucherAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winVoucherAddWizard:true},["widget.winVoucherAddWizard"],0,[Rd.view.vouchers,"winVoucherAddWizard"],0));(Ext.cmd.derive("Rd.view.vouchers.pnlVoucherGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",v_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.v_name,type:"voucher"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.v_name,type:"voucher"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.v_name,type:"voucher"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlVoucherGraphs"],["component","box","container","panel","tabpanel","pnlVoucherGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlVoucherGraphs:true},["widget.pnlVoucherGraphs"],0,[Rd.view.vouchers,"pnlVoucherGraphs"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherPrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridVoucherPrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridVoucherPrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridVoucherPrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridVoucherPrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridVoucherPrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridVoucherPrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/vouchers/private-attr-add.json",read:"/cake3/rd_cake/vouchers/private-attr-index.json",update:"/cake3/rd_cake/vouchers/private-attr-edit.json",destroy:"/cake3/rd_cake/vouchers/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherPrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherPrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherPrivate:true},["widget.gridVoucherPrivate"],0,[Rd.view.vouchers,"gridVoucherPrivate"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StGVoucherRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/vouchers/menu-for-accounting-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StGVoucherRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StGVoucherRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StGVoucherRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StGVoucherRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StGVoucherRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StGVoucherRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:100,remoteSort:true,proxy:{type:"ajax",keepRawData:true,format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(n,a,j){if(!j){Ext.ux.Toaster.msg("Error encountered",n.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var k=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#totals").update({"in":l,out:m,total:k})}},scope:this}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherRadaccts:true},["widget.gridVoucherRadaccts"],0,[Rd.view.vouchers,"gridVoucherRadaccts"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherPassword",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,iconCls:"rights",glyph:Rd.config.icnLock,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),allowBlank:false,labelClsExtra:"lblRdReq",name:"password",allowBlank:false}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherPassword"],["component","box","container","panel","window","winVoucherPassword"],{component:true,box:true,container:true,panel:true,window:true,winVoucherPassword:true},["widget.winVoucherPassword"],0,[Rd.view.vouchers,"winVoucherPassword"],0));(Ext.cmd.derive("Rd.view.components.winPdf",Ext.window.Window,{title:i18n("sOnline_help"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"pdf",glyph:Rd.config.icnPdf,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true,stateful:true,stateId:"winPdfState",srcUrl:"https://sourceforge.net/p/radiusdesk/wiki/",initComponent:function(){var b=this;b.items=[{xtype:"component",itemId:"ifrm",autoEl:{tag:"iframe",src:b.srcUrl}}];Ext.window.Window.prototype.initComponent.apply(this,arguments)},setSrc:function(d){console.log("change");me=this;var e=me.down("#ifrm");console.log(e);e.getEl().dom.src=d}},0,["winPdf"],["component","box","container","panel","window","winPdf"],{component:true,box:true,container:true,panel:true,window:true,winPdf:true},["widget.winPdf"],0,[Rd.view.components,"winPdf"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherDevices",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridVoucherDevice",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},plugins:"gridfilters",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")}]}],username:"nobody",initComponent:function(){var b=this;b.columns=[{xtype:"rownumberer",stateId:"StateGridVoucherDevice1"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridVoucherDevice2"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mVoucherDevice",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{create:"/cake2/rd_cake/vouchers/voucher_device_add.json",read:"/cake2/rd_cake/vouchers/voucher_device_index.json",update:"/cake2/rd_cake/vouchers/voucher_device_edit.json",destroy:"/cake2/rd_cake/vouchers/voucher_device_delete.json"}},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherDevices:true},["widget.gridVoucherDevices"],0,[Rd.view.vouchers,"gridVoucherDevices"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherAddDevice",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New whitelisted device for voucher",width:300,height:250,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,usernamed:"",hidePower:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"username",xtype:"textfield",name:"username",hidden:true,value:e.username},{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:"A8-40-41-13-60-E3"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherAddDevice"],["component","box","container","panel","window","winVoucherAddDevice"],{component:true,box:true,container:true,panel:true,window:true,winVoucherAddDevice:true},["widget.winVoucherAddDevice"],0,[Rd.view.vouchers,"winVoucherAddDevice"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherCsvImport",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:"Add from CSV Import",width:450,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,apId:false,singleField:true,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var g=this;var j=new Date();j.setYear(j.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(g.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var i=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:15},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:g.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:g.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:g.apId},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:g.apId},{xtype:"textfield",name:"batch",fieldLabel:i18n("sBatch_name"),allowBlank:false,labelClsExtra:"lblRdReq",itemId:"batch"},{xtype:"filefield",itemId:"csv_file",emptyText:"Select CSV File..",fieldLabel:"CSV List",allowBlank:false,name:"csv_file",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder},regex:/^.*\.(csv|CSV)$/,regexText:"Only CSV files allowed",labelClsExtra:"lblRdReq"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,boxLabelCls:"lblRdCheck"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:90,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,boxLabelCls:"lblRdCheck"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j}]},{title:"Extra field",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"e-Mail",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"email_title",fieldLabel:"Title",allowBlank:true},{xtype:"textareafield",grow:true,name:"email_message",allowBlank:true,fieldLabel:"Message"}]}]}],buttons:h});return i}},0,["winVoucherCsvImport"],["component","box","container","panel","window","winVoucherCsvImport"],{component:true,box:true,container:true,panel:true,window:true,winVoucherCsvImport:true},["widget.winVoucherCsvImport"],0,[Rd.view.vouchers,"winVoucherCsvImport"],0));(Ext.cmd.derive("Rd.controller.cVouchers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabVouchers",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridVouchers",glyph:Rd.config.icnHome}]});d.populated=true},views:["vouchers.gridVouchers","vouchers.winVoucherAddWizard","components.cmbRealm","components.cmbProfile","vouchers.pnlVoucher","vouchers.gridVoucherPrivate","components.cmbVendor","components.cmbAttribute","vouchers.gridVoucherRadaccts","vouchers.winVoucherPassword","components.winPdf","vouchers.winVoucherPdf","vouchers.cmbPdfFormats","components.vCmbLanguages","components.winCsvColumnSelect","components.pnlUsageGraph","vouchers.winVoucherEmailDetail","vouchers.gridVoucherDevices","vouchers.winVoucherAddDevice","components.cmbSsid","vouchers.pnlVoucherGraphs","vouchers.winVoucherCsvImport"],stores:["sVouchers","sAccessProvidersTree","sRealms","sProfiles","sAttributes","sVendors","sPdfFormats","sLanguages"],models:["mAccessProviderTree","mVoucher","mRealm","mProfile","mPrivateAttribute","mRadacct","mPdfFormat","mUserStat","mVoucherDevice"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/vouchers/add.json",urlDelete:"/cake3/rd_cake/vouchers/delete.json",urlBulkDelete:"/cake3/rd_cake/vouchers/bulk-delete.json",urlViewBasic:"/cake3/rd_cake/vouchers/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/vouchers/edit_basic_info.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/vouchers/export_csv",urlPdfExportLoad:"/cake3/rd_cake/vouchers/pdf-export-settings.json",urlChangePassword:"/cake3/rd_cake/vouchers/change-password.json",urlPdfBase:"/cake3/rd_cake/vouchers/export-pdf",urlEmailSend:"/cake3/rd_cake/vouchers/email-voucher-details.json",urlAddDevice:"/cake2/rd_cake/vouchers/voucher_device_add.json",urlAddCsv:"/cake2/rd_cake/vouchers/add_csv/",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridVouchers"},{ref:"privateGrid",selector:"gridVoucherPrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.singleField=true;b.addCsvList=false;b.simpleDel=true;b.control({"#tabDevices":{destroy:b.appClose},"gridVouchers #reload":{click:b.reload},"gridVouchers #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridVouchers #add":{click:b.add},"gridVouchers #add menuitem[group=add]":{click:b.addOptionClick},"gridVouchers #delete":{click:b.del},"gridVouchers #delete menuitem[group=delete]":{click:b.delOptionClick},"gridVouchers #edit":{click:b.edit},"gridVouchers #pdf":{click:b.pdfExport},"gridVouchers #csv":{click:b.csvExport},"gridVouchers #password":{click:b.changePassword},"gridVouchers #test_radius":{click:b.testRadius},"gridVouchers #email":{click:b.email},"gridVouchers #graph":{click:b.graph},gridVouchers:{select:b.select,activate:b.gridActivate},"winVoucherEmailDetail #send":{click:b.emailSend},"winVoucherAddWizard #btnTreeNext":{click:b.btnTreeNext},"winVoucherAddWizard #quantity":{change:b.quantityChange},"winVoucherAddWizard #activate_on_login":{change:b.chkActivateOnLoginChange},"winVoucherAddWizard #never_expire":{change:b.chkNeverExpireChange},"winVoucherAddWizard #ssid_only":{change:b.chkSsidOnlyChange},"winVoucherAddWizard #btnDataPrev":{click:b.btnDataPrev},"winVoucherAddWizard #btnDataNext":{click:b.btnDataNext},"winVoucherCsvImport #btnTreeNext":{click:b.btnTreeNext},"winVoucherCsvImport #btnDataPrev":{click:b.btnDataPrev},"winVoucherCsvImport #activate_on_login":{change:b.chkActivateOnLoginChange},"winVoucherCsvImport #never_expire":{change:b.chkNeverExpireChange},"winVoucherCsvImport #btnDataNext":{click:b.btnDataNextCsv},"pnlVoucher #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlVoucher #profile":{render:b.renderEventProfile},"pnlVoucher #realm":{render:b.renderEventRealm},"pnlVoucher #activate_on_login":{change:b.chkActivateOnLoginChange},"pnlVoucher #never_expire":{change:b.chkNeverExpireChange},"pnlVoucher #ssid_only":{change:b.chkSsidOnlyChange},"pnlVoucher #tabBasicInfo #save":{click:b.saveBasicInfo},"pnlVoucher gridVoucherPrivate":{select:b.selectVoucherPrivate,activate:b.gridActivate},gridVoucherPrivate:{beforeedit:b.onBeforeEditVoucherPrivate},"gridVoucherPrivate  #cmbVendor":{change:b.cmbVendorChange},"gridVoucherPrivate  #add":{click:b.attrAdd},"gridVoucherPrivate  #reload":{click:b.attrReload},"gridVoucherPrivate  #delete":{click:b.attrDelete},"pnlVoucher gridVoucherDevices":{activate:b.gridActivate},"winVoucherAddDevice #save":{click:b.btnDeviceAddSave},"gridVoucherDevices  #add":{click:b.deviceAdd},"gridVoucherDevices  #reload":{click:b.deviceReload},"gridVoucherDevices  #delete":{click:b.deviceDelete},"#winCsvColumnSelectVouchers #save":{click:b.csvExportSubmit},"pnlVoucher gridVoucherRadaccts #reload":{click:b.gridVoucherRadacctsReload},"pnlVoucher gridVoucherRadaccts #delete":{click:b.deleteRadaccts},"pnlVoucher gridVoucherRadaccts":{activate:b.gridActivate},"winVoucherPassword #save":{click:b.changePasswordSubmit},"winVoucherPdf  #save":{click:b.pdfExportSubmit},winVoucherPdf:{beforeshow:b.frmPdfExportLoad},"#tabVouchers pnlVoucherGraphs #daily":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabVouchers pnlVoucherGraphs #daily #day":{change:b.changeDailyGraph},"#tabVouchers pnlVoucherGraphs #weekly":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabVouchers pnlVoucherGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabVouchers pnlVoucherGraphs #monthly":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabVouchers pnlVoucherGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sVouchers").load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},addOptionClick:function(g){var e=this;var h=g.getItemId();if(h=="addSingle"){e.singleField=true}else{e.singleField=false}if(h=="addCsvList"){e.addCsvList=true}else{e.addCsvList=false}},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;if(d.addCsvList){d.addCsvImport()}else{Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winVoucherAddWizardId")){var h=Ext.widget("winVoucherAddWizard",{id:"winVoucherAddWizardId",singleField:d.singleField});h.show()}}else{if(!Ext.WindowManager.get("winVoucherAddWizardId")){var h=Ext.widget("winVoucherAddWizard",{id:"winVoucherAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,apId:"0",singleField:d.singleField});h.show()}}}},scope:d})}},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("window");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#realm").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#realm").getStore().load();j.down("#profile").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#profile").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("window");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sVouchers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},addCsvImport:function(){var b=this;console.log("We need to import from CSV");Ext.Ajax.request({url:b.getUrlApChildCheck(),method:"GET",success:function(h){var g=Ext.JSON.decode(h.responseText);if(g.success){if(g.items.tree==true){if(!Ext.WindowManager.get("winVoucherCsvImportId")){var a=Ext.widget("winVoucherCsvImport",{id:"winVoucherCsvImportId"});a.show()}}else{if(!Ext.WindowManager.get("winVoucherCsvImportId")){var a=Ext.widget("winVoucherCsvImport",{id:"winVoucherCsvImportId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,apId:"0"});a.show()}}}},scope:b})},btnDataNextCsv:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,waitMsg:"Uploading your CSV File...",url:j.getUrlAddCsv(),success:function(b,a){i.close();j.getStore("sVouchers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(q,k,m,r,n){var o=this;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false);tb.down("#password").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true);tb.down("#password").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},delOptionClick:function(g){var e=this;var h=g.getItemId();if(h=="deleteSimple"){e.simpleDel=true}if(h=="deleteBulk"){e.simpleDel=false}},delInBulk:function(){var o=this;var s=[];var t=0;var p=false;var m="";var r="This will delete <b>ALL</b> the <b>CURRENT</b> listed items<br><br>Are you <b>VERY</b> sure?";var i=o.getGrid().getStore().getFilters();if(i.count()>0){var q=0;while(t<i.count()){p=true;var n=i.getAt(t).serialize();n.field=n.property;s[t]=n;t=t+1}}if(p){m="?filter="+encodeURIComponent(Ext.JSON.encode(s));r="A <b>FILTER</b> is applied on the grid and the <b>DELETE</b> will be according to this filter.<br><br>Are you <b>VERY</b> sure?"}Ext.MessageBox.confirm(i18n("sConfirm"),r,function(a){if(a=="yes"){console.log("You choose YES");Ext.Ajax.request({url:o.getUrlBulkDelete()+m,method:"POST",success:function(d,b){Ext.ux.Toaster.msg("Bulk delete completed","Bulk delete completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);o.reload()},failure:function(d,b){Ext.ux.Toaster.msg("Problems with bulk delete",d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);o.reload()}})}})},del:function(){var b=this;if(b.simpleDel==false){b.delInBulk();return}if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(d,n){var a=i.getGrid().up("tabpanel");var o=d.getId();var b="vTab_"+o;var e=a.down("#"+b);if(e){a.setActiveTab(b);return}var p=d.get("name");a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlVoucher",v_id:o,v_name:p,record:d}});a.setActiveTab(b)})}},onTabBasicInfoActive:function(h){var i=this;var j=h.down("form");var g=h.up("pnlVoucher").v_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{voucher_id:g},success:function(b,d){if(d.result.data.ssid_list!=undefined){var a=j.down("#ssid_list");var e=[];a.getStore().loadData([],false);Ext.Array.forEach(d.result.data.ssid_list,function(n){var m=n.id;e.push(m);a.getStore().loadData([n],true)});a.setValue(e)}}})},saveBasicInfo:function(h){var j=this;var i=h.up("form");var g=h.up("pnlVoucher").v_id;i.submit({clientValidation:true,url:j.getUrlEditBasic(),params:{id:g},success:function(b,a){j.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},pdfExport:function(g){var i=this;var j=false;if(i.getGrid().getStore().getCount()==0){Ext.ux.Toaster.msg(i18n("sNothing_to_export"),i18n("sList_is_empty"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}if(i.getGrid().getSelectionModel().getCount()>0){j=true}if(!Ext.WindowManager.get("winVoucherPdfId")){var h=Ext.widget("winVoucherPdf",{id:"winVoucherPdfId",selecteds:j});h.show()}},pdfExportSubmit:function(z){var w=this;var G=z.up("form");var y=G.up("window");form_to_string=G.getForm().getValues(true);var D=Ext.util.Cookies.get("Token");var x=form_to_string+"&token="+D+"&";var E=[];var H=0;var A=false;var t="";var i=w.getGrid().getStore().getFilters();if(i.count()>0){var B=0;while(H<i.count()){A=true;var u=i.getAt(H).serialize();u.field=u.property;E[H]=u;H=H+1}}if(A){t="filter="+encodeURIComponent(Ext.JSON.encode(E));x=x+t+"&"}var G=z.up("form");if(G.down("#selected_only")!=undefined){if(G.down("#selected_only").getValue()){var C=[];Ext.each(w.getGrid().getSelectionModel().getSelection(),function(a,d){var b=a.getId();Ext.Array.push(C,b)});if(C.length>0){var F=Ext.encode(C);x=x+"selected="+encodeURIComponent(F)}}}var I=w.getUrlPdfBase()+"?"+x;window.open(I);y.close()},frmPdfExportLoad:function(g){var h=this;var e=g.down("form");e.load({url:h.getUrlPdfExportLoad(),method:"GET"})},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectVouchers")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectVouchers",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},email:function(n){var k=this;var i=k.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=k.getGrid().getSelectionModel().getLastSelected();var l=m.get("name");if(!Ext.WindowManager.get("winVoucherEmailDetailId"+m.getId())){var j=Ext.widget("winVoucherEmailDetail",{id:"winVoucherEmailDetailId"+m.getId(),voucherId:m.getId(),voucher_name:l});j.show()}}}},emailSend:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.setLoading(true);g.submit({clientValidation:true,url:j.getUrlEmailSend(),success:function(b,a){i.close();Ext.ux.Toaster.msg("Voucher details sent","Voucher details sent fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},quantityChange:function(k){var l=this;var h=k.up("form");var i=h.down("#batch");var j=k.getValue();if(j>1){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},chkActivateOnLoginChange:function(p){var m=this;var n=p.up("form");var o=n.down("#days_valid");var j=n.down("#hours_valid");var k=n.down("#minutes_valid");var l=p.getValue();if(l){o.setVisible(true);o.setDisabled(false);j.setVisible(true);j.setDisabled(false);k.setVisible(true);k.setDisabled(false)}else{o.setVisible(false);o.setDisabled(true);j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true)}},chkNeverExpireChange:function(i){var l=this;var e=i.up("form");var j=e.down("#expire");var k=i.getValue();if(k){j.setDisabled(true)}else{j.setDisabled(false)}},chkSsidOnlyChange:function(i){var l=this;var h=i.up("form");var j=h.down("#ssid_list");var k=i.getValue();if(k){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}},selectVoucherPrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditVoucherPrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridVoucherPrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridVoucherPrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridVoucherPrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridVoucherPrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},deviceAdd:function(k){var j=this;var l=k.up("pnlVoucher");var h=l.down("gridVoucherDevices").getStore();if(!Ext.WindowManager.get("winVoucherAddDeviceId")){var i=Ext.widget("winVoucherAddDevice",{id:"winVoucherAddDeviceId",store:h,username:l.v_name});i.show()}},btnDeviceAddSave:function(h){var j=this;var i=h.up("winVoucherAddDevice");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddDevice(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},deviceReload:function(b){var g=this;var h=b.up("gridVoucherDevices");h.getStore().load()},deviceDelete:function(j){var i=this;var g=j.up("pnlVoucher");var h=g.down("gridVoucherDevices");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},gridVoucherRadacctsReload:function(g){var h=this;var e=g.up("gridVoucherRadaccts");e.getSelectionModel().deselectAll(true);e.getStore().load()},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},genericDelete:function(e){var h=this;var g=e.up("grid");console.log(g);if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winVoucherPassword"+j.getId())){var h=Ext.widget("winVoucherPassword",{id:"winVoucherPassword"+j.getId(),voucher_id:j.getId(),username:j.get("name"),title:i18n("sChange_password_for")+" "+j.get("name")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.voucher_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){if(a.result.success==false){Ext.ux.Toaster.msg("Problem encountered",a.result.message.message,Ext.ux.Constants.clsError,Ext.ux.Constants.msgError)}else{k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestVoucher",j)}},renderEventRealm:function(k){var i=this;var m=k.up("pnlVoucher");m.cmbRealmRendered=true;if(m.record!=undefined){var n=m.record.get("realm");var j=m.record.get("realm_id");var l=Ext.create("Rd.model.mRealm",{name:n,id:j});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var i=this;var n=k.up("pnlVoucher");n.cmbProfileRendered=true;if(n.record!=undefined){var j=n.record.get("profile");var l=n.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="voucherTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlVoucherGraphs",v_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cVouchers"],0));(Ext.cmd.derive("Rd.controller.cWelcome",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.setHtml("            <h2>Welcome to this controll panel</h2>            Please start off by creating a new <b>Realm</b>.            ");d.populated=true},init:function(){var b=this;if(b.inited){return}b.inited=true}},0,0,0,0,0,0,[Rd.controller,"cWelcome"],0));(Ext.cmd.derive("Rd.view.whiteLists.gridWhiteLists",Ext.grid.Panel,{multiSelect:true,store:"sWhiteLists",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/white-lists/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridBl1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridBl3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridBl6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridWhiteLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridWhiteLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridWhiteLists:true},["widget.gridWhiteLists"],0,[Rd.view.whiteLists,"gridWhiteLists"],0));(Ext.cmd.derive("Rd.model.mWhiteList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mWhiteList"],0));(Ext.cmd.derive("Rd.model.mWhiteListEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"black_list_id",type:"int"},{name:"domain",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mWhiteListEntry"],0));(Ext.cmd.derive("Rd.view.whiteLists.pnlWhiteListDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",white_list_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"White List Entries",layout:"fit",xtype:"gridWhiteListEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlWhiteListDetail"],["component","box","container","panel","tabpanel","pnlWhiteListDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlWhiteListDetail:true},["widget.pnlWhiteListDetail"],0,[Rd.view.whiteLists,"pnlWhiteListDetail"],0));(Ext.cmd.derive("Rd.store.sWhiteLists",Ext.data.Store,{model:"Rd.model.mBlackList",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/white-lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sWhiteLists"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New White List",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winWhiteListAddWizard"],["component","box","container","panel","window","winWhiteListAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListAddWizard:true},["widget.winWhiteListAddWizard"],0,[Rd.view.whiteLists,"winWhiteListAddWizard"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add White List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:false,labelClsExtra:"lblRdReq"},{itemId:"white_list_id",xtype:"textfield",name:"white_list_id",hidden:true,value:e.white_list_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWhiteListEntryAdd"],["component","box","container","panel","window","winWhiteListEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListEntryAdd:true},["widget.winWhiteListEntryAdd"],0,[Rd.view.whiteLists,"winWhiteListEntryAdd"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit White List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRdReq",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:true,value:g.get("domain")},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id},{itemId:"white_list_id",xtype:"textfield",name:"white_list_id",hidden:true,value:g.get("white_list_id")}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWhiteListEntryEdit"],["component","box","container","panel","window","winWhiteListEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListEntryEdit:true},["widget.winWhiteListEntryEdit"],0,[Rd.view.whiteLists,"winWhiteListEntryEdit"],0));(Ext.cmd.derive("Rd.view.whiteLists.gridWhiteListEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/white-lists/menu-for-white-list-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"BLE1"},{text:"Domain",dataIndex:"domain",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"BLE2"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE3"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE4"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mWhiteListEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/white-lists/index-white-list-entry.json",extraParams:{white_list_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridWhiteListEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridWhiteListEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridWhiteListEntries:true},["widget.gridWhiteListEntries"],0,[Rd.view.whiteLists,"gridWhiteListEntries"],0));(Ext.cmd.derive("Rd.controller.cWhiteLists",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabWhiteLists",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridWhiteLists",glyph:Rd.config.icnHome}]});d.populated=true},views:["whiteLists.gridWhiteLists","whiteLists.winWhiteListAddWizard","whiteLists.pnlWhiteListDetail","whiteLists.gridWhiteListEntries","whiteLists.winWhiteListEntryAdd","whiteLists.winWhiteListEntryEdit"],stores:["sAccessProvidersTree","sWhiteLists"],models:["mAccessProviderTree","mWhiteList","mWhiteListEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/white-lists/add.json",urlDelete:"/cake3/rd_cake/white-lists/delete.json",urlEdit:"/cake3/rd_cake/white-lists/edit.json",urlAddEntry:"/cake3/rd_cake/white-lists/add-whitelist-entry.json",urlEditEntry:"/cake3/rd_cake/white-lists/edit-whitelist-entry.json",urlDeleteEntry:"/cake3/rd_cake/white-lists/delete-whitelist-entry.json"},refs:[{ref:"grid",selector:"gridWhiteLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabWhiteLists":{destroy:b.appClose},"gridWhiteLists #reload":{click:b.reload},"gridWhiteLists #add":{click:b.add},"gridWhiteLists #delete":{click:b.del},"gridWhiteLists #edit":{click:b.edit},gridWhiteLists:{select:b.select},"winWhiteListAddWizard #btnTreeNext":{click:b.btnTreeNext},"winWhiteListAddWizard #btnDataPrev":{click:b.btnDataPrev},"winWhiteListAddWizard #btnDataNext":{click:b.btnDataNext},"winWhiteListEdit #save":{click:b.btnEditSave},"pnlWhiteListDetail gridWhiteListEntries":{activate:b.gridActivate},"#tabWhiteLists gridWhiteLists":{activate:b.gridActivate},"pnlWhiteListDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridWhiteListEntries #reload":{click:b.reloadEntries},"gridWhiteListEntries #add":{click:b.addEntry},"gridWhiteListEntries #edit":{click:b.editEntry},"gridWhiteListEntries #delete":{click:b.deleteEntry},"winWhiteListEntryAdd  #save":{click:b.saveWhiteListEntryAdd},"winWhiteListEntryEdit  #save":{click:b.saveWhiteListEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winWhiteListAddWizardId")){var h=Ext.widget("winWhiteListAddWizard",{id:"winWhiteListAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winWhiteListAddWizardId")){var h=Ext.widget("winWhiteListAddWizard",{id:"winWhiteListAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winWhiteListAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winWhiteListAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sWhiteLists").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="whiteListTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlWhiteListDetail",white_list_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlWhiteListDetail").white_list_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winWhiteListEntryAdd",{id:"winWhiteListEntryAdd"+k,white_list_id:k,store:i});j.show()}},saveWhiteListEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winWhiteListEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winWhiteListEntryEditId")){var j=Ext.widget("winWhiteListEntryEdit",{id:"winWhiteListEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveWhiteListEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winWhiteListEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cWhiteLists"],0));(Ext.cmd.derive("Rd.model.mAutoSetup",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"name",type:"string"},{name:"dns_name",type:"string"},{name:"ip_address",type:"string"},{name:"ip_mask",type:"string"},{name:"ip_gateway",type:"string"},{name:"ip_dns_1",type:"string"},{name:"ip_dns_2",type:"string"},{name:"wifi_active",type:"bool"},{name:"channel",type:"int"},{name:"power",type:"int"},{name:"distance",type:"int"},{name:"ssid_secure",type:"string"},{name:"radius",type:"string"},{name:"secret",type:"string"},{name:"ssid_open",type:"string"},{name:"eduroam",type:"bool"},{name:"vpn_server",type:"string"},{name:"tunnel_ip",type:"string"},{name:"contact_ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAutoSetup"],0));(Ext.cmd.derive("Rd.model.mFinAuthorizeNetTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"description",type:"string"},{name:"x_response_code",type:"int"},{name:"x_response_subcode",type:"int"},{name:"x_response_reason_code",type:"int"},{name:"x_response_reason_text",type:"string"},{name:"x_auth_code",type:"string"},{name:"x_avs_code",type:"string"},{name:"x_trans_id",type:"string"},{name:"x_auth_code",type:"string"},{name:"x_method",type:"string"},{name:"x_card_type",type:"string"},{name:"x_account_number",type:"string"},{name:"x_first_name",type:"string"},{name:"x_last_name",type:"string"},{name:"x_company",type:"string"},{name:"x_address",type:"string"},{name:"x_city",type:"string"},{name:"x_state",type:"string"},{name:"x_zip",type:"string"},{name:"x_country",type:"string"},{name:"x_phone",type:"string"},{name:"x_fax",type:"string"},{name:"x_email",type:"string"},{name:"x_amount",type:"string"},{name:"x_catalog_link_id",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"tag",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinAuthorizeNetTransaction"],0));(Ext.cmd.derive("Rd.model.mFinMyGateToken",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"fin_payment_plan",type:"string"},{name:"fin_payment_plan_id",type:"int"},{name:"client_pin",type:"string"},{name:"client_uci",type:"string"},{name:"client_uid",type:"string"},{name:"override",type:"string"},{name:"override_completed",type:"bool"},{name:"active",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinMyGateToken"],0));(Ext.cmd.derive("Rd.model.mFinMyGateTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"fin_my_gate_token",type:"string"},{name:"fin_my_gate_token_id",type:"int"},{name:"permanent_user",type:"string"},{name:"status",type:"string"},{name:"type",type:"string"},{name:"my_gate_reference",type:"string"},{name:"message",type:"string"},{name:"amount",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinMyGateTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPayUTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"merchantReference",type:"string"},{name:"payUReference",type:"string"},{name:"TransactionType",type:"string"},{name:"TransactionState",type:"string"},{name:"ResultCode",type:"string"},{name:"ResultMessage",type:"string"},{name:"DisplayMessage",type:"string"},{name:"merchUserId",type:"string"},{name:"firstName",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"mobile",type:"string"},{name:"regionalId",type:"string"},{name:"amountInCents",type:"int"},{name:"currencyCode",type:"string"},{name:"description",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPayUTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPaymentPlan",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"profile",type:"string"},{name:"profile_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"currency_code",type:"string"},{name:"value",type:"string"},{name:"tax",type:"string"},{name:"active",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPaymentPlan"],0));(Ext.cmd.derive("Rd.model.mFinPaypalTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"business",type:"string"},{name:"option_name1",type:"string"},{name:"option_selection1",type:"string"},{name:"item_name",type:"string"},{name:"item_number",type:"string"},{name:"first_name",type:"string"},{name:"last_name",type:"string"},{name:"payer_email",type:"string"},{name:"payer_id",type:"string"},{name:"payer_status",type:"string"},{name:"payment_gross",type:"string"},{name:"mc_gross",type:"string"},{name:"mc_fee",type:"string"},{name:"mc_currency",type:"string"},{name:"payment_date",type:"string"},{name:"payment_status",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPaypalTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPremiumSmsTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"mobile",type:"string"},{name:"description",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPremiumSmsTransaction"],0));(Ext.cmd.derive("Rd.model.mPolicyTagSelection",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"selected",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPolicyTagSelection"],0));(Ext.cmd.derive("Rd.model.mRealms",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"creator",type:"string"},"phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon",{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mRealms"],0));(Ext.cmd.derive("Rd.model.mTemplate",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"check_attribute_count",type:"int"},{name:"reply_attribute_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTemplate"],0));(Ext.cmd.derive("Rd.model.mTemplateEdit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"attribute",type:"string"},{name:"type",type:"string"},{name:"tooltip",type:"string"},{name:"unit",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mTemplateEdit"],0));(Ext.cmd.derive("Rd.model.mWallpaper",Ext.data.Model,{fields:["id","file","r_dir","img"]},0,0,0,0,0,0,[Rd.model,"mWallpaper"],0));(Ext.cmd.derive("Rd.view.accessProviders.winDetail",Ext.window.Window,{title:i18n("sNew_Access_Provider"),layout:"fit",autoShow:true,width:400,height:500,resizable:false,iconCls:"add",glyph:Rd.config.icnAdd,parent_name:"",parent_id:"",initComponent:function(){var b=this;b.items=[{xtype:"frmAccessProviderDetail",pwdHidden:false,parent_id:this.parent_id,parent_name:this.parent_name}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessProviderDetail"],["component","box","container","panel","window","winAccessProviderDetail"],{component:true,box:true,container:true,panel:true,window:true,winAccessProviderDetail:true},["widget.winAccessProviderDetail"],0,[Rd.view.accessProviders,"winDetail"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointDetail",Ext.panel.Panel,{border:false,plain:true,title:"More Info",collapsible:true,collapsed:true,width:300,layout:"fit",initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,items:[{title:"Connected",html:"bla"},{title:"Device health",html:"Nee"}]}]},0,["pnlAccessPointDetail"],["component","box","container","panel","pnlAccessPointDetail"],{component:true,box:true,container:true,panel:true,pnlAccessPointDetail:true},["widget.pnlAccessPointDetail"],0,[Rd.view.aps,"pnlAccessPointDetail"],0));(Ext.cmd.derive("Rd.view.aps.winApAttachAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Device to Profile",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAttach,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"saveAttach",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:e.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winApAttachAp"],["component","box","container","panel","window","winApAttachAp"],{component:true,box:true,container:true,panel:true,window:true,winApAttachAp:true},["widget.winApAttachAp"],0,[Rd.view.aps,"winApAttachAp"],0));(Ext.cmd.derive("Rd.view.components.ajaxCheckbox",Ext.form.field.Checkbox,{url:null,initComponent:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",success:b.configureCheckbox,scope:b});Ext.form.field.Checkbox.prototype.initComponent.apply(this,arguments)},configureCheckbox:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);if(e.success){if(e.items.disabled==true){h.setDisabled(true)}else{h.setDisabled(false)}if(e.items.checked==true){h.setValue(true)}else{h.setValue(false)}}}},0,["ajaxCheckbox"],["component","box","field","checkboxfield","checkbox","ajaxCheckbox"],{component:true,box:true,field:true,checkboxfield:true,checkbox:true,ajaxCheckbox:true},["widget.ajaxCheckbox"],0,[Rd.view.components,"ajaxCheckbox"],0));(Ext.cmd.derive("Rd.view.components.cmbFinPaymentPlans",Ext.form.ComboBox,{fieldLabel:"Payment plan",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"fin_payment_plan_id",labelClsExtra:"lblRd",extraParam:false,store:"sFinPaymentPlans",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbFinPaymentPlans"],["component","box","field","textfield","pickerfield","combobox","combo","cmbFinPaymentPlans"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbFinPaymentPlans:true},["widget.cmbFinPaymentPlans"],0,[Rd.view.components,"cmbFinPaymentPlans"],0));(Ext.cmd.derive("Rd.view.globalTags.gridGlobalTags",Ext.grid.Panel,{multiSelect:true,store:"sGlobalTags",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD5"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">Basic</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">Full</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridGD6"}];d.callParent(arguments)}},0,["gridGlobalTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalTags:true},["widget.gridGlobalTags"],0,[Rd.view.globalTags,"gridGlobalTags"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguagesEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:"Edit Languages",width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var e=h.mkScrnEditLanguage();var g=h.mkScrnEditLanguageDo();this.items=[e,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnEditLanguage:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:"Select a language to edit",width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbJustLanguages"}],buttons:[{itemId:"btnEditLanguageNext",text:"Next",scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditLanguage",items:[g,h]});return e},mkScrnEditLanguageDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:"Supply the following detail please",width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:"Language name",itemId:"inpNewCountry",allowBlank:false,emptyText:"language name",blankText:"Specify a valid name for the language",textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:"ISO code",itemId:"inpNewIso",allowBlank:false,emptyText:"eg pt or de",blankText:"Specify a valid iso language code",textValid:true,validator:function(){return this.textValid}}],buttons:[{itemId:"btnEditLanguageDoPrev",text:"Prev",scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnEditLanguageDoNext",text:"Next",scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditLanguageDo",items:[g,h]});return e}},0,["editLanguagesW"],["component","box","container","panel","window","editLanguagesW"],{component:true,box:true,container:true,panel:true,window:true,editLanguagesW:true},["widget.editLanguagesW"],0,[Rd.view.i18n,"vWinLanguagesEdit"],0));(Ext.cmd.derive("Rd.view.logViewer.pnlViewFile",Ext.panel.Panel,{html:"",autoScroll:true,autoCreate:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-clear",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),items:[{xtype:"button",iconCls:"b-start",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",iconCls:"b-stop",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",iconCls:"b-btn_info",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.callParent(arguments)}},0,["pnlViewFile"],["component","box","container","panel","pnlViewFile"],{component:true,box:true,container:true,panel:true,pnlViewFile:true},["widget.pnlViewFile"],0,[Rd.view.logViewer,"pnlViewFile"],0));(Ext.cmd.derive("Rd.view.logViewer.pnlViewFile",Ext.panel.Panel,{html:"",autoScroll:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),width:200,items:[{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlViewFile"],["component","box","container","panel","pnlViewFile"],{component:true,box:true,container:true,panel:true,pnlViewFile:true},["widget.pnlViewFile"],0,[Rd.view.logViewer,"pnlViewFile"],0));(Ext.cmd.derive("Rd.view.meshes.cmbCodec",Ext.form.ComboBox,{fieldLabel:"Codec1",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"codec1",labelClsExtra:"lblRd",value:"gsm",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"gsm",text:"gsm"},{id:"ulaw",text:"ulaw"},{id:"alaw",text:"alaw"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCodec"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCodec"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCodec:true},["widget.cmbCodec"],0,[Rd.view.meshes,"cmbCodec"],0));(Ext.cmd.derive("Rd.view.meshes.cmbDialoutCode",Ext.form.ComboBox,{fieldLabel:"Dialout code",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"dialout",labelClsExtra:"lblRd",value:"#",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"#",text:"#"},{id:"9",text:"9"},{id:"0",text:"0"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDialoutCode"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDialoutCode"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDialoutCode:true},["widget.cmbDialoutCode"],0,[Rd.view.meshes,"cmbDialoutCode"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",store:"sMeshEntryPoints",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"entry_points",name:"entry_points",value:"none",multiSelect:true,labelClsExtra:"lblRdReq"},0,["cmbEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEntryPoints:true},["widget.cmbEntryPoints"],0,[Rd.view.meshes,"cmbEntryPoints"],0));(Ext.cmd.derive("Rd.view.meshes.cmbSoftphoneSupport",Ext.form.ComboBox,{fieldLabel:"Softphone Support",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"softph",labelClsExtra:"lblRd",value:"OFF",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"OFF",text:"Off"},{id:"CLIENT",text:"Client"},{id:"MASTER",text:"Master"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbSoftphoneSupport"],["component","box","field","textfield","pickerfield","combobox","combo","cmbSoftphoneSupport"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbSoftphoneSupport:true},["widget.cmbSoftphoneSupport"],0,[Rd.view.meshes,"cmbSoftphoneSupport"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEdit",Ext.window.Window,{width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"mesh",glyph:Rd.config.icnMeshEdit,animCollapse:false,border:false,isWindow:true,minimizable:true,maximizable:true,constrainHeader:true,layout:"border",stateful:true,autoShow:false,meshName:"",meshId:"",initComponent:function(){var b=this;b.items=[{region:"north",xtype:"pnlBanner",heading:b.title,image:"resources/images/48x48/mesh_edit.png"},{region:"center",xtype:"panel",layout:"fit",border:false,items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:i18n("sEntry_points"),itemId:"tabEntryPoints",xtype:"gridMeshEntries",meshId:b.meshId},{title:i18n("sMesh_settings"),itemId:"tabMeshSettings",xtype:"pnlMeshSettings",meshId:b.meshId},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridMeshExits",meshId:b.meshId},{title:i18n("sNode_settings"),itemId:"tabNodeCommonSettings",xtype:"pnlNodeCommonSettings",meshId:b.meshId},{title:i18n("sNodes"),itemId:"tabNodes",xtype:"gridNodes",meshId:b.meshId}]}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEdit"],["component","box","container","panel","window","winMeshEdit"],{component:true,box:true,container:true,panel:true,window:true,winMeshEdit:true},["widget.winMeshEdit"],0,[Rd.view.meshes,"winMeshEdit"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshView",Ext.window.Window,{width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"mesh",glyph:Rd.config.icnView,animCollapse:false,border:false,isWindow:true,minimizable:true,maximizable:true,constrainHeader:true,layout:"border",stateful:true,autoShow:false,meshId:"",initComponent:function(){var b=this;b.items=[{region:"north",xtype:"pnlBanner",heading:b.title,image:"resources/images/48x48/mesh_view.png"},{region:"center",xtype:"panel",layout:"fit",border:false,items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:"Overview",itemId:"tabMeshViewOverwiew",xtype:"pnlMeshViewNodes",meshId:b.meshId},{title:"SSID &#8660; Device",itemId:"tabMeshViewEntries",xtype:"gridMeshViewEntries",meshId:b.meshId},{title:"Node &#8660; Device",itemId:"tabMeshViewNodes",xtype:"gridMeshViewNodes",meshId:b.meshId},{title:"Node &#8660; Nodes",itemId:"tabMeshViewNodeNodes",xtype:"gridMeshViewNodeNodes",meshId:b.meshId},{title:"Nodes",itemId:"tabMeshViewNodeDetails",xtype:"gridMeshViewNodeDetails",meshId:b.meshId}]}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshView"],["component","box","container","panel","window","winMeshView"],{component:true,box:true,container:true,panel:true,window:true,winMeshView:true},["widget.winMeshView"],0,[Rd.view.meshes,"winMeshView"],0));(Ext.cmd.derive("Rd.view.nas.frmNasBasic",Ext.form.Panel,{border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:200,margin:15},buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}],defaultType:"textfield",marginSize:5,initComponent:function(){var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"ping",text:i18n("sPing")},{id:"heartbeat",text:i18n("sHeartbeat")}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id"});var e=this;e.items=[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:true,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sOptional_Info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"type",xtype:"textfield",fieldLabel:i18n("sType"),name:"type",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPorts"),name:"ports",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sCommunity"),name:"community",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sServer"),name:"server",labelClsExtra:"lblRd"},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRd"}]},{title:i18n("sMonitor_settings"),layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true},{xtype:"numberfield",anchor:"100%",name:"ping_interval",itemId:"ping_interval",fieldLabel:i18n("sPing_interval"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:i18n("sMaps_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:e.marginSize}]},{title:i18n("sEnhancements"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sRecord_authentication_requests"),name:"record_auth",inputValue:"record_auth",checked:false,cls:"lblRd",margin:e.marginSize},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",inputValue:"session_auto_close",checked:false,cls:"lblRd",margin:e.marginSize},{xtype:"numberfield",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false}]}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmNasBasic"],["component","box","container","panel","form","frmNasBasic"],{component:true,box:true,container:true,panel:true,form:true,frmNasBasic:true},["widget.frmNasBasic"],0,[Rd.view.nas,"frmNasBasic"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicyFilters",Ext.form.ComboBox,{fieldLabel:"Filter",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"cmbFilter",name:"filter_id",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/filters/index-for-list.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicyFilters"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicyFilters"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicyFilters:true},["widget.cmbPolicyFilters"],0,[Rd.view.policies,"cmbPolicyFilters"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicySchedules",Ext.form.ComboBox,{fieldLabel:"Schedule",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"cmbSchedule",name:"schedule_id",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index-for-list.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicySchedules"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicySchedules"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicySchedules:true},["widget.cmbPolicySchedules"],0,[Rd.view.policies,"cmbPolicySchedules"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicyTagSelection",Ext.grid.Panel,{multiSelect:true,store:"sPolicies",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbfill"}],columns:[{xtype:"rownumberer",stateId:"StateGridPTS1"},{text:i18n("sName"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">{name}</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">{name}</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">{name}</div></tpl>'),dataIndex:"name",filter:{type:"string"},stateId:"StateGridPTS3",tdCls:"gridTree"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPTS4"},{xtype:"advCheckColumn",text:"Select",dataIndex:"selected",renderer:function(l,k,h){var j="x-",i=[j+"grid-checkheader"];if(l){i.push(j+"grid-checkheader-checked")}return'<div class="'+i.join(" ")+'">&#160;</div>'}}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPolicyTagSelection",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-tags/index-for-policy.json",extraParams:{policy_id:b.policyId},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake3/rd_cake/global-tags/index-for-policy.json",update:"/cake3/rd_cake/global-tags/edit-for-policy.json"}},listeners:{load:function(j,k,l,a,m){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicyTagSelection"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicyTagSelection"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicyTagSelection:true},["widget.gridPolicyTagSelection"],0,[Rd.view.policies,"gridPolicyTagSelection"],0));(Ext.cmd.derive("Rd.view.policies.pnlPolicy",Ext.panel.Panel,{plain:true,initComponent:function(){var b=this;b.items=[];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPolicy"],["component","box","container","panel","pnlPolicy"],{component:true,box:true,container:true,panel:true,pnlPolicy:true},["widget.pnlPolicy"],0,[Rd.view.policies,"pnlPolicy"],0));Ext.define("Rd.Application",{extend:"Ext.app.Application",name:"Rd",controllers:["cStartup","cLogin"],dashboardData:null,languages:null,selLanguage:null,autoCreateViewport:true,init:function(){var d=this;if(document.getElementById("divSplash")){var e=document.getElementById("divSplash");e.parentNode.removeChild(e)}d.addUx();Ext.tip.QuickTipManager.init();Ext.state.Manager.setProvider(Ext.create("Ext.state.LocalStorageProvider"));d.applyVtypes();Ext.ariaWarn=Ext.emptyFn},launch:function(){var b=this;b.runAction("cStartup","Index")},runAction:function(a,k,l,n){var b=this;var m=b.getController(a);m.init(b);return m["action"+k](l,n)},setDashboardData:function(d){var e=this;e.dashboardData=d},getDashboardData:function(){var b=this;return b.dashboardData},setLanguages:function(d){var e=this;e.languages=d},getLanguages:function(d){var e=this;return e.languages},setSelLanguage:function(d){var e=this;e.selLanguage=d},getSelLanguage:function(d){var e=this;return e.selLanguage},applyVtypes:function(){Ext.apply(Ext.form.field.VTypes,{IPAddress:function(b){return(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/).test(b)},IPAddressText:i18n("sExample")+": 192.168.1.1",IPAddressMask:/[\d\.]/i,MacAddress:function(b){return(/^([a-fA-F0-9]{2}-){5}[a-fA-F0-9]{2}$/).test(b)},MacAddressMask:/[a-fA-F0-9\-]/,MacAddressText:i18n("sExample")+": 01-23-45-67-89-AB",DnsName:function(b){return(/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/).test(b)},DnsNameText:i18n("This is not a valid DNS name"),PasswordMatch:function(k,l){var j=this;var b=l.up("form");var a=b.down("#password");if(a!=null){if(k!=a.getValue()){return false}else{return true}}return true},PasswordMatchText:i18n("sPasswords_does_not_match"),Numeric:function(){var b=/[0-9]/;return function(a){return b.test(a)}}(),NumericText:"Only numbers are allowed",NumericMask:/[0-9]/})},addUx:function(){Ext.namespace("Ext.ux");Ext.ux.Constants={msgWarn:4000,msgInfo:2000,msgError:8000,clsWarn:"warn",clsInfo:"info",clsError:"error"};Ext.ux.Toaster=function(){var e;var h=500;function g(b,a){return'<div class="msg"><h3>'+b+"</h3><p>"+a+"</p></div>"}return{msg:function(a,d,k,b){if(!e){e=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},false)}var l=Ext.DomHelper.append(e,g(a,d),true);if(k!==undefined){l.addCls(k)}if(b===undefined){b=h}l.on("click",function(){l.destroy()});l.hide();l.slideIn("t").ghost("t",{delay:b,remove:true})}}}();Ext.ux.formFail=function(e,d){console.log(d);switch(d.failureType){case Ext.form.action.Action.CLIENT_INVALID:Ext.ux.Toaster.msg("Failure","Form fields may not be submitted with invalid values",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);break;case Ext.form.action.Action.CONNECT_FAILURE:Ext.ux.Toaster.msg("Failure","Ajax communication failed",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);break;case Ext.form.action.Action.SERVER_INVALID:Ext.ux.Toaster.msg("Failure",d.result.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}};Ext.ux.bytesToHuman=function(h){if((h==0)||(h==null)){return"0 kb"}var e=-1;var g=[" kb"," Mb"," Gb"," Tb","Pb","Eb","Zb","Yb"];do{h=h/1024;e++}while(h>=1024);return Math.max(h,0.1).toFixed(1)+g[e]};Ext.ux.secondsToHuman=function(k){var i=Math.floor(k/86400);var m=Math.floor((k%86400)/3600);var n=Math.floor(((k%86400)%3600)/60);var j=((k%86400)%3600)%60;return l(i,2)+":"+l(m,2)+":"+l(n,2)+":"+l(j,2);function l(b,a){return Array(Math.max(a-String(b).length+1,0)).join(0)+b}};Ext.ux.centsToHuman=function(b){return(b/100).toFixed(2)}},onAppUpdate:function(){Ext.Msg.confirm("Application Update","This application has an update, reload?",function(b){if(b==="yes"){window.location.reload()}})}});Ext.application({name:"Rd",extend:"Rd.Application"});
./app.js:(Ext.cmd.derive("Ext.ux.desktop.Wallpaper",Ext.Component,{cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',stretch:false,wallpaper:null,stateful:true,stateId:"desk-wallpaper",afterRender:function(){var b=this;Ext.Component.prototype.afterRender.call(this);b.setWallpaper(b.wallpaper,b.stretch)},applyState:function(){var d=this,e=d.wallpaper;Ext.Component.prototype.applyState.apply(this,arguments);if(e!=d.wallpaper){d.setWallpaper(d.wallpaper)}},getState:function(){return this.wallpaper&&{wallpaper:this.wallpaper}},setWallpaper:function(h,i){var l=this,j,k;l.stretch=(i!==false);l.wallpaper=h;if(l.rendered){j=l.el.dom.firstChild;if(!h||h==Ext.BLANK_IMAGE_URL){Ext.fly(j).hide()}else{if(l.stretch){j.src=h;l.el.removeCls("ux-wallpaper-tiled");Ext.fly(j).setStyle({width:"100%",height:"100%"}).show()}else{Ext.fly(j).hide();k="url("+h+")";l.el.addCls("ux-wallpaper-tiled")}}l.el.setStyle({backgroundImage:k||""});if(l.stateful){l.saveState()}}return l}},0,["wallpaper"],["component","box","wallpaper"],{component:true,box:true,wallpaper:true},["widget.wallpaper"],0,[Ext.ux.desktop,"Wallpaper"],0));(Ext.cmd.derive("Ext.ux.event.RecorderManager",Ext.panel.Panel,{layout:"fit",buttonAlign:"left",eventsToIgnore:{mousemove:1,mouseover:1,mouseout:1},bodyBorder:false,playSpeed:1,initComponent:function(){var e=this;e.recorder=new Ext.ux.event.Recorder({attachTo:e.attachTo,listeners:{add:e.updateEvents,coalesce:e.updateEvents,buffer:200,scope:e}});e.recorder.eventsToRecord=Ext.apply({},e.recorder.eventsToRecord);function h(a,b){return{text:a,speed:b,group:"speed",checked:b==e.playSpeed,handler:e.onPlaySpeed,scope:e}}e.tbar=[{text:"Record",xtype:"splitbutton",whenIdle:true,handler:e.onRecord,scope:e,menu:e.makeRecordButtonMenu()},{text:"Play",xtype:"splitbutton",whenIdle:true,handler:e.onPlay,scope:e,menu:[h("Qarter Speed (0.25x)",0.25),h("Half Speed (0.5x)",0.5),h("3/4 Speed (0.75x)",0.75),"-",h("Recorded Speed (1x)",1),h("Double Speed (2x)",2),h("Quad Speed (4x)",4),"-",h("Full Speed",1000)]},{text:"Clear",whenIdle:true,handler:e.onClear,scope:e},"->",{text:"Stop",whenActive:true,disabled:true,handler:e.onStop,scope:e}];var g=e.attachTo&&e.attachTo.testEvents;e.items=[{xtype:"textarea",itemId:"eventView",fieldStyle:"font-family: monospace",selectOnFocus:true,emptyText:"Events go here!",value:g?e.stringifyEvents(g):"",scrollToBottom:function(){var a=this.inputEl.dom;a.scrollTop=a.scrollHeight}}];e.fbar=[{xtype:"tbtext",text:"Attached To: "+(e.attachTo&&e.attachTo.location.href)}];Ext.panel.Panel.prototype.initComponent.call(this)},makeRecordButtonMenu:function(){var h=[],l={},j=this.recorder.eventsToRecord,k=this.eventsToIgnore;Ext.Object.each(j,function(d,a){var b=l[a.kind];if(!b){l[a.kind]=b=[];h.push({text:a.kind,menu:b})}b.push({text:d,checked:true,handler:function(e){if(e.checked){j[d]=a}else{delete j[d]}}});if(k[d]){b[b.length-1].checked=false;Ext.Function.defer(function(){delete j[d]},1)}});function i(b,a){return(b.text<a.text)?-1:((a.text<b.text)?1:0)}h.sort(i);Ext.Array.each(h,function(a){a.menu.sort(i)});return h},getEventView:function(){return this.down("#eventView")},onClear:function(){var b=this.getEventView();b.setValue("")},onPlay:function(){var h=this,g=h.getEventView(),e=g.getValue();if(e){e=Ext.decode(e);if(e.length){h.player=Ext.create("Ext.ux.event.Player",{attachTo:window.opener,eventQueue:e,speed:h.playSpeed,listeners:{stop:h.onPlayStop,scope:h}});h.player.start();h.syncBtnUI()}}},onPlayStop:function(){this.player=null;this.syncBtnUI()},onPlaySpeed:function(b){this.playSpeed=b.speed},onRecord:function(){this.recorder.start();this.syncBtnUI()},onStop:function(){var b=this;if(b.player){b.player.stop();b.player=null}else{b.recorder.stop()}b.syncBtnUI();b.updateEvents()},syncBtnUI:function(){var h=this,e=!h.player&&!h.recorder.active;Ext.each(h.query("[whenIdle]"),function(a){a.setDisabled(!e)});Ext.each(h.query("[whenActive]"),function(a){a.setDisabled(e)});var g=h.getEventView();g.setReadOnly(!e)},stringifyEvents:function(h){var e,g=[];Ext.each(h,function(a){e=[];Ext.Object.each(a,function(d,b){if(e.length){e.push(", ")}else{e.push("  { ")}e.push(d,": ");e.push(Ext.encode(b))});e.push(" }");g.push(e.join(""))});return"[\n"+g.join(",\n")+"\n]"},updateEvents:function(){var e=this,h=e.stringifyEvents(e.recorder.getRecordedEvents()),g=e.getEventView();g.setValue(h);g.scrollToBottom()}},0,["eventrecordermanager"],["component","box","container","panel","eventrecordermanager"],{component:true,box:true,container:true,panel:true,eventrecordermanager:true},["widget.eventrecordermanager"],0,[Ext.ux.event,"RecorderManager"],0));(Ext.cmd.derive("Ext.ux.form.MultiSelect",Ext.form.FieldContainer,{alternateClassName:"Ext.ux.Multiselect",layout:"anchor",ddReorder:false,appendOnly:false,displayField:"text",allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:"This field is required",minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) required",delimiter:",",dragText:"{0} Item{1}",ignoreSelectChange:0,pageSize:10,initComponent:function(){var b=this;b.items=b.setupItems();b.bindStore(b.store,true);Ext.form.FieldContainer.prototype.initComponent.call(this);b.initField()},setupItems:function(){var b=this;b.boundList=new Ext.view.BoundList(Ext.apply({anchor:"none 100%",border:1,multiSelect:true,store:b.store,displayField:b.displayField,disabled:b.disabled,tabIndex:0,navigationModel:{type:"default"}},b.listConfig));b.boundList.getNavigationModel().addKeyBindings({pageUp:b.onKeyPageUp,pageDown:b.onKeyPageDown,scope:b});b.boundList.getSelectionModel().on("selectionchange",b.onSelectChange,b);b.boundList.pickerField=b;if(!b.title){return b.boundList}b.boundList.border=false;return{xtype:"panel",isAriaRegion:false,border:true,anchor:"none 100%",layout:"anchor",title:b.title,tbar:b.tbar,items:b.boundList}},onSelectChange:function(e,d){if(!this.ignoreSelectChange){this.setValue(d)}},getSelected:function(){return this.boundList.getSelectionModel().getSelection()},isEqual:function(j,k){var h=Ext.Array.from,l=0,i;j=h(j);k=h(k);i=j.length;if(i!==k.length){return false}for(;l<i;l++){if(k[l]!==j[l]){return false}}return true},afterRender:function(){var i=this,j=i.boundList,g,h;Ext.form.FieldContainer.prototype.afterRender.call(this);if(i.selectOnRender){g=i.getRecordsForValue(i.value);if(g.length){++i.ignoreSelectChange;i.boundList.getSelectionModel().select(g);--i.ignoreSelectChange}delete i.toSelect}if(i.ddReorder&&!i.dragGroup&&!i.dropGroup){i.dragGroup=i.dropGroup="MultiselectDD-"+Ext.id()}if(i.draggable||i.dragGroup){i.dragZone=Ext.create("Ext.view.DragZone",{view:i.boundList,ddGroup:i.dragGroup,dragText:i.dragText})}if(i.droppable||i.dropGroup){i.dropZone=Ext.create("Ext.view.DropZone",{view:i.boundList,ddGroup:i.dropGroup,handleNodeDrop:function(a,b,p){var o=this.view,e=o.getStore(),n=a.records,d;a.view.store.remove(n);d=e.indexOf(b);if(p==="after"){d++}e.insert(d,n);o.getSelectionModel().select(n);i.fireEvent("drop",i,n)}})}h=i.down("panel");if(h&&j){j.ariaEl.dom.setAttribute("aria-labelledby",h.header.id+"-title-textEl")}},onKeyPageUp:function(l){var m=this,e=m.pageSize,p=m.boundList,k=p.getNavigationModel(),o,n;o=k.recordIndex;n=o>e?o-e:0;k.setPosition(n,l)},onKeyPageDown:function(m){var n=this,e=n.pageSize,r=n.boundList,l=r.getNavigationModel(),o,q,p;o=r.getStore().getCount();q=l.recordIndex;p=q<(o-e)?q+e:o-1;l.setPosition(p,m)},isValid:function(){var e=this,g=e.disabled,h=e.forceValidation||!g;return h?e.validateValue(e.value):g},validateValue:function(g){var h=this,i=h.getErrors(g),j=Ext.isEmpty(i);if(!h.preventMark){if(j){h.clearInvalid()}else{h.markInvalid(i)}}return j},markInvalid:function(h){var e=this,g=e.getActiveError();e.setActiveErrors(Ext.Array.from(h));if(g!==e.getActiveError()){e.updateLayout()}},clearInvalid:function(){var d=this,e=d.hasActiveError();d.unsetActiveError();if(e){d.updateLayout()}},getSubmitData:function(){var g=this,e=null,h;if(!g.disabled&&g.submitValue&&!g.isFileUpload()){h=g.getSubmitValue();if(h!==null){e={};e[g.getName()]=h}}return e},getSubmitValue:function(){var e=this,g=e.delimiter,h=e.getValue();return Ext.isString(g)?h.join(g):h},getValue:function(){return this.value||[]},getRecordsForValue:function(p){var q=this,w=[],o=q.store.getRange(),i=q.valueField,s=0,j=o.length,u,t,r;for(r=p.length;s<r;++s){for(t=0;t<j;++t){u=o[t];if(u.get(i)==p[s]){w.push(u)}}}return w},setupValue:function(l){var i=this.delimiter,o=this.valueField,n=0,p,k,m;if(Ext.isDefined(l)){if(i&&Ext.isString(l)){l=l.split(i)}else{if(!Ext.isArray(l)){l=[l]}}for(k=l.length;n<k;++n){m=l[n];if(m&&m.isModel){l[n]=m.get(o)}}p=Ext.Array.unique(l)}else{p=[]}return p},setValue:function(i){var j=this,g=j.boundList.getSelectionModel(),h=j.store;if(!h.getCount()){h.on({load:Ext.Function.bind(j.setValue,j,[i]),single:true});return}i=j.setupValue(i);j.mixins.field.setValue.call(j,i);if(j.rendered){++j.ignoreSelectChange;g.deselectAll();if(i.length){g.select(j.getRecordsForValue(i))}--j.ignoreSelectChange}else{j.selectOnRender=true}},clearValue:function(){this.setValue([])},onEnable:function(){var b=this.boundList;Ext.form.FieldContainer.prototype.onEnable.call(this);if(b){b.enable()}},onDisable:function(){var b=this.boundList;Ext.form.FieldContainer.prototype.onDisable.call(this);if(b){b.disable()}},getErrors:function(h){var i=this,l=Ext.String.format,j=[],k;h=Ext.Array.from(h||i.getValue());k=h.length;if(!i.allowBlank&&k<1){j.push(i.blankText)}if(k<i.minSelections){j.push(l(i.minSelectionsText,i.minSelections))}if(k>i.maxSelections){j.push(l(i.maxSelectionsText,i.maxSelections))}return j},doDestroy:function(){var b=this;b.bindStore(null);Ext.destroy(b.dragZone,b.dropZone,b.keyNav);Ext.form.FieldContainer.prototype.doDestroy.call(this)},onBindStore:function(g){var h=this,e=this.boundList;if(g.autoCreated){h.resolveDisplayField()}if(!Ext.isDefined(h.valueField)){h.valueField=h.displayField}if(e){e.bindStore(g)}},resolveDisplayField:function(){var h=this,e=h.boundList,g=h.getStore();h.valueField=h.displayField="field1";if(!g.expanded){h.displayField="field2"}if(e){e.setDisplayField(h.displayField)}}},0,["multiselectfield","multiselect"],["component","box","container","fieldcontainer","multiselectfield","multiselect"],{component:true,box:true,container:true,fieldcontainer:true,multiselectfield:true,multiselect:true},["widget.multiselect","widget.multiselectfield"],[[Ext.util.StoreHolder.prototype.mixinId||Ext.util.StoreHolder.$className,Ext.util.StoreHolder],[Ext.form.field.Field.prototype.mixinId||Ext.form.field.Field.$className,Ext.form.field.Field]],[Ext.ux.form,"MultiSelect",Ext.ux,"Multiselect"],0));(Ext.cmd.derive("Ext.ux.form.ItemSelector",Ext.ux.form.MultiSelect,{alternateClassName:["Ext.ux.ItemSelector"],hideNavIcons:false,buttons:["top","up","add","remove","down","bottom"],buttonsText:{top:"Move to Top",up:"Move Up",add:"Add to Selected",remove:"Remove from Selected",down:"Move Down",bottom:"Move to Bottom"},layout:{type:"hbox",align:"stretch"},ariaRole:"group",initComponent:function(){var b=this;b.ddGroup=b.id+"-dd";b.ariaRenderAttributes=b.ariaRenderAttributes||{};b.ariaRenderAttributes["aria-labelledby"]=b.id+"-labelEl";Ext.ux.form.MultiSelect.prototype.initComponent.call(this);b.bindStore(b.store)},createList:function(d){var e=this;return Ext.create("Ext.ux.form.MultiSelect",{submitValue:false,getSubmitData:function(){return null},getModelData:function(){return null},flex:1,dragGroup:e.ddGroup,dropGroup:e.ddGroup,title:d,store:{model:e.store.model,data:[]},displayField:e.displayField,valueField:e.valueField,disabled:e.disabled,listeners:{boundList:{scope:e,itemdblclick:e.onItemDblClick,drop:e.syncValue}}})},setupItems:function(){var b=this;b.fromField=b.createList(b.fromTitle);b.toField=b.createList(b.toTitle);return[b.fromField,{xtype:"toolbar",margin:"0 4",padding:0,layout:{type:"vbox",pack:"center"},items:b.createButtons()},b.toField]},createButtons:function(){var d=this,e=[];if(!d.hideNavIcons){Ext.Array.forEach(d.buttons,function(a){e.push({xtype:"button",ui:"default",tooltip:d.buttonsText[a],ariaLabel:d.buttonsText[a],handler:d["on"+Ext.String.capitalize(a)+"BtnClick"],cls:"x-form-itemselector-btn",iconCls:"x-form-itemselector-"+a,navBtn:true,scope:d,margin:"4 0 0 0"})})}return e},getSelections:function(d){var e=d.getStore();return Ext.Array.sort(d.getSelectionModel().getSelection(),function(a,b){a=e.indexOf(a);b=e.indexOf(b);if(a<b){return -1}else{if(a>b){return 1}}return 0})},onTopBtnClick:function(){var h=this.toField.boundList,g=h.getStore(),e=this.getSelections(h);g.suspendEvents();g.remove(e,true);g.insert(0,e);g.resumeEvents();h.refresh();this.syncValue();h.getSelectionModel().select(e)},onBottomBtnClick:function(){var h=this.toField.boundList,g=h.getStore(),e=this.getSelections(h);g.suspendEvents();g.remove(e,true);g.add(e);g.resumeEvents();h.refresh();this.syncValue();h.getSelectionModel().select(e)},onUpBtnClick:function(){var m=this.toField.boundList,i=m.getStore(),n=this.getSelections(m),l,o=0,k=n.length,p=0;i.suspendEvents();for(;o<k;++o,p++){l=n[o];p=Math.max(p,i.indexOf(l)-1);i.remove(l,true);i.insert(p,l)}i.resumeEvents();m.refresh();this.syncValue();m.getSelectionModel().select(n)},onDownBtnClick:function(){var l=this.toField.boundList,j=l.getStore(),m=this.getSelections(l),k,n=m.length-1,i=j.getCount()-1;j.suspendEvents();for(;n>-1;--n,i--){k=m[n];i=Math.min(i,j.indexOf(k)+1);j.remove(k,true);j.insert(i,k)}j.resumeEvents();l.refresh();this.syncValue();l.getSelectionModel().select(m)},onAddBtnClick:function(){var d=this,e=d.getSelections(d.fromField.boundList);d.moveRec(true,e);d.toField.boundList.getSelectionModel().select(e)},onRemoveBtnClick:function(){var d=this,e=d.getSelections(d.toField.boundList);d.moveRec(false,e);d.fromField.boundList.getSelectionModel().select(e)},moveRec:function(m,n){var p=this,l=p.fromField,k=p.toField,j=m?l.store:k.store,o=m?k.store:l.store;j.suspendEvents();o.suspendEvents();j.remove(n);o.add(n);j.resumeEvents();o.resumeEvents();if(l.boundList.containsFocus){l.boundList.focus()}l.boundList.refresh();k.boundList.refresh();p.syncValue()},syncValue:function(){var b=this;b.mixins.field.setValue.call(b,b.setupValue(b.toField.store.getRange()))},onItemDblClick:function(e,d){this.moveRec(e===this.fromField.boundList,d)},setValue:function(m){var o=this,l=o.fromField,k=o.toField,j=l.store,n=k.store,p;if(!o.fromStorePopulated){o.fromField.store.on({load:Ext.Function.bind(o.setValue,o,[m]),single:true});return}m=o.setupValue(m);o.mixins.field.setValue.call(o,m);p=o.getRecordsForValue(m);j.suspendEvents();n.suspendEvents();j.removeAll();n.removeAll();o.populateFromStore(o.store);Ext.Array.forEach(p,function(a){if(j.indexOf(a)>-1){j.remove(a)}n.add(a)});j.resumeEvents();n.resumeEvents();Ext.suspendLayouts();l.boundList.refresh();k.boundList.refresh();Ext.resumeLayouts(true)},onBindStore:function(h,l){var k=this,j=k.fromField,i=k.toField;if(j){j.store.removeAll();i.store.removeAll();if(h.autoCreated){j.resolveDisplayField();i.resolveDisplayField();k.resolveDisplayField()}if(!Ext.isDefined(k.valueField)){k.valueField=k.displayField}if(h.getCount()){k.populateFromStore(h)}else{k.store.on("load",k.populateFromStore,k)}}},populateFromStore:function(e){var d=this.fromField.store;this.fromStorePopulated=true;d.add(e.getRange());d.fireEvent("load",d)},onEnable:function(){var b=this;Ext.ux.form.MultiSelect.prototype.onEnable.call(this);b.fromField.enable();b.toField.enable();Ext.Array.forEach(b.query("[navBtn]"),function(a){a.enable()})},onDisable:function(){var b=this;Ext.ux.form.MultiSelect.prototype.onDisable.call(this);b.fromField.disable();b.toField.disable();Ext.Array.forEach(b.query("[navBtn]"),function(a){a.disable()})},doDestroy:function(){this.bindStore(null);Ext.ux.form.MultiSelect.prototype.doDestroy.call(this)}},0,["itemselector","itemselectorfield"],["component","box","container","fieldcontainer","multiselectfield","multiselect","itemselectorfield","itemselector"],{component:true,box:true,container:true,fieldcontainer:true,multiselectfield:true,multiselect:true,itemselectorfield:true,itemselector:true},["widget.itemselector","widget.itemselectorfield"],0,[Ext.ux.form,"ItemSelector",Ext.ux,"ItemSelector"],0));(Ext.cmd.derive("Ext.ux.form.SearchField",Ext.form.field.Text,{triggers:{clear:{weight:0,cls:"x-form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:"x-form-search-trigger",handler:"onSearchClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var h=this,g=h.store,e;Ext.form.field.Text.prototype.initComponent.apply(this,arguments);h.on("specialkey",function(b,a){if(a.getKey()==a.ENTER){h.onSearchClick()}});if(!g||!g.isStore){g=h.store=Ext.data.StoreManager.lookup(g)}g.setRemoteFilter(true);e=h.store.getProxy();e.setFilterParam(h.paramName);e.encodeFilters=function(a){return a[0].getValue()}},onClearClick:function(){var d=this,e=d.activeFilter;if(e){d.setValue("");d.store.getFilters().remove(e);d.activeFilter=null;d.getTrigger("clear").hide();d.updateLayout()}},onSearchClick:function(){var e=this,d=e.getValue();if(d.length>0){e.activeFilter=new Ext.util.Filter({property:e.paramName,value:d});e.store.getFilters().add(e.activeFilter);e.getTrigger("clear").show();e.updateLayout()}}},0,["searchfield"],["component","box","field","textfield","searchfield"],{component:true,box:true,field:true,textfield:true,searchfield:true},["widget.searchfield"],0,[Ext.ux.form,"SearchField"],0));(Ext.cmd.derive("Ext.ux.grid.SubTable",Ext.grid.plugin.RowExpander,{rowBodyTpl:['<table class="x-grid-subtable">',"{%","this.owner.renderTable(out, values);","%}","</table>"],init:function(m){var l=this,n=l.columns,j,i,k;Ext.grid.plugin.RowExpander.prototype.init.apply(this,arguments);l.columns=[];if(n){for(i=0,j=n.length;i<j;++i){k=Ext.apply({preventRegister:true},n[i]);k.xtype=k.xtype||"gridcolumn";l.columns.push(Ext.widget(k))}}},destroy:function(){var h=this.columns,g,e;if(h){for(e=0,g=h.length;e<g;++e){h[e].destroy()}}this.columns=null;Ext.grid.plugin.RowExpander.prototype.destroy.call(this)},getRowBodyFeatureData:function(e,g,h){Ext.grid.plugin.RowExpander.prototype.getRowBodyFeatureData.apply(this,arguments);h.rowBodyCls+=" x-grid-subtable-row"},renderTable:function(t,j){var r=this,x=r.columns,A=x.length,y=r.getAssociatedRecords(j.record),i=y.length,w,z,s,u,q;t.push("<thead>");for(u=0;u<A;u++){t.push('<th class="x-grid-subtable-header">',x[u].text,"</th>")}t.push("</thead><tbody>");for(s=0;s<i;s++){w=y[s];t.push("<tr>");for(u=0;u<A;u++){z=x[u];q=w.get(z.dataIndex);if(z.renderer&&z.renderer.call){q=z.renderer.call(z.scope||r,q,{},w)}t.push('<td class="x-grid-subtable-cell"');if(z.width!=null){t.push(' style="width:'+z.width+'px"')}t.push('><div class="x-grid-cell-inner">',q,"</div></td>")}t.push("</tr>")}t.push("</tbody>")},getRowBodyContentsFn:function(e){var d=this;return function(a){e.owner=d;return e.applyTemplate(a)}},getAssociatedRecords:function(b){return b[this.association]().getRange()}},0,0,0,0,["plugin.subtable"],0,[Ext.ux.grid,"SubTable"],0));(Ext.cmd.derive("Ext.ux.grid.TransformGrid",Ext.grid.Panel,{constructor:function(I,C){C=Ext.apply({},C);I=this.table=Ext.get(I);var z=C.fields||[],F=C.columns||[],y=[],w=[],D=I.query("thead th"),A=0,x=D.length,B=I.dom,G,i,u,E,t,H;for(;A<x;++A){E=D[A];t=E.innerHTML;H="tcol-"+A;y.push(Ext.applyIf(z[A]||{},{name:H,mapping:"td:nth("+(A+1)+")/@innerHTML"}));w.push(Ext.applyIf(F[A]||{},{text:t,dataIndex:H,width:E.offsetWidth,tooltip:E.title,sortable:true}))}if(C.width){G=C.width}else{G=I.getWidth()+1}if(C.height){i=C.height}Ext.applyIf(C,{store:{data:B,fields:y,proxy:{type:"memory",reader:{record:"tbody tr",type:"xml"}}},columns:w,width:G,height:i});Ext.grid.Panel.prototype.constructor.call(this,C);if(C.remove!==false){B.parentNode.removeChild(B)}},doDestroy:function(){this.table.remove();this.tabl=null;Ext.grid.Panel.prototype.doDestroy.call(this)}},1,0,["component","box","container","panel","tablepanel","gridpanel","grid"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true},0,0,[Ext.ux.grid,"TransformGrid"],0));(Ext.cmd.derive("Ext.ux.grid.plugin.AutoSelector",Ext.plugin.Abstract,{config:{store:null},init:function(e){var d=this;d.grid=e;d.watchGrid();e.on({reconfigure:d.watchGrid,scope:d})},destroy:function(){this.setStore(null);this.grid=null;Ext.plugin.Abstract.prototype.destroy.call(this)},ensureSelection:function(){var e=this.grid,g=e.getStore(),h;if(g.getCount()){h=e.getSelection();if(!h||!h.length){e.getSelectionModel().select(0)}}},watchGrid:function(){this.setStore(this.grid.getStore());this.ensureSelection()},updateStore:function(e){var d=this;Ext.destroy(d.storeListeners);d.storeListeners=e&&e.on({add:d.ensureSelection,remove:d.ensureSelection,destroyable:true,scope:d})}},0,0,0,0,["plugin.gridautoselector"],0,[Ext.ux.grid.plugin,"AutoSelector"],0));(Ext.cmd.derive("Ext.ux.layout.ResponsiveColumn",Ext.layout.container.Auto,{states:{small:1000,large:0},_responsiveCls:"x-responsivecolumn",initLayout:function(){this.innerCtCls+=" "+this._responsiveCls;Ext.layout.container.Auto.prototype.initLayout.call(this)},beginLayout:function(s){var n=this,o=Ext.Element.getViewportWidth(),m=n.states,p=Infinity,u=n.innerCt,t=n._currentState,w,q,r;for(w in m){q=m[w]||Infinity;if(o<=q&&q<=p){p=q;r=w}}if(r!==t){u.replaceCls(t,r,n._responsiveCls);n._currentState=r}Ext.layout.container.Auto.prototype.beginLayout.apply(this,arguments)},onAdd:function(e){Ext.layout.container.Auto.prototype.onAdd.call(this,e);var d=e.responsiveCls;if(d){e.addCls(d)}}},0,0,0,0,["layout.responsivecolumn"],0,[Ext.ux.layout,"ResponsiveColumn"],function(b){if(Ext.isIE8){b.override({responsiveSizePolicy:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:0},setsItemSize:true,calculateItems:function(B,E){var i=this,A=B.targetContext,s=B.childItems,u=s.length,z=E.gotWidth,D=E.width,x,a,y,C,w,t;if(z===false){A.domBlock(i,"width");return false}if(!z){return true}for(y=0;y<u;++y){C=s[y];t=parseInt(C.el.getStyle("background-position-x"),10);w=parseInt(C.el.getStyle("background-position-y"),10);C.setWidth((t/100*(D-w))-w)}B.setContentWidth(D+B.paddingContext.getPaddingInfo().width);return true},getItemSizePolicy:function(){return this.responsiveSizePolicy}})}}));(Ext.cmd.derive("Ext.ux.rating.Picker",Ext.Widget,{focusable:true,cachedConfig:{family:"monospace",glyphs:"☆★",minimum:1,limit:5,overStyle:null,rounding:1,scale:"125%",selectedStyle:null,tooltip:null,trackOver:true,value:null,tooltipText:null,trackingValue:null},config:{animate:null},element:{cls:"ux-rating-picker",reference:"element",children:[{reference:"innerEl",cls:"ux-rating-picker-inner",listeners:{click:"onClick",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},children:[{reference:"valueEl",cls:"ux-rating-picker-value"},{reference:"trackerEl",cls:"ux-rating-picker-tracker"}]}]},defaultBindProperty:"value",twoWayBindable:"value",overCls:"ux-rating-picker-over",trackOverCls:"ux-rating-picker-track-over",applyGlyphs:function(b){if(typeof b==="string"){b=[b.charAt(0),b.charAt(1)]}else{if(typeof b[0]==="number"){b=[String.fromCharCode(b[0]),String.fromCharCode(b[1])]}}return b},applyOverStyle:function(b){this.trackerEl.applyStyles(b)},applySelectedStyle:function(b){this.valueEl.applyStyles(b)},applyTooltip:function(b){if(b&&typeof b!=="function"){if(!b.isTemplate){b=new Ext.XTemplate(b)}b=b.apply.bind(b)}return b},applyTrackingValue:function(b){return this.applyValue(b)},applyValue:function(j){if(j!==null){var g=this.getRounding(),h=this.getLimit(),i=this.getMinimum();j=Math.round(Math.round(j/g)*g*1000)/1000;j=(j<i)?i:(j>h?h:j)}return j},onClick:function(e){var d=this.valueFromEvent(e);this.setValue(d)},onMouseEnter:function(){this.element.addCls(this.overCls)},onMouseLeave:function(){this.element.removeCls(this.overCls)},onMouseMove:function(e){var d=this.valueFromEvent(e);this.setTrackingValue(d)},updateFamily:function(b){this.element.setStyle("fontFamily","'"+b+"'")},updateGlyphs:function(){this.refreshGlyphs()},updateLimit:function(){this.refreshGlyphs()},updateScale:function(b){this.element.setStyle("fontSize",b)},updateTooltip:function(){this.refreshTooltip()},updateTooltipText:function(j){var k=this.innerEl,i=Ext.tip&&Ext.tip.QuickTipManager,h=i&&i.tip,l;if(i){k.dom.setAttribute("data-qtip",j);this.trackerEl.dom.setAttribute("data-qtip",j);l=h&&h.activeTarget;l=l&&l.el;if(l&&k.contains(l)){h.update(j)}}},updateTrackingValue:function(i){var j=this,h=j.trackerEl,g=j.valueToPercent(i);h.setStyle("width",g);j.refreshTooltip()},updateTrackOver:function(b){this.element[b?"addCls":"removeCls"](this.trackOverCls)},updateValue:function(m,r){var o=this,k=o.getAnimate(),n=o.valueEl,p=o.valueToPercent(m),q,l;if(o.isConfiguring||!k){n.setStyle("width",p)}else{n.stopAnimation();n.animate(Ext.merge({from:{width:o.valueToPercent(r)},to:{width:p}},k))}o.refreshTooltip();if(!o.isConfiguring){if(o.hasListeners.change){o.fireEvent("change",o,m,r)}q=o.getWidgetColumn&&o.getWidgetColumn();l=q&&o.getWidgetRecord&&o.getWidgetRecord();if(l&&q.dataIndex){l.set(q.dataIndex,m)}}},afterCachedConfig:function(){this.refresh();return Ext.Widget.prototype.afterCachedConfig.apply(this,arguments)},initConfig:function(b){this.isConfiguring=true;this.callParent([b]);this.refresh()},setConfig:function(){var b=this;b.isReconfiguring=true;b.callParent(arguments);b.isReconfiguring=false;b.refresh();return b},destroy:function(){this.tip=Ext.destroy(this.tip);Ext.Widget.prototype.destroy.call(this)},privates:{getGlyphTextNode:function(d){var e=d.lastChild;if(!e||e.nodeType!==3){e=d.ownerDocument.createTextNode("");d.appendChild(e)}return e},getTooltipData:function(){var b=this;return{component:b,tracking:b.getTrackingValue(),trackOver:b.getTrackOver(),value:b.getValue()}},refresh:function(){var b=this;if(b.invalidGlyphs){b.refreshGlyphs(true)}if(b.invalidTooltip){b.refreshTooltip(true)}},refreshGlyphs:function(w){var n=this,p=!w&&(n.isConfiguring||n.isReconfiguring),t,m,q,o,r,u,s;if(!p){t=n.getGlyphTextNode(n.innerEl.dom);s=n.getGlyphTextNode(n.valueEl.dom);u=n.getGlyphTextNode(n.trackerEl.dom);m=n.getGlyphs();q=n.getLimit();for(o=r="";q--;){r+=m[0];o+=m[1]}t.nodeValue=r;s.nodeValue=o;u.nodeValue=o}n.invalidGlyphs=p},refreshTooltip:function(i){var n=this,j=!i&&(n.isConfiguring||n.isReconfiguring),l=n.getTooltip(),m,k;if(!j){l=n.getTooltip();if(l){m=n.getTooltipData();k=l(m);n.setTooltipText(k)}}n.invalidTooltip=j},valueFromEvent:function(w){var q=this,u=q.innerEl,r=w.getX(),m=q.getRounding(),s=u.getX(),p=r-s,o=u.getWidth(),t=q.getLimit(),n;if(q.getInherited().rtl){p=o-p}n=p/o*t;n=Math.ceil(n/m)*m;return n},valueToPercent:function(b){b=(b/this.getLimit())*100;return b+"%"}}},0,["rating"],["widget","rating"],{widget:true,rating:true},["widget.rating"],0,[Ext.ux.rating,"Picker"],0));(Ext.cmd.derive("Ext.ux.statusbar.ValidationStatus",Ext.Component,{errorIconCls:"x-status-error",errorListCls:"x-status-error-list",validIconCls:"x-status-valid",showText:"The form has errors (click for details...)",hideText:"Click again to hide the error list",submitText:"Saving...",init:function(d){var e=this;e.statusBar=d;d.on({single:true,scope:e,render:e.onStatusbarRender});d.on({click:{element:"el",fn:e.onStatusClick,scope:e,buffer:200}})},onStatusbarRender:function(h){var e=this,g=function(){e.monitor=true};e.monitor=true;e.errors=Ext.create("Ext.util.MixedCollection");e.listAlign=(h.statusAlign==="right"?"br-tr?":"bl-tl?");if(e.form){e.formPanel=Ext.getCmp(e.form)||e.statusBar.lookupController().lookupReference(e.form);e.basicForm=e.formPanel.getForm();e.startMonitoring();e.basicForm.on({beforeaction:function(a,b){if(b.type==="submit"){e.monitor=false}}});e.formPanel.on({beforedestroy:e.destroy,scope:e});e.basicForm.on("actioncomplete",g);e.basicForm.on("actionfailed",g)}},startMonitoring:function(){this.basicForm.getFields().each(function(b){b.on("validitychange",this.onFieldValidation,this)},this)},stopMonitoring:function(){var b=this.basicForm;if(!b.destroyed){b.getFields().each(function(a){a.un("validitychange",this.onFieldValidation,this)},this)}},doDestroy:function(){Ext.destroy(this.msgEl);this.stopMonitoring();this.statusBar.statusEl.un("click",this.onStatusClick,this);Ext.Component.prototype.doDestroy.call(this)},onFieldValidation:function(g,j){var h=this,i;if(!h.monitor){return false}i=g.getErrors()[0];if(i){h.errors.add(g.id,{field:g,msg:i})}else{h.errors.removeAtKey(g.id)}this.updateErrorList();if(h.errors.getCount()>0){if(h.statusBar.getText()!==h.showText){h.statusBar.setStatus({text:h.showText,iconCls:h.errorIconCls})}}else{h.statusBar.clearStatus().setIcon(h.validIconCls)}},updateErrorList:function(){var e=this,h,g=e.getMsgEl();if(e.errors.getCount()>0){h=["<ul>"];this.errors.each(function(a){h.push('<li id="x-err-',a.field.id,'"><a href="#">',a.msg,"</a></li>")});h.push("</ul>");g.update(h.join(""))}else{g.update("")}g.setSize("auto","auto")},getMsgEl:function(){var h=this,g=h.msgEl,e;if(!g){g=h.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:h.errorListCls},true);g.hide();g.on("click",function(a){e=a.getTarget("li",10,true);if(e){Ext.getCmp(e.id.split("x-err-")[1]).focus();h.hideErrors()}},null,{stopEvent:true})}return g},showErrors:function(){var b=this;b.updateErrorList();b.getMsgEl().alignTo(b.statusBar.getEl(),b.listAlign).slideIn("b",{duration:300,easing:"easeOut"});b.statusBar.setText(b.hideText);b.formPanel.body.on("click",b.hideErrors,b,{single:true})},hideErrors:function(){var b=this.getMsgEl();if(b.isVisible()){b.slideOut("b",{duration:300,easing:"easeIn"});this.statusBar.setText(this.showText)}this.formPanel.body.un("click",this.hideErrors,this)},onStatusClick:function(){if(this.getMsgEl().isVisible()){this.hideErrors()}else{if(this.errors.getCount()>0){this.showErrors()}}}},0,0,["component","box"],{component:true,box:true},["plugin.validationstatus"],0,[Ext.ux.statusbar,"ValidationStatus"],0));Ext.override(Ext.grid.column.Column,{constructor:function(b){Ext.apply(b,{align:"left"});this.callParent([b])}});(Ext.cmd.derive("Rd.view.aps.pnlAccessPointEdit",Ext.tab.Panel,{border:false,plain:true,cls:"subTab",tabPosition:"top",ap_profile_id:undefined,initComponent:function(){var b=this;b.items=[{title:"SSIDs",itemId:"tabEntryPoints",xtype:"gridAccessPointEntries",apProfileId:b.ap_profile_id},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridAccessPointExits",apProfileId:b.ap_profile_id},{title:"Common Settings",itemId:"tabAccessPointCommonSettings",xtype:"pnlAccessPointCommonSettings",apProfileId:b.ap_profile_id},{title:"Devices",itemId:"tabAccessPointAps",xtype:"gridAccessPointAps",apProfileId:b.ap_profile_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointEdit"],["component","box","container","panel","tabpanel","pnlAccessPointEdit"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessPointEdit:true},["widget.pnlAccessPointEdit"],0,[Rd.view.aps,"pnlAccessPointEdit"],0));(Ext.cmd.derive("Rd.model.mAccessPointEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"name",type:"string"},{name:"encryption",type:"string"},{name:"hidden",type:"bool"},{name:"isolate",type:"bool"},{name:"key",type:"string"},{name:"auth_server",type:"string"},{name:"auth_secret",type:"string"},{name:"connected_to_exit",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAccessPointEntry"],0));(Ext.cmd.derive("Rd.model.mAccessPointExit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"type",type:"string"},"connects_with"]},0,0,0,0,0,0,[Rd.model,"mAccessPointExit"],0));(Ext.cmd.derive("Rd.model.mAp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},"last_contact_human","country_code","country_name","city","postal_code",{name:"available_to_siblings",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAp"],0));(Ext.cmd.derive("Rd.model.mAccessPointEntryPoint",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mAccessPointEntryPoint"],0));(Ext.cmd.derive("Rd.model.mRealm",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},"phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon","twitter","facebook","youtube","google_plus","linkedin","t_c_title","t_c_content",{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mRealm"],0));(Ext.cmd.derive("Rd.model.mPermanentUser",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"owner",type:"string"},{name:"owner_id",type:"int"},{name:"auth_type",type:"string"},{name:"realm",type:"string"},{name:"realm_id"},{name:"profile",type:"string"},{name:"profile_id"},"perc_time_used","perc_data_used","name","surname","phone","email","address",{name:"active",type:"bool"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage","data_cap","time_cap",{name:"static_ip",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"notes",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPermanentUser"],0));(Ext.cmd.derive("Rd.view.components.cmbApProfile",Ext.form.ComboBox,{fieldLabel:"Profile",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"ap_profile_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_profile_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbApProfile"],["component","box","field","textfield","pickerfield","combobox","combo","cmbApProfile"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbApProfile:true},["widget.cmbApProfile"],0,[Rd.view.components,"cmbApProfile"],0));(Ext.cmd.derive("Rd.view.aps.cmbApHardwareModels",Ext.form.ComboBox,{fieldLabel:i18n("sHardware_model"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"hardware",name:"hardware",value:"dragino",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name","radios"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/aps/hardware_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbApHardwareModels"],["component","box","field","textfield","pickerfield","combobox","combo","cmbApHardwareModels"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbApHardwareModels:true},["widget.cmbApHardwareModels"],0,[Rd.view.aps,"cmbApHardwareModels"],0));(Ext.cmd.derive("Rd.view.components.cmbFiveGigChannels",Ext.form.ComboBox,{fieldLabel:"5G Channel",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"five_chan",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"36",text:"36 (low power)"},{id:"40",text:"40 (low power)"},{id:"44",text:"44 (low power)"},{id:"48",text:"48 (low power)"},{id:"52",text:"52 (DFS)"},{id:"56",text:"56 (DFS)"},{id:"60",text:"60 (DFS)"},{id:"64",text:"64 (DFS)"},{id:"149",text:"149 (high power)"},{id:"153",text:"153 (high power)"},{id:"157",text:"157 (high power)"},{id:"161",text:"161 (high power)"},{id:"165",text:"165 (high power)"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbFiveGigChannels"],["component","box","field","textfield","pickerfield","combobox","combo","cmbFiveGigChannels"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbFiveGigChannels:true},["widget.cmbFiveGigChannels"],0,[Rd.view.components,"cmbFiveGigChannels"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Device",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAddAp"],["component","box","container","panel","window","winAccessPointAddAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddAp:true},["widget.winAccessPointAddAp"],0,[Rd.view.aps,"winAccessPointAddAp"],0));(Ext.cmd.derive("Rd.view.components.cmbDynamicDetail",Ext.form.ComboBox,{fieldLabel:"Login Page",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"dynamic_detail_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mDynamicDetail",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicDetail"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicDetail"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicDetail:true},["widget.cmbDynamicDetail"],0,[Rd.view.components,"cmbDynamicDetail"],0));(Ext.cmd.derive("Rd.view.components.cmbOpenVpnServers",Ext.form.ComboBox,{fieldLabel:i18n("sOpenVPN_Server"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",name:"openvpn_server_id",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/openvpn_servers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbOpenVpnServers"],["component","box","field","textfield","pickerfield","combobox","combo","cmbOpenVpnServers"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbOpenVpnServers:true},["widget.cmbOpenVpnServers"],0,[Rd.view.components,"cmbOpenVpnServers"],0));(Ext.cmd.derive("Rd.view.aps.vcAccessPointExitPoint",Ext.app.ViewController,{config:{urlCheckExperimental:"/cake2/rd_cake/ap_profiles/ap_experimental_check.json"},init:function(){var b=this},onChkDnsOverrideChange:function(i){var l=this;var m=i.up("form");var k=m.down("#txtDns1");var n=m.down("#txtDns2");var j=m.down("#chkDnsDesk");if(i.getValue()){k.enable();n.enable();j.setValue(false);j.disable()}else{k.disable();n.disable();j.enable()}},onChkDnsDeskChange:function(i){var k=this;var l=i.up("form");var h=l.down("#chkDnsOverride");var j=l.down("#chkAnyDns");if(i.getValue()){j.setValue(false);j.disable();h.setValue(false);h.disable()}else{j.enable();h.enable()}},onDnsDeskBeforeRender:function(e){var d=this;Ext.Ajax.request({url:d.getUrlCheckExperimental(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.active){e.show();e.enable()}else{e.hide();e.disable()}}},scope:d})}},0,0,0,0,["controller.vcAccessPointExitPoint"],0,[Rd.view.aps,"vcAccessPointExitPoint"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Access Point Exit",width:530,height:530,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,apProfileId:"",exitId:"",store:undefined,defaults:{border:false},controller:"vcAccessPointExitPoint",initComponent:function(){var o=this;var k=Ext.create("Rd.view.aps.cmbAccessPointEntryPoints",{labelClsExtra:"lblRdlReq"});var p=true;if(o.type=="captive_portal"){p=false}k.getStore().getProxy().setExtraParam("ap_profile_id",o.apProfileId);k.getStore().getProxy().setExtraParam("exit_id",o.exitId);k.getStore().load();var m=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:o.apProfileId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},k,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Auto-add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Auto-add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",hidden:p,items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sBasic"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq",emptyText:"http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/",blankText:"Try http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:i18n("sProxy"),itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:i18n("sEnable"),name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUpstream_proxy"),name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sUpstream_port"),name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_name"),name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_password"),name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:i18n("sCoova_specific"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:i18n("sOptional_config_items"),name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});var q=m.down("#tabCaptivePortal");var l=m.down("#chkNasClient");var n=m.down("#chkLoginPage");var r=m.down("cmbDynamicDetail");if(o.type=="captive_portal"){q.setDisabled(false);l.setVisible(true);l.setDisabled(false);n.setVisible(true);n.setDisabled(false);r.setVisible(true);r.setDisabled(false)}else{q.setDisabled(true);l.setVisible(false);l.setDisabled(true);n.setVisible(false);n.setDisabled(true);r.setVisible(false);r.setDisabled(true)}o.items=m;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditExit"],["component","box","container","panel","window","winAccessPointEditExit"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditExit:true},["widget.winAccessPointEditExit"],0,[Rd.view.aps,"winAccessPointEditExit"],0));(Ext.cmd.derive("Rd.store.sAccessPointEntries",Ext.data.Store,{model:"Rd.model.mAccessPointEntry",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_entries_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_entry_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointEntries"],0));(Ext.cmd.derive("Rd.store.sAccessPointExits",Ext.data.Store,{model:"Rd.model.mAccessPointExit",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_exits_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_exit_delete.json"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointExits"],0));(Ext.cmd.derive("Rd.store.sAps",Ext.data.Store,{model:"Rd.model.mAp",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/ap_profile_ap_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_ap_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAps"],0));(Ext.cmd.derive("Rd.store.sAccessPointEntryPoints",Ext.data.Store,{model:"Rd.model.mAccessPointEntryPoint",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/access_point_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessPointEntryPoints"],0));(Ext.cmd.derive("Rd.store.sRealms",Ext.data.Store,{model:"Rd.model.mRealm",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/realms/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sRealms"],0));(Ext.cmd.derive("Rd.view.components.cmbEncryptionOptions",Ext.form.ComboBox,{fieldLabel:i18n("sEncryption"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"encryption",name:"encryption",value:"none",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEncryptionOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEncryptionOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEncryptionOptions:true},["widget.cmbEncryptionOptions"],0,[Rd.view.components,"cmbEncryptionOptions"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Access Point SSID",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,ap_profile_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:e.apProfileId},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Frequency",defaultType:"radiofield",labelClsExtra:"lblRdReq",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"2.4G",name:"frequency_band",inputValue:"two",margin:Rd.config.radioMargin},{boxLabel:"5G",name:"frequency_band",inputValue:"five",margin:Rd.config.radioMargin},{boxLabel:"Both",name:"frequency_band",inputValue:"both",value:true,margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabEncryption",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAddEntry"],["component","box","container","panel","window","winAccessPointAddEntry"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddEntry:true},["widget.winAccessPointAddEntry"],0,[Rd.view.aps,"winAccessPointAddEntry"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Device",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_id",xtype:"textfield",name:"id",hidden:true,value:g.apId},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditAp"],["component","box","container","panel","window","winAccessPointEditAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditAp:true},["widget.winAccessPointEditAp"],0,[Rd.view.aps,"winAccessPointEditAp"],0));(Ext.cmd.derive("Rd.view.components.cmbRealm",Ext.form.ComboBox,{fieldLabel:i18n("sRealm"),labelSeparator:"",store:"sRealms",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"realm_id",labelClsExtra:"lblRd",type:"create",extraParam:false,initComponent:function(){var h=this;var g="/cake3/rd_cake/realms/index-ap-update.json";if(h.type=="create"){g="/cake3/rd_cake/realms/index-ap-create.json"}var e=Ext.create("Ext.data.Store",{model:"Rd.model.mRealm",proxy:{type:"ajax",format:"json",batchActions:true,url:g,reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(h.extraParam){e.getProxy().setExtraParam("ap_id",h.extraParam)}h.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbRealm"],["component","box","field","textfield","pickerfield","combobox","combo","cmbRealm"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbRealm:true},["widget.cmbRealm"],0,[Rd.view.components,"cmbRealm"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAddExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Access Point Exit",width:530,height:530,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,store:undefined,defaults:{border:false},startScreen:"scrnType",controller:"vcAccessPointExitPoint",initComponent:function(){var e=this;var g=e.mkScrnType();var h=e.mkScrnData();e.items=[g,h];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnType:function(){var l=this;var h=[{itemId:"btnTypeNext",text:i18n("sNext"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}];var i=false;l.store.each(function(a,e,b){var d=a.get("type");if(d=="bridge"){i=true;return false}});if(i==true){var j=[{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge",checked:true},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}else{var j=[{boxLabel:i18n("sEthernet_bridge"),name:"exit_type",inputValue:"bridge",checked:true},{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge"},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}var k=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:i18n("sExit_point_type"),columns:1,vertical:true,items:j}],buttons:h});return k},mkScrnData:function(){var e=this;var g=Ext.create("Rd.view.aps.cmbAccessPointEntryPoints",{labelClsExtra:"lblRdReq"});g.getStore().getProxy().setExtraParam("ap_profile_id",e.apProfileId);g.getStore().load();var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true,value:e.apProfileId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},g,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Auto-add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Auto-add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sBasic"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq",emptyText:"http://your_ip_here/cake3/rd_cake/dynamic-details/chilli_browser_detect/",blankText:"Try http://your_ip_here/cake3/rd_cake/dynamic-details/chilli-browser-detect/"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:i18n("sProxy"),itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:i18n("sEnable"),name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUpstream_proxy"),name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sUpstream_port"),name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_name"),name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:i18n("sAuth_password"),name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:i18n("sCoova_specific"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:i18n("sOptional_config_items"),name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});return h}},0,["winAccessPointAddExit"],["component","box","container","panel","window","winAccessPointAddExit"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAddExit:true},["widget.winAccessPointAddExit"],0,[Rd.view.aps,"winAccessPointAddExit"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointEditEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Access Point SSID",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,ap_profile_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{itemId:"ap_profile_id",xtype:"textfield",name:"ap_profile_id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Frequency",defaultType:"radiofield",labelClsExtra:"lblRdReq",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"2.4G",name:"frequency_band",inputValue:"two",margin:Rd.config.radioMargin},{boxLabel:"5G",name:"frequency_band",inputValue:"five",margin:Rd.config.radioMargin},{boxLabel:"Both",name:"frequency_band",inputValue:"both",value:true,margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabEncryption",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointEditEntry"],["component","box","container","panel","window","winAccessPointEditEntry"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointEditEntry:true},["widget.winAccessPointEditEntry"],0,[Rd.view.aps,"winAccessPointEditEntry"],0));(Ext.cmd.derive("Rd.view.components.ajaxToolbar",Ext.toolbar.Toolbar,{url:null,extra_text:null,initComponent:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",success:b.buildToolbar,scope:b});Ext.toolbar.Toolbar.prototype.initComponent.apply(this,arguments)},buildToolbar:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);if(e.success){Ext.each(e.items,function(a){h.add(a)});if(h.extra_text!=null){h.add({xtype:"tbtext",html:h.extra_text})}}}},0,["ajaxToolbar"],["component","box","container","toolbar","ajaxToolbar"],{component:true,box:true,container:true,toolbar:true,ajaxToolbar:true},["widget.ajaxToolbar"],0,[Rd.view.components,"ajaxToolbar"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridAccessPointEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_entries_grid.json",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAccessPointEntries,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessPointEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridAccessPointEntries2"},{text:i18n("sEncryption"),dataIndex:"encryption",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="encryption==\'none\'"><div class="fieldGreyWhite"><i class="fa fa-unlock"></i>  '+i18n("sNone")+"</div></tpl>",'<tpl if="encryption==\'wep\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWEP")+"</div></tpl>",'<tpl if="encryption==\'psk\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Personal")+"</div></tpl>",'<tpl if="encryption==\'psk2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Personal")+"</div></tpl>",'<tpl if="encryption==\'wpa\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Enterprise")+"</div></tpl>",'<tpl if="encryption==\'wpa2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Enterprise")+"</div></tpl>"),stateId:"StateGridAccessPointEntries3"},{text:i18n("sHidden"),dataIndex:"hidden",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries4",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="hidden"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sClient_isolation"),dataIndex:"isolate",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="isolate"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:"Connected to Exit",dataIndex:"connected_to_exit",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries6",renderer:function(h,a,g){if(h==true){return'<div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>'}if(h==false){a.tdAttr="data-qtip=\"<div><label class='lblTipItem'>Go to Exit Points and connect this SSID to an Exit Point</label></div>\"";return'<div class="fieldRedWhite"><i class="fa  fa-exclamation-circle"></i> No</div>'}}},{text:"Frequency",dataIndex:"frequency_band",tdCls:"gridTree",flex:1,renderer:function(g,h,a){if(g=="both"){return"2.4G and 5G"}if(g=="two"){return"2.4G"}if(g=="five"){return"5G"}},stateId:"StateGridAccessPointEntries7"},{text:"WPA Personal Key",hidden:true,dataIndex:"key",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries8"},{text:"RADIUS Server",hidden:true,dataIndex:"auth_server",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries9"},{text:"RADIUS Secret",hidden:true,dataIndex:"auth_secret",tdCls:"gridTree",flex:1,stateId:"StateGridAccessPointEntries10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointEntries:true},["widget.gridAccessPointEntries"],0,[Rd.view.aps,"gridAccessPointEntries"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointExits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridAccessPointExitsId",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_exits_grid.json",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAccessPointExits,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessPointExitsId1"},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'bridge\'"><div class="fieldGreyWhite"><i class="fa fa-bars"></i>  Bridge</div></tpl>','<tpl if="type==\'captive_portal\'"><div class="fieldPurpleWhite"><i class="fa fa-key"></i>  Captive Portal</div></tpl>','<tpl if="type==\'nat\'"><div class="fieldGreenWhite"><i class="fa fa-arrows-alt"></i>  NAT+DHCP</div></tpl>','<tpl if="type==\'tagged_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-tag"></i>  Tagged Ethernet Bridge</div></tpl>','<tpl if="type==\'openvpn_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-quote-right"></i>  OpenVPN Bridge</div></tpl>'),stateId:"StateGridAccessPointExitsId2"},{text:i18n("sConnects_with"),sortable:false,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(connects_with)"><div class="fieldRedWhite"><i class="fa fa-exclamation-circle"></i> '+i18n("sNo_one")+"</div></tpl>",'<tpl for="connects_with">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"connects_with",stateId:"StateGridAccessPointExitsId3"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointExits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointExits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointExits:true},["widget.gridAccessPointExits"],0,[Rd.view.aps,"gridAccessPointExits"],0));(Ext.cmd.derive("Rd.view.components.cmbCountries",Ext.form.ComboBox,{fieldLabel:"Country",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"country",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/country_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCountries"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCountries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCountries:true},["widget.cmbCountries"],0,[Rd.view.components,"cmbCountries"],0));(Ext.cmd.derive("Rd.view.components.cmbTimezones",Ext.form.ComboBox,{fieldLabel:"Timezone",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"timezone",multiSelect:false,labelClsExtra:"lblRd",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/timezone_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbTimezones"],["component","box","field","textfield","pickerfield","combobox","combo","cmbTimezones"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbTimezones:true},["widget.cmbTimezones"],0,[Rd.view.components,"cmbTimezones"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointCommonSettings",Ext.panel.Panel,{border:false,layout:"hbox",align:"stretch",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:400,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"System",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"}]},{title:i18n("sMonitor"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",name:"heartbeat_interval",itemId:"heartbeat_interval",fieldLabel:i18n("sHeartbeat_interval"),value:60,maxValue:21600,minValue:60},{xtype:"numberfield",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:600,maxValue:21600,minValue:300}]},{title:i18n("sGateway"),layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{labelWidth:300},autoScroll:true,items:[{xtype:"numberfield",name:"gw_dhcp_timeout",itemId:"gw_dhcp_timeout",fieldLabel:i18n("sWait_time_for_DHCP_IP"),value:120,maxValue:600,minValue:120,labelWidth:280},{xtype:"checkbox",fieldLabel:i18n("sUse_previous_settings_when_DHCP_fails"),name:"gw_use_previous",inputValue:"gw_use_previous",itemId:"gw_use_previous",checked:true,labelClsExtra:"lblRd",labelWidth:280}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointCommonSettings"],["component","box","container","panel","pnlAccessPointCommonSettings"],{component:true,box:true,container:true,panel:true,pnlAccessPointCommonSettings:true},["widget.pnlAccessPointCommonSettings"],0,[Rd.view.aps,"pnlAccessPointCommonSettings"],0));(Ext.cmd.derive("Rd.view.aps.gridAccessPointAps",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGAPD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_devices_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sAps,{});b.store.getProxy().setExtraParam("ap_profile_id",b.apProfileId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGAPD1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGAPD2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGAPD3"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGAPD4"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,stateId:"StateGAPD5"},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGAPD6"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",width:170,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_from_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGAPD7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessPointAps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessPointAps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessPointAps:true},["widget.gridAccessPointAps"],0,[Rd.view.aps,"gridAccessPointAps"],0));(Ext.cmd.derive("Rd.view.aps.cmbAccessPointEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:true,labelClsExtra:"lblRdReq",allowBlank:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_profiles/ap_profile_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAccessPointEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAccessPointEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAccessPointEntryPoints:true},["widget.cmbAccessPointEntryPoints"],0,[Rd.view.aps,"cmbAccessPointEntryPoints"],0));(Ext.cmd.derive("Rd.view.components.cmbMacFilter",Ext.form.ComboBox,{fieldLabel:i18n("sMacFilter"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"macfilter",labelClsExtra:"lblRd",value:"disable",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"disable",text:i18n("sDisabled")},{id:"allow",text:i18n("sAllow")},{id:"deny",text:i18n("sDeny")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMacFilter"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMacFilter"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMacFilter:true},["widget.cmbMacFilter"],0,[Rd.view.components,"cmbMacFilter"],0));(Ext.cmd.derive("Rd.view.components.cmbPermanentUser",Ext.form.ComboBox,{fieldLabel:i18n("sOwner"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"username",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"user_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mPermanentUser",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/permanent-users/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(j,k,a,l){if(!a){var b=l.getError();Ext.ux.Toaster.msg("Warning",b,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPermanentUser"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPermanentUser"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPermanentUser:true},["widget.cmbPermanentUser"],0,[Rd.view.components,"cmbPermanentUser"],0));(Ext.cmd.derive("Rd.controller.cAccessPointEdits",Ext.app.Controller,{views:["aps.pnlAccessPointEdit","aps.gridAccessPointEntries","aps.gridAccessPointExits","aps.pnlAccessPointCommonSettings","aps.gridAccessPointAps","aps.winAccessPointAddEntry","components.cmbEncryptionOptions","aps.winAccessPointEditEntry","aps.winAccessPointAddExit","aps.cmbAccessPointEntryPoints","aps.winAccessPointEditExit","aps.cmbApHardwareModels","aps.winAccessPointAddAp","aps.winAccessPointEditAp","components.cmbTimezones","components.cmbCountries","components.cmbFiveGigChannels","components.cmbRealm","components.cmbMacFilter","components.cmbPermanentUser"],stores:["sAccessPointEntries","sAccessPointExits","sAps","sAccessPointEntryPoints","sRealms"],models:["mAccessPointEntry","mAccessPointExit","mAp","mAccessPointEntryPoint","mRealm","mPermanentUser"],config:{urlAddEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_add.json",urlViewEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_view.json",urlEditEntry:"/cake2/rd_cake/ap_profiles/ap_profile_entry_edit.json",urlExitAddDefaults:"/cake2/rd_cake/ap_profiles/ap_profile_exit_add_defaults.json",urlAddExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_add.json",urlViewExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_view.json",urlEditExit:"/cake2/rd_cake/ap_profiles/ap_profile_exit_edit.json",urlViewApCommonSettings:"/cake2/rd_cake/ap_profiles/ap_common_settings_view.json",urlEditApCommonSettings:"/cake2/rd_cake/ap_profiles/ap_common_settings_edit.json",urlAddAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_add.json",urlViewAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_view.json",urlEditAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_edit.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlMapPrefEdit:"/cake2/rd_cake/meshes/map_pref_edit.json",urlMapSave:"/cake2/rd_cake/meshes/map_node_save.json",urlMapDelete:"/cake2/rd_cake/meshes/map_node_delete.json",urlMeshNodes:"/cake2/rd_cake/meshes/mesh_nodes_index.json",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlAdvancedSettingsForModel:"/cake2/rd_cake/ap_profiles/advanced_settings_for_model.json"},refs:[{ref:"editEntryWin",selector:"winAccessPointEditEntry"},{ref:"editExitWin",selector:"winAccessPointEditExit"},{ref:"tabAccessPoints",selector:"#tabAccessPoints"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"gridAccessPointEntries #reload":{click:b.reloadEntry},"gridAccessPointEntries #add":{click:b.addEntry},"gridAccessPointEntries #edit":{click:b.editEntry},"winAccessPointAddEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winAccessPointAddEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winAccessPointAddEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winAccessPointAddEntry #save":{click:b.btnAddEntrySave},"gridAccessPointEntries #delete":{click:b.delEntry},winAccessPointEditEntry:{beforeshow:b.loadEntry},"winAccessPointEditEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winAccessPointEditEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winAccessPointEditEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winAccessPointEditEntry #save":{click:b.btnEditEntrySave},"gridAccessPointExits #reload":{click:b.reloadExit},"gridAccessPointExits #add":{click:b.addExit},winAccessPointAddExit:{beforeshow:b.loadAddExit},"winAccessPointAddExit #btnTypeNext":{click:b.btnExitTypeNext},"winAccessPointAddExit #btnDataPrev":{click:b.btnExitDataPrev},"winAccessPointAddExit #save":{click:b.btnAddExitSave},"gridAccessPointExits #delete":{click:b.delExit},"gridAccessPointExits #edit":{click:b.editExit},winAccessPointEditExit:{beforeshow:b.loadExit},"winAccessPointEditExit #save":{click:b.btnEditExitSave},"#chkProxyEnable":{change:b.chkProxyEnableChange},"pnlAccessPointEdit #tabAccessPointCommonSettings":{activate:b.frmApCommonSettingsLoad},"pnlAccessPointCommonSettings #save":{click:b.btnApCommonSettingsSave},"gridAccessPointAps #reload":{click:b.reloadAps},"gridAccessPointAps #add":{click:b.addAp},"#winAccessPointAddApEdit #save":{click:b.btnAddApSave},"gridAccessPointAps #delete":{click:b.delAp},"gridAccessPointAps #edit":{click:b.editAp},"#winAccessPointEditApEdit":{beforeshow:b.loadAp},"#winAccessPointEditApEdit #save":{click:b.btnEditApSave},"#winAccessPointAddApEdit #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApEdit #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApEdit radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointAddApEdit radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointAddApEdit cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"#winAccessPointAddApEdit":{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointEditApEdit #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApEdit #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApEdit radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointEditApEdit radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointEditApEdit cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"winAccessPointAddExit #chkNasClient":{change:b.chkNasClientChange},"winAccessPointEditExit #chkNasClient":{change:b.chkNasClientChange},"winAccessPointAddExit #chkLoginPage":{change:b.chkLoginPageChange},"winAccessPointEditExit #chkLoginPage":{change:b.chkLoginPageChange}})},actionIndex:function(j,n){var m=this;var k="tabAccessPoint"+j;var i=m.getTabAccessPoints();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnEdit,title:n,closable:true,layout:"fit",xtype:"pnlAccessPointEdit",itemId:k,ap_profile_id:j})}i.setActiveTab(l)},reloadEntry:function(g){var i=this;var h=g.up("pnlAccessPointEdit");var j=h.down("gridAccessPointEntries");j.getStore().reload()},addEntry:function(k){var j=this;var l=k.up("pnlAccessPointEdit");var h=l.down("gridAccessPointEntries").getStore();if(!Ext.WindowManager.get("winAccessPointAddEntryId")){var i=Ext.widget("winAccessPointAddEntry",{id:"winAccessPointAddEntryId",store:h,apProfileId:l.ap_profile_id});i.show()}},cmbEncryptionChange:function(l){var o=this;var p=l.up("form");var j=p.down("#key");var k=p.down("#auth_server");var n=p.down("#auth_secret");var m=l.getValue();if(m=="none"){j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wep")|(m=="psk")|(m=="psk2")){j.setVisible(true);j.setDisabled(false);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wpa")|(m=="wpa2")){j.setVisible(false);j.setDisabled(true);k.setVisible(true);k.setDisabled(false);n.setVisible(true);n.setDisabled(false)}},chkMaxassocChange:function(i){var k=this;var l=i.up("form");var h=l.down("#maxassoc");var j=i.getValue();if(j){h.setVisible(true);h.setDisabled(false)}else{h.setVisible(false);h.setDisabled(true)}},cmbMacFilterChange:function(j){var h=this;var i=j.up("form");var l=i.down("cmbPermanentUser");var k=j.getValue();if(k=="disable"){l.setVisible(false);l.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false)}},btnAddEntrySave:function(h){var j=this;var i=h.up("winAccessPointAddEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){i.store.load();i.close();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("New Access Point SSID created fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:"formFailure"})},editEntry:function(o){var m=this;var p=o.up("pnlAccessPointEdit");var j=p.down("gridAccessPointEntries").getStore();if(p.down("gridAccessPointEntries").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=p.down("gridAccessPointEntries").getSelectionModel().getLastSelected();var l=n.getId();if(!Ext.WindowManager.get("winAccessPointEditEntryId")){var k=Ext.widget("winAccessPointEditEntry",{id:"winAccessPointEditEntryId",store:j,entryId:l});k.show()}else{var k=Ext.WindowManager.get("winAccessPointEditEntryId");k.entryId=l;m.loadEntry(k)}}},loadEntry:function(i){var j=this;var g=i.down("form");var h=i.entryId;g.load({url:j.getUrlViewEntry(),method:"GET",params:{entry_id:h},success:function(o,p,a){var n=g.down("cmbMacFilter");var b=n.getValue();if(b!="disable"){var d=g.down("cmbPermanentUser");var e=Ext.create("Rd.model.mPermanentUser",{username:p.result.data.username,id:p.result.data.permanent_user_id});d.getStore().loadData([e],false);d.setValue(p.result.data.permanent_user_id)}}})},btnEditEntrySave:function(h){var j=this;var i=h.up("winAccessPointEditEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delEntry:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointEntries");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},chkNasClientChange:function(h){var j=this;var g=h.up("form");var i=g.down("#cmbRealm");if(h.getValue()){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},chkLoginPageChange:function(h){var i=this;var j=h.up("form");var g=j.down("#cmbDynamicDetail");if(h.getValue()){g.setVisible(true);g.setDisabled(false)}else{g.setVisible(false);g.setDisabled(true)}},reloadExit:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointExits");h.getStore().reload()},loadAddExit:function(h){var e=this;var g=h.down("#scrnData");g.load({url:e.getUrlExitAddDefaults(),method:"GET"})},addExit:function(l){var k=this;var m=l.up("pnlAccessPointEdit");var i=m.down("gridAccessPointEntries").getStore().count();if(i==0){Ext.ux.Toaster.msg(i18n("sDefine_some_entry_points_first"),i18n("sDefine_some_entry_points_first"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}var n=m.down("gridAccessPointExits").getStore();if(!Ext.WindowManager.get("winAccessPointAddExitId")){var j=Ext.widget("winAccessPointAddExit",{id:"winAccessPointAddExitId",store:n,apProfileId:m.ap_profile_id});j.show()}},btnExitTypeNext:function(y){var u=this;var x=y.up("winAccessPointAddExit");var t=x.down("radiogroup").getValue().exit_type;var z=x.down("#vlan");var r=x.down("#tabCaptivePortal");var w=x.down("#type");var q=x.down("#cmbOpenVpnServers");var o=x.down("#chkNasClient");var p=x.down("#cmbRealm");var A=x.down("#chkLoginPage");var s=x.down("cmbDynamicDetail");w.setValue(t);if(t=="openvpn_bridge"){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}if(t=="tagged_bridge"){z.setVisible(true);z.setDisabled(false)}else{z.setVisible(false);z.setDisabled(true)}if(t=="captive_portal"){r.setDisabled(false);r.tab.show();o.setVisible(true);o.setDisabled(false);A.setVisible(true);A.setDisabled(false);s.setVisible(true);s.setDisabled(false);p.setVisible(true);p.setDisabled(false)}else{r.setDisabled(true);r.tab.hide();o.setVisible(false);o.setDisabled(true);A.setVisible(false);A.setDisabled(true);s.setVisible(false);s.setDisabled(true);p.setVisible(false);p.setDisabled(true)}x.getLayout().setActiveItem("scrnData")},btnExitDataPrev:function(g){var e=this;var h=g.up("winAccessPointAddExit");h.getLayout().setActiveItem("scrnType")},btnAddExitSave:function(h){var j=this;var i=h.up("winAccessPointAddExit");var g=i.down("#scrnData");g.submit({clientValidation:true,url:j.getUrlAddExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delExit:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointExits");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},editExit:function(A){var z=this;var B=A.up("pnlAccessPointEdit");var t=B.down("gridAccessPointExits").getStore();if(B.down("gridAccessPointExits").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var G=B.down("gridAccessPointExits").getSelectionModel().getLastSelected();var F=G.getId();var C=G.get("ap_profile_id");var y=G.get("type");if(!Ext.WindowManager.get("winAccessPointEditExitId")){var u=Ext.widget("winAccessPointEditExit",{id:"winAccessPointEditExitId",store:t,exitId:F,apProfileId:C,type:y});u.show()}else{var u=Ext.WindowManager.get("winAccessPointEditExitId");var D=u.down("#vlan");var w=u.down("#tabCaptivePortal");u.exitId=F;u.apProfileId=C;var s=win.down("#cmbOpenVpnServers");var r=u.down("#chkNasClient");var E=u.down("#chkLoginPage");var x=u.down("cmbDynamicDetail");if(y=="openvpn_bridge"){s.setVisible(true);s.setDisabled(false);D.setVisible(false);D.setDisabled(true)}else{s.setVisible(false);s.setDisabled(true)}if(y=="tagged_bridge"){D.setVisible(true);D.setDisabled(false)}else{D.setVisible(false);D.setDisabled(true)}if(y=="captive_portal"){w.setDisabled(false);w.tab.show();r.setVisible(true);r.setDisabled(false);E.setVisible(true);E.setDisabled(false);x.setVisible(true);x.setDisabled(false)}else{w.setDisabled(true);w.tab.hide();r.setVisible(false);r.setDisabled(true);E.setVisible(false);E.setDisabled(true);x.setVisible(false);x.setDisabled(true)}z.loadExit(u)}}},loadExit:function(i){var g=this;var h=i.down("form");var j=i.exitId;h.load({url:g.getUrlViewExit(),method:"GET",params:{exit_id:j},success:function(d,e,s){var a=h.down("#type");var w=a.getValue();var A=h.down("#vlan");var b=h.down("#cmbOpenVpnServers");if(w=="openvpn_bridge"){b.setVisible(true);b.setDisabled(false);A.setVisible(false);A.setDisabled(true)}else{b.setVisible(false);b.setDisabled(true)}if(w=="tagged_bridge"){A.setVisible(true);A.setDisabled(false)}else{A.setVisible(false);A.setDisabled(true)}var t=h.down("cmbAccessPointEntryPoints");t.setValue(e.result.data.entry_points);if(e.result.data.type=="captive_portal"){if((e.result.data.auto_login_page==true)&&(e.result.data.dynamic_detail!=null)){var x=h.down("cmbDynamicDetail");var y=Ext.create("Rd.model.mDynamicDetail",{name:e.result.data.dynamic_detail,id:e.result.data.dynamic_detail_id});x.getStore().loadData([y],false);x.setValue(e.result.data.dynamic_detail_id)}else{h.down("cmbDynamicDetail").setVisible(false);h.down("cmbDynamicDetail").setDisabled(true)}if((e.result.data.auto_dynamic_client==true)&&(e.result.data.realm_records!=null)){var z=h.down("cmbRealm");var u=[];Ext.Array.forEach(e.result.data.realm_records,function(l){var k=Ext.create("Rd.model.mRealm",{name:l.name,id:l.id});Ext.Array.push(u,k)});z.getStore().loadData(u,false);z.setValue(e.result.data.realm_ids)}else{h.down("cmbRealm").setVisible(false);h.down("cmbRealm").setDisabled(true)}}}})},btnEditExitSave:function(h){var j=this;var i=h.up("winAccessPointEditExit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},chkProxyEnableChange:function(g){var i=this;var h=g.up("panel");var j=Ext.ComponentQuery.query("textfield",h);if(g.getValue()){Ext.Array.each(j,function(a,d,b){a.setDisabled(false);a.setVisible(true)})}else{Ext.Array.each(j,function(a,d,b){a.setDisabled(true);a.setVisible(false)})}},frmApCommonSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.apProfileId;j.load({url:i.getUrlViewApCommonSettings(),method:"GET",params:{ap_profile_id:h}})},btnApCommonSettingsSave:function(i){var j=this;var k=i.up("form");var l=i.up("#tabAccessPointCommonSettings");var h=l.apProfileId;k.submit({clientValidation:true,url:j.getUrlEditApCommonSettings(),params:{ap_profile_id:h},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},reloadAps:function(g){var i=this;var h=g.up("pnlAccessPointEdit");var j=h.down("gridAccessPointAps");j.getStore().reload()},cmbApHardwareModelsChange:function(r){var m=this;var t=r.up("form");var s=r.getValue();var o=1;var q=r.getSelection();if(q!=null){o=q.get("radios")}var l=t.down("#tabRadiosRadio1");var p=t.down("#tabAdvWifiRadio1");var n=r.up("window");if(n.getItemId()!="winAccessPointEditApEdit"){t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s}})}else{t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s,ap_id:n.apId}})}if(o==2){l.setDisabled(false);l.tab.show();p.setDisabled(false);p.tab.show()}else{l.setDisabled(true);l.tab.hide();p.setDisabled(true);p.tab.hide()}},loadAdvancedWifiSettings:function(m){var o=this;var p=m.down("form");var k=p.down("cmbApHardwareModels");var l=k.getValue();var n=p.down("#tabAdvWifiRadio1");n.setDisabled(true);n.tab.hide();var j=p.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide();p.load({url:o.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:l}})},addAp:function(k){var j=this;var l=k.up("pnlAccessPointEdit");var h=l.down("gridAccessPointAps").getStore();if(!Ext.WindowManager.get("winAccessPointAddApId")){var i=Ext.widget("winAccessPointAddAp",{id:"winAccessPointAddApId",store:h,apProfileId:l.ap_profile_id,apProfileName:l.title,itemId:"winAccessPointAddApEdit"});i.show()}},btnAddApSave:function(h){var j=this;var i=h.up("winAccessPointAddAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delAp:function(j){var i=this;var g=j.up("pnlAccessPointEdit");var h=g.down("gridAccessPointAps");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}}})}},editAp:function(q){var n=this;var r=q.up("pnlAccessPointEdit");var k=r.down("gridAccessPointAps").getStore();if(r.down("gridAccessPointAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var o=r.down("gridAccessPointAps").getSelectionModel().getLastSelected();var m=o.getId();var p=o.get("ap_profile_id");if(!Ext.WindowManager.get("winAccessPointEditApId")){var l=Ext.widget("winAccessPointEditAp",{id:"winAccessPointEditApId",store:k,apId:m,apProfileId:r.ap_profile_id,apProfileName:r.title,itemId:"winAccessPointEditApEdit"});l.show()}}},loadAp:function(l){var n=this;var i=l.down("form");var k=l.apId;i.load({url:n.getUrlViewAp(),method:"GET",params:{ap_id:k}});var m=i.down("#tabAdvWifiRadio1");m.setDisabled(true);m.tab.hide();var j=i.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide()},btnEditApSave:function(h){var j=this;var i=h.up("winAccessPointEditAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},chkRadioEnableChange:function(l){var k=this;var h=l.up("panel");var j=l.getValue();var i=Ext.ComponentQuery.query("field",h);Ext.Array.forEach(i,function(a){if(a!=l){a.setDisabled(!j)}})},radio_0_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},radio_1_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg(i18n("sLoading_Google_Maps_API"),i18n("sLoading_Google_Maps_API"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("pnlAccessPointEdit");var l="mapTab";var k=j.down("#"+l);if(k){j.setActiveTab(l);return}var m=i18n("sGoogle_Maps");var n=j.mesh_id;Ext.Ajax.request({url:o.getUrlMapPrefView(),method:"GET",params:{mesh_id:n},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.add({title:m,itemId:l,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshEditGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:n});j.setActiveTab(l)}},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sError_encountered"),i18n("sMap_preferences_could_not_be_fetched"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:o})},dragStart:function(i,g,h){var j=this;j.lastMovedMarker=h;j.lastOrigPosition=h.getPosition();j.editWindow=g.editwindow},dragEnd:function(j,l,i){var k=this;var h=i.getPosition();l.new_lng=h.lng();l.new_lat=h.lat();l.editwindow.open(l.gmap,i);k.lastLng=h.lng();k.lastLat=h.lat();k.lastDragId=j},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapDelete(),method:"GET",params:{id:j.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_deleted_fine"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},btnMapSave:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapSave(),method:"GET",params:{id:j.lastDragId,lat:j.lastLat,lon:j.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},mapPreferences:function(n){var m=this;var o=n.up("pnlMeshEdit");var l=o.mesh_id;var j="winMeshMapPreferences_"+l;var p=o.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(j)){var k=Ext.widget("winMeshMapPreferences",{id:j,mapPanel:p,meshId:l});k.show();k.down("form").load({url:m.getUrlMapPrefView(),method:"GET",params:{mesh_id:l}})}},mapNodeAdd:function(n){var m=this;var o=n.up("pnlMeshEdit");var l=o.mesh_id;var k="winMeshMapNodeAdd_"+l;var p=o.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(k)){var j=Ext.widget("winMeshMapNodeAdd",{id:k,mapPanel:p,meshId:l});j.show()}},meshMapNodeAddSubmit:function(r){var p=this;var n=r.up("winMeshMapNodeAdd");var q=n.down("cmbMeshAddMapNodes");var m=q.getValue();var k=n.mapPanel;n.close();var o=k.gmap.getCenter();var l=k.addMarker({lat:o.lat(),lng:o.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:i18n("sNew_marker"),listeners:{dragend:function(){p.dragEnd(m,k,l)},dragstart:function(){k.addwindow.close();p.dragStart(m,k,l)}}});k.addwindow.open(k.gmap,l)},mapPreferencesSnapshot:function(t){var r=this;var w=t.up("form");var n=t.up("winMeshMapPreferences");var u=n.mapPanel;var m=u.gmap.getZoom();var q=u.gmap.getMapTypeId();var o=u.gmap.getCenter();var s=o.lat();var p=o.lng();w.down("#lat").setValue(s);w.down("#lng").setValue(p);w.down("#zoom").setValue(m);w.down("#type").setValue(q.toUpperCase())},mapPreferencesSave:function(i){var l=this;var h=i.up("form");var j=i.up("winMeshMapPreferences");var k=j.meshId;h.submit({clientValidation:true,url:l.getUrlMapPrefEdit(),params:{mesh_id:k},success:function(b,a){j.close();Ext.ux.Toaster.msg(i18n("sItem_updated_fine"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:l,failure:Ext.ux.formFail})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();var h=g.meshId;Ext.Ajax.request({url:e.getUrlMeshNodes(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var l=g.addMarker({lat:i.lat,lng:i.lng,icon:d,draggable:true,title:i.name,listeners:{dragend:function(){e.dragEnd(i.id,g,l)},dragstart:function(){e.dragStart(i.id,g,l)}}})});g.setLoading(false)}},scope:e})}},0,0,0,0,0,0,[Rd.controller,"cAccessPointEdits"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointView",Ext.tab.Panel,{border:false,plain:true,cls:"subTab",tabPosition:"top",ap_id:undefined,apName:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sOverview"),itemId:"tabAccessPointViewOverwiew",xtype:"pnlChartApMain",apId:b.ap_id},{title:i18n("sSSID_to_Device"),itemId:"tabAccessPointViewEntries",xtype:"gridApViewEntries",apId:b.ap_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessPointView"],["component","box","container","panel","tabpanel","pnlAccessPointView"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessPointView:true},["widget.pnlAccessPointView"],0,[Rd.view.aps,"pnlAccessPointView"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartBase",Ext.panel.Panel,{layout:"fit",initComponent:function(){var b=this;b.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload")},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",labelWidth:40,extraParam:b.apId},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",pressed:true},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week"},{xtype:"button",text:"Past month",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"month"}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartBase"],["component","box","container","panel","pnlChartBase"],{component:true,box:true,container:true,panel:true,pnlChartBase:true},["widget.pnlChartBase"],0,[Rd.view.charts,"pnlChartBase"],0));(Ext.cmd.derive("Rd.view.charts.vcChartApData",Ext.app.ViewController,{span:"hour",entry_id:0,init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},onCmbSsidChange:function(d){var e=this;e.entry_id=d.getValue();e.load()},pnlAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var h=e.getView().apId;var g=e.getView().down("cartesian");g.getStore().getProxy().setExtraParams({timespan:e.span,entry_id:e.entry_id,ap_id:h});g.getStore().load()}},0,0,0,0,["controller.vcChartApData"],0,[Rd.view.charts,"vcChartApData"],0));(Ext.cmd.derive("Rd.view.aps.cmbAccessPointEntryPointReports",Ext.form.ComboBox,{fieldLabel:"SSID",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"entry_point_id",labelClsExtra:"lblRdReq",allowBlank:true,apId:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_reports/view_entry_points.json",extraParams:{ap_id:d.apId},reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;d.setValue(0);Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAccessPointEntryPointReports"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAccessPointEntryPointReports"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAccessPointEntryPointReports:true},["widget.cmbAccessPointEntryPointReports"],0,[Rd.view.aps,"cmbAccessPointEntryPointReports"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApData",Ext.panel.Panel,{controller:"vcChartApData",apId:"",listeners:{afterrender:"pnlAfterRender"},url:"/cake2/rd_cake/ap_reports/view_data_usage.json",initComponent:function(){var h=this;var g="Data usage";h.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"cmbAccessPointEntryPointReports",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"ssid",labelWidth:40,addAll:true,apId:h.apId,listeners:{change:"onCmbSsidChange"}},{xtype:"button",text:"Hourly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Daily",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Weekly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]},"->",{xtype:"component",itemId:"totals",tpl:"In <b>{in}</b> Out <b>{out}</b> Total <b>{total}</b>",style:"margin-right:5px",cls:"lblRd"}];h.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"}],proxy:{type:"ajax",format:"json",url:h.url,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(l){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var d=Ext.ux.bytesToHuman(a.totalIn);var k=Ext.ux.bytesToHuman(a.totalOut);var b=Ext.ux.bytesToHuman(a.totalInOut);h.down("#totals").update({"in":d,out:k,total:b})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:10,left:10,right:10,bottom:10},width:"100%",store:h.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["tx_bytes","rx_bytes"],renderer:function(a,b,d){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",fields:["time_unit"],position:"bottom",grid:true,label:{rotate:{degrees:-45}}}],series:[{type:"area",title:["TX Bytes","RX Bytes"],xField:"time_unit",yField:["tx_bytes","rx_bytes"],style:{opacity:0.8},marker:{opacity:0,scaling:0.01,fx:{duration:200,easing:"easeOut"}},highlightCfg:{opacity:1,scaling:1.5},tooltip:{trackMouse:true,renderer:function(a,k,b){var d=Ext.ux.bytesToHuman(k.get("tx_bytes"));var l=Ext.ux.bytesToHuman(k.get("rx_bytes"));a.setHtml("Data TX <b>"+d+"</b><br>Data RX <b>"+l+"</b>")}}}]});h.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartApData"],["component","box","container","panel","pnlChartApData"],{component:true,box:true,container:true,panel:true,pnlChartApData:true},["widget.pnlChartApData"],0,[Rd.view.charts,"pnlChartApData"],0));(Ext.cmd.derive("Rd.view.charts.vcChartApUsers",Ext.app.ViewController,{span:"hour",entry_id:0,init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},onCmbSsidChange:function(d){var e=this;e.entry_id=d.getValue();e.load()},pnlAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var h=e.getView().apId;var g=e.getView().down("cartesian");g.getStore().getProxy().setExtraParams({timespan:e.span,entry_id:e.entry_id,ap_id:h});g.getStore().load()}},0,0,0,0,["controller.vcChartApUsers"],0,[Rd.view.charts,"vcChartApUsers"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApUsers",Ext.panel.Panel,{controller:"vcChartApUsers",apId:"",listeners:{afterrender:"pnlAfterRender"},url:"/cake2/rd_cake/ap_reports/view_connected_users.json",initComponent:function(){var h=this;var g="Data usage";h.tbar=[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"cmbAccessPointEntryPointReports",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"ssid",labelWidth:40,addAll:true,apId:h.apId,listeners:{change:"onCmbSsidChange"}},{xtype:"button",text:"Hourly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Daily",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Weekly",toggleGroup:"time_n",enableToggle:true,scale:"small",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]},"->",{xtype:"component",itemId:"totals",tpl:"Users: <b>{users}</b>",style:"margin-right:5px",cls:"lblRd"}];h.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"users",type:"int"}],proxy:{type:"ajax",format:"json",url:h.url,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(b){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var d=a.totalUsers;h.down("#totals").update({users:d})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:10,left:10,right:10,bottom:10},width:"100%",store:h.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,increment:1,grid:true,fields:["users"],minimum:0},{type:"category",fields:["time_unit"],position:"bottom",grid:true,label:{rotate:{degrees:-45}}}],series:[{type:"area",title:["Users"],xField:"time_unit",yField:["users"],style:{opacity:0.8},marker:{opacity:0,scaling:0.01,fx:{duration:200,easing:"easeOut"}},highlightCfg:{opacity:1,scaling:1.5},tooltip:{trackMouse:true,renderer:function(b,j,d){var a=j.get("users");b.setHtml("<b>"+a+"</b> Users")}}}]});h.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlChartApUsers"],["component","box","container","panel","pnlChartApUsers"],{component:true,box:true,container:true,panel:true,pnlChartApUsers:true},["widget.pnlChartApUsers"],0,[Rd.view.charts,"pnlChartApUsers"],0));(Ext.cmd.derive("Rd.view.charts.pnlChartApMain",Ext.panel.Panel,{layout:{type:"hbox",pack:"start",align:"stretch"},defaults:{frame:false,bodyPadding:10},url:"/cake2/rd_cake/ap_reports/view_overview.json",apId:"",initComponent:function(){var b=this;b.items=[{flex:1,margin:"0 10 0 0",frame:false,border:false,layout:"fit",title:"Hardware",ui:"light",glyph:Rd.config.icnGears,itemId:"pnlOverview",tpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{img}.png" alt="dragino" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{model}</span>","</div>","<div class='twoColumnContainer'>",'<tpl for="components">',"<div class='twoColumnItem'>",'<div class="sectionHeader">',"<h2>{name}</h2>","</div>",'<ul class="fa-ul">','<tpl for="items">',"<tpl if=\"style == 'rdOk'\">","<li style='color:green;'><i class='fa-li fa  fa-check-circle'></i>","{description} <b>{value}</b>.</li>","</tpl>","<tpl if=\"style == 'rdWarn'\">","<li style='color:red;'><i class='fa-li fa  fa-exclamation-circle'></i>","{description} <b>{value}</b>.</li>","</tpl>","<tpl if=\"style == 'rdInfo'\">","<li><i class='fa-li fa fa-arrow-circle-right'></i>","{description} <b>{value}</b>.</li>","</tpl>","</tpl>","</ul>","</div>","</tpl>","</div>"),tools:[{type:"refresh",tooltip:"Refresh",handler:function(g,h,a){b.refresh()}}]},{flex:1,frame:false,border:false,layout:"accordion",scrollable:true,items:[{title:i18n("sData_Usage"),glyph:Rd.config.icnData,layout:"fit",margins:"0 0 0 0",plain:true,xtype:"pnlChartApData",apId:b.apId},{title:i18n("sUsers_Connected"),glyph:Rd.config.icnUser,layout:"fit",margins:"0 0 0 0",plain:true,xtype:"pnlChartApUsers",apId:b.apId}]}];b.fetchData();Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},refresh:function(){var b=this;b.down("#pnlOverview").setLoading(true);b.fetchData()},fetchData:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",params:{ap_id:b.apId},success:"dataToGui",scope:b})},dataToGui:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);h.down("#pnlOverview").setLoading(false);if(e.success==true){h.down("#pnlOverview").setData(e.data)}}},0,["pnlChartApMain"],["component","box","container","panel","pnlChartApMain"],{component:true,box:true,container:true,panel:true,pnlChartApMain:true},["widget.pnlChartApMain"],0,[Rd.view.charts,"pnlChartApMain"],0));(Ext.cmd.derive("Rd.model.mApViewEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"ap_profile_entry_id"},{name:"mac"},{name:"vendor"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_node"}]},0,0,0,0,0,0,[Rd.model,"mApViewEntry"],0));(Ext.cmd.derive("Rd.store.sApViewEntries",Ext.data.Store,{model:"Rd.model.mApViewEntry",remoteSort:false,groupField:"name",proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/ap_reports/view_entries.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sApViewEntries"],0));(Ext.cmd.derive("Rd.view.aps.vcApViewEntries",Ext.app.ViewController,{span:"hour",init:function(){},onBtnTimeToggled:function(e){var d=this;if(e.pressed){d.span=e.getItemId();d.load()}},onBtnReloadClick:function(e){var d=this;d.load()},gridAfterRender:function(e){var d=this;d.load()},load:function(){var e=this;var d=e.getView().apId;e.getView().getStore().getProxy().setExtraParams({timespan:e.span,ap_id:d});e.getView().getStore().load()}},0,0,0,0,["controller.vcApViewEntries"],0,[Rd.view.aps,"vcApViewEntries"],0));(Ext.cmd.derive("Rd.view.aps.gridApViewEntries",Ext.grid.Panel,{controller:"vcApViewEntries",multiSelect:true,stateful:true,stateId:"StateGridApViewEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},apId:"",listeners:{afterrender:"gridAfterRender"},tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),listeners:{click:"onBtnReloadClick"}},{xtype:"button",text:"Past hour",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"hour",pressed:true,listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Past day",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"day",listeners:{toggle:"onBtnTimeToggled"}},{xtype:"button",text:"Past week",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"week",listeners:{toggle:"onBtnTimeToggled"}}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:"{name}",hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sApViewEntries,{});b.store.getProxy().setExtraParam("ap_id",b.apId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApViewEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridApViewEntries2"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridApViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridApViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridApViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var t=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var B=k.get("l_tx_bitrate");var h=k.get("l_rx_bitrate");var y=k.get("l_modified");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var e=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var g=k.get("l_tx_failed");var A=k.get("l_tx_retries");var i=k.get("l_authenticated");var d=k.get("l_authorized");var p=k.get("l_node");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+B+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+h+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApViewEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApViewEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApViewEntries:true},["widget.gridApViewEntries"],0,[Rd.view.aps,"gridApViewEntries"],0));(Ext.cmd.derive("Rd.controller.cAccessPointViews",Ext.app.Controller,{views:["aps.pnlAccessPointView","charts.pnlChartApMain","aps.gridApViewEntries"],config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlMapPrefView:"/cake2/rd_cake/ap_profiles/map_pref_view.json",urlOverviewGoogleMap:"/cake2/rd_cake/ap_reports/overview_google_map.json",urlRestartNodes:"/cake2/rd_cake/ap_reports/restart_nodes.json",urlApProfileAddApAction:"/cake2/rd_cake/ap_actions/add.json"},refs:[{ref:"tabAccessPoints",selector:"#tabAccessPoints"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlApView gridAccessPointViewEntries #reload":{click:b.reloadViewEntry},"pnlApView gridAccessPointViewEntries button":{toggle:b.viewEntryTimeToggle},"pnlApView #tabAccessPointViewEntries":{},"pnlApView gridAccessPointViewEntries #reload menuitem[group=refresh]":{click:function(e){var a=this;a.autoRefresh(e,"entries")}},pnlApView:{beforeshow:b.pnlViewClose,destroy:b.pnlViewClose}})},actionIndex:function(m,i){var n=this;var k="tabAccessPointView"+m;var j=n.getTabAccessPoints();var l=j.items.findBy(function(a){return a.getItemId()===k});if(!l){l=j.add({glyph:Rd.config.icnView,title:i,closable:true,layout:"fit",xtype:"pnlAccessPointView",itemId:k,ap_id:m})}j.setActiveTab(l)},viewEntryTimeToggle:function(g,h){var e=this;if(h){e.reloadViewEntry(g)}},reloadViewEntry:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewEntries");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},viewNodeTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNode(g)}},reloadViewNode:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewNodes");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},viewNodeNodesTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNodeNodes(g)}},reloadViewNodeNodes:function(o){var l=this;var p=o.up("pnlMeshView");var m=p.down("gridMeshViewNodeNodes");var k=m.down("#day");var j=m.down("#week");var n="hour";if(k.pressed){n="day"}if(j.pressed){n="week"}m.getStore().getProxy().setExtraParam("timespan",n);m.getStore().reload()},tabMeshViewNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNode(b)},tabMeshViewEntriesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewEntry(b)},tabMeshViewNodeNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeNodes(b)},tabMeshViewNodeDetailsActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeDetails(b)},autoRefresh:function(n,k){var l=this;var j=n.getItemId();var b=n.up("button");var m=30000;clearInterval(l.autoRefresInterval);b.setGlyph(Rd.config.icnTime);if(j=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(j=="mnuRefresh1m"){m=60000}if(j=="mnuRefresh5m"){m=360000}l.autoRefresInterval=setInterval(function(){if(k=="nodes"){l.reloadViewNode(b)}if(k=="node_nodes"){l.reloadViewNodeNodes(b)}if(k=="entries"){l.reloadViewEntry(b)}},m)},pnlViewClose:function(){var b=this;if(b.autoRefresInterval!=undefined){clearInterval(b.autoRefresInterval)}}},0,0,0,0,0,0,[Rd.controller,"cAccessPointViews"],0));(Ext.cmd.derive("Rd.view.aps.gridApProfiles",Ext.grid.Panel,{multiSelect:true,store:"sApProfiles",stateful:true,stateId:"StateGridApProfiles",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApProfiles1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApProfiles2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridApProfiles3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridApProfiles4"},{text:"AP Count",dataIndex:"ap_count",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl><div class="fieldGreyWhite">{ap_count}</div></tpl>'),stateId:"StateGridApProfiles7",width:Rd.config.gridNumberCol},{text:"APs Up",dataIndex:"aps_up",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='aps_up &gt; 0'><div class=\"fieldGreenWhite\">{aps_up}</div>",'<tpl else><div class="fieldBlue">{aps_up}</div></tpl>'),stateId:"StateGridApProfiles8",width:Rd.config.gridNumberCol},{text:"APs Down",dataIndex:"aps_down",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='aps_down &gt; 0'><div class=\"fieldRedWhite\">{aps_down}</div>",'<tpl else><div class="fieldBlue">{aps_down}</div></tpl>'),stateId:"StateGridApProfiles9",width:Rd.config.gridNumberCol},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridApProfiles10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApProfiles"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApProfiles"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApProfiles:true},["widget.gridApProfiles"],0,[Rd.view.aps,"gridApProfiles"],0));(Ext.cmd.derive("Rd.view.aps.gridApLists",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridApLists",stateEvents:["groupclick","columnhide"],store:"sApLists",border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ap_profiles/menu_for_aps_grid.json",plugins:["gridfilters",{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{hardware}.png" alt="{hardware}" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{hw_human}</span>","</div>",'<div class="sectionHeader">',"<h2>DEVICE INFORMATION (for the past hour)</h2>","</div>","<div style='background-color:white; padding:5px;'>",'<ul class="fa-ul">',"<tpl if='state == \"never\"'>","<li style='color:blue;'><i class='fa-li fa fa-question-circle'></i>Never connected before</li>","</tpl>","<tpl if='state == \"down\"'>","<li style='color:red;'><i class='fa-li fa  fa-exclamation-circle'></i>Offline (last check-in <b>{last_contact_human}</b> ago).</li>","</tpl>","<tpl if='state == \"up\"'>",'<li style="color:green;"><i class="fa-li fa fa-check-circle"></i>Online (last check-in <b>{last_contact_human}</b> ago).</li>',"</tpl>",'<tpl for="ssids">','<li><i class="fa-li fa fa-wifi"></i><b>{name}</b> had <b>{users}</b> users.</li>',"</tpl>",'<li><i class="fa-li fa fa-info-circle"></i>Public IP <b>{last_contact_from_ip}</b>.</li>','<li><i class="fa-li fa fa-database"></i>Data usage <b>{data_past_hour}</b>.</li>','<li><i class="fa-li fa fa-link"></i>Last connection from <b>{newest_station}</b> which was <b>{newest_time}</b> ({newest_vendor}).</li>',"</ul>","</div>")}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridApLists1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,stateId:"StateGridApLists2",sortable:false,hidden:true},{text:i18n("sProfile"),dataIndex:"ap_profile",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridApLists4"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists5",hidden:true},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists6"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridApLists7",hidden:true},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",width:170,renderer:function(k,l,a){var i=a.get("state");if(i!="never"){var j=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreenWhite">'+j+"</div>"}if(i=="down"){return'<div class="fieldRedWhite">'+j+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGridApLists8"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",width:170,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_from_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGridApLists9"},{text:"Last command",sortable:false,width:170,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'last_cmd_status == ""\'><div class="fieldBlue">(nothing)</div></tpl>','<tpl if=\'last_cmd_status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> {last_cmd}</div></tpl>','<tpl if=\'last_cmd_status == "fetched"\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> {last_cmd}</div></tpl>'),stateId:"StateGridApLists10",hidden:false},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGridApLists11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApLists:true},["widget.gridApLists"],0,[Rd.view.aps,"gridApLists"],0));(Ext.cmd.derive("Rd.view.aps.gridUnknownAps",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUnknownAps",stateEvents:["groupclick","columnhide"],border:false,store:"sUnknownAps",viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/unknown_aps/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridUnknownAps1"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUnknownAps2"},{text:i18n("sVendor"),dataIndex:"vendor",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUnknownAps3"},{text:i18n("sLast_contact"),dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUnknownAps4"},{text:i18n("sFrom_IP"),dataIndex:"last_contact_from_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{last_contact_from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUnknownAps5"},{text:"Redirect To",flex:1,hidden:false,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='new_server'>",'<tpl if=\'new_server_status == "awaiting"\'><div class="fieldBlueWhite">{new_server}</div></tpl>','<tpl if=\'new_server_status == "fetched"\'><div class="fieldGreenWhite">{new_server}</div></tpl>',"</tpl>"),dataIndex:"new_server",filter:{type:"boolean"},stateId:"StateGridUnknownAps6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownAps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownAps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownAps:true},["widget.gridUnknownAps"],0,[Rd.view.aps,"gridUnknownAps"],0));(Ext.cmd.derive("Rd.model.mAccessProviderTree",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"}],idProperty:"id"},0,0,0,0,0,0,[Rd.model,"mAccessProviderTree"],0));(Ext.cmd.derive("Rd.model.mUnknownAp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"},{name:"vendor",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},"last_contact_human","country_code","country_name","city","postal_code","new_server","new_server_status"]},0,0,0,0,0,0,[Rd.model,"mUnknownAp"],0));(Ext.cmd.derive("Rd.model.mApProfile",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"ap_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"aps_up",type:"int"},{name:"aps_down",type:"int"},{name:"connected_users",type:"int"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"view",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mApProfile"],0));(Ext.cmd.derive("Rd.model.mApList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"ap_profile_id",type:"int"},{name:"ap_profile",type:"string"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_from_ip",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"last_contact_human","state","country_code","country_name","city","postal_code","data_past_hour","newest_station","newest_time","newest_vendor","ssids","hardware","hw_human","last_cmd","last_cmd_status","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mApList"],0));(Ext.cmd.derive("Rd.model.mDynamicDetail",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},"user_id","phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon","theme","register_users","lost_password",{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicDetail"],0));(Ext.cmd.derive("Rd.view.components.winHardwareAddAction",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:220,glyph:Rd.config.icnAdd,grid:null,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winHardwareAddAction"],["component","box","container","panel","window","winHardwareAddAction"],{component:true,box:true,container:true,panel:true,window:true,winHardwareAddAction:true},["widget.winHardwareAddAction"],0,[Rd.view.components,"winHardwareAddAction"],0));(Ext.cmd.derive("Rd.view.aps.winAccessPointAttachAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Device to Profile",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAttach,autoShow:false,apProfileId:"",apProfileName:"",defaults:{border:false},initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbApProfile",{itemId:"ap_profile_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.apProfileId,name:g.apProfileName}],true);h.setValue(g.apProfileId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"saveAttach",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:g.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:"Radios",glyph:Rd.config.icnWifi,layout:"fit",itemId:"tabRadio",autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:"hbox",items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio0_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio0_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio0_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",hidden:"true",itemId:"tabRadiosRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sEnable"),itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"fieldcontainer",fieldLabel:"Band",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:i18n("sTwo_point_four_gig"),name:"radio1_band",inputValue:"24",itemId:"radio24",margin:Rd.config.radioMargin},{boxLabel:i18n("sFive_gig"),name:"radio1_band",inputValue:"5",itemId:"radio5",margin:Rd.config.radioMargin}]},{xtype:"numberfield",anchor:"100%",name:"radio1_channel_two",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_channel_five",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,cls:"subTab",tabPosition:"top",border:false,items:[{title:i18n("sRadio_zero"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:i18n("sRadio_one"),xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"fieldcontainer",fieldLabel:"HT-mode",defaultType:"radiofield",labelClsExtra:"lblRd",layout:{type:"hbox",align:"begin",pack:"start"},items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20",checked:true,margin:Rd.config.radioMargin},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40",margin:Rd.config.radioMargin}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessPointAttachAp"],["component","box","container","panel","window","winAccessPointAttachAp"],{component:true,box:true,container:true,panel:true,window:true,winAccessPointAttachAp:true},["widget.winAccessPointAttachAp"],0,[Rd.view.aps,"winAccessPointAttachAp"],0));(Ext.cmd.derive("Rd.store.sAccessProvidersTree",Ext.data.TreeStore,{model:"Rd.model.mAccessProviderTree",proxy:{type:"ajax",url:"/cake3/rd_cake/access-providers/index-tree.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},root:{username:i18n("sLogged_in_user"),leaf:false,id:"0",iconCls:"admin",expanded:false,monitor:"na",active:"na"},listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},exception:function(h,e,g){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.responseText,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sAccessProvidersTree"],0));(Ext.cmd.derive("Rd.store.sUnknownAps",Ext.data.Store,{model:"Rd.model.mUnknownAp",remoteSort:false,proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/unknown_aps/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/unknown_aps/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownAps"],0));(Ext.cmd.derive("Rd.store.sApProfiles",Ext.data.Store,{model:"Rd.model.mApProfile",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ap_profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},listeners:{exception:function(h,e,g){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.responseText,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},api:{destroy:"/cake2/rd_cake/ap_profile/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sApProfiles"],0));(Ext.cmd.derive("Rd.store.sApLists",Ext.data.Store,{model:"Rd.model.mApList",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",url:"/cake2/rd_cake/aps/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/ap_profiles/ap_profile_ap_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sApLists"],0));(Ext.cmd.derive("Rd.view.aps.winApUnknownRedirect",Ext.window.Window,{title:"Redirect To Another Server",layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnRedirect,unknownApId:"",new_server:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"unknown_node_id",xtype:"textfield",name:"id",hidden:true,value:b.unknownApId},{xtype:"textfield",fieldLabel:"IP Address / FQDN",name:"new_server",allowBlank:false,labelClsExtra:"lblRdReq",value:b.new_server}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winApUnknownRedirect"],["component","box","container","panel","window","winApUnknownRedirect"],{component:true,box:true,container:true,panel:true,window:true,winApUnknownRedirect:true},["widget.winApUnknownRedirect"],0,[Rd.view.aps,"winApUnknownRedirect"],0));(Ext.cmd.derive("Rd.view.aps.winApProfileAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:"New Access Point Profile",width:400,height:400,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,formBind:true}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,formBind:true}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winApProfileAddWizard"],["component","box","container","panel","window","winApProfileAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winApProfileAddWizard:true},["widget.winApProfileAddWizard"],0,[Rd.view.aps,"winApProfileAddWizard"],0));(Ext.cmd.derive("Rd.controller.cAccessPoints",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:true,itemId:"tabAccessPoints",items:[{xtype:"gridApProfiles",title:i18n("sAccess_Point_Profiles"),glyph:Rd.config.icnProfile},{xtype:"gridApLists",title:i18n("sAttached_Devices"),glyph:Rd.config.icnChain},{xtype:"gridUnknownAps",title:i18n("sDetached_Devices"),glyph:Rd.config.icnChainBroken}]});d.populated=true},views:["aps.gridApProfiles","aps.gridApLists","aps.gridUnknownAps","aps.winAccessPointAttachAp","aps.cmbApHardwareModels","aps.winApProfileAddWizard","aps.winAccessPointEditAp","aps.winAccessPointAddAp","components.cmbDynamicDetail","components.winHardwareAddAction","aps.winApUnknownRedirect"],stores:["sAccessProvidersTree","sUnknownAps","sApProfiles","sApLists"],models:["mAccessProviderTree","mUnknownAp","mApProfile","mApList","mDynamicDetail"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake2/rd_cake/ap_profiles/add.json",urlDelete:"/cake2/rd_cake/ap_profiles/delete.json",urlAddAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_add.json",urlViewAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_view.json",urlEditAp:"/cake2/rd_cake/ap_profiles/ap_profile_ap_edit.json",urlAdvancedSettingsForModel:"/cake2/rd_cake/ap_profiles/advanced_settings_for_model.json",urlNoteAdd:"/cake2/rd_cake/ap_profiles/note_add.json",urlApProfileAddApAction:"/cake2/rd_cake/ap_actions/add.json",urlRestartAps:"/cake2/rd_cake/ap_actions/restart_aps.json",urlRedirectAp:"/cake2/rd_cake/aps/redirect_unknown.json"},refs:[{ref:"grid",selector:"gridApProfiles"},{ref:"gridApLists",selector:"gridApLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabAccessPoints":{destroy:b.appClose},"#tabAccessPoints gridApProfiles":{activate:b.gridActivate},"#tabAccessPoints gridApLists":{activate:b.gridActivate},"#tabAccessPoints gridUnknownAps":{activate:b.gridActivate},"gridApProfiles #reload":{click:b.reload},"gridApProfiles #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridApProfiles #add":{click:b.add},"gridApProfiles #delete":{click:b.del},"gridApProfiles #edit":{click:b.edit},gridApProfiles:{select:b.select},"winApProfileAddWizard #btnTreeNext":{click:b.btnTreeNext},"winApProfileAddWizard #btnDataPrev":{click:b.btnDataPrev},"winApProfileAddWizard #btnDataNext":{click:b.btnDataNext},"gridUnknownAps #reload":{click:b.gridUnknownApsReload},"gridUnknownAps #reload menuitem[group=refresh]":{click:b.reloadUnknownApsOptionClick},"gridUnknownAps #attach":{click:b.attachAp},"winAccessPointAttachAp cmbHardwareOptions":{change:b.cmbHardwareOptionsChange},"winAccessPointAttachAp #saveAttach":{click:b.btnAttachApSave},"gridUnknownAps #delete":{click:b.delUnknownAp},"gridUnknownAps #redirect":{click:b.redirectAp},"winApUnknownRedirect #save":{click:b.btnRedirectApSave},"gridApLists #reload":{click:b.gridApListsReload},"gridApLists #reload menuitem[group=refresh]":{click:b.reloadApListsOptionClick},"gridApLists #add":{click:b.addAp},"#winAccessPointAddApMain #save":{click:b.btnAddApSave},"gridApLists #delete":{click:b.delAp},"gridApLists #edit":{click:b.editAp},"#winAccessPointEditApMain":{beforeshow:b.loadAp},"#winAccessPointEditApMain #save":{click:b.btnEditApSave},"gridApLists #view":{click:b.viewAp},"gridApLists #execute":{click:b.execute},"#winHardwareAddActionMain #save":{click:b.commitExecute},"gridApLists #restart":{click:b.restart},"winAccessPointAttachAp #chkRadio0Enable":{change:b.chkRadioEnableChange},"winAccessPointAttachAp #chkRadio1Enable":{change:b.chkRadioEnableChange},"winAccessPointAttachAp radio[name=radio0_band]":{change:b.radio_0_BandChange},"winAccessPointAttachAp radio[name=radio1_band]":{change:b.radio_1_BandChange},"winAccessPointAttachAp cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},winAccessPointAttachAp:{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointAddApMain #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApMain #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointAddApMain radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointAddApMainradio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointAddApMain cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"#winAccessPointAddApMain":{beforeshow:b.loadAdvancedWifiSettings},"#winAccessPointEditApMain #chkRadio0Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApMain #chkRadio1Enable":{change:b.chkRadioEnableChange},"#winAccessPointEditApMain radio[name=radio0_band]":{change:b.radio_0_BandChange},"#winAccessPointEditApMain radio[name=radio1_band]":{change:b.radio_1_BandChange},"#winAccessPointEditApMain cmbApHardwareModels":{change:b.cmbApHardwareModelsChange},"gridApProfiles #note":{click:b.note},"gridNote[noteForGrid=ap_profiles] #reload":{click:b.noteReload},"gridNote[noteForGrid=ap_profiles] #add":{click:b.noteAdd},"gridNote[noteForGrid=ap_profiles] #delete":{click:b.noteDelete},"gridNote[noteForGrid=ap_profiles]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=ap_profiles] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=ap_profiles] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=ap_profiles] #btnNoteAddNext":{click:b.btnNoteAddNext}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadApLists!=undefined){clearInterval(b.autoReloadApLists)}if(b.autoReloadUnknownAps!=undefined){clearInterval(b.autoReloadUnknownAps)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},gridActivate:function(d){var e=this;d.getStore().load()},gridApListsReload:function(g){var h=this;var e=g.up("gridApLists");e.getStore().load()},reloadApListsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadApLists);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadApLists=setInterval(function(){j.gridApListsReload(b)},k)},gridUnknownApsReload:function(g){var h=this;var e=g.up("gridUnknownAps");e.getStore().load()},reloadUnknownApsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownAps);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownAps=setInterval(function(){j.gridUnknownApsReload(b)},k)},select:function(m,n){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=n.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=n.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var j=n.get("view");if(j==true){if(tb.down("#view")!=null){tb.down("#view").setDisabled(false)}}else{if(tb.down("#view")!=null){tb.down("#view").setDisabled(true)}}},addAp:function(l){var j=this;var k=l.up("#tabAccessPoints");var h=k.down("gridApLists").getStore();if(!Ext.WindowManager.get("winAccessPointAddApId")){var i=Ext.widget("winAccessPointAddAp",{id:"winAccessPointAddApId",store:h,apProfileId:"",apProfileName:"",itemId:"winAccessPointAddApMain"});i.show()}},btnAddApSave:function(h){var j=this;var i=h.up("winAccessPointAddAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added_fine"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delAp:function(e){var h=this;var g=e.up("gridApLists");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},editAp:function(p){var o=this;var r=p.up("#tabAccessPoints");var l=r.down("gridApLists").getStore();if(r.down("gridApLists").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var t=r.down("gridApLists").getSelectionModel().getLastSelected();var s=t.getId();var q=t.get("ap_profile_id");var n=t.get("ap_profile");if(!Ext.WindowManager.get("winAccessPointEditApId")){var m=Ext.widget("winAccessPointEditAp",{id:"winAccessPointEditApId",store:l,apId:s,apProfileId:q,apProfileName:n,itemId:"winAccessPointEditApMain"});m.show()}}},loadAp:function(l){var n=this;var i=l.down("form");var k=l.apId;i.load({url:n.getUrlViewAp(),method:"GET",params:{ap_id:k}});var m=i.down("#tabAdvWifiRadio1");m.setDisabled(true);m.tab.hide();var j=i.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide()},btnEditApSave:function(h){var j=this;var i=h.up("winAccessPointEditAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},execute:function(l){var j=this;var k=l.up("#tabAccessPoints");var h=k.down("gridApLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sSelect_an_item_on_which_to_execute_the_command"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winHardwareAddActionMain")){var i=Ext.widget("winHardwareAddAction",{id:"winHardwareAddActionMain",grid:h});i.show()}}},commitExecute:function(j){var m=this;var k=j.up("#winHardwareAddActionMain");var n=k.down("form");var i=k.grid.getSelectionModel().getSelection();var l=[];Ext.Array.forEach(i,function(b){var a=b.getId();Ext.Array.push(l,{id:a})});n.submit({clientValidation:true,url:m.getUrlApProfileAddApAction(),params:l,success:function(b,a){k.grid.getStore().reload();k.close();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:m,failure:Ext.ux.formFail})},restart:function(g){var i=this;var j=g.up("#tabAccessPoints");var h=j.down("gridApLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_restart"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(d){if("yes"===d){var b=h.getSelectionModel().getSelection();var a=[];Ext.Array.forEach(b,function(l){var e=l.getId();Ext.Array.push(a,{id:e})});Ext.Ajax.request({url:i.getUrlRestartAps(),method:"POST",jsonData:{aps:a},success:function(e,l){Ext.ux.Toaster.msg(i18n("sCommand_queued"),i18n("sCommand_queued_for_execution"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().reload()},failure:function(e,l){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().reload()}})}}})}},viewAp:function(i){var l=this;var m=l.getGridApLists().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGridApLists().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cAccessPointViews","Index",k,j)}}},attachAp:function(r){var o=this;var p=r.up("#tabAccessPoints");var k=p.down("gridUnknownAps").getStore();if(p.down("gridUnknownAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var q=p.down("gridUnknownAps").getSelectionModel().getLastSelected();var m=q.getId();var n=q.get("mac");if(!Ext.WindowManager.get("winAccessPointAttachApId")){var l=Ext.widget("winAccessPointAttachAp",{id:"winAccessPointAttachApId",mac:n,store:k});l.show()}}},btnAttachApSave:function(h){var j=this;var i=h.up("winAccessPointAttachAp");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},delUnknownAp:function(e){var h=this;var g=e.up("gridUnknownAps");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sFirst_select_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sError_encountered"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}}})}},chkRadioEnableChange:function(l){var k=this;var h=l.up("panel");var j=l.getValue();h.down("fieldcontainer").setVisible(j);var i=Ext.ComponentQuery.query("field",h);Ext.Array.forEach(i,function(a){if(a!=l){if(!(a.isDisabled())){a.setVisible(j)}}})},radio_0_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},radio_1_BandChange:function(m){var o=this;var l=m.getValue();var k=m.up("panel");var j=k.down("#radio24");var n=k.down("#numRadioTwoChan");var p=k.down("#numRadioFiveChan");if(j.getValue()){n.setVisible(true);n.setDisabled(false);p.setVisible(false);p.setDisabled(true)}else{n.setVisible(false);n.setDisabled(true);p.setVisible(true);p.setDisabled(false)}},cmbApHardwareModelsChange:function(r){var m=this;var t=r.up("form");var s=r.getValue();var o=1;var q=r.getSelection();if(q!=null){o=q.get("radios")}var l=t.down("#tabRadiosRadio1");var p=t.down("#tabAdvWifiRadio1");var n=r.up("window");if(n.getItemId()!="winAccessPointEditApMain"){t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s}})}else{t.load({url:m.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:s,ap_id:n.apId}})}if(o==2){l.setDisabled(false);l.tab.show();p.setDisabled(false);p.tab.show()}else{l.setDisabled(true);l.tab.hide();p.setDisabled(true);p.tab.hide()}},loadAdvancedWifiSettings:function(m){var o=this;var p=m.down("form");var k=p.down("cmbApHardwareModels");var l=k.getValue();var n=p.down("#tabAdvWifiRadio1");n.setDisabled(true);n.tab.hide();var j=p.down("#tabRadiosRadio1");j.setDisabled(true);j.tab.hide();p.load({url:o.getUrlAdvancedSettingsForModel(),method:"GET",params:{model:l}})},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winApProfileAddWizardId")){var h=Ext.widget("winApProfileAddWizard",{id:"winApProfileAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winApProfileAddWizardId")){var h=Ext.widget("winApProfileAddWizard",{id:"winApProfileAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winApProfileAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winApProfileAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sApProfiles").load();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){var h=b.getGrid().getSelectionModel().getSelection();var g=[];Ext.Array.forEach(h,function(e){var d=e.getId();Ext.Array.push(g,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:g,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}}})}},edit:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cAccessPointEdits","Index",k,j)}}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteApProfiles"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteApProfiles"+m.getId(),noteForId:m.getId(),noteForGrid:"ap_profiles",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteApProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteApProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sItem_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.show({title:i18n("sConfirm"),msg:i18n("sAre_you_sure_you_want_to_do_that_qm"),buttons:Ext.Msg.YESNO,icon:Ext.Msg.QUESTION,callback:function(a){if("yes"===a){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}}})}},redirectAp:function(q){var n=this;var o=q.up("#tabAccessPoints");var r=o.down("gridUnknownAps").getStore();if(o.down("gridUnknownAps").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=o.down("gridUnknownAps").getSelectionModel().getLastSelected();var m=p.getId();var l=p.get("new_server");if(!Ext.WindowManager.get("winApUnknownRedirectId")){var k=Ext.widget("winApUnknownRedirect",{id:"winApUnknownRedirectId",unknownApId:m,new_server:l,store:r});k.show()}}},btnRedirectApSave:function(h){var j=this;var i=h.up("winApUnknownRedirect");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlRedirectAp(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},scope:j,failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cAccessPoints"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridAccessProviders",Ext.grid.Panel,{multiSelect:true,store:"sAccessProvidersGrid",stateful:true,stateId:"StateGridAccessProviders",stateEvents:["groupclick","columnhide"],border:false,urlMenu:"/cake3/rd_cake/access-providers/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridAccessProviders1"},{text:i18n("sOwner"),sortable:true,flex:1,dataIndex:"owner",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders2"},{text:i18n("sUsername"),sortable:true,flex:1,dataIndex:"username",tdCls:"gridMain",filter:{type:"string"},stateId:"StateGridAccessProviders3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders4"},{text:i18n("sSurname"),dataIndex:"surname",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders5"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders6"},{text:i18n("s_email"),flex:1,dataIndex:"email",tdCls:"gridTree",filter:{type:"string"},stateId:"StateGridAccessProviders7"},{text:i18n("sActive"),xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridAccessProviders9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridAccessProviders10",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridAccessProviders11"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridAccessProviders12"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessProviders"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessProviders"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessProviders:true},["widget.gridAccessProviders"],0,[Rd.view.accessProviders,"gridAccessProviders"],0));(Ext.cmd.derive("Rd.view.components.winCsvColumnSelect",Ext.window.Window,{title:i18n("sCSV_export"),layout:"fit",autoShow:false,width:450,height:400,glyph:Rd.config.icnCsv,columns:[],initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"checkboxgroup",columns:2,vertical:true,items:b.columns}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winCsvColumnSelect"],["component","box","container","panel","window","winCsvColumnSelect"],{component:true,box:true,container:true,panel:true,window:true,winCsvColumnSelect:true},["widget.winCsvColumnSelect"],0,[Rd.view.components,"winCsvColumnSelect"],0));(Ext.cmd.derive("Rd.model.mApUserRight",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"group_right"},{name:"parent_id",type:"int"},{name:"allowed",type:"bool"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index_ap.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mApUserRight"],0));(Ext.cmd.derive("Rd.model.mApRealms",Ext.data.Model,{fields:["id","name","create","read","update","delete"]},0,0,0,0,0,0,[Rd.model,"mApRealms"],0));(Ext.cmd.derive("Rd.model.mAccessProviderGrid",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"username",type:"string"},"name","surname","phone","email","monitor","active","language",{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAccessProviderGrid"],0));(Ext.cmd.derive("Rd.view.accessProviders.pnlAccessProvider",Ext.tab.Panel,{border:false,ap_id:null,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;if(b.limits){b.items=[{title:i18n("sDetail"),itemId:"tabDetail",xtype:"pnlAccessProviderDetail",ap_id:b.ap_id},{title:i18n("sRealms"),itemId:"tabRealms",xtype:"gridApRealms",ap_id:b.ap_id},{title:i18n("sRights"),itemId:"tabRights",xtype:"treeApUserRights",ap_id:b.ap_id},{title:i18n("sLimits"),itemId:"tabLimits",xtype:"gridAccessProviderLimits",ap_id:b.ap_id}]}else{b.items=[{title:i18n("sDetail"),itemId:"tabDetail",xtype:"pnlAccessProviderDetail",ap_id:b.ap_id},{title:i18n("sRealms"),itemId:"tabRealms",xtype:"gridApRealms",ap_id:b.ap_id},{title:i18n("sRights"),itemId:"tabRights",xtype:"treeApUserRights",ap_id:b.ap_id}]}Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessProvider"],["component","box","container","panel","tabpanel","pnlAccessProvider"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlAccessProvider:true},["widget.pnlAccessProvider"],0,[Rd.view.accessProviders,"pnlAccessProvider"],0));(Ext.cmd.derive("Rd.store.sLanguages",Ext.data.Store,{fields:["id","country","language","icon_file","text","rtl"],proxy:{type:"rest",url:"/cake3/rd_cake/dashboard/i18n.json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sLanguages"],0));(Ext.cmd.derive("Rd.model.mApRight",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"parent_id",type:"int"},{name:"allowed",type:"bool"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index_ap.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mApRight"],0));(Ext.cmd.derive("Rd.store.sApRights",Ext.data.TreeStore,{model:"Rd.model.mApRight",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index_ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index_ap.json",update:"/cake2/rd_cake/acos_rights/edit_ap.json"}},root:{alias:i18n("sDefault_Access_Provider_Rights"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}},0,0,0,0,0,0,[Rd.store,"sApRights"],0));(Ext.cmd.derive("Rd.store.sAccessProvidersGrid",Ext.data.Store,{model:"Rd.model.mAccessProviderGrid",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/access-providers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sAccessProvidersGrid"],0));(Ext.cmd.derive("Rd.view.accessProviders.winApAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_Access_Provider"),width:400,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"parent_id",xtype:"textfield",name:"parent_id",value:e.user_id,hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"}]},{title:i18n("sOptional_info"),layout:"anchor",itemId:"tabOptional",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name"},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",vtype:"email"},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]}]}]});return d}},0,["winApAddWizard"],["component","box","container","panel","window","winApAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winApAddWizard:true},["widget.winApAddWizard"],0,[Rd.view.accessProviders,"winApAddWizard"],0));(Ext.cmd.derive("Rd.view.components.winNoteAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Note"),width:350,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",noteForId:"",noteForGrid:"",refreshGrid:"",initComponent:function(){var e=this;var h=e.mkScrnApTree();var g=e.mkScrnNote();e.items=[h,g];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnNote:function(){var e=this;var g=[{itemId:"btnNoteAddPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnNoteAddNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnNoteAddNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnNote",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"note",fieldLabel:i18n("sNote"),anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winNoteAdd"],["component","box","container","panel","window","winNoteAdd"],{component:true,box:true,container:true,panel:true,window:true,winNoteAdd:true},["widget.winNoteAdd"],0,[Rd.view.components,"winNoteAdd"],0));(Ext.cmd.derive("Rd.view.components.winEnableDisable",Ext.window.Window,{title:i18n("sEnable_fs_Disable"),layout:"fit",autoShow:false,width:350,height:300,iconCls:"rights",glyph:Rd.config.icnLight,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:i18n("sAction"),columns:1,vertical:true,items:[{boxLabel:i18n("sEnable"),name:"rb",inputValue:"enable",checked:true},{boxLabel:i18n("sDisable"),name:"rb",inputValue:"disable"}]}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winEnableDisable"],["component","box","container","panel","window","winEnableDisable"],{component:true,box:true,container:true,panel:true,window:true,winEnableDisable:true},["widget.winEnableDisable"],0,[Rd.view.components,"winEnableDisable"],0));(Ext.cmd.derive("Rd.model.mNote",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"note",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNote"],0));(Ext.cmd.derive("Rd.view.components.gridNote",Ext.grid.Panel,{multiSelect:true,border:false,noteForId:"",noteForGrid:"",tbar:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete"),disabled:true}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer"},{text:i18n("sNote"),dataIndex:"note",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{note}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{note}</div></tpl>")},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",width:150}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mNote",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/"+b.noteForGrid+"/note-index.json",extraParams:{for_id:b.noteForId},reader:{type:"json",rootProperty:"items",messageProperty:"message",keepRawData:true},api:{destroy:"/cake3/rd_cake/"+b.noteForGrid+"/note-del.json"}},autoLoad:true});b.getStore().addListener("load",b.onStoreNoteLoaded,b);Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},onStoreNoteLoaded:function(){var d=this;console.log(d.getStore().getTotalCount());var e=d.getStore().getTotalCount();d.down("#count").update({count:e})}},0,["gridNote"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNote"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNote:true},["widget.gridNote"],0,[Rd.view.components,"gridNote"],0));(Ext.cmd.derive("Rd.view.components.winNote",Ext.window.Window,{title:i18n("sNote_management"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"note",glyph:Rd.config.icnNote,noteForId:"",noteForGrid:"",noteForName:"",initComponent:function(){var b=this;b.items={xtype:"gridNote",noteForId:b.noteForId,noteForGrid:b.noteForGrid};b.title=i18n("sNote_management")+": "+b.noteForName;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winNote"],["component","box","container","panel","window","winNote"],{component:true,box:true,container:true,panel:true,window:true,winNote:true},["widget.winNote"],0,[Rd.view.components,"winNote"],0));(Ext.cmd.derive("Rd.view.accessProviders.vcAccessProviderDetails",Ext.app.ViewController,{init:function(){},onChkWlActiveChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("#txtWlHeader").setDisabled(false);e.down("#clrWlHeaderBg").setDisabled(false);e.down("#clrWlHeaderFg").setDisabled(false);e.down("#txtWlFooter").setDisabled(false);e.down("#chkWlImgActive").setDisabled(false);e.down("#flWlImgFileUpload").setDisabled(false)}else{e.down("#txtWlHeader").setDisabled(true);e.down("#clrWlHeaderBg").setDisabled(true);e.down("#clrWlHeaderFg").setDisabled(true);e.down("#txtWlFooter").setDisabled(true);e.down("#chkWlImgActive").setDisabled(true);e.down("#flWlImgFileUpload").setDisabled(true)}},onChkWlImgActiveChange:function(h){var j=this;var g=h.up("panel");var i=h.getValue();if(i){g.down("#flWlImgFileUpload").setDisabled(false)}else{g.down("#flWlImgFileUpload").setDisabled(true)}}},0,0,0,0,["controller.vcAccessProviderDetails"],0,[Rd.view.accessProviders,"vcAccessProviderDetails"],0));(Ext.cmd.derive("Rd.view.accessProviders.pnlAccessProviderDetail",Ext.panel.Panel,{border:false,ap_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},controller:"vcAccessProviderDetails",initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,border:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true,value:b.ap_id,itemId:"ap_id"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"}]},{title:i18n("sOptional_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name"},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",vtype:"email"},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]},{title:"White Label",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",itemId:"chkWlActive",fieldLabel:i18n("sActivate"),name:"wl_active",inputValue:"wl_active",checked:false,listeners:{change:"onChkWlActiveChange"}},{xtype:"textfield",fieldLabel:"Header Text",name:"wl_header",itemId:"txtWlHeader",disabled:true},{xtype:"colorfield",fieldLabel:"Header Background",name:"wl_h_bg",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#FFFFFF",itemId:"clrWlHeaderBg",disabled:true},{xtype:"colorfield",fieldLabel:"Header Foreground",name:"wl_h_fg",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#4b4c4c",itemId:"clrWlHeaderFg",disabled:true},{xtype:"textfield",fieldLabel:"Footer Text",name:"wl_footer",itemId:"txtWlFooter",disabled:true},{xtype:"checkbox",itemId:"chkWlImgActive",fieldLabel:"Include Logo",name:"wl_img_active",inputValue:"wl_img_active",checked:false,disabled:true,listeners:{change:"onChkWlImgActiveChange"}},{xtype:"filefield",itemId:"flWlImgFileUpload",emptyText:i18n("sSelect_an_image"),fieldLabel:"New Logo File",allowBlank:true,name:"wl_img_file_upload",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"textfield",name:"wl_img_file",hidden:true},{xtype:"image",autoEl:"div",title:"Current Logo",itemId:"imgWlLogo"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlAccessProviderDetail"],["component","box","container","panel","pnlAccessProviderDetail"],{component:true,box:true,container:true,panel:true,pnlAccessProviderDetail:true},["widget.pnlAccessProviderDetail"],0,[Rd.view.accessProviders,"pnlAccessProviderDetail"],0));(Ext.cmd.derive("Rd.view.components.advCheckColumn",Ext.grid.column.Check,{renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},0,["advCheckColumn"],["component","box","container","headercontainer","gridcolumn","checkcolumn","advCheckColumn"],{component:true,box:true,container:true,headercontainer:true,gridcolumn:true,checkcolumn:true,advCheckColumn:true},["widget.advCheckColumn"],0,[Rd.view.components,"advCheckColumn"],0));(Ext.cmd.derive("Rd.view.accessProviders.treeApUserRights",Ext.tree.Panel,{useArrows:true,rootVisible:true,rowLines:true,stripeRows:true,border:false,ap_id:null,columns:[{xtype:"treecolumn",text:i18n("sName"),sortable:true,dataIndex:"alias",tdCls:"gridTree",width:300},{xtype:"advCheckColumn",text:i18n("sAllow"),dataIndex:"allowed",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=true;if(i.isLeaf()){n=false}if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},{text:"Default Group Right",xtype:"templatecolumn",width:"120",dataIndex:"group_right",tpl:new Ext.XTemplate('<tpl if=\'group_right == "yes"\'><div class="fieldGreen">'+i18n("sYes")+"</div></tpl>",'<tpl if=\'group_right == "no"\'><div class="fieldRed">'+i18n("sNo")+"</div></tpl>")},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridComment"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.TreeStore,{model:"Rd.model.mApUserRight",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index_ap.json",extraParams:{ap_id:b.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index_ap.json",update:"/cake2/rd_cake/acos_rights/edit_ap.json"}},root:{alias:i18n("sAccess_Provider_Rights"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(j,k,l,a,m){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});Ext.tree.Panel.prototype.initComponent.apply(this,arguments)}},0,["treeApUserRights"],["component","box","container","panel","tablepanel","treepanel","treeApUserRights"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeApUserRights:true},["widget.treeApUserRights"],0,[Rd.view.accessProviders,"treeApUserRights"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridRealms",Ext.grid.Panel,{stateful:true,stateId:"StateGridApRealms",stateEvents:["groupclick","columnhide"],border:false,ap_id:null,columns:[{xtype:"rownumberer",stateId:"StateGridApRealms1"},{text:i18n("sRealm"),dataIndex:"name",tdCls:"gridMain",flex:1},{xtype:"advCheckColumn",text:i18n("sCreate"),dataIndex:"create",stateId:"StateGridApRealms2"},{xtype:"advCheckColumn",text:i18n("sRead"),dataIndex:"read",stateId:"StateGridApRealms3"},{xtype:"advCheckColumn",text:i18n("sUpdate"),dataIndex:"update",stateId:"StateGridApRealms4"},{xtype:"advCheckColumn",text:i18n("sDelete"),dataIndex:"delete",stateId:"StateGridApRealms5"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mApRealms",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/index-ap.json",extraParams:{ap_id:b.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/index-ap.json",update:"/cake3/rd_cake/realms/edit-ap.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_right"),i18n("sRight_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_right"),i18n("sRight_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false,autoSync:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridApRealms"],["component","box","container","panel","tablepanel","gridpanel","grid","gridApRealms"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridApRealms:true},["widget.gridApRealms"],0,[Rd.view.accessProviders,"gridRealms"],0));(Ext.cmd.derive("Rd.view.permanentUsers.winPermanentUserPassword",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,iconCls:"rights",glyph:Rd.config.icnKey,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),allowBlank:false,labelClsExtra:"lblRdReq",name:"password",allowBlank:false}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPermanentUserPassword"],["component","box","container","panel","window","winPermanentUserPassword"],{component:true,box:true,container:true,panel:true,window:true,winPermanentUserPassword:true},["widget.winPermanentUserPassword"],0,[Rd.view.permanentUsers,"winPermanentUserPassword"],0));(Ext.cmd.derive("Rd.view.components.vCmbLanguages",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sLanguages",queryMode:"local",valueField:"id",displayField:"text",typeAhead:true,mode:"local",itemId:"cmbLanguage",tpl:Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="x-boundlist-item">','<img src="{icon_file}" style="float:left;margin:5px;"/>','<div style="margin-left:70px;font-weight:bold;font-size:16px;">{country}</div>','<div style="margin-left:70px;font-size: 14px;color: #4d4d4d;">{language}</div>',"</div>","</tpl>"),displayTpl:Ext.create("Ext.XTemplate",'<tpl for=".">',"{country} - {language}","</tpl>")},0,["cmbLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbLanguages:true},["widget.cmbLanguages"],0,[Rd.view.components,"vCmbLanguages"],0));(Ext.cmd.derive("Rd.view.accessProviders.gridAccessProviderLimits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridApl",stateEvents:["groupclick","columnhide"],border:false,comp_id:null,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var d=this;d.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];var e=Ext.create("Ext.grid.plugin.RowEditing",{clicksToMoveEditor:1,autoCancel:false});d.plugins=[e];d.store=Ext.create(Ext.data.Store,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"active",type:"bool"},{name:"count",type:"int"},{name:"description",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{ap_id:d.ap_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake2/rd_cake/limits/add.json",read:"/cake2/rd_cake/limits/index.json",update:"/cake2/rd_cake/limits/edit.json",destroy:"/cake2/rd_cake/limits/delete.json"}},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.load()},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);k.load()}})}},scope:this},autoLoad:true,autoSync:false});d.columns=[{xtype:"rownumberer",stateId:"StateGridApl1"},{text:"Item to Limit",dataIndex:"alias",tdCls:"gridTree",stateId:"StateGridApl12"},{text:i18n("sActive"),xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",stateId:"StateGridApl3",editor:{xtype:"checkbox",cls:"x-grid-checkheader-editor"}},{text:"Limit count",dataIndex:"count",tdCls:"gridTree",stateId:"StateGridApl14",editor:{xtype:"numberfield",allowBlank:false,minValue:0,maxValue:150000}},{text:"Description",flex:1,dataIndex:"description",tdCls:"gridTree",stateId:"StateGridApl15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridAccessProviderLimits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridAccessProviderLimits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridAccessProviderLimits:true},["widget.gridAccessProviderLimits"],0,[Rd.view.accessProviders,"gridAccessProviderLimits"],0));(Ext.cmd.derive("Rd.controller.cAccessProviders",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,plain:true,itemId:"tabAccessProviders",cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridAccessProviders",glyph:Rd.config.icnHome}]});d.populated=true},views:["accessProviders.pnlAccessProvider","accessProviders.pnlAccessProviderDetail","accessProviders.treeApUserRights","accessProviders.gridRealms","accessProviders.gridAccessProviders","accessProviders.winApAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","permanentUsers.winPermanentUserPassword","components.winEnableDisable","components.vCmbLanguages","accessProviders.gridAccessProviderLimits"],stores:["sLanguages","sApRights","sAccessProvidersGrid","sAccessProvidersTree"],models:["mApUserRight","mApRealms","mAccessProviderGrid","mAccessProviderTree"],selectedRecord:undefined,config:{urlAdd:"/cake2/rd_cake/access_providers/add.json",urlEdit:"/cake3/rd_cake/access-providers/edit.json",urlDelete:"/cake2/rd_cake/access_providers/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/access-providers/exportCsv",urlNoteAdd:"/cake3/rd_cake/access-providers/note_add.json",urlViewAPDetail:"/cake3/rd_cake/access-providers/view.json",urlEnableDisable:"/cake3/rd_cake/access-providers/enable_disable.json",urlChangePassword:"/cake3/rd_cake/access-providers/change_password.json",urlLimitCheck:"/cake2/rd_cake/limits/limit_check.json"},refs:[{ref:"winAccessProviders",selector:"#accessProvidersWin"},{ref:"grid",selector:"gridAccessProviders"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabAccessProviders":{destroy:b.appClose},"gridAccessProviders #reload":{click:b.reload},"gridAccessProviders #add":{click:b.add},"gridAccessProviders #edit":{click:b.edit},"gridAccessProviders #delete":{click:b.del},"gridAccessProviders #note":{click:b.note},"gridAccessProviders #csv":{click:b.csvExport},"gridAccessProviders #password":{click:b.changePassword},"gridAccessProviders #enable_disable":{click:b.enableDisable},gridAccessProviders:{activate:b.gridActivate,itemclick:b.gridClick},"winApAddWizard #btnTreeNext":{click:b.btnTreeNext},"winApAddWizard #btnDetailPrev":{click:b.btnDetailPrev},"winApAddWizard #save":{click:b.addSubmit},"winAccessProviderDetail #save":{click:b.addSubmit},"pnlAccessProvider pnlAccessProviderDetail #save":{click:b.editSubmit},"pnlAccessProvider treeApUserRights #reload":{click:b.apRightReload},"pnlAccessProvider treeApUserRights #expand":{click:b.apRightExpand},"pnlAccessProvider treeApUserRights advCheckColumn":{checkchange:b.apRightChange},"pnlAccessProvider gridApRealms #reload":{click:b.apRealmsReload},"pnlAccessProvider gridAccessProviderLimits #reload":{click:b.limitsReload},"#winCsvColumnSelectAp #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=access-providers] #reload":{click:b.noteReload},"gridNote[noteForGrid=access-providers] #add":{click:b.noteAdd},"gridNote[noteForGrid=access-providers] #delete":{click:b.noteDelete},"gridNote[noteForGrid=access-providers]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=access-providers] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=access-providers] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=access-providers] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlAccessProvider #tabDetail":{beforerender:b.tabDetailActivate,activate:b.tabDetailActivate},"pnlAccessProvider #tabRealms":{activate:b.tabRealmsActivate},"pnlAccessProvider #tabRights":{activate:b.tabRightsActivate},"pnlAccessProvider #tabLimits":{activate:b.tabLimitsActivate},"winPermanentUserPassword #save":{click:b.changePasswordSubmit},"#winEnableDisableUser #save":{click:b.enableDisableSubmit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(){var b=this;Ext.Ajax.request({url:b.getUrlApChildCheck(),method:"GET",success:function(h){var g=Ext.JSON.decode(h.responseText);if(g.success){if(g.items.tree==true){if(!Ext.WindowManager.get("winApAddWizardId")){var a=Ext.widget("winApAddWizard",{id:"winApAddWizardId",no_tree:false,selLanguage:b.application.getSelLanguage()});a.show()}}else{if(!Ext.WindowManager.get("winApAddWizardId")){var a=Ext.widget("winApAddWizard",{id:"winApAddWizardId",noTree:true,selLanguage:b.application.getSelLanguage(),startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user")});a.show()}}}},scope:b})},btnTreeNext:function(i){var m=this;var j=i.up("treepanel");var n=j.getSelectionModel().getLastSelected();if(n){var l=i.up("winApAddWizard");l.down("#owner").setValue(n.get("username"));l.down("#parent_id").setValue(n.getId());l.getLayout().setActiveItem("scrnData");var k=l.down("tabpanel");k.setActiveTab(0)}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDetailPrev:function(g){var e=this;var h=g.up("winApAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var d=e.getId();var b="apTab_"+d;var n=a.down("#"+b);if(n){a.setActiveTab(b);return}var p=e.get("username");Ext.Ajax.request({url:i.getUrlLimitCheck(),method:"GET",success:function(m){var k=Ext.JSON.decode(m.responseText);console.log(k);if(k.success){var l=k.data.enabled;a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlAccessProvider",ap_id:d,limits:l}});a.setActiveTab(b)}},scope:i})})}},editSubmit:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=e.down("#ap_id").getValue();e.load({url:h.getUrlViewAPDetail(),method:"GET",params:{ap_id:a},success:function(o,p,m){if(p.result.data.wl_img!=null){var n=e.down("#imgWlLogo");n.setSrc(p.result.data.wl_img)}}})},failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(e){var d=Ext.JSON.decode(e.responseText);if(d.success){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()}else{Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),i18n("sProblems_deleting_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},apRightReload:function(e){var h=this;var g=e.up("treeApUserRights");g.getStore().load()},apRightExpand:function(l){var j=this;var i=l.up("treeApUserRights");var h=i.getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=i.getSelectionModel().getLastSelected();i.expandNode(k,true)}},apRightChange:function(e){var h=this;var g=e.up("treeApUserRights");g.getStore().sync({success:function(a,b){Ext.ux.Toaster.msg(i18n("sRight_Changed"),i18n("sRight_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sProblems_changing_right"),i18n("sThere_were_some_problems_experienced_during_changing_of_the_right"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},apRealmsReload:function(e){var h=this;var g=e.up("gridApRealms");g.getStore().load()},limitsReload:function(e){var h=this;var g=e.up("grid");g.getStore().load()},onStoreApLoaded:function(){var d=this;var e=d.getStore("sAccessProvidersGrid").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAp")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAp",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteAp"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteAp"+m.getId(),noteForId:m.getId(),noteForGrid:"access-providers",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteApAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteApAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteApAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(h){var j=this;var g=h.down("form");var i=h.up("pnlAccessProvider").ap_id;g.load({url:j.getUrlViewAPDetail(),method:"GET",params:{ap_id:i},success:function(d,e,a){if(e.result.data.wl_img!=null){var b=g.down("#imgWlLogo");b.setSrc(e.result.data.wl_img)}}})},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPermanentUsersPassword"+j.getId())){var h=Ext.widget("winPermanentUserPassword",{id:"winPermanentUsersPassword"+j.getId(),user_id:j.getId(),username:j.get("username"),title:i18n("sChange_password_for")+" "+j.get("username")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.user_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisableUser")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisableUser"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabRealmsActivate:function(e){var d=this;e.getStore().load()},tabRightsActivate:function(e){var d=this;e.getStore().load()},tabLimitsActivate:function(e){var d=this;e.getStore().load()}},0,0,0,0,0,0,[Rd.controller,"cAccessProviders"],0));(Ext.cmd.derive("Rd.view.acos.treeAco",Ext.tree.Panel,{useArrows:true,store:"sAcos",rootVisible:true,rowLines:true,stripeRows:true,border:false,columns:[{xtype:"treecolumn",text:i18n("sName"),flex:1,sortable:true,dataIndex:"alias",tdCls:"gridTree"},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridTree"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}],initComponent:function(){var b=this;b.mask=new Ext.LoadMask(b,{msg:i18n("sConnecting")+" ...."});Ext.tree.Panel.prototype.initComponent.apply(this,arguments)}},0,["treeAco"],["component","box","container","panel","tablepanel","treepanel","treeAco"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeAco:true},["widget.treeAco"],0,[Rd.view.acos,"treeAco"],0));(Ext.cmd.derive("Rd.view.acos.treeApRights",Ext.tree.Panel,{useArrows:true,store:"sApRights",rootVisible:true,rowLines:true,stripeRows:true,border:false,columns:[{xtype:"treecolumn",text:i18n("sName"),flex:1,sortable:true,dataIndex:"alias",tdCls:"gridTree"},{xtype:"advCheckColumn",text:i18n("sAllow"),dataIndex:"allowed",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=true;if(i.isLeaf()){n=false}if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}},{text:i18n("sComment"),flex:2,dataIndex:"comment",sortable:false,tdCls:"gridTree"}],tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-expand",glyph:Rd.config.icnExpand,scale:"large",itemId:"expand",tooltip:i18n("sExpand")},{xtype:"tbfill"}]},0,["treeApRights"],["component","box","container","panel","tablepanel","treepanel","treeApRights"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,treeApRights:true},["widget.treeApRights"],0,[Rd.view.acos,"treeApRights"],0));(Ext.cmd.derive("Rd.model.mAco",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"alias",type:"string"},{name:"comment",type:"string"},{name:"parent_id",type:"int"}],idProperty:"id",proxy:{type:"ajax",url:"/cake2/rd_cake/acos_rights/index.json",format:"json",batchActions:true,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/acos_rights/dummy_delete.json"}}},0,0,0,0,0,0,[Rd.model,"mAco"],0));(Ext.cmd.derive("Rd.view.acos.winAcoEdit",Ext.window.Window,{title:i18n("sEdit_ACO_object"),closable:true,draggable:false,resizable:false,border:false,layout:"fit",autoShow:false,width:350,height:350,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaults:{anchor:"100%"},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"parent_id",hidden:true},{xtype:"hiddenfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sAlias"),name:"alias",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sOptional_Description")}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAcoEdit"],["component","box","container","panel","window","winAcoEdit"],{component:true,box:true,container:true,panel:true,window:true,winAcoEdit:true},["widget.winAcoEdit"],0,[Rd.view.acos,"winAcoEdit"],0));(Ext.cmd.derive("Rd.store.sAcos",Ext.data.TreeStore,{model:"Rd.model.mAco",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/acos_rights/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake2/rd_cake/acos_rights/index.json",destroy:"/cake2/rd_cake/acos_rights/delete.json"}},root:{alias:i18n("sAccess_control_objects_br_ACOs_br"),leaf:false,id:"0",iconCls:"root",expanded:false},folderSort:true,clearOnLoad:true,listeners:{load:function(b,j,k,a,l){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}},0,0,0,0,0,0,[Rd.store,"sAcos"],0));(Ext.cmd.derive("Rd.view.acos.winAcoAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,border:false,title:i18n("sAdd_ACO_object"),layout:"fit",autoShow:false,width:350,height:350,iconCls:"add",glyph:Rd.config.icnAdd,parentId:undefined,parentDisplay:undefined,initComponent:function(){var b=this;b.items=[{xtype:"form",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaults:{anchor:"100%"},items:[{itemId:"parent_id",xtype:"textfield",name:"parent_id",hidden:true,value:b.parentId},{xtype:"displayfield",fieldLabel:i18n("sParent_node"),value:b.parentDisplay,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sAlias"),name:"alias",allowBlank:false,blankText:i18n("sEnter_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sOptional_Description")}],buttons:[{text:i18n("sSave"),scale:"large",action:"save",itemId:"save",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAcoAdd"],["component","box","container","panel","window","winAcoAdd"],{component:true,box:true,container:true,panel:true,window:true,winAcoAdd:true},["widget.winAcoAdd"],0,[Rd.view.acos,"winAcoAdd"],0));(Ext.cmd.derive("Rd.controller.cAcos",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabAcos",plain:true,cls:"subSubTab",items:[{title:i18n("sAccess_Controll_Objects"),xtype:"treeAco"},{title:i18n("sAccess_Provider_Rights"),xtype:"treeApRights"}]});d.populated=true},views:["acos.treeAco","acos.winAcoAdd","acos.winAcoEdit","acos.treeApRights"],stores:["sAcos","sApRights"],models:["mAco","mApRight"],acoSelectedRecord:undefined,apRightsSelectedRecord:undefined,config:{urlAcosRightsAdd:"/cake2/rd_cake/acos_rights/add.json",urlAcosRightEdit:"/cake2/rd_cake/acos_rights/edit.json"},refs:[{ref:"treeAco",selector:"treeAco"},{ref:"treeApRights",selector:"treeApRights"}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({"#tabAcos":{destroy:me.appClose},"treeAco #reload":{click:me.acoReload},"treeAco #add":{click:me.acoAdd},"treeAco #edit":{click:me.acoEdit},"treeAco #delete":{click:me.acoDelete},"treeAco #expand":{click:me.acoExpand},"winAcoAdd #save":{click:me.acoAddSubmit},"winAcoEdit #save":{click:me.acoEditSubmit},"#tabAcos treeAco":{itemclick:me.acoGridClick},"treeApRights advCheckColumn":{checkchange:me.apRightChange},"#tabAcos treeApRights":{itemclick:me.apRightsGridClick},"treeApRights #reload":{click:me.apRightsReload},"treeApRights #expand":{click:me.apRightsExpand}})},appClose:function(){var b=this;b.populated=false},acoReload:function(){var b=this;b.getStore("sAcos").load()},acoAdd:function(){var k=this;var h=k.getTreeAco().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_of_the_tree_under_which_to_add_an_ACO_entry"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{console.log(k.acoSelectedRecord.getId());var j=k.acoSelectedRecord.getId();var l=k.acoSelectedRecord.get("alias");if(!Ext.WindowManager.get("winAcoAddId")){var j=k.acoSelectedRecord.getId();var l=k.acoSelectedRecord.get("alias");var i=Ext.widget("winAcoAdd",{id:"winAcoAddId",parentId:j,parentDisplay:l});i.show()}}}},acoAddSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAcosRightsAdd(),success:function(b,a){i.close();j.getTreeAco().getStore().load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},acoEdit:function(){var h=this;var e=h.getTreeAco().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(e>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.acoSelectedRecord.getId()==0){Ext.ux.Toaster.msg(i18n("sRoot_node_selected"),i18n("sYou_can_not_edit_the_root_node"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winAcoEditId")){var g=Ext.widget("winAcoEdit",{id:"winAcoAddId"});g.show();g.down("form").loadRecord(h.acoSelectedRecord);g.down('hiddenfield[name="parent_id"]').setValue(h.acoSelectedRecord.parentNode.getId())}}}}},acoEditSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAcosRightEdit(),success:function(b,a){i.close();j.getTreeAco().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},acoDelete:function(){var b=this;if(b.getTreeAco().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){Ext.each(b.getTreeAco().getSelectionModel().getSelection(),function(e){e.remove(true)});b.getTreeAco().getStore().sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}})}},acoGridClick:function(n,j,k,i,l){var m=this;m.acoSelectedRecord=j},acoExpand:function(){var d=this;var e=d.getTreeAco().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{d.getTreeAco().expandNode(d.acoSelectedRecord,true)}},apRightChange:function(){var b=this;b.getTreeApRights().getStore().sync({success:function(e,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},apRightsGridClick:function(n,j,k,i,l){var m=this;m.apRightsSelectedRecord=j},apRightsReload:function(){var b=this;b.getStore("sApRights").load()},apRightsExpand:function(){var d=this;var e=d.getTreeApRights().getSelectionModel().getCount();if(e==0){Ext.ux.Toaster.msg(i18n("sSelect_a_node"),i18n("sFirst_select_a_node_to_expand"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{d.getTreeApRights().expandNode(d.apRightsSelectedRecord,true)}}},0,0,0,0,0,0,[Rd.controller,"cAcos"],0));(Ext.cmd.derive("Rd.view.activityMonitor.gridRadaccts",Ext.grid.Panel,{multiSelect:true,store:"sRadaccts",stateful:true,stateId:"StateGridRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/radaccts/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var e=this;var d=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"user",text:"User"},{id:"voucher",text:"Voucher"},{id:"device",text:"Device"}]});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.columns=[{xtype:"rownumberer",stateId:"StateGridRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts3"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts4"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts5"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts6"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts7"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts8"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts9"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts10"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridRadaccts11"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(a,i,j){if(j.get("active")==true){var b=j.get("online_human");return'<div class="fieldGreen">'+b+" "+i18n("sOnline")+"</div>"}else{return a}},stateId:"StateGridRadaccts12"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.secondsToHuman(a)},stateId:"StateGridRadaccts13"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts14"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts15"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts16"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridRadaccts17"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridRadaccts18"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts19"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts20"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts21"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts22"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts23"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadaccts24"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts25"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts26"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRadaccts27"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRadaccts:true},["widget.gridRadaccts"],0,[Rd.view.activityMonitor,"gridRadaccts"],0));(Ext.cmd.derive("Rd.view.activityMonitor.gridRadpostauths",Ext.grid.Panel,{multiSelect:true,store:"sRadpostauths",stateful:true,stateId:"StateGridRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/radpostauths/menu_for_grid.json",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths3"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths4"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridRadpostauths5"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRadpostauths6"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridRadpostauths7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRadpostauths:true},["widget.gridRadpostauths"],0,[Rd.view.activityMonitor,"gridRadpostauths"],0));(Ext.cmd.derive("Rd.model.mRadacct",Ext.data.Model,{fields:[{name:"id",type:"int"},"acctsessionid","acctuniqueid","username","groupname","realm","nasipaddress","nasidentifier","nasportid","nasporttype",{name:"acctstarttime",type:"date",dateFormat:"Y-m-d H:i:s"},"acctstoptime","acctsessiontime","acctauthentic","connectinfo_start","connectinfo_stop","acctinputoctets","acctoutputoctets","calledstationid","callingstationid","acctterminatecause","servicetype","framedprotocol","framedipaddress","acctstartdelay","acctstopdelay","xascendsessionsvrkey","active","online_human"]},0,0,0,0,0,0,[Rd.model,"mRadacct"],0));(Ext.cmd.derive("Rd.model.mRadpostauth",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"realm",type:"string"},{name:"pass",type:"string"},{name:"reply",type:"string"},{name:"nasname",type:"string"},"authdate"]},0,0,0,0,0,0,[Rd.model,"mRadpostauth"],0));(Ext.cmd.derive("Rd.model.mNas",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"nasname",type:"string"},{name:"shortname",type:"string"},{name:"nasidentifier",type:"string"},{name:"type",type:"string"},{name:"ports",type:"string"},{name:"secret",type:"string"},{name:"community",type:"string"},{name:"server",type:"string"},{name:"description",type:"string"},"connection_type","record_auth","dynamic_attribute","dynamic_value","monitor","ping_interval","heartbeat_dead_after","session_auto_close","session_dead_time","on_public_maps","lat","lon","photo_file_name",{name:"owner",type:"string"},"user_id","realms","tags","connection_type","status",{name:"status_time",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"manage_tags",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNas"],0));(Ext.cmd.derive("Rd.model.mUserStat",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"time_unit",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mUserStat"],0));(Ext.cmd.derive("Rd.store.sRadaccts",Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}},0,0,0,0,0,0,[Rd.store,"sRadaccts"],0));(Ext.cmd.derive("Rd.store.sRadpostauths",Ext.data.Store,{model:"Rd.model.mRadpostauth",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}},0,0,0,0,0,0,[Rd.store,"sRadpostauths"],0));(Ext.cmd.derive("Rd.view.components.pnlUsageGraph",Ext.panel.Panel,{margins:"0 0 0 0",plain:true,border:false,tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"datefield",fieldLabel:i18n("sDay"),name:"day",itemId:"day",value:new Date(),format:"Y-m-d",labelClsExtra:"lblRd",labelAlign:"left",labelWidth:50,margin:2,labelSeparator:""}]},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}],type:"permanent",span:"daily",username:false,initComponent:function(){var d=this;d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mUserStat",proxy:{type:"ajax",format:"json",extraParams:{username:d.username,type:d.type,span:d.span},url:"/cake2/rd_cake/user_stats/index.json",reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},listeners:{beforeload:function(a){e.setLoading(true)},load:function(l){e.setLoading(false);var a=e.getStore().getProxy().getReader().rawData;var j=Ext.ux.bytesToHuman(a.totalIn);var k=Ext.ux.bytesToHuman(a.totalOut);var b=Ext.ux.bytesToHuman(a.totalInOut);d.down("#totals").update({"in":j,out:k,total:b})}},autoLoad:false});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:20,left:20,right:20,bottom:20},width:"100%",store:d.store,legend:{docked:"bottom"},axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["data_in","data_out"],renderer:function(a,b,h){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",position:"bottom",grid:false,fields:["time_unit"]}],interactions:["itemhighlight"],series:[{type:"bar",title:["Data In","Data out"],xField:"time_unit",yField:["data_in","data_out"],stacked:true,style:{opacity:0.8},highlight:{fillStyle:"yellow"},tooltip:{renderer:function(a,k,b){var j=Ext.ux.bytesToHuman(k.get("data_in"));var l=Ext.ux.bytesToHuman(k.get("data_out"));a.setHtml("Data in <b>"+j+"</b><br>Data out <b>"+l+"</b>")}}}]});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlUsageGraph"],["component","box","container","panel","pnlUsageGraph"],{component:true,box:true,container:true,panel:true,pnlUsageGraph:true},["widget.pnlUsageGraph"],0,[Rd.view.components,"pnlUsageGraph"],0));(Ext.cmd.derive("Rd.view.components.cmbNas",Ext.form.ComboBox,{fieldLabel:i18n("sNAS_IP_Address"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"nasname",typeAhead:true,allowBlank:false,mode:"local",name:"profile_id",pageSize:1,labelClsExtra:"lblRd",listConfig:{getInnerTpl:function(){return'<div data-qtip="{nasname} : {shortname}"><div class="combo-main">{nasname}</div><div class="combo-detail"> {shortname}</div></div>'}},initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mNas",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbNas"],["component","box","field","textfield","pickerfield","combobox","combo","cmbNas"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbNas:true},["widget.cmbNas"],0,[Rd.view.components,"cmbNas"],0));(Ext.cmd.derive("Rd.view.components.chrtBasicPie",Ext.chart.PolarChart,{width:250,height:350,animate:true,shadow:true,interactions:["rotate"],insetPadding:50,innerPadding:20,legend:{docked:"bottom"},initComponent:function(){var b=this;Ext.chart.PolarChart.prototype.initComponent.apply(this,arguments)}},0,0,["component","box","container","panel","draw","polar"],{component:true,box:true,container:true,panel:true,draw:true,polar:true},0,0,[Rd.view.components,"chrtBasicPie"],0));(Ext.cmd.derive("Rd.view.activityMonitor.pnlRadius",Ext.panel.Panel,{border:false,layout:{type:"hbox",align:"stretch"},tbar:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">'+i18n("sReload_every")+"</b>",{text:i18n("s30_seconds"),itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:i18n("s1_minute"),itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:i18n("s5_minutes"),itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:i18n("sStop_auto_reload"),itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"cmbNas",allowBlank:true,width:400}],bbar:[{xtype:"component",itemId:"status",tpl:"Status: {mesg}",style:"margin-right:5px",cls:"lblYfi"}],authBasicStore:null,authDetailStore:null,initComponent:function(){var b=this;b.items=[{xtype:"panel",title:i18n("sAuthentication"),autoScroll:true,flex:2,layout:{type:"hbox"},collapsible:true,collapseDirection:"left"},{xtype:"panel",title:i18n("sAccounting"),autoScroll:true,flex:1,layout:{type:"hbox"},collapsible:true,collapseDirection:"right"}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},auth_basic:function(){var d=this;d.authBasicStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.authBasicStore});return e},auth_detail:function(){var d=this;d.authDetailStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.authDetailStore});return e},acct_detail:function(){var d=this;d.acctDetailStore=Ext.create("Ext.data.JsonStore",{fields:["name","data"]});var e=Ext.create("Rd.view.components.chrtBasicPie",{store:d.acctDetailStore});return e}},0,["pnlRadius"],["component","box","container","panel","pnlRadius"],{component:true,box:true,container:true,panel:true,pnlRadius:true},["widget.pnlRadius"],0,[Rd.view.activityMonitor,"pnlRadius"],0));(Ext.cmd.derive("Rd.controller.cActivityMonitor",Ext.app.Controller,{actionIndex:function(g){var j=this;var i=g.up("tabpanel");am_id="tabActivityMonitor";var h=i.down("#"+am_id);if(h){i.setActiveTab(am_id);return}i.add({title:"Activity Monitor",xtype:"tabpanel",itemId:am_id,closable:true,glyph:Rd.config.icnActivity,border:false,itemId:"tabActivityMonitor",plain:true,cls:"subSubTab",layout:"fit",items:[{title:i18n("sAccounting_data"),xtype:"gridRadaccts"},{title:i18n("sAuthentication_data"),xtype:"gridRadpostauths"}]});i.setActiveTab(am_id)},views:["activityMonitor.gridRadaccts","activityMonitor.gridRadpostauths","components.cmbNas","activityMonitor.pnlRadius","components.winCsvColumnSelect","components.pnlUsageGraph"],stores:["sRadaccts","sRadpostauths"],models:["mRadacct","mRadpostauth","mNas","mUserStat"],selectedRecord:null,specific_nas:undefined,config:{urlExportCsvAcct:"/cake2/rd_cake/radaccts/export_csv",urlExportCsvAuth:"/cake2/rd_cake/radpostauths/export_csv",urlKickActive:"/cake2/rd_cake/radaccts/kick_active.json",urlCloseOpen:"/cake2/rd_cake/radaccts/close_open.json"},refs:[{ref:"grid",selector:"gridRadaccts"},{ref:"gridRadpostauths",selector:"gridRadpostauths"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.getStore("sRadaccts").addListener("load",b.onStoreRadacctsLoaded,b);b.control({"#tabActivityMonitor":{destroy:b.appClose},"gridRadaccts #reload":{click:b.reload},"gridRadaccts #reload menuitem[group=refresh]":{click:b.acctReloadOptionClick},"gridRadaccts #connected":{click:b.reload},"gridRadaccts #csv":{click:b.csvExportAcct},"gridRadaccts #graph":{click:b.usageGraph},"gridRadaccts #kick":{click:b.kickActive},"gridRadaccts #close":{click:b.closeOpen},gridRadaccts:{},gridRadaccts:{activate:b.reload},"gridRadpostauths #reload":{click:b.reloadPostAuths},gridRadpostauths:{activate:b.gridActivate},"gridRadpostauths #reload menuitem[group=refresh]":{click:b.authReloadOptionClick},"gridRadpostauths #csv":{click:b.csvExportAuth},"pnlRadius #reload":{click:b.radiusReload},"pnlRadius #reload menuitem[group=refresh]":{click:b.radiusReloadOptionClick},pnlRadius:{activate:b.radiusActivate},"pnlRadius  cmbNas":{change:b.cmbNasChange},"#winCsvColumnSelectAcct #save":{click:b.csvExportSubmitAcct},"#winCsvColumnSelectAuth #save":{click:b.csvExportSubmitAuth},"#daily":{activate:b.loadGraph},"#daily #reload":{click:b.reloadDailyGraph},"#daily #day":{change:b.changeDailyGraph},"#weekly":{activate:b.loadGraph},"#weekly #reload":{click:b.reloadWeeklyGraph},"#weekly #day":{change:b.changeWeeklyGraph},"#monthly":{activate:b.loadGraph},"#monthly #reload":{click:b.reloadMonthlyGraph},"#monthly #day":{change:b.changeMonthlyGraph}})},reload:function(){var d=this;var e=d.getGrid().down("#connected");if(e==null){e=true}else{e=e.pressed}d.getStore("sRadaccts").getProxy().extraParams={only_connected:e};d.getStore("sRadaccts").load()},onStoreRadacctsLoaded:function(){var g=this;var j=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalIn);var h=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalOut);var i=Ext.ux.bytesToHuman(g.getStore("sRadaccts").getProxy().getReader().rawData.totalInOut);g.getGrid().down("#totals").update({"in":j,out:h,total:i})},gridActivate:function(d){var e=this;d.getStore().load()},reloadPostAuths:function(){var b=this;b.getStore("sRadpostauths").load()},appClose:function(){var b=this;b.populated=false;if(b.autoReloadAcct!=undefined){clearInterval(b.autoReloadAcct)}if(b.autoReloadAuth!=undefined){clearInterval(b.autoReloadAuth)}if(b.autoReloadRadius!=undefined){clearInterval(b.autoReloadRadius)}},acctReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadAcct);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadAcct=setInterval(function(){j.reload()},k)},authReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadAuth);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadAuth=setInterval(function(){j.reloadPostAuths()},k)},radiusReload:function(g){var j=this;var h=g.up("pnlRadius");var i={};h.down("#status").update({mesg:"fetching the latest info"});if(j.specific_nas!=undefined){console.log(j.specific_nas);i.nas_id=j.specific_nas}Ext.Ajax.request({url:"/cake2/rd_cake/free_radius/index.json",method:"GET",params:i,success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){h.authBasicStore.loadData(a.items.auth_basic);h.authDetailStore.loadData(a.items.auth_detail);h.acctDetailStore.loadData(a.items.acct_detail);h.down("#status").update({mesg:"idle"})}},scope:j})},radiusActivate:function(e){var h=this;var g=e.down("#reload");h.radiusReload(g)},radiusReloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadRadius);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadRadius=setInterval(function(){j.radiusReload(b)},k)},cmbNasChange:function(j){var l=this;var k=j.getValue();var i=j.getStore();var h=i.getById(k);if(h!=null){l.specific_nas=k}},csvExportAcct:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAcct")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAcct",columns:k});j.show()}},csvExportSubmitAcct:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsvAcct()+B);I.close()}},csvExportAuth:function(n,l){var m=this;var i=m.getGridRadpostauths().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectAuth")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectAuth",columns:k});j.show()}},csvExportSubmitAuth:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsvAuth()+B);I.close()}},closeOpen:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k={};var l=i.getSelectionModel().getSelection();Ext.Array.each(l,function(b){var a=b.getId();k[a]=a});Ext.Ajax.request({url:j.getUrlCloseOpen(),method:"GET",params:k,success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reload()}},scope:j})}},kickActive:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.ux.Toaster.msg("Sending request","Please be patient",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.setDisabled(true);var k={};var l=i.getSelectionModel().getSelection();Ext.Array.each(l,function(b){var a=b.getId();k[a]=a});Ext.Ajax.request({url:j.getUrlKickActive(),method:"GET",params:k,success:function(b){h.setDisabled(false);var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reload()}},scope:j})}},usageGraph:function(h){var j=this;var i=h.up("grid");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(d,e){var a=i.up("tabpanel");var b=d.get("username");b=b.replace("@","_");b=b.toLowerCase();var p=d.get("username");var g="graphTab_"+b;var o=a.down("#"+g);if(o){a.setActiveTab(g);return}a.add({title:b,itemId:g,closable:true,iconCls:"graph",glyph:Rd.config.icnGraph,layout:"fit",xtype:"tabpanel",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",items:[{title:"Daily",itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:p,type:"activity_viewer"},{title:"Weekly",itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:p,type:"activity_viewer"},{title:"Monthly",itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:p,type:"activity_viewer"}]});a.setActiveTab(g)})}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cActivityMonitor"],0));(Ext.cmd.derive("Rd.view.blackLists.gridBlackLists",Ext.grid.Panel,{multiSelect:true,store:"sBlackLists",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/black-lists/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridBl1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridBl3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridBl6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridBlackLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridBlackLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridBlackLists:true},["widget.gridBlackLists"],0,[Rd.view.blackLists,"gridBlackLists"],0));(Ext.cmd.derive("Rd.model.mBlackList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mBlackList"],0));(Ext.cmd.derive("Rd.model.mBlackListEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"black_list_id",type:"int"},{name:"domain",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mBlackListEntry"],0));(Ext.cmd.derive("Rd.view.blackLists.pnlBlackListDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",black_list_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Black List Entries",layout:"fit",xtype:"gridBlackListEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlBlackListDetail"],["component","box","container","panel","tabpanel","pnlBlackListDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlBlackListDetail:true},["widget.pnlBlackListDetail"],0,[Rd.view.blackLists,"pnlBlackListDetail"],0));(Ext.cmd.derive("Rd.store.sBlackLists",Ext.data.Store,{model:"Rd.model.mBlackList",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/black-lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sBlackLists"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Black List",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winBlackListAddWizard"],["component","box","container","panel","window","winBlackListAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winBlackListAddWizard:true},["widget.winBlackListAddWizard"],0,[Rd.view.blackLists,"winBlackListAddWizard"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Black List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:false,labelClsExtra:"lblRdReq"},{itemId:"black_list_id",xtype:"textfield",name:"black_list_id",hidden:true,value:e.black_list_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winBlackListEntryAdd"],["component","box","container","panel","window","winBlackListEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winBlackListEntryAdd:true},["widget.winBlackListEntryAdd"],0,[Rd.view.blackLists,"winBlackListEntryAdd"],0));(Ext.cmd.derive("Rd.view.blackLists.winBlackListEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Black List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRdReq",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:true,value:g.get("domain")},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id},{itemId:"black_list_id",xtype:"textfield",name:"black_list_id",hidden:true,value:g.get("black_list_id")}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winBlackListEntryEdit"],["component","box","container","panel","window","winBlackListEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winBlackListEntryEdit:true},["widget.winBlackListEntryEdit"],0,[Rd.view.blackLists,"winBlackListEntryEdit"],0));(Ext.cmd.derive("Rd.view.blackLists.gridBlackListEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/black-lists/menu-for-black-list-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"BLE1"},{text:"Domain",dataIndex:"domain",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"BLE2"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE3"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE4"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mBlackListEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/black-lists/index-black-list-entry.json",extraParams:{black_list_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridBlackListEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridBlackListEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridBlackListEntries:true},["widget.gridBlackListEntries"],0,[Rd.view.blackLists,"gridBlackListEntries"],0));(Ext.cmd.derive("Rd.controller.cBlackLists",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabBlackLists",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridBlackLists",glyph:Rd.config.icnHome}]});d.populated=true},views:["blackLists.gridBlackLists","blackLists.winBlackListAddWizard","blackLists.pnlBlackListDetail","blackLists.gridBlackListEntries","blackLists.winBlackListEntryAdd","blackLists.winBlackListEntryEdit"],stores:["sAccessProvidersTree","sBlackLists"],models:["mAccessProviderTree","mBlackList","mBlackListEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/black-lists/add.json",urlDelete:"/cake3/rd_cake/black-lists/delete.json",urlEdit:"/cake3/rd_cake/black-lists/edit.json",urlAddEntry:"/cake3/rd_cake/black-lists/add-blacklist-entry.json",urlEditEntry:"/cake3/rd_cake/black-lists/edit-blacklist-entry.json",urlDeleteEntry:"/cake3/rd_cake/black-lists/delete-blacklist-entry.json"},refs:[{ref:"grid",selector:"gridBlackLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabBlackLists":{destroy:b.appClose},"gridBlackLists #reload":{click:b.reload},"gridBlackLists #add":{click:b.add},"gridBlackLists #delete":{click:b.del},"gridBlackLists #edit":{click:b.edit},gridBlackLists:{select:b.select},"winBlackListAddWizard #btnTreeNext":{click:b.btnTreeNext},"winBlackListAddWizard #btnDataPrev":{click:b.btnDataPrev},"winBlackListAddWizard #btnDataNext":{click:b.btnDataNext},"winBlackListEdit #save":{click:b.btnEditSave},"pnlBlackListDetail gridBlackListEntries":{activate:b.gridActivate},"#tabBlackLists gridBlackLists":{activate:b.gridActivate},"pnlBlackListDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridBlackListEntries #reload":{click:b.reloadEntries},"gridBlackListEntries #add":{click:b.addEntry},"gridBlackListEntries #edit":{click:b.editEntry},"gridBlackListEntries #delete":{click:b.deleteEntry},"winBlackListEntryAdd  #save":{click:b.saveBlackListEntryAdd},"winBlackListEntryEdit  #save":{click:b.saveBlackListEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winBlackListAddWizardId")){var h=Ext.widget("winBlackListAddWizard",{id:"winBlackListAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winBlackListAddWizardId")){var h=Ext.widget("winBlackListAddWizard",{id:"winBlackListAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winBlackListAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winBlackListAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sBlackLists").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="blackListTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlBlackListDetail",black_list_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlBlackListDetail").black_list_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winBlackListEntryAdd",{id:"winBlackListEntryAdd"+k,black_list_id:k,store:i});j.show()}},saveBlackListEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winBlackListEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winBlackListEntryEditId")){var j=Ext.widget("winBlackListEntryEdit",{id:"winBlackListEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveBlackListEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winBlackListEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cBlackLists"],0));(Ext.cmd.derive("Rd.view.categories.gridCategories",Ext.grid.Panel,{multiSelect:true,store:"sCategories",stateful:true,stateId:"StateGridCtg",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/categories/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridCtg1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridCtg3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridCtg5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridCtg6"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "low"\'><div class="fieldGreen">Low</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "high"\'><div class="fieldOrange">High</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridCtg7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridCategories"],["component","box","container","panel","tablepanel","gridpanel","grid","gridCategories"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridCategories:true},["widget.gridCategories"],0,[Rd.view.categories,"gridCategories"],0));(Ext.cmd.derive("Rd.model.mCategory",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mCategory"],0));(Ext.cmd.derive("Rd.view.categories.winCategoryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Category",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winCategoryEdit"],["component","box","container","panel","window","winCategoryEdit"],{component:true,box:true,container:true,panel:true,window:true,winCategoryEdit:true},["widget.winCategoryEdit"],0,[Rd.view.categories,"winCategoryEdit"],0));(Ext.cmd.derive("Rd.store.sCategories",Ext.data.Store,{model:"Rd.model.mCategory",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/categories/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sCategories"],0));(Ext.cmd.derive("Rd.view.categories.winCategoryAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Category",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winCategoryAddWizard"],["component","box","container","panel","window","winCategoryAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winCategoryAddWizard:true},["widget.winCategoryAddWizard"],0,[Rd.view.categories,"winCategoryAddWizard"],0));(Ext.cmd.derive("Rd.view.categories.cmbProtectionLevel",Ext.form.ComboBox,{fieldLabel:"Protection Level",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"protection_level",labelClsExtra:"lblRd",value:"medium",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"low",text:"Low"},{id:"medium",text:"Medium"},{id:"high",text:"High"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProtectionLevel"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProtectionLevel"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProtectionLevel:true},["widget.cmbProtectionLevel"],0,[Rd.view.categories,"cmbProtectionLevel"],0));(Ext.cmd.derive("Rd.controller.cCategories",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridCategories",border:true,itemId:"tabCategories",plain:true});d.populated=true},views:["categories.gridCategories","categories.winCategoryEdit","categories.winCategoryAddWizard","categories.cmbProtectionLevel"],stores:["sAccessProvidersTree","sCategories"],models:["mAccessProviderTree","mCategory"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/categories/add.json",urlDelete:"/cake3/rd_cake/categories/delete.json",urlEdit:"/cake3/rd_cake/categories/edit.json"},refs:[{ref:"grid",selector:"gridCategories"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabCategories":{destroy:b.appClose},"gridCategories #reload":{click:b.reload},"gridCategories #add":{click:b.add},"gridCategories #delete":{click:b.del},"gridCategories #edit":{click:b.edit},gridCategories:{select:b.select},"winCategoryAddWizard #btnTreeNext":{click:b.btnTreeNext},"winCategoryAddWizard #btnDataPrev":{click:b.btnDataPrev},"winCategoryAddWizard #btnDataNext":{click:b.btnDataNext},"winCategoryEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winCategoryAddWizardId")){var h=Ext.widget("winCategoryAddWizard",{id:"winCategoryAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winCategoryAddWizardId")){var h=Ext.widget("winCategoryAddWizard",{id:"winCategoryAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winCategoryAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winCategoryAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sCategories").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winCategoryEditId")){var i=Ext.widget("winCategoryEdit",{id:"winCategoryEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winCategoryEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cCategories"],0));(Ext.cmd.derive("Rd.view.dashboard.winPasswordChanger",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnLock,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"password",itemId:"password",allowBlank:false,inputType:"password",fieldLabel:i18n("sPassword"),labelClsExtra:"lblRdReq"},{name:"confirm",itemId:"confirm",allowBlank:false,inputType:"password",fieldLabel:i18n("sConfirm"),labelClsExtra:"lblRdReq",vtype:"PasswordMatch"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPasswordChanger"],["component","box","container","panel","window","winPasswordChanger"],{component:true,box:true,container:true,panel:true,window:true,winPasswordChanger:true},["widget.winPasswordChanger"],0,[Rd.view.dashboard,"winPasswordChanger"],0));(Ext.cmd.derive("Rd.view.Viewport",Ext.container.Viewport,{layout:{type:"fit"}},0,["viewP"],["component","box","container","viewport","viewP"],{component:true,box:true,container:true,viewport:true,viewP:true},["widget.viewP"],0,[Rd.view,"Viewport"],0));(Ext.cmd.derive("Rd.view.dashboard.pnlDashboard",Ext.panel.Panel,{layout:"fit",dashboard_data:undefined,initComponent:function(){var s=this;var x=s.dashboard_data.user.username;var w=Rd.config.headerName;var t=Rd.config.levelAColor;var q="color:"+t+";font-weight:200; font-size: smaller;";var u=new Ext.XTemplate("<h1>"+w+'<span style="'+q+'"> | <i class="fa">{fa_value}</i> {value}</span><h1>');var r=Rd.config.footerName;var B={};var A=false;var p="";var C=false;if(s.dashboard_data.white_label.active==true){w=s.dashboard_data.white_label.hName;r=s.dashboard_data.white_label.fName;var y=s.dashboard_data.white_label.hBg;B={background:y};C=s.dashboard_data.white_label.hFg;if(s.dashboard_data.white_label.imgActive==true){var z=s.dashboard_data.white_label.imgFile;var u=new Ext.XTemplate('<img src="'+z+'" alt="Logo" style="float:left; padding-right: 20px;">','<h1 style="color:'+C+';">'+w+'<span style="'+q+'"> | <i class="fa">{fa_value}</i> {value}</span><h1>')}else{var u=new Ext.XTemplate('<h1 style="color:'+C+';">'+w+'<span style="'+q+'">',' | <i class="fa">{fa_value}</i> {value}</span><h1>')}}s.dockedItems=[{xtype:"toolbar",dock:"bottom",ui:"footer",items:['<b><i class="fa fa-graduation-cap"></i> '+x+"</b>","->","<b>"+r+"</b> "+Rd.config.footerLicense]},{xtype:"toolbar",dock:"top",ui:"default",style:B,items:[{xtype:"tbtext",itemId:"tbtHeader",tpl:u,data:{headerName:Rd.config.headerName}},"->",{xtype:"button",glyph:Rd.config.icnMenu,scale:"medium",menu:[{text:i18n("sLogout"),glyph:Rd.config.icnPower,itemId:"mnuLogout"},"-",{text:i18n("sSettings"),glyph:Rd.config.icnSpanner,itemId:"mnuSettings"},{text:i18n("sPassword"),glyph:Rd.config.icnLock,itemId:"mnuPassword"}]}]}];Ext.panel.Panel.prototype.initComponent.call(this)}},0,["pnlDashboard"],["component","box","container","panel","pnlDashboard"],{component:true,box:true,container:true,panel:true,pnlDashboard:true},["widget.pnlDashboard"],0,[Rd.view.dashboard,"pnlDashboard"],0));(Ext.cmd.derive("Rd.view.dashboard.winDashboardSettings",Ext.window.Window,{title:i18n("sSettings"),layout:"fit",autoShow:false,width:350,height:300,glyph:Rd.config.icnSpanner,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbRealm"},{xtype:"checkbox",boxLabel:"Show Data Usage",name:"show_data_usage",inputValue:"show_data_usage",checked:true,cls:"lblRdReq"},{xtype:"checkbox",boxLabel:"Compact View",name:"compact_view",inputValue:"compact_view",checked:true,cls:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winDashboardSettings"],["component","box","container","panel","window","winDashboardSettings"],{component:true,box:true,container:true,panel:true,window:true,winDashboardSettings:true},["widget.winDashboardSettings"],0,[Rd.view.dashboard,"winDashboardSettings"],0));(Ext.cmd.derive("Rd.view.dashboard.tpDashboard",Ext.tab.Panel,{layout:"fit",ui:"navigation",tabPosition:"left",tabRotation:0,defaults:{textAlign:"left"},initComponent:function(){var b=this;b.items=b.dashboard_data.tabs;Ext.tab.Panel.prototype.initComponent.call(this)}},0,["tpDashboard"],["component","box","container","panel","tabpanel","tpDashboard"],{component:true,box:true,container:true,panel:true,tabpanel:true,tpDashboard:true},["widget.tpDashboard"],0,[Rd.view.dashboard,"tpDashboard"],0));(Ext.cmd.derive("Rd.controller.cDashboard",Ext.app.Controller,{views:["components.cmbRealm","dashboard.pnlDashboard","dashboard.tpDashboard","dashboard.winPasswordChanger","dashboard.winDashboardSettings"],config:{urlChangePassword:"/cake3/rd_cake/dashboard/change_password.json",urlSettingsSubmit:"/cake3/rd_cake/dashboard/settings_submit.json",urlViewSettings:"/cake3/rd_cake/dashboard/settings_view.json"},models:["mRealm"],stores:[],refs:[{ref:"viewP",selector:"viewP",xtype:"viewP",autoCreate:true},{ref:"pnlDashboard",selector:"pnlDashboard",xtype:"pnlDashboard"}],init:function(){var b=this;if(b.inited){return}b.inited=true;this.control({"tpDashboard #cWelcome":{activate:function(a){b.application.runAction("cWelcome","Index",a)}},"tpDashboard #cDataUsage":{activate:function(a){b.application.runAction("cDataUsage","Index",a)}},"tpDashboard #cUtilities":{activate:function(a){b.application.runAction("cUtilities","Index",a)}},"tpDashboard #cAccessProviders":{activate:function(a){b.application.runAction("cAccessProviders","Index",a)}},"tpDashboard #cMeshes":{activate:function(a){b.application.runAction("cMeshes","Index",a);b.updateBanner(a)}},"tpDashboard #cAccessPoints":{activate:function(a){b.application.runAction("cAccessPoints","Index",a);b.updateBanner(a)}},"tpDashboard #cProfileComponents":{activate:function(a){b.application.runAction("cProfileComponents","Index",a)}},"tpDashboard #cProfiles":{activate:function(a){b.application.runAction("cProfiles","Index",a)}},"tpDashboard #cActivityMonitor":{activate:function(a){b.application.runAction("cActivityMonitor","Index",a)}},"tpDashboard #cPermanentUsers":{activate:function(a){b.application.runAction("cPermanentUsers","Index",a)}},"tpDashboard #cVouchers":{activate:function(a){b.application.runAction("cVouchers","Index",a)}},"tpDashboard #cDevices":{activate:function(a){b.application.runAction("cDevices","Index",a)}},"tpDashboard #cTopUps":{activate:function(a){b.application.runAction("cTopUps","Index",a)}},"tpDashboard #cRealms":{activate:function(a){b.application.runAction("cRealms","Index",a)}},"tpDashboard #cDynamicClients":{activate:function(a){b.application.runAction("cDynamicClients","Index",a)}},"tpDashboard #cNas":{activate:function(a){b.application.runAction("cNas","Index",a)}},"tpDashboard #cTags":{activate:function(a){b.application.runAction("cTags","Index",a)}},"tpDashboard #cSsids":{activate:function(a){b.application.runAction("cSsids","Index",a)}},"tpDashboard #cDynamicDetails":{activate:function(a){b.application.runAction("cDynamicDetails","Index",a)}},"tpDashboard #cOpenvpnServers":{activate:function(a){b.application.runAction("cOpenvpnServers","Index",a)}},"tpDashboard #cIpPools":{activate:function(a){b.application.runAction("cIpPools","Index",a)}},"tpDashboard #cAcos":{activate:function(a){b.application.runAction("cAcos","Index",a)}},"tpDashboard #cLogViewer":{activate:function(a){b.application.runAction("cLogViewer","Index",a)}},"tpDashboard #cDebug":{activate:function(a){b.application.runAction("cDebug","Index",a)}},"pnlDashboard  #mnuLogout":{click:b.onLogout},"pnlDashboard  #mnuSettings":{click:b.onSettings},"winDashboardSettings #save":{click:b.onSettingsSubmit},winDashboardSettings:{beforeshow:b.loadSettings},"pnlDashboard  #mnuPassword":{click:b.onPassword},"winPasswordChanger #save":{click:b.onChangePassword},"tpDashboard #cGlobalDomains":{activate:function(a){b.application.runAction("cGlobalDomains","Index",a)}},"tpDashboard #cCategories":{activate:function(a){b.application.runAction("cCategories","Index",a)}},"tpDashboard #cFilters":{activate:function(a){b.application.runAction("cFilters","Index",a)}},"tpDashboard #cBlackLists":{activate:function(a){b.application.runAction("cBlackLists","Index",a)}},"tpDashboard #cWhiteLists":{activate:function(a){b.application.runAction("cWhiteLists","Index",a)}},"tpDashboard #cSchedules":{activate:function(a){b.application.runAction("cSchedules","Index",a)}},"tpDashboard #cPolicies":{activate:function(a){b.application.runAction("cPolicies","Index",a)}},"tpDashboard > tabpanel":{activate:b.updateBanner}})},actionIndex:function(){var l=this;var k=l.application.getDashboardData();var o=k.user.username;var j=k.user.cls;var m=l.getView("dashboard.pnlDashboard").create({dashboard_data:k});var n=l.getView("dashboard.tpDashboard").create({dashboard_data:k});var p=l.getViewP();p.removeAll(true);p.add([m]);m.add([n])},onLogout:function(b){var e=this;b.up("panel").close();e.getViewP().removeAll(true);e.application.runAction("cLogin","Exit")},loadSettings:function(h){var e=this;var g=h.down("form");g.load({url:e.getUrlViewSettings(),method:"GET",success:function(k,l,a){var b=g.down("cmbRealm");var d=Ext.create("Rd.model.mRealm",{name:l.result.data.realm_name,id:l.result.data.realm_id});b.getStore().loadData([d],false);b.setValue(l.result.data.realm_id)}})},onSettings:function(b){var g=this;if(!Ext.WindowManager.get("winDashboardSettingsId")){var h=Ext.widget("winDashboardSettings",{id:"winDashboardSettingsId"});h.show()}},onSettingsSubmit:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlSettingsSubmit(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onPassword:function(b){var g=this;if(!Ext.WindowManager.get("winPasswordChangerId")){var h=Ext.widget("winPasswordChanger",{id:"winPasswordChangerId"});h.show()}},onChangePassword:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlChangePassword(),success:function(b,a){var e=new Date();e.setDate(e.getDate()+1);Ext.util.Cookies.set("Token",a.result.data.token,e,"/",null,false);var d=a.result.data.token;Ext.Ajax.setExtraParams({token:d});i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},updateBanner:function(h){var k=h.getGlyph();var j=h.getTitle();var i=h.getInitialConfig();if(i.tooltip!==undefined){j=i.tooltip}k=k.replace("@FontAwesome","");var l=h.up("pnlDashboard");l.down("#tbtHeader").setData({fa_value:"&#"+k+";",value:j})}},0,0,0,0,0,0,[Rd.controller,"cDashboard"],0));(Ext.cmd.derive("Rd.view.dataUsage.vcPnlDataUsage",Ext.app.ViewController,{onClickTodayButton:function(e){var d=this;d.getView().setScrollY(0,{duration:1000})},onClickThisWeekButton:function(e){var h=this;var g=h.getView().down("pnlDataUsageDay").getHeight();h.getView().setScrollY(g+1,{duration:1000})},onClickThisMonthButton:function(j){var i=this;var g=i.getView().down("pnlDataUsageDay").getHeight();var h=i.getView().down("pnlDataUsageWeek").getHeight();i.getView().setScrollY(g+h+1,{duration:1000})}},0,0,0,0,["controller.vcPnlDataUsage"],0,[Rd.view.dataUsage,"vcPnlDataUsage"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageDay",Ext.panel.Panel,{title:"Today",headerPosition:"right",height:550,margin:0,padding:0,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"dayStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});Ext.create("Ext.data.Store",{storeId:"activeStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"callingstationid",type:"string"},{name:"online_human",type:"string"},{name:"online",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"dailyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:g,padding:h,border:false,itemId:"plrDaily",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("dayStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:10,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users Today",itemId:"gridTopTenDaily",border:true,store:Ext.data.StoreManager.lookup("dayStore"),emptyText:"No Users for Today",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:2,margin:g,padding:h,layout:"fit",border:false},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Active Sessions",border:true,store:Ext.data.StoreManager.lookup("activeStore"),emptyText:"No Active Sessions Now",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"MAC Address",dataIndex:"callingstationid"},{text:"Time Online",dataIndex:"online",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(a,d,j){var b=j.get("online_human");return'<div class="fieldGreen">'+b+" "+i18n("sOnline")+"</div>"}}],flex:1}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageDay"],["component","box","container","panel","pnlDataUsageDay"],{component:true,box:true,container:true,panel:true,pnlDataUsageDay:true},["widget.pnlDataUsageDay"],0,[Rd.view.dataUsage,"pnlDataUsageDay"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageWeek",Ext.panel.Panel,{ui:"light",title:"This Week",headerPosition:"right",height:550,margin:0,padding:0,border:true,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"weekStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"weeklyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:0,padding:0,border:false,itemId:"plrWeekly",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("weekStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:10,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users This Week",itemId:"gridTopTenDaily",border:true,store:Ext.data.StoreManager.lookup("weekStore"),emptyText:"No Users For This Week",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:1,margin:0,padding:0,layout:"fit",border:false}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageWeek"],["component","box","container","panel","pnlDataUsageWeek"],{component:true,box:true,container:true,panel:true,pnlDataUsageWeek:true},["widget.pnlDataUsageWeek"],0,[Rd.view.dataUsage,"pnlDataUsageWeek"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageMonth",Ext.panel.Panel,{title:"This Month",headerPosition:"right",height:550,margin:0,padding:0,layout:{type:"vbox",align:"stretch"},initComponent:function(){var e=this;var g=5;var h=5;Ext.create("Ext.data.Store",{storeId:"monthStore",fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"data_in",type:"int"},{name:"data_out",type:"int"},{name:"data_total",type:"int"}]});e.items=[{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",margin:g,padding:h,flex:1,bodyCls:"subSubTab",layout:"fit",border:true,ui:"light",itemId:"monthlyTotal",tpl:new Ext.XTemplate('<div class="divInfo">','<tpl if="type==\'realm\'"><h2 style="color: #009933;"><i class="fa fa-dribbble"></i> {item_name}</h2></tpl>','<tpl if="type==\'user\'"><h2 style="color: #0066ff;"><i class="fa fa-user"></i> {item_name}</h2></tpl>','<h1 style="font-size:250%;">{data_total}</h1>','<p style="color: #000000; font-size:110%;">',"In: {data_in}<br>","Out: {data_out}","</p>","</div>"),data:{},bbar:["->",{xtype:"button",scale:"large",text:"See More..",glyph:Rd.config.icnView,itemId:"btnSeeMore"}]},{xtype:"pnlDataUsageUserDetail",margin:g,padding:h,hidden:true,flex:1},{flex:1,margin:g,padding:h,border:false,itemId:"plrMonthly",xtype:"polar",innerPadding:10,interactions:["rotate","itemhighlight"],store:Ext.data.StoreManager.lookup("monthStore"),series:{type:"pie",highlight:true,angleField:"data_total",label:{field:"name",display:"rotate"},donut:20,tooltip:{trackMouse:true,renderer:function(a,d,b){a.setHtml("<h2>"+d.get("username")+"</h2><h3>"+Ext.ux.bytesToHuman(d.get("data_total"))+"</h3>")}}}},{xtype:"grid",margin:g,padding:h,ui:"light",title:"Top 10 Users This Month",itemId:"gridTopTenMonthly",border:true,store:Ext.data.StoreManager.lookup("monthStore"),emptyText:"No Users For This Month",columns:[{xtype:"rownumberer"},{text:"Username",dataIndex:"username",flex:1},{text:"Data In",dataIndex:"data_in",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Out",dataIndex:"data_out",hidden:true,renderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Total",dataIndex:"data_total",tdCls:"gridMain",renderer:function(a){return Ext.ux.bytesToHuman(a)}}],flex:1}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"pnlDataUsageGraph",flex:1,margin:0,padding:0,layout:"fit",border:false}]}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageMonth"],["component","box","container","panel","pnlDataUsageMonth"],{component:true,box:true,container:true,panel:true,pnlDataUsageMonth:true},["widget.pnlDataUsageMonth"],0,[Rd.view.dataUsage,"pnlDataUsageMonth"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsage",Ext.panel.Panel,{scrollable:true,layout:{type:"vbox",align:"stretch"},controller:"vcPnlDataUsage",initComponent:function(){var b=this;b.dockedItems=[{xtype:"toolbar",dock:"top",cls:"subTab",frame:true,border:true,items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"small",itemId:"reload",tooltip:i18n("sReload")},{xtype:"cmbRealm"},{xtype:"button",scale:"small",itemId:"btnShowRealm",text:"Show Realm Data",hidden:true},"|",{xtype:"button",glyph:Rd.config.icnHourStart,text:"Today",listeners:{click:"onClickTodayButton"}},{xtype:"button",glyph:Rd.config.icnHourHalf,text:"This Week",listeners:{click:"onClickThisWeekButton"}},{xtype:"button",glyph:Rd.config.icnHourEnd,text:"This Month",listeners:{click:"onClickThisMonthButton"}}]}];b.items=[{xtype:"pnlDataUsageDay",glyph:Rd.config.icnHourStart},{xtype:"pnlDataUsageWeek",glyph:Rd.config.icnHourHalf},{xtype:"pnlDataUsageMonth",glyph:Rd.config.icnHourEnd}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsage"],["component","box","container","panel","pnlDataUsage"],{component:true,box:true,container:true,panel:true,pnlDataUsage:true},["widget.pnlDataUsage"],0,[Rd.view.dataUsage,"pnlDataUsage"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageGraph",Ext.panel.Panel,{margins:"0 0 0 0",plain:true,border:false,initComponent:function(){var d=this;d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mUserStat"});var e=Ext.create("Ext.chart.CartesianChart",{insetPadding:{top:20,left:20,right:20,bottom:20},width:"100%",store:d.store,axes:[{type:"numeric",position:"left",adjustByMajorUnit:true,grid:true,fields:["data_in","data_out"],renderer:function(a,b,h){return Ext.ux.bytesToHuman(b)},minimum:0},{type:"category",position:"bottom",grid:false,fields:["time_unit"]}],interactions:["itemhighlight"],series:[{type:"bar",title:["Data In","Data out"],xField:"time_unit",yField:["data_in","data_out"],stacked:true,style:{opacity:0.8},highlight:{fillStyle:"yellow"},tooltip:{renderer:function(a,k,b){var j=Ext.ux.bytesToHuman(k.get("data_in"));var l=Ext.ux.bytesToHuman(k.get("data_out"));a.setHtml("Data in <b>"+j+"</b><br>Data out <b>"+l+"</b>")}}}]});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDataUsageGraph"],["component","box","container","panel","pnlDataUsageGraph"],{component:true,box:true,container:true,panel:true,pnlDataUsageGraph:true},["widget.pnlDataUsageGraph"],0,[Rd.view.dataUsage,"pnlDataUsageGraph"],0));(Ext.cmd.derive("Rd.view.dataUsage.pnlDataUsageUserDetail",Ext.panel.Panel,{scrollable:true,layout:{type:"vbox",align:"stretch"},border:true,ui:"light",title:"Today",headerPosition:"right",initComponent:function(){var b=this;b.items=[{xtype:"progressbar",itemId:"pbData",text:'<i class="fa  fa-database"></i> Data Usage',height:20,margin:5,value:1},{xtype:"progressbar",itemId:"pbTime",text:'<i class="fa fa-clock-o"></i> Time Usage',height:20,margin:5,width:"100%",value:0.5},{xtype:"panel",itemId:"pnlInfo",height:150,tpl:new Ext.XTemplate("<div>",'<ul class="fa-ul">',"<tpl if='type == \"voucher\"'>","<li style='color:blue;'><i class='fa-li fa  fa-ticket'></i> Voucher</li>","</tpl>","<li><i class='fa-li fa  fa-cubes'></i> {profile}</li>","<li><i class='fa-li fa  fa-star'></i><b>Created</b> {created}</li>",'<tpl if="Ext.isDefined(last_reject_time)">',"<li style='color:red;'><i class='fa-li fa fa-warning'></i> <b>Last Failed Login</b> {last_reject_time}</li>","</tpl>",'<tpl if="Ext.isDefined(last_reject_message)">',"<li style='color:red;'><i class='fa-li fa fa-warning'></i> <b>Failed Login Message</b> {last_reject_message}</li>","</tpl>",'<tpl if="Ext.isDefined(last_accept_time)">',"<li style='color:green;'><i class='fa-li fa fa-check-circle'></i> <b>Last Good Login</b> {last_accept_time}</li>","</tpl>",'<tpl if="Ext.isDefined(data_cap)">',"<li><i class='fa-li fa fa-database'></i> <b>Data Cap</b> {data_cap}</li>","</tpl>",'<tpl if="Ext.isDefined(data_used)">',"<li style='color:blue;'><i class='fa-li fa fa-database'></i> <b>Data Used</b> {data_used}</li>","</tpl>",'<tpl if="Ext.isDefined(time_cap)">',"<li><i class='fa-li fa fa-clock-o'></i> <b>Time Cap</b> {time_cap}</li>","</tpl>",'<tpl if="Ext.isDefined(time_used)">',"<li style='color:blue;'><i class='fa-li fa fa-clock-o'></i> <b>Time Used</b> {time_used}</li>","</tpl>","</ul>","</div>")}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},paintUserDetail:function(o){var p=this;if(Ext.isDefined(o.username)){p.setTitle(o.username)}if(Ext.isDefined(o.type)){if(o.type=="voucher"){p.setGlyph(Rd.config.icnVoucher)}if(o.type=="user"){p.setGlyph(Rd.config.icnUser)}if(o.type=="device"){p.setGlyph(Rd.config.icnDevice)}}if(Ext.isDefined(o.perc_data_used)){if(o.perc_data_used<70){var j="wifigreen";p.down("#pbData").toggleCls("wifiyellow",false);p.down("#pbData").toggleCls("wifired",false);p.down("#pbData").toggleCls(j,true)}if(o.perc_data_used>=70&&o.perc_data_used<90){j="wifiyellow";p.down("#pbData").toggleCls("wifigreen",false);p.down("#pbData").toggleCls("wifired",false);p.down("#pbData").toggleCls(j,true)}if(o.perc_data_used>=90){j="wifired";p.down("#pbData").toggleCls("wifigreen",false);p.down("#pbData").toggleCls("wifiyellow",false);p.down("#pbData").toggleCls(j,true)}var k='<i class="fa  fa-database"></i>  Data Usage '+o.perc_data_used+" %";var l=o.perc_data_used/100;p.down("#pbData").show().setValue(l).updateText(k)}else{p.down("#pbData").hide()}if(Ext.isDefined(o.perc_time_used)){if(o.perc_time_used<70){var j="wifigreen";p.down("#pbTime").toggleCls("wifiyellow",false);p.down("#pbTime").toggleCls("wifired",false);p.down("#pbTime").toggleCls(j,true)}if(o.perc_time_used>=70&&o.perc_time_used<90){j="wifiyellow";p.down("#pbTime").toggleCls("wifigreen",false);p.down("#pbTime").toggleCls("wifired",false);p.down("#pbTime").toggleCls(j,true)}if(o.perc_time_used>=90){j="wifired";p.down("#pbTime").toggleCls("wifigreen",false);p.down("#pbTime").toggleCls("wifiyellow",false);p.down("#pbTime").toggleCls(j,true)}var n='<i class="fa fa-clock-o"></i> Time Usage '+o.perc_time_used+" %";var m=o.perc_time_used/100;p.down("#pbTime").show().setValue(m).updateText(n)}else{p.down("#pbTime").hide()}p.down("#pnlInfo").setData(o)}},0,["pnlDataUsageUserDetail"],["component","box","container","panel","pnlDataUsageUserDetail"],{component:true,box:true,container:true,panel:true,pnlDataUsageUserDetail:true},["widget.pnlDataUsageUserDetail"],0,[Rd.view.dataUsage,"pnlDataUsageUserDetail"],0));(Ext.cmd.derive("Rd.controller.cDataUsage",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"pnlDataUsage",border:true,itemId:"tabDataUsage",plain:true});d.populated=true},views:["dataUsage.pnlDataUsage","components.cmbRealm","components.pnlUsageGraph","dataUsage.pnlDataUsageDay","dataUsage.pnlDataUsageWeek","dataUsage.pnlDataUsageMonth","dataUsage.pnlDataUsageGraph","dataUsage.pnlDataUsageUserDetail"],stores:[],models:["mRealm","mUserStat"],selectedRecord:null,config:{urlUsageForRealm:"/cake2/rd_cake/data_usage/usage_for_realm.json",username:false,type:"realm"},refs:[{ref:"pnlDataUsageDay",selector:"pnlDataUsageDay"},{ref:"pnlDataUsageWeek",selector:"pnlDataUsageWeek"},{ref:"pnlDataUsageMonth",selector:"pnlDataUsageMonth"},{ref:"pnlDataUsage",selector:"pnlDataUsage"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({pnlDataUsage:{afterlayout:b.resizeSegments},"#tabDataUsage":{destroy:b.appClose},"#tabDataUsage cmbRealm":{change:b.realmChange,afterrender:b.afterRenderEventRealm},"#tabDataUsage #reload":{click:b.reload},"#tabDataUsage #btnShowRealm":{click:b.btnShowRealmClick},"#tabDataUsage grid":{rowclick:b.rowClickEvent},"#tabDataUsage #btnSeeMore":{click:b.openActivityViewer}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.fetchDataUsage()},realmChange:function(d){var e=this;e.setType("realm");e.setUsername(d.getValue());e.fetchDataUsage()},afterRenderEventRealm:function(k){var n=this;var j=n.application.getDashboardData();var m=j.data_usage.realm_name;var i=j.data_usage.realm_id;var l=Ext.create("Rd.model.mRealm",{name:m,id:i});k.getStore().loadData([l],false);k.setValue(i)},fetchDataUsage:function(){var b=this;b.getPnlDataUsage().setLoading(true);Ext.Ajax.request({url:b.getUrlUsageForRealm(),params:{type:b.getType(),username:b.getUsername()},method:"GET",success:function(a){var e=Ext.JSON.decode(a.responseText);b.getPnlDataUsage().setLoading(false);if(e.success){console.log(e);b.paintDataUsage(e.data)}else{}}})},paintDataUsage:function(j){var k=this;var l=k.getPnlDataUsageDay().down("#dailyTotal");var i=k.getPnlDataUsageWeek().down("#weeklyTotal");var h=k.getPnlDataUsageMonth().down("#monthlyTotal");j.daily.totals.data_in=Ext.ux.bytesToHuman(j.daily.totals.data_in);j.daily.totals.data_out=Ext.ux.bytesToHuman(j.daily.totals.data_out);j.daily.totals.data_total=Ext.ux.bytesToHuman(j.daily.totals.data_total);l.setData(j.daily.totals);j.weekly.totals.data_in=Ext.ux.bytesToHuman(j.weekly.totals.data_in);j.weekly.totals.data_out=Ext.ux.bytesToHuman(j.weekly.totals.data_out);j.weekly.totals.data_total=Ext.ux.bytesToHuman(j.weekly.totals.data_total);i.setData(j.weekly.totals);j.monthly.totals.data_in=Ext.ux.bytesToHuman(j.monthly.totals.data_in);j.monthly.totals.data_out=Ext.ux.bytesToHuman(j.monthly.totals.data_out);j.monthly.totals.data_total=Ext.ux.bytesToHuman(j.monthly.totals.data_total);h.setData(j.monthly.totals);Ext.data.StoreManager.lookup("dayStore").setData(j.daily.top_ten);Ext.data.StoreManager.lookup("activeStore").setData(j.daily.active_sessions);k.getPnlDataUsageDay().down("cartesian").getStore().setData(j.daily.graph.items);Ext.data.StoreManager.lookup("weekStore").setData(j.weekly.top_ten);k.getPnlDataUsageWeek().down("cartesian").getStore().setData(j.weekly.graph.items);Ext.data.StoreManager.lookup("monthStore").setData(j.monthly.top_ten);k.getPnlDataUsageMonth().down("cartesian").getStore().setData(j.monthly.graph.items);if(j.user_detail!=undefined){k.paintUserDetail(j.user_detail)}else{k.hideUserDetail()}},paintUserDetail:function(d){var e=this;e.getPnlDataUsageDay().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageDay().down("#plrDaily").hide();e.getPnlDataUsageDay().down("pnlDataUsageUserDetail").show();e.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageWeek().down("#plrWeekly").hide();e.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").show();e.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").paintUserDetail(d);e.getPnlDataUsageMonth().down("#plrMonthly").hide();e.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").show()},hideUserDetail:function(){var b=this;b.getPnlDataUsageDay().down("#plrDaily").show();b.getPnlDataUsageDay().down("pnlDataUsageUserDetail").hide();b.getPnlDataUsageWeek().down("#plrWeekly").show();b.getPnlDataUsageWeek().down("pnlDataUsageUserDetail").hide();b.getPnlDataUsageMonth().down("#plrMonthly").show();b.getPnlDataUsageMonth().down("pnlDataUsageUserDetail").hide()},rowClickEvent:function(g,h){var j=this;var i=h.get("username");j.getPnlDataUsage().down("#btnShowRealm").show();j.getPnlDataUsage().down("cmbRealm").setDisabled(true);j.setUsername(i);j.setType("user");j.fetchDataUsage()},btnShowRealmClick:function(e){var d=this;d.getPnlDataUsage().down("cmbRealm").setDisabled(false);e.hide();d.setUsername(d.getPnlDataUsage().down("cmbRealm").getValue());d.setType("realm");d.fetchDataUsage()},resizeSegments:function(e){var d=this;if(e.getHeight()>400){d.getPnlDataUsageDay().setHeight((e.getHeight()-40));d.getPnlDataUsageWeek().setHeight((e.getHeight()-40));d.getPnlDataUsageMonth().setHeight((e.getHeight()-40))}},openActivityViewer:function(e){var h=this;var g=h.getPnlDataUsage();h.application.runAction("cActivityMonitor","Index",g)}},0,0,0,0,0,0,[Rd.controller,"cDataUsage"],0));(Ext.cmd.derive("Rd.view.debugOutput.pnlViewDebug",Ext.panel.Panel,{html:"",autoScroll:true,autoCreate:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")},{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_debug"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_debug"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"time",tooltip:i18n("sAdd_debug_time")}]},{xtype:"buttongroup",title:i18n("sFilters"),items:[{xtype:"cmbNas",itemId:"nas",emptyText:i18n("sAny_NAS_device"),forceSelection:false,allowBlank:true,labelWidth:120,width:400},{xtype:"tbspacer",width:10},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",itemId:"username",allowBlank:true,emptyText:i18n("sAny_user"),labelSeparator:"",labelClsExtra:"lblRd",labelWidth:120}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlViewDebug"],["component","box","container","panel","pnlViewDebug"],{component:true,box:true,container:true,panel:true,pnlViewDebug:true},["widget.pnlViewDebug"],0,[Rd.view.debugOutput,"pnlViewDebug"],0));(Ext.cmd.derive("Rd.controller.cDebug",Ext.app.Controller,{actionIndex:function(e){var h=this;if(h.populated){return}var g=Ext.create("Rd.view.debugOutput.pnlViewDebug",{region:"center",layout:"fit",margins:"0 0 0 0",border:false,itemId:"pnlDebug"});e.add(g);h.populated=true},views:["debugOutput.pnlViewDebug"],stores:[],models:["mNas"],socket:undefined,showFirstTime:undefined,showDiv:undefined,htmlToAdd:"",renderFlag:undefined,countTimeout:undefined,timeout:undefined,config:{urlFrStatusDb:"/cake2/rd_cake/free_radius/status_debug.json",urlFrStartDb:"/cake2/rd_cake/free_radius/start_debug.json",urlFrStopDb:"/cake2/rd_cake/free_radius/stop_debug.json",urlFrTimeDb:"/cake2/rd_cake/free_radius/time_debug.json",portWebSocket:"8000"},refs:[{ref:"file",selector:"pnlViewDebug"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlViewDebug #clear":{click:b.clear},"pnlViewDebug #start":{click:b.start},"pnlViewDebug #stop":{click:b.stop},"pnlViewDebug #time":{click:b.time},"#pnlDebug":{afterrender:b.onShow,render:b.onRender,destroy:b.onDestroy}})},clear:function(b){var e=this;e.showDiv.innerHTML=""},start:function(b){var j=this;var k={};var l=b.up("pnlViewDebug").down("#nas").getValue();var i=b.up("pnlViewDebug").down("#username").getValue();if(l!=null){k.nas_id=l}if(i!=""){k.username=i}Ext.Ajax.request({url:j.getUrlFrStartDb(),method:"GET",params:k,success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(j.countTimeout);j.timeout=d.data.time_added;j.countTimeout=setInterval(function(){j.timeout=j.timeout-1;if(j.timeout>0){j.getFile().down("#feedback").update({message:"Stopping debug tace in "+j.timeout+" seconds"})}else{clearInterval(j.countTimeout);j.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000);Ext.ux.Toaster.msg("Debug trace started","Debug trace started fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.getFile().down("#time").setDisabled(false)}},scope:j})},stop:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStopDb(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(e.countTimeout);e.getFile().down("#feedback").update({message:"Debug tace stopped"});e.getFile().down("#time").setDisabled(true);Ext.ux.Toaster.msg("Debug trace stopped","Debug trace stopped fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},time:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrTimeDb(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){clearInterval(e.countTimeout);e.timeout=d.data.time_added;e.countTimeout=setInterval(function(){e.timeout=e.timeout-1;if(e.timeout>0){e.getFile().down("#feedback").update({message:"Stopping debug tace in "+e.timeout+" seconds"})}else{clearInterval(e.countTimeout);e.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000);Ext.ux.Toaster.msg("Debug timeout increased","Debug timeout increased fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},ioLoaded:function(g){var i=this;var h=i.application.getDashboardData().token;var j=document.location.host;i.socket=io.connect("http://"+j+":"+i.getPortWebSocket()+"?token="+h);i.socket.on("connect",function(){});i.socket.on("message",function(l){if(Ext.isString(l)){var b=i18n("sReceiving_new_logfile_data");i.getFile().down("#feedback").update({message:b});var a=l.split("\n");var e=a.length-1;var d=false;a.forEach(function(k,o,p){if(o==e){d=true}i.newText(k,d)})}});i.socket.on("error",function(a){console.error("Unable to connect Socket.IO",a)})},onShow:function(g){var h=this;if(h.showFirstTime==undefined){h.showFirstTime=true;h.showDiv=h.getFile().body.dom;var e=document.location.host;Ext.Loader.loadScript({url:"http://"+e+":"+h.getPortWebSocket()+"/socket.io/socket.io.js",onLoad:h.ioLoaded,scope:h})}else{if(h.renderFlag==true){h.showDiv=h.getFile().body.dom;h.socket.socket.reconnect();h.renderFlag=false}}},onRender:function(e){var d=this;if(d.showFirstTime==true){d.renderFlag=true}Ext.Ajax.request({url:d.getUrlFrStatusDb(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.data.level>0){d.getFile().down("#start").toggle(true);d.getFile().down("#time").setDisabled(false);if(a.data.time_added!=undefined){d.timeout=a.data.time_added;d.countTimeout=setInterval(function(){d.timeout=d.timeout-1;if(d.timeout>0){d.getFile().down("#feedback").update({message:"Stopping debug tace in "+d.timeout+" seconds"})}else{clearInterval(d.countTimeout);d.getFile().down("#feedback").update({message:"Debug tace stopped"})}},1000)}}else{d.getFile().down("#stop").toggle(true);d.getFile().down("#time").setDisabled(true)}}},scope:d})},onDestroy:function(e){var d=this;d.populated=false;d.renderFlag=false;d.socket.disconnect();clearInterval(d.countTimeout)},newText:function(d,r){var t=this;var y="<br />";if(r==true){y=""}var w=d.split(": ");if(w.length>=3){var x="<span class='txtGrey'>"+w[0]+"</span> : ";var s=w[1];var C="txtGrey";var A=/Info/i;if(s.search(A)!=-1){C="txtBlue"}var u=/Error/i;if(s.search(u)!=-1){C="txtRed"}var q="<span class='"+C+"'>"+w[1]+"</span> : ";w.shift();w.shift();var B=w.toString();if(C=="txtRed"){B="<span class='txtBold'>"+B+"</span>"}t.htmlToAdd=t.htmlToAdd+x+q+B+y}else{t.htmlToAdd=t.htmlToAdd+d+y}if(r==true){t.showDiv.innerHTML=t.showDiv.innerHTML+t.htmlToAdd;t.htmlToAdd="";t.getFile().body.scrollTo("top",99999,true);var z=i18n("sAwaiting_new_logfile_data");t.getFile().down("#feedback").update({message:z})}}},0,0,0,0,0,0,[Rd.controller,"cDebug"],0));(Ext.cmd.derive("Rd.view.devices.gridDevices",Ext.grid.Panel,{multiSelect:true,store:"sDevices",stateful:true,stateId:"StateGridDevices",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridDevices1"},{text:i18n("sOwner"),dataIndex:"permanent_user",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDevices2"},{text:i18n("sMAC_address"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDevices3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDevices4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridDevices5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridDevices6"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDevices7"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices8"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices9"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices10"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices11"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridDevices12"},{header:i18n("sData_used"),hidden:true,dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_data_used");i.toggleCls("wifigreen",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridDevices13"},{header:i18n("sTime_used"),hidden:true,dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_time_used");i.toggleCls("wifired",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridDevices14"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridDevices15",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDevices16"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDevices17"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDevices:true},["widget.gridDevices"],0,[Rd.view.devices,"gridDevices"],0));(Ext.cmd.derive("Rd.model.mProfile",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"data_cap_in_profile",type:"bool"},{name:"time_cap_in_profile",type:"bool"},"profile_components",{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mProfile"],0));(Ext.cmd.derive("Rd.model.mDevice",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"permanent_user",type:"string"},{name:"permanent_user_id"},{name:"realm",type:"string"},{name:"profile",type:"string"},{name:"profile_id"},"perc_time_used","perc_data_used","name","description","vendor_id",{name:"active",type:"bool"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage",{name:"notes",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDevice"],0));(Ext.cmd.derive("Rd.model.mAttribute",Ext.data.Model,{fields:["id","name"]},0,0,0,0,0,0,[Rd.model,"mAttribute"],0));(Ext.cmd.derive("Rd.model.mVendor",Ext.data.Model,{fields:["id","name"]},0,0,0,0,0,0,[Rd.model,"mVendor"],0));(Ext.cmd.derive("Rd.model.mPrivateAttribute",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"type",type:"string"},{name:"attribute",type:"string"},{name:"op",type:"string"},{name:"value",type:"string"},{name:"edit",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPrivateAttribute"],0));(Ext.cmd.derive("Rd.view.devices.pnlDevice",Ext.tab.Panel,{border:false,d_id:null,d_name:null,cmbOwnerRendered:false,plain:true,record:undefined,cls:"subTab",initComponent:function(){var e=this;var g=new Date();var h=new Date();h.setYear(h.getFullYear()+1);e.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:500,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,name:"permanent_user_id",labelClsExtra:"lblRdReq",itemId:"owner"},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date("May 20, 2013 00:00:00"),hidden:true,disabled:true,value:g},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date("May 21, 2013 00:00:00"),hidden:true,disabled:true,value:h}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,plain:true,margin:"0 20 40 0"}]}},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridDevicePrivate",username:e.d_name},{title:i18n("sAuthentication_data"),layout:"fit",xtype:"gridDeviceRadpostauths",username:e.d_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridDeviceRadaccts",username:e.d_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDevice"],["component","box","container","panel","tabpanel","pnlDevice"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDevice:true},["widget.pnlDevice"],0,[Rd.view.devices,"pnlDevice"],0));(Ext.cmd.derive("Rd.store.sPermanentUsers",Ext.data.Store,{model:"Rd.model.mPermanentUser",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/permanent-users/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sPermanentUsers"],0));(Ext.cmd.derive("Rd.store.sProfiles",Ext.data.Store,{model:"Rd.model.mProfile",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/profiles/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sProfiles"],0));(Ext.cmd.derive("Rd.store.sDevices",Ext.data.Store,{model:"Rd.model.mDevice",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sDevices"],0));(Ext.cmd.derive("Rd.store.sAttributes",Ext.data.Store,{model:"Rd.model.mAttribute",proxy:{type:"ajax",url:"/cake2/rd_cake/profile_components/attributes.json",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sAttributes"],0));(Ext.cmd.derive("Rd.store.sVendors",Ext.data.Store,{model:"Rd.model.mVendor",proxy:{type:"ajax",url:"/cake2/rd_cake/profile_components/vendors.json",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sVendors"],0));(Ext.cmd.derive("Rd.view.devices.winDeviceAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_device"),width:500,height:460,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},owner:"",startScreen:"scrnData",selLanguage:null,initComponent:function(){var e=this;var d=e.mkScrnData();e.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnData:function(){var l=this;var i=new Date();var k=new Date();k.setYear(k.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(l.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:Rd.config.labelWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",cls:"subTab",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"owner",name:"permanent_user_id"},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:i},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:k}]}]}],buttons:h});return j}},0,["winDeviceAddWizard"],["component","box","container","panel","window","winDeviceAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDeviceAddWizard:true},["widget.winDeviceAddWizard"],0,[Rd.view.devices,"winDeviceAddWizard"],0));(Ext.cmd.derive("Rd.view.devices.pnlDeviceGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",d_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.d_name,type:"device"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.d_name,type:"device"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.d_name,type:"device"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDeviceGraphs"],["component","box","container","panel","tabpanel","pnlDeviceGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDeviceGraphs:true},["widget.pnlDeviceGraphs"],0,[Rd.view.devices,"pnlDeviceGraphs"],0));(Ext.cmd.derive("Rd.view.components.cmbProfile",Ext.form.ComboBox,{fieldLabel:i18n("sProfile"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"profile_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mProfile",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/profiles/index-ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProfile"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProfile"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProfile:true},["widget.cmbProfile"],0,[Rd.view.components,"cmbProfile"],0));(Ext.cmd.derive("Rd.view.components.cmbCap",Ext.form.ComboBox,{fieldLabel:i18n("sCap_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"cap",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"hard",text:i18n("sHard")},{id:"soft",text:i18n("sSoft")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCap"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCap"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCap:true},["widget.cmbCap"],0,[Rd.view.components,"cmbCap"],0));(Ext.cmd.derive("Rd.view.devices.gridDeviceRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDeviceRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-accounting-data.json",plugins:"gridfilters",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}],columns:[{xtype:"rownumberer",stateId:"StateGridDeviceRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDeviceRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StateGridDeviceRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StateGridDeviceRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridDeviceRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridDeviceRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDeviceRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",buffered:true,leadingBufferZone:450,pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{callingstationid:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(p,a,k){if(!k){Ext.ux.Toaster.msg("Error encountered",p.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=b.getStore().getTotalCount();var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var o=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#count").update({count:n});b.down("#totals").update({"in":m,out:o,total:l})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDeviceRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDeviceRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDeviceRadaccts:true},["widget.gridDeviceRadaccts"],0,[Rd.view.devices,"gridDeviceRadaccts"],0));(Ext.cmd.derive("Rd.view.devices.gridDeviceRadpostauths",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDeviceRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/devices/menu-for-authentication-data.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDeviceRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths3"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridDeviceRadpostauths4"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDeviceRadpostauths5"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridDeviceRadpostauths6"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadpostauth",buffered:true,leadingBufferZone:450,pageSize:150,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radpostauths/delete.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDeviceRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDeviceRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDeviceRadpostauths:true},["widget.gridDeviceRadpostauths"],0,[Rd.view.devices,"gridDeviceRadpostauths"],0));(Ext.cmd.derive("Rd.view.devices.gridDevicePrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDevicePrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridDevicePrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridDevicePrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridDevicePrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridDevicePrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridDevicePrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/devices/private-attr-add.json",read:"/cake3/rd_cake/devices/private-attr-index.json",update:"/cake3/rd_cake/devices/private-attr-edit.json",destroy:"/cake3/rd_cake/devices/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDevicePrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDevicePrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDevicePrivate:true},["widget.gridDevicePrivate"],0,[Rd.view.devices,"gridDevicePrivate"],0));(Ext.cmd.derive("Rd.view.components.cmbVendor",Ext.form.ComboBox,{fieldLabel:i18n("sVendor"),labelSeparator:"",store:"sVendors",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",labelClsExtra:"lblRd",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbVendor"],["component","box","field","textfield","pickerfield","combobox","combo","cmbVendor"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbVendor:true},["widget.cmbVendor"],0,[Rd.view.components,"cmbVendor"],0));(Ext.cmd.derive("Rd.view.components.cmbAttribute",Ext.form.ComboBox,{fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sAttributes",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",labelClsExtra:"lblRd",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbAttribute"],["component","box","field","textfield","pickerfield","combobox","combo","cmbAttribute"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbAttribute:true},["widget.cmbAttribute"],0,[Rd.view.components,"cmbAttribute"],0));(Ext.cmd.derive("Rd.controller.cDevices",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDevices",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDevices",glyph:Rd.config.icnHome}]});d.populated=true},views:["devices.gridDevices","devices.winDeviceAddWizard","components.cmbPermanentUser","components.cmbProfile","components.cmbCap","components.winNote","components.winNoteAdd","components.winCsvColumnSelect","components.winEnableDisable","devices.pnlDevice","devices.gridDeviceRadaccts","devices.gridDeviceRadpostauths","devices.gridDevicePrivate","components.pnlUsageGraph","components.cmbVendor","components.cmbAttribute","devices.pnlDeviceGraphs"],stores:["sAccessProvidersTree","sPermanentUsers","sRealms","sProfiles","sDevices","sAttributes","sVendors"],models:["mAccessProviderTree","mPermanentUser","mRealm","mProfile","mDevice","mUserStat","mRadacct","mRadpostauth","mAttribute","mVendor","mPrivateAttribute"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/devices/add.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/devices/export-csv",urlNoteAdd:"/cake3/rd_cake/devices/note-add.json",urlViewBasic:"/cake3/rd_cake/devices/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/devices/edit-basic-info.json",urlEnableDisable:"/cake3/rd_cake/devices/enable-disable.json",urlDelete:"/cake3/rd_cake/devices/delete.json",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridDevices"},{ref:"privateGrid",selector:"gridDevicePrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDevices":{destroy:b.appClose},"gridDevices #reload":{click:b.reload},"gridDevices #add":{click:b.add},"gridDevices #delete":{click:b.del},"gridDevices #edit":{click:b.edit},"gridDevices #note":{click:b.note},"gridDevices #csv":{click:b.csvExport},"gridDevices #enable_disable":{click:b.enableDisable},"gridDevices #test_radius":{click:b.testRadius},"gridDevices #graph":{click:b.graph},gridDevices:{select:b.select,activate:b.gridActivate},"winDeviceAddWizard #btnDataNext":{click:b.btnDataNext},"winDeviceAddWizard #profile":{change:b.cmbProfileChange},"winDeviceAddWizard #owner":{change:b.cmbOwnerChange},"winDeviceAddWizard #always_active":{change:b.chkAlwaysActiveChange},"winDeviceAddWizard #to_date":{change:b.toDateChange},"winDeviceAddWizard #from_date":{change:b.fromDateChange},"#winCsvColumnSelectDevices #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=devices] #reload":{click:b.noteReload},"gridNote[noteForGrid=devices] #add":{click:b.noteAdd},"gridNote[noteForGrid=devices] #delete":{click:b.noteDelete},"gridNote[noteForGrid=devices]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=devices] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=devices] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=devices] #btnNoteAddNext":{click:b.btnNoteAddNext},"#winEnableDisableDevice #save":{click:b.enableDisableSubmit},"pnlDevice gridUserRadpostauths #reload":{click:b.gridDeviceRadpostauthsReload},"pnlDevice gridDeviceRadpostauths #delete":{click:b.deletePostAuths},"pnlDevice gridDevicePrivate":{select:b.selectDevicePrivate,activate:b.onDeviceActivate},"pnlDevice gridDeviceRadpostauths":{activate:b.onDeviceRadpostauthsActivate},"pnlDevice gridDeviceRadaccts #reload":{click:b.gridDeviceRadacctsReload},"pnlDevice gridDeviceRadaccts #delete":{click:b.deleteRadaccts},"pnlDevice gridDeviceRadaccts":{activate:b.onDeviceRadacctsActivate},"pnlDevice #profile":{change:b.cmbProfileChange,render:b.renderEventProfile},"pnlDevice #owner":{render:b.renderEventOwner,change:b.cmbOwnerChange},"pnlDevice #always_active":{change:b.chkAlwaysActiveChange},"pnlDevice #to_date":{change:b.toDateChange},"pnlDevice #from_date":{change:b.fromDateChange},"pnlDevice #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlDevice #tabBasicInfo #save":{click:b.saveBasicInfo},gridDevicePrivate:{beforeedit:b.onBeforeEditDevicePrivate},"gridDevicePrivate  #cmbVendor":{change:b.cmbVendorChange},"gridDevicePrivate  #add":{click:b.attrAdd},"gridDevicePrivate  #reload":{click:b.attrReload},"gridDevicePrivate  #delete":{click:b.attrDelete},"#tabDevices pnlDeviceGraphs #daily":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabDevices pnlDeviceGraphs #daily #day":{change:b.changeDailyGraph},"#tabDevices pnlDeviceGraphs #weekly":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabDevices pnlDeviceGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabDevices pnlDeviceGraphs #monthly":{activate:b.loadGraph},"#tabDevices pnlDeviceGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabDevices pnlDeviceGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sDevices").load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var h=this;if(!Ext.WindowManager.get("winDeviceAddWizardId")){var g=Ext.widget("winDeviceAddWizard",{id:"winDeviceAddWizardId",selLanguage:h.application.getSelLanguage()});g.show()}},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sDevices").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},cmbOwnerChange:function(k){var i=this;var n=k.getValue();var l=k.getStore().getById(n);var m=l.get("owner_id");var j=k.up("form");j.down("cmbProfile").getStore().getProxy().setExtraParam("ap_id",m);j.down("cmbProfile").getStore().load()},cmbProfileChange:function(r){var p=this;var s=r.up("form");var q=s.down("#cmbDataCap");var t=s.down("#cmbTimeCap");var o=r.getValue();var m=r.getStore();var u=m.getById(o);if(u!=null){var n=u.get("data_cap_in_profile");if(n){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}var w=u.get("time_cap_in_profile");if(w){t.setVisible(true);t.setDisabled(false)}else{t.setVisible(false);t.setDisabled(true)}}},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}},toDateChange:function(k,l,j){var n=this;var d=k.up("form");var m=d.down("#from_date");if(l<=m.getValue()){Ext.ux.Toaster.msg(i18n("sEnd_date_wrong"),i18n("sThe_end_date_should_be_after_the_start_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},fromDateChange:function(k,l,d){var m=this;var n=k.up("form");var j=n.down("#to_date");if(l>=j.getValue()){Ext.ux.Toaster.msg(i18n("sStart_date_wrong"),i18n("sThe_start_date_should_be_before_the_end_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},onStoreDevicesLoaded:function(){var d=this;var e=d.getStore("sDevices").getTotalCount();d.getGrid().down("#count").update({count:e})},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(d,n){var a=i.getGrid().up("tabpanel");var p=d.getId();var o="dTab_"+p;var e=a.down("#"+o);if(e){a.setActiveTab(o);return}var b=d.get("name");a.add({title:b,itemId:o,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDevice",d_id:p,d_name:b,record:d}});a.setActiveTab(o)})}},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectDevices")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectDevices",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDevices"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDevices"+m.getId(),noteForId:m.getId(),noteForGrid:"devices",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDevicesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDevicesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDevicesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDevicesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_modify"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisableDevice")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisableDevice"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestDevice",j)}},onTabBasicInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDevice").d_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{device_id:h},success:function(d,e){if(e.result.data.data_cap_type!=undefined){var a=j.down("#cmbDataCap");a.setVisible(true);a.setDisabled(false);a.setValue(e.result.data.data_cap_type)}if(e.result.data.time_cap_type!=undefined){var b=j.down("#cmbTimeCap");b.setVisible(true);b.setDisabled(false);b.setValue(e.result.data.time_cap_type)}}})},saveBasicInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlDevice").d_id;j.submit({clientValidation:true,url:i.getUrlEditBasic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onDeviceActivate:function(d){var e=this;d.getStore().load()},onDeviceRadpostauthsActivate:function(d){var e=this;d.getStore().load()},gridDeviceRadpostauthsReload:function(g){var h=this;var e=g.up("gridDeviceRadpostauths");e.getStore().load()},onDeviceRadacctsActivate:function(d){var e=this;d.getStore().load()},onDevicePrivateActivate:function(d){var e=this;d.getStore().load()},gridDeviceRadacctsReload:function(g){var h=this;var e=g.up("gridDeviceRadaccts");e.getStore().load()},deletePostAuths:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeletePostAuths(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},selectDevicePrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditDevicePrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridDevicePrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridDevicePrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridDevicePrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridDevicePrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},renderEventOwner:function(k){var m=this;var i=k.up("pnlDevice");i.cmbOwnerRendered=true;if(i.record!=undefined){var j=i.record.get("permanent_user");var n=i.record.get("permanent_user_id");var l=Ext.create("Rd.model.mPermanentUser",{username:j,id:n});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var n=this;var i=k.up("pnlDevice");i.cmbProfileRendered=true;if(i.record!=undefined){var j=i.record.get("profile");var l=i.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="deviceTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlDeviceGraphs",d_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cDevices"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winAttachUnknownDynamicClient",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Unknown Client To Owner",width:500,height:520,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAttach,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var k=this;var l=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(k.no_tree==true){var l=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:k.user_id},{xtype:"textfield",name:"unknown_dynamic_client_id",hidden:true,value:k.unknown_dynamic_client_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:k.owner,labelClsExtra:"lblRdReq"},{xtype:"displayfield",fieldLabel:"NAS-Identifier",value:k.nasidentifier,labelClsExtra:"lblRdReq"},{xtype:"displayfield",fieldLabel:"Called-Station-Id",value:k.calledstationid,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Monitor",itemId:"tabMonitor",layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[i,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForDynamicClientOwner",realFlag:true}}]}],buttons:l});return j}},0,["winAttachUnknownDynamicClient"],["component","box","container","panel","window","winAttachUnknownDynamicClient"],{component:true,box:true,container:true,panel:true,window:true,winAttachUnknownDynamicClient:true},["widget.winAttachUnknownDynamicClient"],0,[Rd.view.dynamicClients,"winAttachUnknownDynamicClient"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridDynamicClients",Ext.grid.Panel,{multiSelect:true,store:"sDynamicClients",stateful:true,stateId:"StateGridDc1",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/dynamic_clients/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridDc1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDc2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDc3"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDc4"},{text:i18n("sCalled-Station-Id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDc5",hidden:true},{text:i18n("sActive"),width:130,hidden:true,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='active == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='active == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDc6"},{text:"To Sub-Providers",width:130,hidden:true,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDc7"},{text:i18n("sRealms"),sortable:false,width:150,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(realms)"><div class="fieldBlueWhite">Available to all!</div></tpl>','<tpl for="realms">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"realms"},{text:"Last Contact",dataIndex:"last_contact",width:150,tdCls:"gridTree",renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUdc4"},{text:"From IP",dataIndex:"last_contact_ip",tdCls:"gridTree",width:150,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(last_contact_ip)"><div class="fieldGreyWhite">Not Available</div>',"<tpl else>",'<div class="fieldGreyWhite">{last_contact_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>","</tpl>"),filter:{type:"string"},stateId:"StateGridUdc5"},{text:i18n("sStatus"),dataIndex:"status",tdCls:"gridTree",width:130,hidden:true,renderer:function(h,j,a){if(h!="unknown"){var i=a.get("status_time");if(h=="up"){return'<div class="fieldGreen">'+i18n("sUp")+" "+Ext.ux.secondsToHuman(i)+"</div>"}if(h=="down"){return'<div class="fieldRed">'+i18n("sDown")+" "+Ext.ux.secondsToHuman(i)+"</div>"}}else{return'<div class="fieldBlue">'+i18n("sUnknown")+"</div>"}},stateId:"StateGridDc10"},{text:i18n("sNotes"),sortable:false,width:130,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDc11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicClients"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicClients"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicClients:true},["widget.gridDynamicClients"],0,[Rd.view.dynamicClients,"gridDynamicClients"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridUnknownDynamicClients",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUdc",stateEvents:["groupclick","columnhide"],border:false,store:"sUnknownDynamicClients",viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/unknown_dynamic_clients/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridUdc1"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUdc2"},{text:"Called-Station-Id",dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUdc3"},{text:"Last Contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUdc4"},{text:"From IP",dataIndex:"last_contact_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{last_contact_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUdc5"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownDynamicClients"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownDynamicClients"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownDynamicClients:true},["widget.gridUnknownDynamicClients"],0,[Rd.view.dynamicClients,"gridUnknownDynamicClients"],0));(Ext.cmd.derive("Rd.model.mDynamicClient",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"nasidentifier",type:"string"},{name:"calledstationid",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_contact_ip",type:"string"},"last_contact_human",{name:"timezone",type:"string"},{name:"monitor",type:"string"},{name:"session_auto_close",type:"bool"},{name:"session_dead_time",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"active",type:"bool"},{name:"on_public_maps",type:"bool"},"lat","lon",{name:"user_id",type:"int"},"country_code","country_name","city","postal_code",{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicClient"],0));(Ext.cmd.derive("Rd.model.mRealmForDynamicClientOwner",Ext.data.Model,{fields:["id","name","selected"]},0,0,0,0,0,0,[Rd.model,"mRealmForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.model.mUnknownDynamicClient",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"nasidentifier",type:"string"},{name:"calledstationid",type:"string"},{name:"last_contact_ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},"last_contact_human","country_code","country_name","city","postal_code"]},0,0,0,0,0,0,[Rd.model,"mUnknownDynamicClient"],0));(Ext.cmd.derive("Rd.model.mDynamicClientState",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"state",type:"bool"},{name:"time",type:"string"},{name:"start",type:"string"},{name:"end",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mDynamicClientState"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClient",Ext.tab.Panel,{border:false,dynamic_client_id:null,record:null,plain:true,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:"Dynamic Client",itemId:"tabDynamicClient",xtype:"pnlDynamicClientDynamicClient",dynamic_client_id:b.dynamic_client_id},{title:"Realms",itemId:"tabRealms",layout:"fit",border:false,xtype:"pnlRealmsForDynamicClientOwner",record:b.record,dynamic_client_id:b.dynamic_client_id},{title:"Photo",itemId:"tabPhoto",xtype:"pnlDynamicClientPhoto",dynamic_client_id:b.dynamic_client_id},{title:"Availability",itemId:"tabAvailability",xtype:"gridDynamicClientsAvailability",dynamic_client_id:b.dynamic_client_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClient"],["component","box","container","panel","tabpanel","pnlDynamicClient"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicClient:true},["widget.pnlDynamicClient"],0,[Rd.view.dynamicClients,"pnlDynamicClient"],0));(Ext.cmd.derive("Rd.view.nas.winMapPreferences",Ext.window.Window,{title:i18n("sPreferences"),layout:"fit",autoShow:false,width:350,height:350,iconCls:"settings",glyph:Rd.config.icnSpanner,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"HYBRID",text:i18n("sHybrid")},{id:"ROADMAP",text:i18n("sRoadmap")},{id:"SATELLITE",text:i18n("sSatellite")},{id:"TERRAIN",text:i18n("sTerrain")}]});this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"numberfield",name:"lng",itemId:"lng",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"lat",itemId:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"zoom",itemId:"zoom",fieldLabel:i18n("sZoom_level"),value:17,maxValue:22,minValue:0,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"type",itemId:"type",fieldLabel:i18n("sType"),store:e,queryMode:"local",displayField:"text",valueField:"id",allowBlank:false,forceSelection:true,labelClsExtra:"lblRdReq"}],buttons:[{itemId:"snapshot",text:i18n("sSnapshot"),scale:"large",iconCls:"b-snapshot",glyph:Rd.config.icnSnapshot,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapPreferences"],["component","box","container","panel","window","winMapPreferences"],{component:true,box:true,container:true,panel:true,window:true,winMapPreferences:true},["widget.winMapPreferences"],0,[Rd.view.nas,"winMapPreferences"],0));(Ext.cmd.derive("Rd.store.sDynamicClients",Ext.data.Store,{model:"Rd.model.mDynamicClient",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/dynamic_clients/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sDynamicClients"],0));(Ext.cmd.derive("Rd.store.sUnknownDynamicClients",Ext.data.Store,{model:"Rd.model.mUnknownDynamicClient",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/unknown_dynamic_clients/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/unknown_dynamic_clients/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownDynamicClients"],0));(Ext.cmd.derive("Rd.view.components.pnlGMap",Ext.ux.GMapPanel,{urlMenu:"/cake2/rd_cake/nas/menu_for_maps.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",markers:[],infoWindows:[],infowindow:undefined,editwindow:undefined,addwindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,initComponent:function(){var k=this;k.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:k.urlMenu});var l=k.centerLatLng.lat;var j=k.centerLatLng.lng;k.center=new google.maps.LatLng(l,j);k.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapInfoDiv";k.infowindow=new google.maps.InfoWindow({content:h});k.infoWindows.push(k.infowindow);google.maps.event.addListener(k.infowindow,"domready",function(){var q=k.infowindow.getContent();if(k.i_pnl){k.i_pnl.destroy()}var b=k.marker_record.get("photo_file_name");var d=k.urlPhotoBase+b;var r="N/A";if(k.marker_record.get("status")!="unknown"){if(k.marker_record.get("status")=="up"){var e=i18n("sUp")}if(k.marker_record.get("status")=="down"){var e=i18n("sDown")}r=e+" "+Ext.ux.secondsToHuman(k.marker_record.get("status_time"))}var a=Ext.apply({time_in_state:r},k.marker_record.data);var g=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sName")+"  </label><label class='lblValue'> {shortname}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sIP_Address")+"  </label><label class='lblValue'> {nasname}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sConnection")+"  </label><label class='lblValue'> {connection_type}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sCurrent_state")+"  </label><label class='lblValue'> {time_in_state}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sDescription")+"  </label><label class='lblValue'> {description}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sPublic")+"  </label><label class='lblValue'> {on_public_maps}</label><br>","</div>"]);var p=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='"+i18n("sNas_Image")+"'>","</div>"]);k.i_pnl=Ext.create("Ext.tab.Panel",{itemId:"pnlMapsInfo",width:350,height:250,layout:"fit",activeTab:0,items:[{title:"Info",itemId:"tabMapInfo",bodyPadding:2,tpl:g,autoScroll:true,data:a},{title:"Photo",itemId:"tabMapPhoto",bodyPadding:2,tpl:p,autoScroll:true,data:{image:d}}],renderTo:q});k.i_pnl.doLayout()});var i=document.createElement("div");i.className=i.className+"mapEditDiv";k.editwindow=new google.maps.InfoWindow({content:i});k.infoWindows.push(k.editwindow);google.maps.event.addListener(k.editwindow,"domready",function(){var a=k.editwindow.getContent();if(k.e_pnl){k.e_pnl.destroy()}var b=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sNew_position")+"</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLatitude")+"  </label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLongitude")+"  </label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","</div>"]);k.e_pnl=Ext.create("Ext.panel.Panel",{title:i18n("sAction_required"),itemId:"pnlMapsEdit",height:170,tpl:b,layout:"fit",buttonAlign:"center",buttons:[{xtype:"button",itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes},{xtype:"button",itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose},{xtype:"button",itemId:"delete",text:i18n("sDelete"),scale:"large",glyph:Rd.config.icnDelete}],renderTo:a});k.e_pnl.update({lng:k.new_lng,lat:k.new_lat})});k.addwindow=new google.maps.InfoWindow({content:"<div style='padding:5px;margin:5px; height:100px; width:200px;'><div class='lblRdReq'>"+i18n("sAction_required")+"</div><div class='lblRd'>"+i18n("sDrag_and_drop_marker_torequired_position")+"</div></div>"});k.infoWindows.push(k.addwindow);Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}},createMap:function(){var b=this;Ext.ux.GMapPanel.prototype.createMap.apply(this,arguments);b.store.load()}},0,["pnlGMap"],["component","box","container","panel","gmappanel","pnlGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlGMap:true},["widget.pnlGMap"],0,[Rd.view.components,"pnlGMap"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winMapDynamicClientAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:500,height:300,glyph:Rd.config.icnNote,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Select a Dynamic Client",cls:"lblWizard"}],items:[{xtype:"cmbDynamicClientsAddMap"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapDynamicClientAdd"],["component","box","container","panel","window","winMapDynamicClientAdd"],{component:true,box:true,container:true,panel:true,window:true,winMapDynamicClientAdd:true},["widget.winMapDynamicClientAdd"],0,[Rd.view.dynamicClients,"winMapDynamicClientAdd"],0));(Ext.cmd.derive("Rd.view.dynamicClients.winDynamicClientAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Dynamic Client",width:500,height:510,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var k=this;var l=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(k.no_tree==true){var l=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:k.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:k.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"NAS-Identifier",name:"nasidentifier",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Called-Station-Id",name:"calledstationid",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Monitor",itemId:"tabMonitor",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[i,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForDynamicClientOwner",realFlag:true}}]}],buttons:l});return j}},0,["winDynamicClientAddWizard"],["component","box","container","panel","window","winDynamicClientAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDynamicClientAddWizard:true},["widget.winDynamicClientAddWizard"],0,[Rd.view.dynamicClients,"winDynamicClientAddWizard"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",dynamic_client_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.dynamic_client_id,type:"dynamic_client"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.dynamic_client_id,type:"dynamic_client"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.dynamic_client_id,type:"dynamic_client"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientGraphs"],["component","box","container","panel","tabpanel","pnlDynamicClientGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicClientGraphs:true},["widget.pnlDynamicClientGraphs"],0,[Rd.view.dynamicClients,"pnlDynamicClientGraphs"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientDynamicClient",Ext.panel.Panel,{border:false,dynamic_client_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"heartbeat",text:i18n("sHeartbeat")},{id:"websocket",text:"Websocket"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:e,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id",value:"off"});h.items={xtype:"form",height:"100%",width:500,layout:"fit",autoScroll:true,frame:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"dynamic_client_id",hidden:true,value:h.dynamic_client_id},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"NAS-Identifier",name:"nasidentifier",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Called-Station-Id",name:"calledstationid",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Monitor",itemId:"tabMonitor",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:"Maps",itemId:"tabMaps",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:"Enhancements",itemId:"tabEnhancements",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActive"),name:"active",inputValue:"active",itemId:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",itemId:"chkSessionAutoClose",inputValue:"session_auto_close",checked:true,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",itemId:"nrSessionDeadTime",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false},{xtype:"cmbTimezones",required:false,value:24,allowBlank:true}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientDynamicClient"],["component","box","container","panel","pnlDynamicClientDynamicClient"],{component:true,box:true,container:true,panel:true,pnlDynamicClientDynamicClient:true},["widget.pnlDynamicClientDynamicClient"],0,[Rd.view.dynamicClients,"pnlDynamicClientDynamicClient"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlRealmsForDynamicClientOwner",Ext.panel.Panel,{border:false,dynamic_client_id:null,record:null,layout:"fit",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll"}],initComponent:function(){var d=this;var e=Ext.create("Rd.view.dynamicClients.gridRealmsForDynamicClientOwner",{realFlag:true});e.getStore().getProxy().setExtraParam("dynamic_client_id",d.dynamic_client_id);e.getStore().getProxy().setExtraParam("owner_id",d.record.get("user_id"));e.getStore().getProxy().setExtraParam("available_to_siblings",d.record.get("available_to_siblings"));d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmsForDynamicClientOwner"],["component","box","container","panel","pnlRealmsForDynamicClientOwner"],{component:true,box:true,container:true,panel:true,pnlRealmsForDynamicClientOwner:true},["widget.pnlRealmsForDynamicClientOwner"],0,[Rd.view.dynamicClients,"pnlRealmsForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridRealmsForDynamicClientOwner",Ext.grid.Panel,{border:false,realFlag:false,columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",flex:1},{xtype:"advCheckColumn",text:"Include",dataIndex:"selected",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;if(b.realFlag){urlUpdate="/cake3/rd_cake/realms/update-dynamic-client-realm.json";b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbseparator"},{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_sub_providers"),cls:"lblRd",itemId:"chkAvailSub",name:"available_to_siblings",inputValue:true}]}else{b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRealmForDynamicClientOwner",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/list-realms-for-dynamic-client-owner.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/list-realms-for-dynamic-client-owner.json",update:"/cake3/rd_cake/realms/update-dynamic-client-realm.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg("Updated Realm","Updated Realm",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg("Problems Updating Realm","Problems Updating Realm",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealmsForDynamicClientOwner"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealmsForDynamicClientOwner"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealmsForDynamicClientOwner:true},["widget.gridRealmsForDynamicClientOwner"],0,[Rd.view.dynamicClients,"gridRealmsForDynamicClientOwner"],0));(Ext.cmd.derive("Rd.view.components.cmpImg",Ext.Component,{html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',url:"",afterRender:function(){var b=this;if(b.url!=""){b.setImage(b.url)}Ext.Component.prototype.afterRender.apply(this,arguments)},setImage:function(g){var e=this,h;h=e.el.dom.firstChild;h.src=g}},0,["cmpImg"],["component","box","cmpImg"],{component:true,box:true,cmpImg:true},["widget.cmpImg"],0,[Rd.view.components,"cmpImg"],0));(Ext.cmd.derive("Rd.view.dynamicClients.pnlDynamicClientPhoto",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:"Current Photo",flex:1,border:false,items:[{xtype:"cmpImg"}]},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:"Select an image",fieldLabel:"New photo",allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicClientPhoto"],["component","box","container","panel","pnlDynamicClientPhoto"],{component:true,box:true,container:true,panel:true,pnlDynamicClientPhoto:true},["widget.pnlDynamicClientPhoto"],0,[Rd.view.dynamicClients,"pnlDynamicClientPhoto"],0));(Ext.cmd.derive("Rd.view.dynamicClients.gridDynamicClientsAvailability",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridDynamicClientsAvailability",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/dynamic_client_states/menu_for_grid.json",urlIndex:"/cake2/rd_cake/dynamic_client_states/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridDynamicClientsAvailability1"},{text:i18n("sState"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='state == true'><div class=\"fieldGreen\">"+i18n("sUp")+"</div></tpl>","<tpl if='state == false'><div class=\"fieldRed\">"+i18n("sDown")+"</div></tpl>"),dataIndex:"state",stateId:"StateGridDynamicClientsAvailability2"},{text:i18n("sDuration"),dataIndex:"time",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability3"},{text:i18n("sStarted"),dataIndex:"start",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability4"},{text:i18n("sEnded"),dataIndex:"end",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridDynamicClientsAvailability5"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicClientState",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/dynamic_client_states/delete.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("dynamic_client_id",b.dynamic_client_id);Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicClientsAvailability"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicClientsAvailability"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicClientsAvailability:true},["widget.gridDynamicClientsAvailability"],0,[Rd.view.dynamicClients,"gridDynamicClientsAvailability"],0));(Ext.cmd.derive("Rd.view.dynamicClients.cmbDynamicClientsAddMap",Ext.form.ComboBox,{fieldLabel:"Available",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/dynamic_clients/clients_avail_for_map.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicClientsAddMap"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicClientsAddMap"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicClientsAddMap:true},["widget.cmbDynamicClientsAddMap"],0,[Rd.view.dynamicClients,"cmbDynamicClientsAddMap"],0));(Ext.cmd.derive("Rd.controller.cDynamicClients",Ext.app.Controller,{owner:undefined,user_id:undefined,actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDynamicClients",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDynamicClients",glyph:Rd.config.icnHome},{title:"Unknown clients",xtype:"gridUnknownDynamicClients",glyph:Rd.config.icnQuestion}]});d.populated=true},views:["dynamicClients.gridDynamicClients","dynamicClients.winDynamicClientAddWizard","dynamicClients.gridUnknownDynamicClients","dynamicClients.winAttachUnknownDynamicClient","components.cmbTimezones","components.winNote","components.winNoteAdd","dynamicClients.pnlDynamicClient","dynamicClients.pnlDynamicClientDynamicClient","dynamicClients.pnlRealmsForDynamicClientOwner","dynamicClients.gridRealmsForDynamicClientOwner","dynamicClients.pnlDynamicClientPhoto","dynamicClients.gridDynamicClientsAvailability","components.pnlUsageGraph","dynamicClients.pnlDynamicClientGraphs","components.pnlGMap","dynamicClients.winMapDynamicClientAdd","nas.winMapPreferences","dynamicClients.cmbDynamicClientsAddMap"],stores:["sAccessProvidersTree","sDynamicClients","sUnknownDynamicClients"],models:["mAccessProviderTree","mDynamicClient","mRealmForDynamicClientOwner","mUnknownDynamicClient","mDynamicClientState","mUserStat"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/dynamic_clients/export_csv",urlAdd:"/cake2/rd_cake/dynamic_clients/add.json",urlDelete:"/cake2/rd_cake/dynamic_clients/delete.json",urlEdit:"/cake2/rd_cake/dynamic_clients/edit.json",urlNoteAdd:"/cake2/rd_cake/dynamic_clients/note_add.json",urlView:"/cake2/rd_cake/dynamic_clients/view.json",urlViewPhoto:"/cake2/rd_cake/dynamic_clients/view_photo.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",urlUploadPhoto:"/cake2/rd_cake/dynamic_clients/upload_photo/",urlMapDelete:"/cake2/rd_cake/dynamic_clients/delete_map.json",urlMapSave:"/cake2/rd_cake/dynamic_clients/edit_map.json",urlGreenMark:"resources/images/map_markers/green-dot.png",urlRedMark:"resources/images/map_markers/red-dot.png",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlYellowMark:"resources/images/map_markers/yellow-dot.png",urlViewMapPref:"/cake2/rd_cake/dynamic_clients/view_map_pref.json",urlEditMapPref:"/cake2/rd_cake/dynamic_clients/edit_map_pref.json"},refs:[{ref:"grid",selector:"gridDynamicClients"},{ref:"pnlGMap",selector:"pnlGMap"}],autoReloadUnknownDynamicClients:undefined,autoReload:undefined,init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDynamicClients":{destroy:b.appClose},"#tabDynamicClients gridDynamicClients":{activate:b.gridActivate},"#tabDynamicClients gridUnknownDynamicClients":{activate:b.gridActivate},"gridDynamicClients #reload":{click:b.reload},"gridDynamicClients #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridDynamicClients #add":{click:b.add},"gridDynamicClients #delete":{click:b.del},"gridDynamicClients #edit":{click:b.edit},"pnlDynamicClient #tabDynamicClient":{activate:b.onTabDynamicClientActive},"pnlDynamicClient #tabDynamicClient #monitorType":{change:b.monitorTypeChange},"pnlDynamicClient #tabDynamicClient #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"pnlDynamicClient #tabDynamicClient #save":{click:b.saveDynamicClient},"pnlRealmsForDynamicClientOwner #chkAvailForAll":{change:b.chkAvailForAllChangeTab},"pnlRealmsForDynamicClientOwner gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"pnlRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"pnlDynamicClient #tabRealms":{activate:b.tabRealmsActivate},"pnlDynamicClient #tabPhoto":{activate:b.tabPhotoActivate},"pnlDynamicClient #tabPhoto #save":{click:b.photoSave},"pnlDynamicClient #tabPhoto #cancel":{click:b.photoCancel},"pnlDynamicClient #tabAvailability":{activate:b.tabAvailabilityActivate},"gridDynamicClientsAvailability #reload":{click:b.gridDynamicClientsAvailabilityReload},"gridDynamicClientsAvailability #delete":{click:b.gridDynamicClientsAvailabilityDelete},"gridDynamicClients #note":{click:b.note},"gridDynamicClients #graph":{click:b.graph},"gridDynamicClients #map":{click:b.mapLoadApi},gridDynamicClients:{select:b.select},"winDynamicClientAddWizard #btnTreeNext":{click:b.btnTreeNext},"winDynamicClientAddWizard #btnDataPrev":{click:b.btnDataPrev},"winDynamicClientAddWizard #btnDataNext":{click:b.btnDataNext},"winDynamicClientAddWizard #monitorType":{change:b.monitorTypeChange},"winDynamicClientAddWizard #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"winDynamicClientAddWizard gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"winDynamicClientAddWizard #tabRealms":{activate:b.gridRealmsForDynamicClientOwnerActivate},"winDynamicClientAddWizard #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winDynamicClientAddWizard gridRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"gridUnknownDynamicClients #reload":{click:b.gridUnknownDynamicClientsReload},"gridUnknownDynamicClients #reload menuitem[group=refresh]":{click:b.reloadUnknownDynamicClientsOptionClick},"gridUnknownDynamicClients #attach":{click:b.attachAttachUnknownDynamicClient},"winAttachUnknownDynamicClient #btnTreeNext":{click:b.btnTreeNext},"winAttachUnknownDynamicClient #btnDataPrev":{click:b.btnDataPrev},"winAttachUnknownDynamicClient #btnDataNext":{click:b.btnDataNext},"winAttachUnknownDynamicClient #monitorType":{change:b.monitorTypeChange},"winAttachUnknownDynamicClient #chkSessionAutoClose":{change:b.chkSessionAutoCloseChange},"winAttachUnknownDynamicClient gridRealmsForDynamicClientOwner #reload":{click:b.gridRealmsForDynamicClientOwnerReload},"winAttachUnknownDynamicClient #tabRealms":{activate:b.gridRealmsForDynamicClientOwnerActivate},"winAttachUnknownDynamicClient #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winAttachUnknownDynamicClient gridRealmsForDynamicClientOwner #chkAvailSub":{change:b.gridRealmsForDynamicClientOwnerChkAvailSub},"gridUnknownDynamicClients #delete":{click:b.delUnknownDynamicClient},"gridNote[noteForGrid=dynamic_clients] #reload":{click:b.noteReload},"gridNote[noteForGrid=dynamic_clients] #add":{click:b.noteAdd},"gridNote[noteForGrid=dynamic_clients] #delete":{click:b.noteDelete},"gridNote[noteForGrid=dynamic_clients]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=dynamic_clients] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=dynamic_clients] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=dynamic_clients] #btnNoteAddNext":{click:b.btnNoteAddNext},"#tabDynamicClients pnlDynamicClientGraphs #daily":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabDynamicClients pnlDynamicClientGraphs #daily #day":{change:b.changeDailyGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabDynamicClients pnlDynamicClientGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly":{activate:b.loadGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabDynamicClients pnlDynamicClientGraphs #monthly #day":{change:b.changeMonthlyGraph},"pnlGMap #preferences":{click:b.mapPreferences},"winMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMapPreferences #save":{click:b.mapPreferencesSave},"pnlGMap #add":{click:b.mapDynamicClientAdd},"winMapDynamicClientAdd #save":{click:b.mapDynamicClientAddSubmit},"pnlGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadUnknownDynamicClients!=undefined){clearInterval(b.autoReloadUnknownDynamicClients)}},gridActivate:function(d){var e=this;d.getStore().load()},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},add:function(g){var i=this;var j=g.up("#tabDynamicClients");var h=j.down("gridDynamicClients").getStore();Ext.Ajax.request({url:i.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winDynamicClientAddWizardId")){var d=Ext.widget("winDynamicClientAddWizard",{id:"winDynamicClientAddWizardId",store:h});d.show()}}else{if(!Ext.WindowManager.get("winDynamicClientAddWizardId")){var d=Ext.widget("winDynamicClientAddWizard",{id:"winDynamicClientAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,store:h});d.show()}}}},scope:i})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("window");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("window");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(q){var n=this;var p=q.up("window");var s=q.up("form");var m=s.down("tabpanel");var t=s.down("gridRealmsForDynamicClientOwner");var r={};var l=false;var o=s.down("#chkAvailForAll");if(o.getValue()==true){r.avail_for_all=true}else{t.getStore().each(function(a){if(a.get("selected")==true){l=true;r[a.getId()]=a.get("selected")}},n)}if(r.avail_for_all==undefined){if(l!=true){var m=s.down("tabpanel");m.setActiveTab("tabRealms");Ext.ux.Toaster.msg(i18n("sSelect_at_least_one_realm"),i18n("sSelect_one_or_more_realms"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}s.submit({clientValidation:true,url:n.getUrlAdd(),params:r,success:function(b,a){p.store.load();p.close();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,e,b,d){if(e.result.errors.username!=undefined){m.setActiveTab(0)}else{m.setActiveTab("tabNas")}Ext.ux.formFail(a,e)}})},monitorTypeChange:function(j){var l=this;var h=j.up("form");var i=h.down("#heartbeat_dead_after");var k=j.getValue();if(k=="heartbeat"){i.setVisible(true)}else{i.setVisible(false)}},chkSessionAutoCloseChange:function(h){var i=this;var g=h.up("panel");var j=g.down("#nrSessionDeadTime");if(h.getValue()==true){j.setVisible(true)}else{j.setVisible(false)}},chkAvailForAllChange:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForDynamicClientOwner");if(h.getValue()==true){g.hide()}else{g.show()}},chkAvailForAllChangeTab:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForDynamicClientOwner");if(h.getValue()==true){g.hide()}else{g.show()}g.getStore().getProxy().setExtraParam("clear_flag",true);g.getStore().load();g.getStore().getProxy().setExtraParam("clear_flag",false)},gridRealmsForDynamicClientOwnerReload:function(e){var h=this;var g=e.up("gridRealmsForDynamicClientOwner");g.getStore().load()},gridRealmsForDynamicClientOwnerActivate:function(g){var j=this;var i=g.down("#chkAvailSub").getValue();var h=g.down("gridRealmsForDynamicClientOwner");h.getStore().getProxy().setExtraParam("owner_id",j.owner_id);h.getStore().getProxy().setExtraParam("available_to_siblings",i);h.getStore().load()},gridRealmsForDynamicClientOwnerChkAvailSub:function(h){var j=this;var i=h.getValue();var g=h.up("gridRealmsForDynamicClientOwner");g.getStore().getProxy().setExtraParam("owner_id",j.owner_id);g.getStore().getProxy().setExtraParam("available_to_siblings",i);g.getStore().load()},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},edit:function(h){var j=this;var i=h.up("gridDynamicClients");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(d,g){var a=i.up("tabpanel");var b=d.getId();var o="dynamic_clientTab_"+b;var e=a.down("#"+o);if(e){a.setActiveTab(o);return}var p=d.get("name");a.add({title:p,itemId:o,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDynamicClient",dynamic_client_id:b,record:d}});a.setActiveTab(o)})}},onTabDynamicClientActive:function(h){var j=this;var g=h.down("form");var i=h.up("pnlDynamicClient").dynamic_client_id;g.load({url:j.getUrlView(),method:"GET",params:{dynamic_client_id:i}})},saveDynamicClient:function(h){var j=this;var g=h.up("form");var i=h.up("pnlDynamicClient").dynamic_client_id;g.submit({clientValidation:true,url:j.getUrlEdit(),params:{id:i},success:function(b,a){j.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabRealmsActivate:function(g){var h=this;var e=g.down("gridRealmsForDynamicClientOwner");e.getStore().load()},tabPhotoActivate:function(e){var h=this;var g=e.up("pnlDynamicClient");Ext.Ajax.request({url:h.getUrlViewPhoto(),method:"GET",params:{id:g.dynamic_client_id},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var j=e.down("cmpImg");var a=h.getUrlPhotoBase()+b.data.photo_file_name;j.setImage(a)}},scope:h})},photoSave:function(l){var j=this;var k=l.up("form");var i=k.up("pnlDynamicClient");var h=i.down("pnlDynamicClientPhoto");k.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:j.getUrlUploadPhoto(),params:{id:i.dynamic_client_id},success:function(d,b){if(b.result.success){var e=b.result.photo_file_name;var g=h.down("cmpImg");var a=j.getUrlPhotoBase()+e;g.setImage(a)}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},photoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabAvailabilityActivate:function(e){var d=this;e.getStore().load()},gridDynamicClientsAvailabilityReload:function(e){var h=this;var g=e.up("gridDynamicClientsAvailability");g.getStore().load()},gridDynamicClientsAvailabilityDelete:function(e){var h=this;var g=e.up("gridDynamicClientsAvailability");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},gridUnknownDynamicClientsReload:function(g){var h=this;var e=g.up("gridUnknownDynamicClients");e.getStore().load()},reloadUnknownDynamicClientsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownDynamicClients);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownDynamicClients=setInterval(function(){j.gridUnknownDynamicClientsReload(b)},k)},attachAttachUnknownDynamicClient:function(q){var p=this;var t=q.up("#tabDynamicClients");var n=t.down("gridUnknownDynamicClients").getStore();if(t.down("gridUnknownDynamicClients").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var w=t.down("gridUnknownDynamicClients").getSelectionModel().getLastSelected();var u=w.getId();var m=w.get("nasidentifier");var r=w.get("calledstationid");var s=true;if(!Ext.WindowManager.get("winAttachUnknownDynamicClientId")){var o=Ext.widget("winAttachUnknownDynamicClient",{id:"winAttachUnknownDynamicClientId",store:n,nasidentifier:m,calledstationid:r,unknown_dynamic_client_id:u});o.show()}}},delUnknownDynamicClient:function(g){var i=this;var j=g.up("#tabDynamicClients");var h=j.down("gridUnknownDynamicClients");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDynamicClient"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDynamicClient"+m.getId(),noteForId:m.getId(),noteForGrid:"dynamic_clients",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDynamicClientAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicClientAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDynamicClientAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicClientAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="dynamicClientTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlDynamicClientGraphs",dynamic_client_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("gridDynamicClients");var m=j.up("tabpanel");var l="mapTab";var k=m.down("#"+l);if(k){m.setActiveTab(l);return}var n=i18n("sGoogle_Maps");Ext.Ajax.request({url:o.getUrlViewMapPref(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){m.add({title:n,itemId:l,closable:true,iconCls:"map",glyph:Rd.config.icnMap,layout:"fit",items:{xtype:"pnlGMap",store:o.getStore("sDynamicClients"),mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[]}});m.setActiveTab(l)}},scope:o})},mapPreferences:function(e){var h=this;if(!Ext.WindowManager.get("winMapPreferencesId")){var g=Ext.widget("winMapPreferences",{id:"winMapPreferencesId"});g.show();g.down("form").load({url:h.getUrlViewMapPref(),method:"GET"})}},mapPreferencesSnapshot:function(r){var p=this;var t=r.up("form");var s=p.getPnlGMap();var l=s.gmap.getZoom();var o=s.gmap.getMapTypeId();var m=s.gmap.getCenter();var q=m.lat();var n=m.lng();t.down("#lat").setValue(q);t.down("#lng").setValue(n);t.down("#zoom").setValue(l);t.down("#type").setValue(o.toUpperCase())},mapPreferencesSave:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlEditMapPref(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},mapDynamicClientAdd:function(e){var h=this;if(!Ext.WindowManager.get("winMapDynamicClientAddId")){var g=Ext.widget("winMapDynamicClientAdd",{id:"winMapDynamicClientAddId"});g.show()}},mapDynamicClientAddSubmit:function(u){var p=this;var s=u.up("window");var o=s.down("cmbDynamicClientsAddMap");var x=o.getValue();var t=o.getStore().getById(x);s.close();var n=p.getGrid().up("tabpanel");var r=n.down("#mapTab");if(r!=null){var q=r.down("gmappanel");var y=q.gmap.getCenter();var w=q.addMarker({lat:y.lat(),lng:y.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){p.dragEnd(t,q,w)},dragstart:function(){q.addwindow.close();p.dragStart(t,q,w)}}});q.addwindow.open(q.gmap,w)}},markerClick:function(w,s,x){var q=this;var u=w.get("nasname");var y=w.get("shortname");s.marker_record=w;var p=Ext.ComponentQuery.query("#pnlMapsInfo");if(p[0]){var n="N/A";if(w.get("status")!="unknown"){if(w.get("status")=="up"){var d=i18n("sUp")}if(w.get("status")=="down"){var d=i18n("sDown")}n=d+" "+Ext.ux.secondsToHuman(w.get("status_time"))}var t=Ext.apply({time_in_state:n},w.data);p[0].down("#tabMapInfo").update(t);var r=q.getUrlPhotoBase()+w.get("photo_file_name");p[0].down("#tabMapPhoto").update({image:r})}s.infowindow.open(s.gmap,x)},dragStart:function(g,j,h){var i=this;i.lastMovedMarker=h;i.lastOrigPosition=h.getPosition();i.editWindow=j.editwindow},dragEnd:function(l,k,i){var j=this;var h=i.getPosition();k.new_lng=h.lng();k.new_lat=h.lat();k.editwindow.open(k.gmap,i);j.lastLng=h.lng();j.lastLat=h.lat();j.lastDragId=l.getId()},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapDelete(),method:"GET",params:{id:d.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},btnMapSave:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapSave(),method:"GET",params:{id:d.lastDragId,lat:d.lastLat,lon:d.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})}},0,0,0,0,0,0,[Rd.controller,"cDynamicClients"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPhotoAdd",Ext.window.Window,{title:i18n("sAdd_photo"),layout:"fit",autoShow:false,width:500,height:480,glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,data_view:undefined,initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"stretch_to_fit",name:"Stretch To Fit"},{id:"horizontal",name:"Horizontal Fit"},{id:"vertical",name:"Vertical Fit"},{id:"original",name:"Original Size"},{id:"dynamic",name:"Device Dependent Fit"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:"Fit",store:e,queryMode:"local",displayField:"name",valueField:"id",name:"fit",value:"stretch_to_fit"});h.items=[{xtype:"form",layout:"fit",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sTitle"),name:"title",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sPhoto"),allowBlank:false,labelClsExtra:"lblRdReq",name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"checkbox",fieldLabel:"Active",name:"active",inputValue:"active",checked:true,labelClsExtra:"lblRdReq"}]},{title:"Advanced",layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[g,{xtype:"colorfield",fieldLabel:"Background color",name:"background_color",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#DDDDE5"},{xtype:"textfield",fieldLabel:"URL",name:"url",labelClsExtra:"lblRd",vtype:"url"},{xtype:"numberfield",name:"slide_duration",fieldLabel:"Slide Duration",value:10,maxValue:300,minValue:2},{xtype:"checkbox",fieldLabel:"Include Title",name:"include_title",inputValue:"include_title",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include Description",name:"include_description",inputValue:"include_description",checked:true,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhotoAdd"],["component","box","container","panel","window","winPhotoAdd"],{component:true,box:true,container:true,panel:true,window:true,winPhotoAdd:true},["widget.winPhotoAdd"],0,[Rd.view.dynamicDetails,"winPhotoAdd"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPageEdit",Ext.window.Window,{title:i18n("sEdit_own_page"),layout:"fit",autoShow:false,width:600,height:450,iconCls:"edit",glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"htmleditor",width:580,height:250,name:"content",labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPageEdit"],["component","box","container","panel","window","winPageEdit"],{component:true,box:true,container:true,panel:true,window:true,winPageEdit:true},["widget.winPageEdit"],0,[Rd.view.dynamicDetails,"winPageEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetails",Ext.grid.Panel,{multiSelect:true,store:"sDynamicDetails",stateful:true,stateId:"StateGridDynamicDetails",stateEvents:["groupclick","columnhide"],border:false,plugins:"gridfilters",urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-grid.json",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridDynamicDetails1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails3"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails4"},{text:i18n("sFax"),dataIndex:"fax",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails5"},{text:i18n("sCell"),dataIndex:"cell",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails6"},{text:i18n("s_email"),dataIndex:"email",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails7"},{text:i18n("sURL"),dataIndex:"url",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridDynamicDetails8"},{text:"Theme",dataIndex:"theme",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridDynamicDetails8a"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridDynamicDetails9"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridDynamicDetails10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetails"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetails"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetails:true},["widget.gridDynamicDetails"],0,[Rd.view.dynamicDetails,"gridDynamicDetails"],0));(Ext.cmd.derive("Rd.model.mDynamicPhoto",Ext.data.Model,{fields:["id","dynamic_detail_id","title","description","url","file_name","img",{name:"active",type:"bool"},"fit","background_color","slide_duration",{name:"include_title",type:"bool"},{name:"include_description",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicPhoto"],0));(Ext.cmd.derive("Rd.model.mDynamicPage",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"content",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mDynamicPage"],0));(Ext.cmd.derive("Rd.model.mDynamicPair",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"value",type:"string"},{name:"priority",type:"int"},"dynamic_detail_id"]},0,0,0,0,0,0,[Rd.model,"mDynamicPair"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetail",Ext.tab.Panel,{border:false,dynamic_detail_id:null,plain:true,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDetail"),xtype:"pnlDynamicDetailDetail",itemId:"tabDetail"},{title:i18n("sLogo"),itemId:"tabLogo",xtype:"pnlDynamicDetailLogo",margin:5},{title:i18n("sPhotos"),itemId:"tabPhoto",xtype:"pnlDynamicDetailPhoto",dynamic_detail_id:b.dynamic_detail_id},{title:i18n("sOwn_pages"),itemId:"tabPages",xtype:"gridDynamicDetailPages",dynamic_detail_id:b.dynamic_detail_id},{title:i18n("sDynamic_keys"),itemId:"tabPairs",xtype:"gridDynamicDetailPairs",dynamic_detail_id:b.dynamic_detail_id},{title:"Settings",itemId:"tabSettings",xtype:"pnlDynamicDetailSettings",dynamic_detail_id:b.dynamic_detail_id,user_id:b.user_id},{title:"Click to connect",itemId:"tabClickToConect",xtype:"pnlDynamicDetailClickToConnect",dynamic_detail_id:b.dynamic_detail_id},{title:"Social login",itemId:"tabSocialLogin",xtype:"pnlDynamicDetailSocialLogin",dynamic_detail_id:b.dynamic_detail_id,user_id:b.user_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetail"],["component","box","container","panel","tabpanel","pnlDynamicDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlDynamicDetail:true},["widget.pnlDynamicDetail"],0,[Rd.view.dynamicDetails,"pnlDynamicDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPhotoEdit",Ext.window.Window,{title:i18n("sEdit_photo"),layout:"fit",autoShow:false,width:500,height:480,glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,data_view:undefined,initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"stretch_to_fit",name:"Stretch To Fit"},{id:"horizontal",name:"Horizontal Fit"},{id:"vertical",name:"Vertical Fit"},{id:"original",name:"Original Size"},{id:"dynamic",name:"Device Dependent Fit"}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:"Fit",store:e,queryMode:"local",displayField:"name",name:"fit",valueField:"id",value:"stretch_to_fit"});h.items=[{xtype:"form",layout:"fit",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sTitle"),name:"title",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sOptional_photo"),allowBlank:true,labelClsExtra:"lblRd",name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}},{xtype:"checkbox",fieldLabel:"Active",name:"active",inputValue:"active",checked:true,labelClsExtra:"lblRdReq"}]},{title:"Advanced",layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[g,{xtype:"colorfield",fieldLabel:"Background color",name:"background_color",beforeBodyEl:['<div class="x-colorpicker-field-swatch custom-color-picker-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="x-colorpicker-field-swatch-inner"></div></div>'],value:"#DDDDE5"},{xtype:"textfield",fieldLabel:"URL",name:"url",labelClsExtra:"lblRd",vtype:"url"},{xtype:"numberfield",name:"slide_duration",fieldLabel:"Slide Duration",value:10,maxValue:300,minValue:2},{xtype:"checkbox",fieldLabel:"Include Title",name:"include_title",inputValue:"include_title",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include Description",name:"include_description",inputValue:"include_description",checked:true,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhotoEdit"],["component","box","container","panel","window","winPhotoEdit"],{component:true,box:true,container:true,panel:true,window:true,winPhotoEdit:true},["widget.winPhotoEdit"],0,[Rd.view.dynamicDetails,"winPhotoEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPairEdit",Ext.window.Window,{title:i18n("sEdit_dynamic_pair"),layout:"fit",autoShow:false,width:400,height:350,iconCls:"edit",glyph:Rd.config.icnEdit,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sValue"),name:"value",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"numberfield",name:"priority",fieldLabel:i18n("sPriority"),value:1,maxValue:20,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPairEdit"],["component","box","container","panel","window","winPairEdit"],{component:true,box:true,container:true,panel:true,window:true,winPairEdit:true},["widget.winPairEdit"],0,[Rd.view.dynamicDetails,"winPairEdit"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPairAdd",Ext.window.Window,{title:i18n("sAdd_dynamic_pair"),layout:"fit",autoShow:false,width:400,height:350,iconCls:"add",glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sValue"),name:"value",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"numberfield",name:"priority",fieldLabel:i18n("sPriority"),value:1,maxValue:20,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPairAdd"],["component","box","container","panel","window","winPairAdd"],{component:true,box:true,container:true,panel:true,window:true,winPairAdd:true},["widget.winPairAdd"],0,[Rd.view.dynamicDetails,"winPairAdd"],0));(Ext.cmd.derive("Rd.store.sDynamicDetails",Ext.data.Store,{model:"Rd.model.mDynamicDetail",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sDynamicDetails"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winPageAdd",Ext.window.Window,{title:i18n("sAdd_own_page"),layout:"fit",autoShow:false,width:600,height:450,iconCls:"add",glyph:Rd.config.icnAdd,dynamic_detail_id:undefined,grid:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"htmleditor",width:580,height:250,name:"content",labelClsExtra:"lblRdReq",allowBlank:false}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPageAdd"],["component","box","container","panel","window","winPageAdd"],{component:true,box:true,container:true,panel:true,window:true,winPageAdd:true},["widget.winPageAdd"],0,[Rd.view.dynamicDetails,"winPageAdd"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.frmDetail",Ext.form.Panel,{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",owner:"",user_id:"",no_tree:false,initComponent:function(){var d=this;var e=[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,margin:"0 20 40 0"}];if(d.no_tree){e=[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",formBind:true,margin:"0 20 40 0"}]}d.buttons=e;d.items=[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:d.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:d.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"fieldset",title:i18n("sOptional_Info"),collapsible:true,border:false,collapsed:true,defaults:{anchor:"100%"},items:[{xtype:"displayfield",fieldLabel:i18n("sContact_detail"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sAddress"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sLocation"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",allowBlank:true}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmDynamicDetailDetail"],["component","box","container","panel","form","frmDynamicDetailDetail"],{component:true,box:true,container:true,panel:true,form:true,frmDynamicDetailDetail:true},["widget.frmDynamicDetailDetail"],0,[Rd.view.dynamicDetails,"frmDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.winDynamicDetailAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_dynamic_page"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",owner:"",user_id:"",no_tree:false,defaults:{border:false},initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var d=this;var e=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return e},mkScrnDynamicDetailDetail:function(){me=this;var b=Ext.create("Rd.view.dynamicDetails.frmDetail",{itemId:"scrnDynamicDetailDetail",user_id:me.user_id,owner:me.owner,no_tree:true});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]},{title:"T&C",layout:"anchor",itemId:"tabTc",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Compulsory",itemId:"chkTc",name:"t_c_check",inputValue:"t_c_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"URL",itemId:"txtTcUrl",name:"t_c_url",disabled:true,allowBlank:false,margin:15}]}]}]});return d}},0,["winDynamicDetailAddWizard"],["component","box","container","panel","window","winDynamicDetailAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winDynamicDetailAddWizard:true},["widget.winDynamicDetailAddWizard"],0,[Rd.view.dynamicDetails,"winDynamicDetailAddWizard"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailDetail",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailDetail"],["component","box","container","panel","pnlDynamicDetailDetail"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailDetail:true},["widget.pnlDynamicDetailDetail"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailDetail"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailLogo",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var d=this;var e=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='DynamicDetail logo'>","</div>"]);d.items={xtype:"panel",frame:true,height:"100%",width:450,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:i18n("sCurrent_logo"),flex:1,border:false,itemId:"pnlImg",tpl:e,data:{img:d.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailLogo"],["component","box","container","panel","pnlDynamicDetailLogo"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailLogo:true},["widget.pnlDynamicDetailLogo"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailLogo"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailPhoto",Ext.panel.Panel,{border:false,frame:false,layout:{type:"hbox",align:"stretch"},store:undefined,dynamic_detail_id:null,bodyStyle:{backgroundColor:Rd.config.panelGrey},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-photos.json",urlShufflePhoto:"/cake3/rd_cake/dynamic-details/shuffle-photo.json",initComponent:function(){var h=this;var e=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap">',"<div>","<div><h1>{title}</h1></div>",'<img src="{img}" />','<div class="description">{description}</div>','<tpl if="Ext.isEmpty(url)">',"<div></div>","<tpl else>",'<div><a href="{url}" target="_blank">{url}</a></div>',"</tpl>","</div>",'<div class="thumb-info">','<ul class="fa-ul">','<tpl if="active">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Enabled</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Disabled</span></li>',"</tpl>","<tpl if=\"fit=='stretch_to_fit'\">",'<li><i class="fa-li fa fa-expand"></i>Stretch To Fit</li>',"</tpl>","<tpl if=\"fit=='horizontal'\">",'<li><i class="fa-li fa fa-expand"></i>Horizontal Fit</li>',"</tpl>","<tpl if=\"fit=='vertical'\">",'<li><i class="fa-li fa fa-expand"></i>Vertical Fit</li>',"</tpl>","<tpl if=\"fit=='original'\">",'<li><i class="fa-li fa fa-expand"></i>Original Size</li>',"</tpl>",'<li style="background-color:#{background_color};"><i class="fa-li fa fa-paint-brush"></i>Background HTML <b>#{background_color}</b></li>','<li><i class="fa-li fa fa-clock-o"></i>Slide duration <b>{slide_duration}</b> seconds</li>','<tpl if="include_title">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Show Title</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Hide Title</span></li>',"</tpl>",'<tpl if="include_description">','<li><span class="txtGreen"><i class="fa-li fa fa-check-circle"></i>Show Description</span></li>',"<tpl else>",'<li><span class="txtGrey"><i class="fa-li fa fa-minus-circle"></i>Hide Description</span></li>',"</tpl>","</ul>","</div>","</div>","</tpl>");h.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPhoto",proxy:{type:"ajax",url:"/cake3/rd_cake/dynamic-details/index-photo.json",extraParams:{dynamic_detail_id:h.dynamic_detail_id},batchActions:true,format:"json",reader:{keepRawData:true,type:"json",rootProperty:"items"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-photo.json"}},listeners:{load:function(d,j,a){if(!a){Ext.ux.Toaster.msg("Error encountered",d.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var b=h.down("dataview").getStore().getTotalCount();h.down("#count").update({count:b})}},scope:this}});var g=Ext.create("Ext.view.View",{store:h.store,multiSelect:true,tpl:e,itemSelector:"div.thumb-wrap",emptyText:i18n("sNo_images_available"),listeners:{render:function(b){var a=this;a.dragZone=new Ext.view.DragZone({view:b,ddGroup:"dynPhotos",dragText:'<span class="txtBlue"><i class="fa  fa-lightbulb-o"></i> <b>Drag & Drop</b> to rearrange items</span>'});a.dopZone=new Ext.view.DropZone({view:b,ddGroup:"dynPhotos",handleNodeDrop:function(x,u,t){var i=this.view,d=i.getStore(),r,y,w,s;if(x.copy){y=x.records;x.records=[];for(w=0,s=y.length;w<s;w++){x.records.push(y[w].copy(y[w].getId()))}}else{x.view.store.remove(x.records,x.view===i)}r=d.indexOf(u);if(t!=="before"){r++}d.insert(r,x.records);i.getSelectionModel().select(x.records);a.commitShuffle(d)}})},scope:h}});h.items={xtype:"panel",frame:false,height:"100%",width:550,itemId:"pnlForPhotoView",layout:{type:"vbox",align:"stretch"},items:g,autoScroll:true,tbar:Ext.create("Rd.view.components.ajaxToolbar",{url:h.urlMenu,extra_text:'<span class="txtBlue"><i class="fa  fa-lightbulb-o"></i> <b>Drag & Drop</b> to rearrange items</span>'}),bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},commitShuffle:function(g){var e=this;var h=[];g.each(function(b){var a=b.getId();Ext.Array.push(h,{id:a})});Ext.Ajax.request({url:e.urlShufflePhoto,method:"POST",jsonData:h,params:{dynamic_detail_id:e.dynamic_detail_id},success:function(a,b){Ext.ux.Toaster.msg("Updating Photo Position","Updating Photo Position Completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.reload()},failure:function(a,b){Ext.ux.Toaster.msg("Problems Updating Photo Position","Problems Updating Photo Position",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.reload()}})}},0,["pnlDynamicDetailPhoto"],["component","box","container","panel","pnlDynamicDetailPhoto"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailPhoto:true},["widget.pnlDynamicDetailPhoto"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailPhoto"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetailPages",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDynamicDetailPages",stateEvents:["groupclick","columnhide"],border:false,dynamic_detail_id:undefined,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-dynamic-pages.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDynamicDetailPages1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",width:200,stateId:"StateGridDynamicDetailPages2"},{text:i18n("sContent"),dataIndex:"content",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPages3"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPage",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index-page.json",extraParams:{dynamic_detail_id:b.dynamic_detail_id},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-page.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetailPages"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetailPages"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetailPages:true},["widget.gridDynamicDetailPages"],0,[Rd.view.dynamicDetails,"gridDynamicDetailPages"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.gridDynamicDetailPairs",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridDynamicDetailPairs",stateEvents:["groupclick","columnhide"],border:false,dynamic_detail_id:undefined,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/dynamic-details/menu-for-dynamic-pairs.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],columns:[{xtype:"rownumberer",stateId:"StateGridDynamicDetailPairs1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridDynamicDetailPairs2"},{text:i18n("sValue"),dataIndex:"value",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPairs3"},{text:i18n("sPriority"),dataIndex:"priority",tdCls:"gridTree",flex:1,stateId:"StateGridDynamicDetailPairs4"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDynamicPair",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/index-pair.json",extraParams:{dynamic_detail_id:b.dynamic_detail_id},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/dynamic-details/delete-pair.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridDynamicDetailPairs"],["component","box","container","panel","tablepanel","gridpanel","grid","gridDynamicDetailPairs"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridDynamicDetailPairs:true},["widget.gridDynamicDetailPairs"],0,[Rd.view.dynamicDetails,"gridDynamicDetailPairs"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.vcDynamicDetailSettings",Ext.app.ViewController,{init:function(){},onCmbThemesChange:function(h){var e=this;e.theme=h.getValue();console.log("The Theme is now "+e.theme);var g=h.up("panel");if(e.theme=="Custom"){g.down("#txtCoovaDesktopUrl").setDisabled(false);g.down("#txtCoovaDesktopUrl").setHidden(false);g.down("#txtCoovaMobileUrl").setDisabled(false);g.down("#txtCoovaMobileUrl").setHidden(false);g.down("#txtMikrotikDesktopUrl").setDisabled(false);g.down("#txtMikrotikDesktopUrl").setHidden(false);g.down("#txtMikrotikMobileUrl").setDisabled(false);g.down("#txtMikrotikMobileUrl").setHidden(false)}else{g.down("#txtCoovaDesktopUrl").setDisabled(true);g.down("#txtCoovaDesktopUrl").setHidden(true);g.down("#txtCoovaMobileUrl").setDisabled(true);g.down("#txtCoovaMobileUrl").setHidden(true);g.down("#txtMikrotikDesktopUrl").setDisabled(true);g.down("#txtMikrotikDesktopUrl").setHidden(true);g.down("#txtMikrotikMobileUrl").setDisabled(true);g.down("#txtMikrotikMobileUrl").setHidden(true)}},onChkRegisterUsersChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("cmbRealm").setDisabled(false);e.down("cmbProfile").setDisabled(false);e.down("#chkRegMacCheck").setDisabled(false);e.down("#chkRegAutoAdd").setDisabled(false);e.down("#chkRegEmail").setDisabled(false)}else{e.down("cmbRealm").setDisabled(true);e.down("cmbProfile").setDisabled(true);e.down("#chkRegMacCheck").setDisabled(true);e.down("#chkRegAutoAdd").setDisabled(true);e.down("#chkRegEmail").setDisabled(true)}},onChkRegAutoSuffixChange:function(g){var h=this;var e=g.up("panel");if(g.getValue()){e.down("#txtRegSuffix").setDisabled(false)}else{e.down("#txtRegSuffix").setDisabled(true)}},chkSlideshowChange:function(j){var m=this;var n=j.up("form");var i=n.down("#nrEnforceInSeconds");var k=n.down("#chkSlideshowEnforce");var l=j.getValue();if(l){k.setDisabled(false);if(k.getValue()){i.setDisabled(false)}else{i.setDisabled(true)}}else{i.setDisabled(true);k.setDisabled(true)}},chkEnforceChange:function(i){var k=this;var l=i.up("form");var h=l.down("#nrEnforceInSeconds");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}}},0,0,0,0,["controller.vcDynamicDetailSettings"],0,[Rd.view.dynamicDetails,"vcDynamicDetailSettings"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailSettings",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},controller:"vcDynamicDetailSettings",user_id:undefined,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/i18n.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Theme",layout:"anchor",itemId:"tabTheme",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"cmbThemes",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbThemesChange"}},{xtype:"textfield",fieldLabel:"Coova Desktop URL",itemId:"txtCoovaDesktopUrl",name:"coova_desktop_url",value:"/rd_login/cc/d/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Coova Mobile URL",itemId:"txtCoovaMobileUrl",name:"coova_mobile_url",value:"/rd_login/cc/m/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Mikrotik Desktop URL",itemId:"txtMikrotikDesktopUrl",name:"mikrotik_desktop_url",value:"/rd_login/mt/d/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Mikrotik Mobile URL",itemId:"txtMikrotikMobileUrl",name:"mikrotik_mobile_url",value:"/rd_login/mt/m/index.html",disabled:true,hidden:true,allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Slideshow",itemId:"chkSlideshow",name:"slideshow_check",inputValue:"slideshow_check",checked:false,labelClsExtra:"lblRdReq",listeners:{change:"chkSlideshowChange"}},{xtype:"checkbox",fieldLabel:"Enforce Watching",itemId:"chkSlideshowEnforce",name:"slideshow_enforce_watching",inputValue:"slideshow_enforce_watching",checked:false,labelClsExtra:"lblRd",disabled:true,listeners:{change:"chkEnforceChange"}},{xtype:"numberfield",name:"slideshow_enforce_seconds",fieldLabel:"Enforce in Seconds",itemId:"nrEnforceInSeconds",value:30,maxValue:300,minValue:1,disabled:true}]},{title:"Login",layout:"anchor",itemId:"tabUsersVouchers",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"User login",itemId:"chkUserLogin",name:"user_login_check",inputValue:"user_login_check",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Auto-add suffix",itemId:"chkAutoSuffix",name:"auto_suffix_check",inputValue:"auto_suffix_check",checked:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Suffix",itemId:"txtSuffix",name:"auto_suffix",disabled:true},{xtype:"checkbox",fieldLabel:"Lost password",itemId:"chkLostPassword",name:"lost_password",inputValue:"lost_password",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Voucher login",itemId:"chkVoucherLogin",name:"voucher_login_check",inputValue:"voucher_login_check",checked:true,labelClsExtra:"lblRdReq"}]},{title:"T&Cs",layout:"anchor",itemId:"tabTandC",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Agree to T&C",itemId:"chkTc",name:"t_c_check",inputValue:"t_c_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"T&C URL",itemId:"txtTcUrl",name:"t_c_url",disabled:true,allowBlank:false,vtype:"url"}]},{title:"Redirect",layout:"anchor",itemId:"tabRedirect",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Redirect after connect",itemId:"chkRedirect",name:"redirect_check",inputValue:"redirect_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Redirect to URL",itemId:"txtRedirectUrl",name:"redirect_url",disabled:true,allowBlank:false,vtype:"url"},{xtype:"checkbox",fieldLabel:"Show usage",itemId:"chkUsage",name:"usage_show_check",inputValue:"usage_show_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"usage_refresh_interval",fieldLabel:"Refresh every (seconds)",itemId:"nrUsageRefresh",value:120,maxValue:600,minValue:60,disabled:true}]},{title:i18n("sRegistration"),layout:"anchor",itemId:"tabRegistration",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sUser_registration"),itemId:"chkRegisterUsers",name:"register_users",inputValue:"register_users",labelClsExtra:"lblRdReq",listeners:{change:"onChkRegisterUsersChange"}},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",disabled:true,extraParam:d.user_id},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",disabled:true,extraParam:d.user_id},{xtype:"checkbox",boxLabel:"One user registration per device",itemId:"chkRegMacCheck",name:"reg_mac_check",inputValue:"reg_mac_check",disabled:true,checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Auto-add device after authentication",itemId:"chkRegAutoAdd",name:"reg_auto_add",inputValue:"reg_auto_add",disabled:true,checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Send confirmation email",itemId:"chkRegEmail",name:"reg_email",inputValue:"reg_email",disabled:true,checked:false,cls:"lblRd"}]},{title:i18n("sLanguage"),layout:"anchor",itemId:"tabLanguage",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbDynamicDetailLanguages",labelClsExtra:"lblRdReq"},{fieldLabel:"Available Languages",store:e,queryMode:"local",emptyText:"Just The Default Language",displayField:"name",valueField:"id",xtype:"tagfield",name:"available_languages[]",labelClsExtra:"lblRd"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailSettings"],["component","box","container","panel","pnlDynamicDetailSettings"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailSettings:true},["widget.pnlDynamicDetailSettings"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailSettings"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailClickToConnect",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:200,maxWidth:Rd.config.maxWidth},items:[{xtype:"textfield",name:"id",hidden:true},{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkClickToConnect",name:"connect_check",inputValue:"connect_check",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",itemId:"txtConnectUsername",fieldLabel:"Connect as",name:"connect_username",allowBlank:false,blankText:i18n("sSupply_a_value"),disabled:true},{xtype:"textfield",itemId:"txtConnectSuffix",fieldLabel:"Add suffix of",name:"connect_suffix",allowBlank:false,blankText:i18n("sSupply_a_value"),disabled:true},{xtype:"numberfield",name:"connect_delay",fieldLabel:"Delay before connecting (seconds)",itemId:"nrConnectDelay",value:0,maxValue:600,minValue:0,disabled:true},{xtype:"checkbox",fieldLabel:"Only Click-to-connect",itemId:"chkConnectOnly",name:"connect_only",inputValue:"connect_only",checked:false,disabled:true}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailClickToConnect"],["component","box","container","panel","pnlDynamicDetailClickToConnect"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailClickToConnect:true},["widget.pnlDynamicDetailClickToConnect"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailClickToConnect"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.cmbThemes",Ext.form.ComboBox,{fieldLabel:"Theme",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"theme",name:"theme",value:"Default",multiSelect:false,labelClsExtra:"lblRd",allowBlank:false,excludeCustom:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{exclude_custom:d.excludeCustom},url:"/cake3/rd_cake/dynamic-details/available-themes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbThemes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbThemes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbThemes:true},["widget.cmbThemes"],0,[Rd.view.dynamicDetails,"cmbThemes"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.pnlDynamicDetailSocialLogin",Ext.panel.Panel,{border:false,dynamic_detail_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},user_id:undefined,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"voucher",name:"Voucher"},{id:"user",name:"Permanent User"}]});d.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabSocialBasic",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",name:"id",hidden:true,value:d.dynamic_detail_id},{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkEnableSocialLogin",name:"social_enable",inputValue:"social_enable",checked:true,labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:"Temp login user",allowBlank:false,name:"social_temp_permanent_user_id",itemId:"socialTempUser"}]},{title:"Facebook",layout:"anchor",itemId:"tabFacebook",glyph:Rd.config.icnFacebook,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"fb_enable",inputValue:"fb_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"fb_record_info",inputValue:"fb_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"fb_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"fb_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"fb_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"fbRealm",extraParam:d.user_id,name:"fb_realm",allowBlank:false},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"fbProfile",extraParam:d.user_id,name:"fb_profile",allowBlank:true}]},{title:"Google+",layout:"anchor",itemId:"tabGoogle",glyph:Rd.config.icnGoogle,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"gp_enable",inputValue:"gp_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"gp_record_info",inputValue:"gp_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"gp_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"gp_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"gp_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"gpRealm",extraParam:d.user_id,name:"gp_realm",allowBlank:true},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"gpProfile",extraParam:d.user_id,name:"gp_profile",allowBlank:true}]},{title:"Twitter",layout:"anchor",itemId:"tabTwitter",glyph:Rd.config.icnTwitter,defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",name:"tw_enable",inputValue:"tw_enable",labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Record info",name:"tw_record_info",inputValue:"tw_record_info",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Key/Id",name:"tw_id",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Secret",name:"tw_secret",labelClsExtra:"lblRdReq"},{xtype:"combobox",fieldLabel:"Auto create",store:e,queryMode:"local",displayField:"name",valueField:"id",value:"voucher",name:"tw_voucher_or_user",labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",labelClsExtra:"lblRdReq",itemId:"twRealm",extraParam:d.user_id,name:"tw_realm",allowBlank:true},{xtype:"cmbProfile",labelClsExtra:"lblRdReq",itemId:"twProfile",extraParam:d.user_id,name:"tw_profile",allowBlank:true}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlDynamicDetailSocialLogin"],["component","box","container","panel","pnlDynamicDetailSocialLogin"],{component:true,box:true,container:true,panel:true,pnlDynamicDetailSocialLogin:true},["widget.pnlDynamicDetailSocialLogin"],0,[Rd.view.dynamicDetails,"pnlDynamicDetailSocialLogin"],0));(Ext.cmd.derive("Rd.view.dynamicDetails.cmbDynamicDetailLanguages",Ext.form.ComboBox,{fieldLabel:"Default Language",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",name:"default_language",multiSelect:false,allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"string"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/dynamic-details/i18n.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDynamicDetailLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDynamicDetailLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDynamicDetailLanguages:true},["widget.cmbDynamicDetailLanguages"],0,[Rd.view.dynamicDetails,"cmbDynamicDetailLanguages"],0));(Ext.cmd.derive("Rd.controller.cDynamicDetails",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabDynamicDetails",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridDynamicDetails",glyph:Rd.config.icnHome}]});d.populated=true},views:["dynamicDetails.gridDynamicDetails","dynamicDetails.winDynamicDetailAddWizard","dynamicDetails.pnlDynamicDetail","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","dynamicDetails.pnlDynamicDetailDetail","dynamicDetails.pnlDynamicDetailLogo","dynamicDetails.pnlDynamicDetailPhoto","dynamicDetails.winPhotoAdd","dynamicDetails.winPhotoEdit","dynamicDetails.gridDynamicDetailPages","dynamicDetails.winPageAdd","dynamicDetails.winPageEdit","dynamicDetails.gridDynamicDetailPairs","dynamicDetails.winPairAdd","dynamicDetails.winPairEdit","dynamicDetails.pnlDynamicDetailSettings","dynamicDetails.pnlDynamicDetailClickToConnect","dynamicDetails.cmbThemes","components.cmbPermanentUser","components.cmbRealm","components.cmbProfile","dynamicDetails.pnlDynamicDetailSocialLogin","dynamicDetails.cmbDynamicDetailLanguages"],stores:["sDynamicDetails","sAccessProvidersTree","sPermanentUsers","sProfiles","sRealms"],models:["mDynamicDetail","mAccessProviderTree","mDynamicPhoto","mDynamicPage","mDynamicPair","mPermanentUser","mProfile","mRealm"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/dynamic-details/add.json",urlEdit:"/cake3/rd_cake/dynamic-details/edit.json",urlEditSettings:"/cake3/rd_cake/dynamic-details/edit-settings.json",urlEditClickToConnect:"/cake3/rd_cake/dynamic-details/edit-click-to-connect.json",urlDelete:"/cake3/rd_cake/dynamic-details/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/dynamic-details/export-csv",urlNoteAdd:"/cake3/rd_cake/dynamic-details/note-add.json",urlViewDynamicDetail:"/cake3/rd_cake/dynamic-details/view.json",urlLogoBase:"/cake3/rd_cake/img/dynamic_details/",urlUploadLogo:"/cake3/rd_cake/dynamic-details/upload_logo/",urlUploadPhoto:"/cake3/rd_cake/dynamic-details/upload-photo/",urlEditPhoto:"/cake3/rd_cake/dynamic-details/edit-photo/",urlAddPage:"/cake3/rd_cake/dynamic-details/add-page.json",urlEditPage:"/cake3/rd_cake/dynamic-details/edit_page.json",urlAddPair:"/cake3/rd_cake/dynamic-details/add_pair.json",urlEditPair:"/cake3/rd_cake/dynamic-details/edit_pair.json",urlPreviewMobile:"/cake3/rd_cake/dynamic-details/preview-chilli-mobile",urlPreviewDesktop:"/cake3/rd_cake/dynamic-details/preview-chilli-desktop",urlViewSocial:"/cake3/rd_cake/dynamic-details/view-social-login.json",urlEditSocial:"/cake3/rd_cake/dynamic-details/edit-social-login.json"},refs:[{ref:"grid",selector:"gridDynamicDetails"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabDynamicDetails":{destroy:b.appClose},"gridDynamicDetails #reload":{click:b.reload},"gridDynamicDetails #add":{click:b.add},"gridDynamicDetails #delete":{click:b.del},"gridDynamicDetails #edit":{click:b.edit},"gridDynamicDetails #note":{click:b.note},"gridDynamicDetails #csv":{click:b.csvExport},"gridDynamicDetails #mobile":{click:b.previewMobile},"gridDynamicDetails #desktop":{click:b.previewDesktop},gridDynamicDetails:{itemclick:b.gridClick},"winDynamicDetailAddWizard #btnTreeNext":{click:b.btnTreeNext},"winDynamicDetailAddWizard #btnDynamicDetailDetailPrev":{click:b.btnDynamicDetailDetailPrev},"winDynamicDetailAddWizard #chkTc":{change:b.chkTcChange},"winDynamicDetailAddWizard #save":{click:b.addSubmit},"pnlDynamicDetail pnlDynamicDetailDetail #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEdit())}},"#winCsvColumnSelectDynamicDetails #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=dynamicDetails] #reload":{click:b.noteReload},"gridNote[noteForGrid=dynamicDetails] #add":{click:b.noteAdd},"gridNote[noteForGrid=dynamicDetails] #delete":{click:b.noteDelete},"gridNote[noteForGrid=dynamicDetails]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=dynamicDetails] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=dynamicDetails] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=dynamicDetails] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlDynamicDetail #tabDetail":{beforerender:b.tabDetailActivate,activate:b.tabDetailActivate},"pnlDynamicDetail #tabSettings #chkUserLogin":{change:b.chkUserLoginChange},"pnlDynamicDetail #tabSettings #chkAutoSuffix":{change:b.chkAutoSuffixChange},"pnlDynamicDetail #tabSettings #chkTc":{change:b.chkTcChange},"pnlDynamicDetail #tabSettings #chkRedirect":{change:b.chkRedirectChange},"pnlDynamicDetail #tabSettings #chkUsage":{change:b.chkUsageChange},"pnlDynamicDetail #tabClickToConect #chkClickToConnect":{change:b.chkClickToConnectChange},"pnlDynamicDetail #tabLogo":{activate:b.tabLogoActivate},"pnlDynamicDetail #tabLogo #save":{click:b.logoSave},"pnlDynamicDetail #tabLogo #cancel":{click:b.logoCancel},"pnlDynamicDetail #tabPhoto":{activate:b.tabPhotoActivate},"pnlDynamicDetail #tabPhoto #reload":{click:b.photoReload},"pnlDynamicDetail #tabPhoto #add":{click:b.photoAdd},"pnlDynamicDetail #tabPhoto #delete":{click:b.photoDel},"pnlDynamicDetail #tabPhoto #edit":{click:b.photoEdit},"winPhotoAdd #save":{click:b.photoAddSave},"winPhotoAdd #cancel":{click:b.photoAddCancel},"winPhotoEdit #save":{click:b.photoEditSave},"winPhotoEdit #cancel":{click:b.photoEditCancel},"pnlDynamicDetail #tabPages":{activate:b.tabPagesActivate},"pnlDynamicDetail gridDynamicDetailPages #reload":{click:b.pageReload},"pnlDynamicDetail gridDynamicDetailPages #add":{click:b.pageAdd},"pnlDynamicDetail gridDynamicDetailPages #delete":{click:b.pageDel},"pnlDynamicDetail gridDynamicDetailPages #edit":{click:b.pageEdit},"winPageAdd #save":{click:b.pageAddSave},"winPageEdit #save":{click:b.pageEditSave},"pnlDynamicDetail #tabPairs":{activate:b.tabPairsActivate},"pnlDynamicDetail gridDynamicDetailPairs #reload":{click:b.pairReload},"pnlDynamicDetail gridDynamicDetailPairs #add":{click:b.pairAdd},"pnlDynamicDetail gridDynamicDetailPairs #delete":{click:b.pairDel},"pnlDynamicDetail gridDynamicDetailPairs #edit":{click:b.pairEdit},"winPairAdd #save":{click:b.pairAddSave},"winPairEdit #save":{click:b.pairEditSave},"pnlDynamicDetail #tabSettings":{activate:b.tabSettingsActivate},"pnlDynamicDetail #tabClickToConect":{activate:b.tabDetailActivate},"pnlDynamicDetail #tabSocialLogin":{activate:b.tabSocialLoginActivate},"pnlDynamicDetail pnlDynamicDetailSettings #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditSettings())}},"pnlDynamicDetail pnlDynamicDetailClickToConnect #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditClickToConnect())}},"pnlDynamicDetail pnlDynamicDetailSocialLogin #save":{click:function(g){var a=this;a.editSubmit(g,a.getUrlEditSocial())}}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sDynamicDetails").load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winDynamicDetailAddWizardId")){var h=Ext.widget("winDynamicDetailAddWizard",{id:"winDynamicDetailAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winDynamicDetailAddWizardId")){var h=Ext.widget("winDynamicDetailAddWizard",{id:"winDynamicDetailAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winDynamicDetailAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDynamicDetailDetailPrev:function(g){var e=this;var h=g.up("winDynamicDetailAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sDynamicDetails").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},chkUserLoginChange:function(j){var l=this;var m=j.up("form");var n=m.down("#chkAutoSuffix");var i=m.down("#txtSuffix");var k=j.getValue();if(k){n.setDisabled(false)}else{n.setDisabled(true);i.setDisabled(true)}},chkAutoSuffixChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtSuffix");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkTcChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtTcUrl");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkRedirectChange:function(i){var k=this;var l=i.up("form");var h=l.down("#txtRedirectUrl");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkUsageChange:function(i){var k=this;var l=i.up("form");var h=l.down("#nrUsageRefresh");var j=i.getValue();if(j){h.setDisabled(false)}else{h.setDisabled(true)}},chkClickToConnectChange:function(l){var q=this;var r=l.up("form");var k=r.down("#txtConnectUsername");var m=r.down("#txtConnectSuffix");var n=r.down("#nrConnectDelay");var o=r.down("#chkConnectOnly");var p=l.getValue();if(p){k.setDisabled(false);m.setDisabled(false);n.setDisabled(false);o.setDisabled(false)}else{k.setDisabled(true);m.setDisabled(true);n.setDisabled(true);o.setDisabled(true)}},del:function(e){var d=this;if(d.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var h=d.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(h,function(j){var g=j.getId();Ext.Array.push(b,{id:g})});Ext.Ajax.request({url:d.getUrlDelete(),method:"POST",jsonData:b,success:function(g,j){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);d.reload()},failure:function(g,j){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);d.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=o.getGrid().up("tabpanel");var t=o.getGrid().getSelectionModel().getLastSelected();var s=t.getId();var l=t.get("user_id");var r="dynamicDetailTab_"+s;var n=m.down("#"+r);if(n){m.setActiveTab(r);return}var p=o.selectedRecord.get("name");m.add({title:p,itemId:r,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlDynamicDetail",dynamic_detail_id:s,user_id:l}});m.setActiveTab(r)}},editSubmit:function(g,h){var i=this;var j=g.up("form");j.submit({clientValidation:true,url:h,success:function(b,a){i.getStore("sDynamicDetails").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectDynamicDetails")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectDynamicDetails",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteDynamicDetails"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteDynamicDetails"+m.getId(),noteForId:m.getId(),noteForGrid:"dynamicDetails",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteDynamicDetailsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicDetailsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteDynamicDetailsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteDynamicDetailsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;j.load({url:i.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:h}})},tabSettingsActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;j.load({url:i.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:h},success:function(n,o,a){if(o.result.data.realm_id!=null){var p=j.down("#realm");var e=Ext.create("Rd.model.mRealm",{name:o.result.data.realm,id:o.result.data.realm_id});p.getStore().loadData([e],false);p.setValue(o.result.data.realm_id)}if(o.result.data.profile_id!=null){var d=j.down("#profile");var b=Ext.create("Rd.model.mProfile",{name:o.result.data.profile,id:o.result.data.profile_id});d.getStore().loadData([b],false);d.setValue(o.result.data.profile_id)}}})},tabLogoActivate:function(k){var j=this;var i=k.up("pnlNas");var l=k.up("pnlDynamicDetail").dynamic_detail_id;var h=k.down("#pnlImg");Ext.Ajax.request({url:j.getUrlViewDynamicDetail(),method:"GET",params:{dynamic_detail_id:l},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=j.getUrlLogoBase()+b.data.icon_file_name;h.update({image:a})}},scope:j})},logoSave:function(n){var l=this;var m=n.up("form");var k=m.up("pnlDynamicDetail");var i=m.up("panel");var j=i.down("#pnlImg");m.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:l.getUrlUploadLogo(),params:{id:k.dynamic_detail_id},success:function(d,b){if(b.result.success){var e=b.result.icon_file_name;var a=l.getUrlLogoBase()+e;j.update({image:a})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},logoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabPhotoActivate:function(e){var d=this;e.down("dataview").getStore().load()},photoReload:function(b){var e=this;b.up("#tabPhoto").down("dataview").getStore().load()},photoAdd:function(b){var i=this;var j=b.up("pnlDynamicDetail").dynamic_detail_id;var k=b.up("#tabPhoto").down("dataview");if(!Ext.WindowManager.get("winPhotoAddId")){var l=Ext.widget("winPhotoAdd",{id:"winPhotoAddId",dynamic_detail_id:j,data_view:k});l.show()}},photoAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:i.getUrlUploadPhoto(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},photoAddCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},photoDel:function(e){var h=this;var g=e.up("#tabPhoto").down("dataview");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},photoEdit:function(j){var i=this;var h=j.up("#tabPhoto").down("dataview");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPhotoEditId")){var g=Ext.widget("winPhotoEdit",{id:"winPhotoEditId",data_view:h});g.down("form").loadRecord(h.getSelectionModel().getLastSelected());g.show()}}}},photoEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Updating your photo...",url:i.getUrlEditPhoto(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},photoEditCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},tabPagesActivate:function(d){var e=this;d.getStore().load()},pageReload:function(b){var e=this;b.up("pnlDynamicDetail").down("#tabPages").getStore().load()},pageAdd:function(b){var i=this;var k=b.up("pnlDynamicDetail").dynamic_detail_id;var j=b.up("pnlDynamicDetail").down("#tabPages");if(!Ext.WindowManager.get("winPageAddId")){var l=Ext.widget("winPageAdd",{id:"winPageAddId",dynamic_detail_id:k,grid:j});l.show()}},pageAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlAddPage(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pageEdit:function(b){var h=this;var i=b.up("pnlDynamicDetail").down("#tabPages");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPageEditId")){var j=Ext.widget("winPageEdit",{id:"winPageEditId",grid:i});j.down("form").loadRecord(i.getSelectionModel().getLastSelected());j.show()}}}},pageEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlEditPage(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pageDel:function(b){var g=this;var h=b.up("pnlDynamicDetail").down("#tabPages");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},tabPairsActivate:function(d){var e=this;d.getStore().load()},pairReload:function(b){var e=this;b.up("pnlDynamicDetail").down("#tabPairs").getStore().load()},pairAdd:function(b){var i=this;var k=b.up("pnlDynamicDetail").dynamic_detail_id;var j=b.up("pnlDynamicDetail").down("#tabPairs");if(!Ext.WindowManager.get("winPairAddId")){var l=Ext.widget("winPairAdd",{id:"winPairAddId",dynamic_detail_id:k,grid:j});l.show()}},pairAddSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlAddPair(),params:{dynamic_detail_id:g.dynamic_detail_id},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pairEdit:function(b){var h=this;var i=b.up("pnlDynamicDetail").down("#tabPairs");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i.getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winPairEditId")){var j=Ext.widget("winPairEdit",{id:"winPairEditId",grid:i});j.down("form").loadRecord(i.getSelectionModel().getLastSelected());j.show()}}}},pairEditSave:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,url:i.getUrlEditPair(),success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.grid.getStore().load();g.close()},failure:Ext.ux.formFail})},pairDel:function(b){var g=this;var h=b.up("pnlDynamicDetail").down("#tabPairs");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},previewMobile:function(b){var g=this;if(g.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g.getGrid().getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var h=g.getGrid().getSelectionModel().getLastSelected();window.open(g.getUrlPreviewMobile()+"?dynamic_id="+h.getId())}}},previewDesktop:function(b){var g=this;if(g.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g.getGrid().getSelectionModel().getCount()>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var h=g.getGrid().getSelectionModel().getLastSelected();window.open(g.getUrlPreviewDesktop()+"?dynamic_id="+h.getId())}}},tabSocialLoginActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlDynamicDetail").dynamic_detail_id;if(i.modelInited==undefined){Ext.define("SocialForm",{extend:"Ext.data.Model",fields:[{name:"id",type:"int"},{name:"social_temp_permanent_user_id",type:"int"},{name:"social_temp_permanent_user_name",type:"string"},{name:"social_enable",type:"boolean",defaultValue:false},{name:"fb_enable",type:"boolean",defaultValue:false},{name:"fb_record_info",type:"boolean",defaultValue:false},{name:"fb_id",type:"string"},{name:"fb_secret",type:"string"},{name:"fb_profile",type:"int"},{name:"fb_profile_name",type:"string"},{name:"fb_realm",type:"int"},{name:"fb_realm_name",type:"string"},{name:"fb_voucher_or_user",type:"string"},{name:"gp_enable",type:"boolean",defaultValue:false},{name:"gp_record_info",type:"boolean",defaultValue:false},{name:"gp_id",type:"string"},{name:"gp_secret",type:"string"},{name:"gp_profile",type:"int"},{name:"gp_profile_name",type:"string"},{name:"gp_realm",type:"int"},{name:"gp_realm_name",type:"string"},{name:"gp_voucher_or_user",type:"string"},{name:"tw_enable",type:"boolean",defaultValue:false},{name:"tw_record_info",type:"boolean",defaultValue:false},{name:"tw_id",type:"string"},{name:"tw_secret",type:"string"},{name:"tw_profile",type:"int"},{name:"tw_profile_name",type:"string"},{name:"tw_realm",type:"int"},{name:"tw_realm_name",type:"string"},{name:"tw_voucher_or_user",type:"string"}]});i.modelInited=true}Ext.Ajax.request({url:i.getUrlViewSocial(),method:"GET",params:{dynamic_detail_id:h},success:function(X){var R=Ext.JSON.decode(X.responseText);if(R.success){var d=Ext.create("SocialForm",R.data);j.loadRecord(d);var S=d.get("social_temp_permanent_user_id");var H=d.get("social_temp_permanent_user_name");var M=Ext.create("Rd.model.mPermanentUser",{username:H,id:S});j.down("#socialTempUser").getStore().loadData([M],false);j.down("#socialTempUser").setValue(S);var e=d.get("fb_profile");var F=d.get("fb_profile_name");var P=Ext.create("Rd.model.mProfile",{name:F,id:e});j.down("#fbProfile").getStore().loadData([P],false);j.down("#fbProfile").setValue(e);var V=d.get("fb_realm");var J=d.get("fb_realm_name");var I=Ext.create("Rd.model.mRealm",{name:J,id:V});j.down("#fbRealm").getStore().loadData([I],false);j.down("#fbRealm").setValue(V);var Y=d.get("gp_profile");var T=d.get("gp_profile_name");var b=Ext.create("Rd.model.mProfile",{name:T,id:Y});j.down("#gpProfile").getStore().loadData([b],false);j.down("#gpProfile").setValue(Y);var N=d.get("gp_realm");var L=d.get("gp_realm_name");var W=Ext.create("Rd.model.mRealm",{name:L,id:N});j.down("#gpRealm").getStore().loadData([I],false);j.down("#gpRealm").setValue(N);var G=d.get("tw_profile");var K=d.get("tw_profile_name");var O=Ext.create("Rd.model.mProfile",{name:K,id:G});j.down("#twProfile").getStore().loadData([O],false);j.down("#twProfile").setValue(G);var a=d.get("tw_realm");var Q=d.get("tw_realm_name");var U=Ext.create("Rd.model.mRealm",{name:Q,id:a});j.down("#twRealm").getStore().loadData([U],false);j.down("#twRealm").setValue(a)}},scope:i})}},0,0,0,0,0,0,[Rd.controller,"cDynamicDetails"],0));(Ext.cmd.derive("Rd.view.filters.gridFilters",Ext.grid.Panel,{multiSelect:true,store:"sFilters",stateful:true,stateId:"StateGridF",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/filters/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridF1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridF3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridF5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridF6"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "low"\'><div class="fieldGreen">Low</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "high"\'><div class="fieldOrange">High</div></tpl>','<tpl if=\'protection_level == "custom"\'><div class="fieldBlue">Custom</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridF7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridFilters"],["component","box","container","panel","tablepanel","gridpanel","grid","gridFilters"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridFilters:true},["widget.gridFilters"],0,[Rd.view.filters,"gridFilters"],0));(Ext.cmd.derive("Rd.model.mFilter",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFilter"],0));(Ext.cmd.derive("Rd.view.filters.vcFilterEdit",Ext.app.ViewController,{init:function(){},url:"/cake3/rd_cake/filters/filter-detail-for.json",load_done:false,onFilterLevelChange:function(k){var n=this;var m=k.getValue();var i=k.up("form");var j=i.down("#cgrpCategories");var l=m.filter_level;Ext.Array.each(j.getBoxes(),function(a){if(l=="low"){if(a.level=="low"){a.setValue(true)}else{a.setValue(false)}}if(l=="medium"){if((a.level=="low")||(a.level=="medium")){a.setValue(true)}else{a.setValue(false)}}if(l=="high"){if((a.level=="low")||(a.level=="medium")||(a.level=="high")){a.setValue(true)}else{a.setValue(false)}}})},onCustomChange:function(g){var i=this;var j=g.up("form");var h=j.down("#cgrpCategories");if(g.getValue()){Ext.Array.each(h.getBoxes(),function(a){a.setReadOnly(false)})}else{Ext.Array.each(h.getBoxes(),function(a){a.setReadOnly(true)})}},onAfterEditRender:function(j){var g=this;var h=j.down("form");var i=j.record.getId();Ext.Ajax.request({url:g.url,method:"GET",params:{filter_id:i},success:g.buildFilter,scope:g})},buildFilter:function(q){var n=this;var m=Ext.JSON.decode(q.responseText);var o=n.getView();var l=o.down("#rgrpFilterLevel");var p=o.down("#custom");if(m.success){Ext.each(m.categories,function(a){o.down("#cgrpCategories").add(a)});var s={filter_level:m.protection_level};l.setValue(s);if(m.custom){p.setValue(true);var t=o.down("#cgrpCategories");var r=m.custom_categories;t.setValue({"categories[]":r})}else{p.setValue(false)}}}},0,0,0,0,["controller.vcFilterEdit"],0,[Rd.view.filters,"vcFilterEdit"],0));(Ext.cmd.derive("Rd.view.filters.winFilterEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Filter",width:600,height:500,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},listeners:{afterrender:"onAfterEditRender"},controller:"vcFilterEdit",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",autoScroll:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Settings",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"Filter Level",columns:3,vertical:true,itemId:"rgrpFilterLevel",items:[{boxLabel:"Low",name:"filter_level",inputValue:"low"},{boxLabel:"Medium",name:"filter_level",inputValue:"medium"},{boxLabel:"High",name:"filter_level",inputValue:"high"}],listeners:{change:"onFilterLevelChange"}},{xtype:"checkbox",boxLabel:"Customise",name:"custom",inputValue:"custom",itemId:"custom",checked:true,cls:"lblRd",listeners:{change:"onCustomChange"},autoEl:{tag:"div","data-qtip":"To Customise Your Choice Click Here"}},{xtype:"checkboxgroup",fieldLabel:"Categories",columns:3,vertical:false,itemId:"cgrpCategories",items:[]}]},{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabBasic",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]}]}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winFilterEdit"],["component","box","container","panel","window","winFilterEdit"],{component:true,box:true,container:true,panel:true,window:true,winFilterEdit:true},["widget.winFilterEdit"],0,[Rd.view.filters,"winFilterEdit"],0));(Ext.cmd.derive("Rd.store.sFilters",Ext.data.Store,{model:"Rd.model.mFilter",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/filters/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sFilters"],0));(Ext.cmd.derive("Rd.view.filters.winFilterAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Filter",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winFilterAddWizard"],["component","box","container","panel","window","winFilterAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winFilterAddWizard:true},["widget.winFilterAddWizard"],0,[Rd.view.filters,"winFilterAddWizard"],0));(Ext.cmd.derive("Rd.controller.cFilters",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridFilters",border:true,itemId:"tabFilters",plain:true});d.populated=true},views:["filters.gridFilters","filters.winFilterEdit","filters.winFilterAddWizard"],stores:["sAccessProvidersTree","sFilters"],models:["mAccessProviderTree","mFilter"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/filters/add.json",urlDelete:"/cake3/rd_cake/filters/delete.json",urlEdit:"/cake3/rd_cake/filters/edit.json"},refs:[{ref:"grid",selector:"gridFilters"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabFilters":{destroy:b.appClose},"gridFilters #reload":{click:b.reload},"gridFilters #add":{click:b.add},"gridFilters #delete":{click:b.del},"gridFilters #edit":{click:b.edit},gridFilters:{select:b.select},"winFilterAddWizard #btnTreeNext":{click:b.btnTreeNext},"winFilterAddWizard #btnDataPrev":{click:b.btnDataPrev},"winFilterAddWizard #btnDataNext":{click:b.btnDataNext},"winFilterEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winFilterAddWizardId")){var h=Ext.widget("winFilterAddWizard",{id:"winFilterAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winFilterAddWizardId")){var h=Ext.widget("winFilterAddWizard",{id:"winFilterAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winFilterAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winFilterAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sFilters").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winFilterEditId")){var i=Ext.widget("winFilterEdit",{id:"winFilterEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winFilterEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cFilters"],0));(Ext.cmd.derive("Rd.view.globalDomains.gridGlobalDomains",Ext.grid.Panel,{multiSelect:true,store:"sGlobalDomains",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-domains/menu-for-grid.json",plugins:"gridfilters",urlCategoryFilter:"/cake3/rd_cake/categories/index-for-filter.json",initComponent:function(){var e=this;var d=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:e.urlCategoryFilter,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD6"},{text:"Categories",sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(categories)"><div"></div></tpl>','<tpl for="categories">','<div class="fieldGreen">{name}</div>',"</tpl>"),dataIndex:"categories",stateId:"StateGridGD7",filter:{type:"list",store:d}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridGlobalDomains"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalDomains"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalDomains:true},["widget.gridGlobalDomains"],0,[Rd.view.globalDomains,"gridGlobalDomains"],0));(Ext.cmd.derive("Rd.model.mGlobalDomain",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"tags"]},0,0,0,0,0,0,[Rd.model,"mGlobalDomain"],0));(Ext.cmd.derive("Rd.model.mGenericList",Ext.data.Model,{fields:["id","text"]},0,0,0,0,0,0,[Rd.model,"mGenericList"],0));(Ext.cmd.derive("Rd.view.globalDomains.winGlobalDomainEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Global Domain",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winGlobalDomainEdit"],["component","box","container","panel","window","winGlobalDomainEdit"],{component:true,box:true,container:true,panel:true,window:true,winGlobalDomainEdit:true},["widget.winGlobalDomainEdit"],0,[Rd.view.globalDomains,"winGlobalDomainEdit"],0));(Ext.cmd.derive("Rd.store.sGlobalDomains",Ext.data.Store,{model:"Rd.model.mGlobalDomain",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-domains/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/global-domains/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sGlobalDomains"],0));(Ext.cmd.derive("Rd.view.globalDomains.winGlobalDomainAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Global Domain",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winGlobalDomainAddWizard"],["component","box","container","panel","window","winGlobalDomainAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winGlobalDomainAddWizard:true},["widget.winGlobalDomainAddWizard"],0,[Rd.view.globalDomains,"winGlobalDomainAddWizard"],0));(Ext.cmd.derive("Rd.controller.cGlobalDomains",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridGlobalDomains",border:true,itemId:"tabGlobalDomains",plain:true});d.populated=true},views:["globalDomains.gridGlobalDomains","globalDomains.winGlobalDomainEdit","globalDomains.winGlobalDomainAddWizard"],stores:["sAccessProvidersTree","sGlobalDomains","sCategories"],models:["mAccessProviderTree","mGlobalDomain","mCategory","mGenericList"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/global-domains/export-csv",urlAdd:"/cake3/rd_cake/global-domains/add.json",urlDelete:"/cake3/rd_cake/global-domains/delete.json",urlEdit:"/cake3/rd_cake/global-domains/edit.json"},refs:[{ref:"grid",selector:"gridGlobalDomains"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabGlobalDomains":{destroy:b.appClose},"gridGlobalDomains #reload":{click:b.reload},"gridGlobalDomains #add":{click:b.add},"gridGlobalDomains #delete":{click:b.del},"gridGlobalDomains #edit":{click:b.edit},gridGlobalDomains:{select:b.select},"winGlobalDomainAddWizard #btnTreeNext":{click:b.btnTreeNext},"winGlobalDomainAddWizard #btnDataPrev":{click:b.btnDataPrev},"winGlobalDomainAddWizard #btnDataNext":{click:b.btnDataNext},"winGlobalDomainEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winGlobalDomainAddWizardId")){var h=Ext.widget("winGlobalDomainAddWizard",{id:"winGlobalDomainAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winGlobalDomainAddWizardId")){var h=Ext.widget("winGlobalDomainAddWizard",{id:"winGlobalDomainAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winGlobalDomainAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winGlobalDomainAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sGlobalDomains").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winGlobalDomainEditId")){var i=Ext.widget("winGlobalDomainEdit",{id:"winGlobalDomainEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winGlobalDomainEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cGlobalDomains"],0));(Ext.cmd.derive("Rd.view.globalTags.gridGlobalTags",Ext.grid.Panel,{multiSelect:true,store:"sGlobalTags",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD5"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">Basic</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">Full</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridGD6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridGlobalTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalTags:true},["widget.gridGlobalTags"],0,[Rd.view.globalTags,"gridGlobalTags"],0));(Ext.cmd.derive("Rd.model.mGlobalTag",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mGlobalTag"],0));(Ext.cmd.derive("Rd.view.globalTags.winGlobalTagEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Global Tag",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winGlobalTagEdit"],["component","box","container","panel","window","winGlobalTagEdit"],{component:true,box:true,container:true,panel:true,window:true,winGlobalTagEdit:true},["widget.winGlobalTagEdit"],0,[Rd.view.globalTags,"winGlobalTagEdit"],0));(Ext.cmd.derive("Rd.store.sGlobalTags",Ext.data.Store,{model:"Rd.model.mGlobalTag",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-tags/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sGlobalTags"],0));(Ext.cmd.derive("Rd.view.globalTags.winGlobalTagAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Global Tag",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbProtectionLevel"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winGlobalTagAddWizard"],["component","box","container","panel","window","winGlobalTagAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winGlobalTagAddWizard:true},["widget.winGlobalTagAddWizard"],0,[Rd.view.globalTags,"winGlobalTagAddWizard"],0));(Ext.cmd.derive("Rd.view.globalTags.cmbProtectionLevel",Ext.form.ComboBox,{fieldLabel:"Protection Level",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"protection_level",labelClsExtra:"lblRd",value:"medium",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbProtectionLevel"],["component","box","field","textfield","pickerfield","combobox","combo","cmbProtectionLevel"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbProtectionLevel:true},["widget.cmbProtectionLevel"],0,[Rd.view.globalTags,"cmbProtectionLevel"],0));(Ext.cmd.derive("Rd.controller.cGlobalTags",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridGlobalTags",border:true,itemId:"tabGlobalTags",plain:true});d.populated=true},views:["globalTags.gridGlobalTags","globalTags.winGlobalTagEdit","globalTags.winGlobalTagAddWizard","globalTags.cmbProtectionLevel"],stores:["sAccessProvidersTree","sGlobalTags"],models:["mAccessProviderTree","mGlobalTag"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/global-tags/add.json",urlDelete:"/cake3/rd_cake/global-tags/delete.json",urlEdit:"/cake3/rd_cake/global-tags/edit.json"},refs:[{ref:"grid",selector:"gridGlobalTags"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabGlobalTags":{destroy:b.appClose},"gridGlobalTags #reload":{click:b.reload},"gridGlobalTags #add":{click:b.add},"gridGlobalTags #delete":{click:b.del},"gridGlobalTags #edit":{click:b.edit},gridGlobalTags:{select:b.select},"winGlobalTagAddWizard #btnTreeNext":{click:b.btnTreeNext},"winGlobalTagAddWizard #btnDataPrev":{click:b.btnDataPrev},"winGlobalTagAddWizard #btnDataNext":{click:b.btnDataNext},"winGlobalTagEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winGlobalTagAddWizardId")){var h=Ext.widget("winGlobalTagAddWizard",{id:"winGlobalTagAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winGlobalTagAddWizardId")){var h=Ext.widget("winGlobalTagAddWizard",{id:"winGlobalTagAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winGlobalTagAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winGlobalTagAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sGlobalTags").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winGlobalTagEditId")){var i=Ext.widget("winGlobalTagEdit",{id:"winGlobalTagEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winGlobalTagEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cGlobalTags"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpAdd",Ext.window.Window,{title:i18n("sAdd_Msgid"),layout:"fit",autoShow:true,width:300,iconCls:"add",glyph:Rd.config.icnAdd,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sMsgid"),name:"msgid",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please")},{xtype:"textfield",fieldLabel:i18n("sMsgstr"),name:"msgstr",allowBlank:true},{xtype:"textfield",name:"comment",fieldLabel:i18n("sOptional_Comment")}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpAdd"],["component","box","container","panel","window","winPhpAdd"],{component:true,box:true,container:true,panel:true,window:true,winPhpAdd:true},["widget.winPhpAdd"],0,[Rd.view.i18n,"winPhpAdd"],0));(Ext.cmd.derive("Rd.view.components.pnlBanner",Ext.panel.Panel,{margins:"0 0 0 0",height:52,layout:"fit",border:false,heading:"",image:"",initComponent:function(){var b=this;b.html="<div class='banner'><img style='float:left; margin-left:4px;' src='"+b.image+"'><h1>"+b.heading+"</h1></div>";Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlBanner"],["component","box","container","panel","pnlBanner"],{component:true,box:true,container:true,panel:true,pnlBanner:true},["widget.pnlBanner"],0,[Rd.view.components,"pnlBanner"],0));(Ext.cmd.derive("Rd.view.i18n.vPanI18n",Ext.tab.Panel,{defaults:{layout:"fit"},items:[{title:i18n("sJavascript_Phrases"),itemId:"JsPhrases",xtype:"gridJavascriptPhrases"},{title:i18n("sPHP_Phrases"),itemId:"PhpPhrases",xtype:"gridPhpPhrases"}],initComponent:function(){Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["i18nP"],["component","box","container","panel","tabpanel","i18nP"],{component:true,box:true,container:true,panel:true,tabpanel:true,i18nP:true},["widget.i18nP"],0,[Rd.view.i18n,"vPanI18n"],0));(Ext.cmd.derive("Rd.view.i18n.gridJavascriptPhrases",Ext.grid.Panel,{store:"sI18nJsPhrases",stateful:true,stateId:"StateGridJavascriptPhrases",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},border:false,columns:[{xtype:"rownumberer"},{text:i18n("sKey"),dataIndex:"key",tdCls:"grdBold"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"grdGrey"},{text:i18n("sEnglish_use_as_reference"),dataIndex:"english",tdCls:"grdItalic"},{text:i18n("sTranslated"),dataIndex:"translated",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:false},renderer:function(b){if((b=="(modify me)")||(b=="(new addition)")){return"<span class='new'>"+b+"</span"}else{return b}}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],tbar:[{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbLanguages",width:350}]},{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"splitbutton",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuNewKey"},{text:i18n("sLanguage_of_country"),iconCls:"language16",glyph:Rd.config.icnFlag,itemId:"mnuLanguageNew"}]}},{xtype:"splitbutton",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuDelKey"},{text:i18n("sCountry"),iconCls:"country16",glyph:Rd.config.icnCountry,itemId:"mnuDelCountry"},{text:i18n("sLanguage"),iconCls:"language16",glyph:Rd.config.icnLanguage,itemId:"mnuLanguageDel"}]}},{xtype:"splitbutton",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit"),menu:{items:[{text:i18n("sKey"),iconCls:"key16",glyph:Rd.config.icnKey,itemId:"mnuEditKey"},{text:i18n("sCountry"),iconCls:"country16",glyph:Rd.config.icnCountry,itemId:"mnuCountryEdit"},{text:i18n("sLanguage"),iconCls:"language16",glyph:Rd.config.icnLanguage,itemId:"mnuLanguageEdit"},{text:i18n("sCopy_phrases_from_language"),iconCls:"copy16",glyph:Rd.config.icnCopy,itemId:"mnuLanguageCopy"}]}}]}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]},0,["gridJavascriptPhrases"],["component","box","container","panel","tablepanel","gridpanel","grid","gridJavascriptPhrases"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridJavascriptPhrases:true},["widget.gridJavascriptPhrases"],0,[Rd.view.i18n,"gridJavascriptPhrases"],0));(Ext.cmd.derive("Rd.view.i18n.gridPhpPhrases",Ext.grid.Panel,{store:"sI18nPhpPhrases",stateful:true,stateId:"StateGridPhpPhrases",stateEvents:["groupclick","columnhide"],border:false,multiSelect:true,viewConfig:{preserveScrollOnRefresh:true},columns:[{xtype:"rownumberer"},{text:"Comments",dataIndex:"comment",tdCls:"grdGrey"},{text:"Msgid",dataIndex:"msgid",tdCls:"grdBold"},{text:"Msgstr",dataIndex:"msgstr",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:true}}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],tbar:[{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbLanguages",width:350}]},{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")}]},{xtype:"buttongroup",title:i18n("sPHP_Phrases"),items:[{xtype:"button",iconCls:"b-copy",glyph:Rd.config.icnCopy,scale:"large",itemId:"copy",tooltip:i18n("sCopy")},{xtype:"button",iconCls:"b-meta_edit",glyph:Rd.config.icnMeta,scale:"large",itemId:"meta",tooltip:i18n("sEdit_meta_info")},{xtype:"button",iconCls:"b-comment",glyph:Rd.config.icnNote,scale:"large",itemId:"comment",tooltip:i18n("sAdd_comment")}]}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]},0,["gridPhpPhrases"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPhpPhrases"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPhpPhrases:true},["widget.gridPhpPhrases"],0,[Rd.view.i18n,"gridPhpPhrases"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpMeta",Ext.window.Window,{title:i18n("sSpecify_Meta_data"),layout:"fit",autoShow:true,width:400,height:450,resizable:false,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,autoScroll:true,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:"Project-Id-Version",name:"Project-Id-Version",allowBlank:false,blankText:i18n("sEnter")+" Enter Project-Id-Version"},{xtype:"textfield",fieldLabel:"POT-Creation-Date",name:"POT-Creation-Date",allowBlank:false,blankText:i18n("sEnter")+" POT-Creation-Date"},{xtype:"textfield",fieldLabel:"PO-Revision-Date",name:"PO-Revision-Date",allowBlank:false,blankText:i18n("sEnter")+" PO-Revision-Date"},{xtype:"textfield",fieldLabel:"Last-Translator",name:"Last-Translator",allowBlank:false,blankText:i18n("sEnter")+" Last-Translator"},{xtype:"textfield",fieldLabel:"Language-Team",name:"Language-Team",allowBlank:false,blankText:i18n("sEnter")+" Language-Team"},{xtype:"textfield",fieldLabel:"MIME-Version",name:"MIME-Version",allowBlank:false,blankText:i18n("sEnter")+"  MIME-Version"},{xtype:"textfield",fieldLabel:"Content-Type",name:"Content-Type",allowBlank:false,blankText:i18n("sEnter")+" Content-Type"},{xtype:"textfield",fieldLabel:"Content-Transfer-Encoding",name:"Content-Transfer-Encoding",allowBlank:false,blankText:i18n("sEnter")+" Content-Transfer-Encoding"},{xtype:"textfield",fieldLabel:"Plural-Forms",name:"Plural-Forms",allowBlank:false,blankText:i18n("sEnter")+" Plural-Forms"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpMeta"],["component","box","container","panel","window","winPhpMeta"],{component:true,box:true,container:true,panel:true,window:true,winPhpMeta:true},["widget.winPhpMeta"],0,[Rd.view.i18n,"winPhpMeta"],0));(Ext.cmd.derive("Rd.model.mI18nMeta",Ext.data.Model,{fields:["Project-Id-Version","POT-Creation-Date","PO-Revision-Date","Last-Translator","Language-Team","MIME-Version","Content-Type","Content-Transfer-Encoding","Plural-Forms"],idProperty:"Project-Id-Version",proxy:{type:"ajax",url:"/cake2/rd_cake/php_phrases/get_metadata.json",format:"json",batchActions:false,reader:{type:"json",rootProperty:"items",messageProperty:"message"}}},0,0,0,0,0,0,[Rd.model,"mI18nMeta"],0));(Ext.cmd.derive("Rd.view.components.vCmbCountries",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_country"),labelSeparator:"",store:"sCountries",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbCountry",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name} ({iso_code})"><div class="combo-wrapper"><img src="{icon_file}" /><div class="combo-country">{name}</div><div class="combo-language"> {iso_code}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["vCmbCountries"],["component","box","field","textfield","pickerfield","combobox","combo","vCmbCountries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,vCmbCountries:true},["widget.vCmbCountries"],0,[Rd.view.components,"vCmbCountries"],0));(Ext.cmd.derive("Rd.view.i18n.vWinCountryEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Countries"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var e=h.mkScrnCountryEdit();var g=h.mkScrnCountryEditDo();this.items=[e,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnCountryEdit:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_country_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"vCmbCountries"}],buttons:[{itemId:"btnCountryEditNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",glyph:Rd.config.icnNext,iconCls:"b-next"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnCountryEdit",items:[g,h]});return e},mkScrnCountryEditDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sCountry_name"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sCountry_name"),blankText:i18n("sSpecify_a_valid_name_please")},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_ZA_or_DE"),blankText:i18n("sSpecify_a_valid_iso_country_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:uppercase"},{xtype:"filefield",name:"icon",fieldLabel:i18n("sFlag_icon"),allowBlank:false,buttonText:i18n("sSelect_Icon")+"..."}],buttons:[{itemId:"btnCountryEditDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnCountryEditDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnCountryEditDo",items:[g,h]});return e}},0,["vWinCountryEdit"],["component","box","container","panel","window","vWinCountryEdit"],{component:true,box:true,container:true,panel:true,window:true,vWinCountryEdit:true},["widget.vWinCountryEdit"],0,[Rd.view.i18n,"vWinCountryEdit"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Language"),width:380,height:420,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var j=this;var h=j.mkScrnIntro();var g=j.mkScrnNewCountry();var i=j.mkScrnNewLanguage();this.items=[h,g,i];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnIntro:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_an_existing_country_to_add_a_language_to_fs")+" "+i18n("sAlternatively_choose_to_create_a_new_country_fs"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"vCmbCountries"},{xtype:"fieldcontainer",defaultType:"checkboxfield",defaults:{flex:1},layout:"vbox",items:[{boxLabel:i18n("sCreate_new_country"),name:"chkNewCountry",inputValue:"1",itemId:"chkNewCountry",checked:true}]}],buttons:[{itemId:"btnIntroNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnIntro",items:[g,h]});return e},mkScrnNewCountry:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,overflowY:"auto",bodyPadding:10,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sCountry_name"),itemId:"inpNewCountry",allowBlank:false,emptyText:"country name",blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_ZA_or_DE"),blankText:i18n("sSpecify_a_valid_iso_country_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:uppercase",textValid:true,validator:function(){return this.textValid}},{xtype:"filefield",name:"icon",fieldLabel:i18n("sFlag_icon"),allowBlank:false,buttonText:i18n("sSelect_Icon")+"..."}],buttons:[{itemId:"btnNewCountryPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnNewCountryNext",text:i18n("sNext"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{itemId:"scrnNewCountry",layout:"vbox",border:false,items:[g,h]});return e},mkScrnNewLanguage:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,overflowY:"auto",bodyPadding:10,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sLanguage"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sLanguage"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_pt_or_de"),blankText:i18n("sSpecify_a_valid_iso_language_code"),maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:lowercase",textValid:true,validator:function(){return this.textValid}},{xtype:"checkbox",boxLabel:i18n("sRight_to_left"),name:"rtl",inputValue:"rtl",checked:false}],buttons:[{itemId:"btnNewLanguagePrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack},{itemId:"btnNewLanguageNext",text:i18n("sNext"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{itemId:"scrnNewLanguage",layout:"vbox",border:false,items:[g,h]});return e}},0,["addLanguageW"],["component","box","container","panel","window","addLanguageW"],{component:true,box:true,container:true,panel:true,window:true,addLanguageW:true},["widget.addLanguageW"],0,[Rd.view.i18n,"vWinLanguageAdd"],0));(Ext.cmd.derive("Rd.model.mI18nJsPhrase",Ext.data.Model,{fields:["id","key","comment","english","translated","key_id"]},0,0,0,0,0,0,[Rd.model,"mI18nJsPhrase"],0));(Ext.cmd.derive("Rd.store.sI18nJsPhrases",Ext.data.Store,{model:"Rd.model.mI18nJsPhrase",proxy:{type:"rest",url:"/cake2/rd_cake/phrase_values/list_phrases_for",format:"json",api:{update:"/cake2/rd_cake/phrase_values/update_phrase",destroy:"/cake2/rd_cake/phrase_values/delete_keys"},reader:{type:"json",rootProperty:"items"}},listeners:{update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nJsPhrases"],0));(Ext.cmd.derive("Rd.model.mI18nCountry",Ext.data.Model,{fields:["id","name","iso_code","icon_file"]},0,0,0,0,0,0,[Rd.model,"mI18nCountry"],0));(Ext.cmd.derive("Rd.store.sCountries",Ext.data.Store,{model:"Rd.model.mI18nCountry",proxy:{type:"rest",url:"/cake2/rd_cake/countries",format:"json",reader:{type:"json",rootProperty:"items"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sCountries"],0));(Ext.cmd.derive("Rd.model.mI18nLanguage",Ext.data.Model,{fields:["id","name","iso_code","rtl"]},0,0,0,0,0,0,[Rd.model,"mI18nLanguage"],0));(Ext.cmd.derive("Rd.store.sJustLanguages",Ext.data.Store,{model:"Rd.model.mI18nLanguage",proxy:{type:"rest",url:"/cake2/rd_cake/languages",format:"json",reader:{type:"json",rootProperty:"items"}},listeners:{update:function(g,h,i,j){g.sync({success:function(a,b){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(a,b){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sJustLanguages"],0));(Ext.cmd.derive("Rd.model.mI18nKey",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"comment",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mI18nKey"],0));(Ext.cmd.derive("Rd.store.sI18nPhraseKeys",Ext.data.Store,{model:"Rd.model.mI18nKey",proxy:{type:"rest",url:"/cake2/rd_cake/phrase_keys",format:"json",reader:{type:"json",rootProperty:"items"}},listeners:{update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("Database could not be updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nPhraseKeys"],0));(Ext.cmd.derive("Rd.model.mI18nPhpPhrase",Ext.data.Model,{fields:["id","comment","msgid","msgstr"]},0,0,0,0,0,0,[Rd.model,"mI18nPhpPhrase"],0));(Ext.cmd.derive("Rd.store.sI18nPhpPhrases",Ext.data.Store,{model:"Rd.model.mI18nPhpPhrase",proxy:{type:"rest",url:"/cake2/rd_cake/php_phrases",format:"json",api:{},reader:{type:"json",rootProperty:"items"}},listeners:{load:function(e,g,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),e.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(k,l,a,b,m,n){if(a=="edit"){k.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_database"),i18n("sDatabase_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_database"),i18n("sDatabase_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sI18nPhpPhrases"],0));(Ext.cmd.derive("Rd.view.components.winHelp",Ext.window.Window,{title:i18n("sOnline_help"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"help",glyph:Rd.config.icnHelp,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true,stateful:true,stateId:"winHelpWin",srcUrl:"https://sourceforge.net/p/radiusdesk/wiki/",initComponent:function(){var b=this;b.items=[{xtype:"component",itemId:"ifrm",autoEl:{tag:"iframe",src:b.srcUrl}}];Ext.window.Window.prototype.initComponent.apply(this,arguments)},setSrc:function(d){console.log("change");me=this;var e=me.down("#ifrm");console.log(e);e.getEl().dom.src=d}},0,["winHelp"],["component","box","container","panel","window","winHelp"],{component:true,box:true,container:true,panel:true,window:true,winHelp:true},["widget.winHelp"],0,[Rd.view.components,"winHelp"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpCopy",Ext.window.Window,{title:i18n("sCopy_from_another_language"),layout:"fit",autoShow:true,width:300,iconCls:"copy",glyph:Rd.config.icnCopy,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sSource"),itemId:"source",name:"source",allowBlank:false},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sDestination"),itemId:"destination",name:"destination",allowBlank:false},{xtype:"checkbox",boxLabel:i18n("sMaintain_existing_translations"),name:"maintain_existing",inputValue:"remove",checked:true}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpCopy"],["component","box","container","panel","window","winPhpCopy"],{component:true,box:true,container:true,panel:true,window:true,winPhpCopy:true},["widget.winPhpCopy"],0,[Rd.view.i18n,"winPhpCopy"],0));(Ext.cmd.derive("Rd.view.i18n.vWinI18n",Ext.window.Window,{width:600,height:400,layout:"fit",title:i18n("si18n_Manager"),stateful:true,stateId:"stateWin",icon:"resources/images/16x16/i18n.png",items:[{xtype:"i18nP"}],initComponent:function(){Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["i18nW"],["component","box","container","panel","window","i18nW"],{component:true,box:true,container:true,panel:true,window:true,i18nW:true},["widget.i18nW"],0,[Rd.view.i18n,"vWinI18n"],0));(Ext.cmd.derive("Rd.view.components.vCmbJustLanguages",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sJustLanguages",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbJustLanguage",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name}"><div class="combo-wrapper"><div class="combo-country"> {name}</div><div class="combo-language"> {iso_code}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbJustLanguages"],["component","box","field","textfield","pickerfield","combobox","combo","cmbJustLanguages"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbJustLanguages:true},["widget.cmbJustLanguages"],0,[Rd.view.components,"vCmbJustLanguages"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageDel",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sDelete_language"),width:380,height:300,plain:true,border:false,layout:"vbox",bodyCls:"bodyCls",iconCls:"delete",glyph:Rd.config.icnDelete,items:[{xtype:"panel",border:false,baseCls:"regMsg",html:i18n("sSelect_the_language_to_delete_fs")+" "+i18n("sMake_sure_you_know_what_you_are_doing_fs"),width:"100%"},{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},items:[{xtype:"cmbJustLanguages",name:"id"}],buttons:[{itemId:"btnLanguageDelNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0",formBind:true}]}],defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["delLanguageW"],["component","box","container","panel","window","delLanguageW"],{component:true,box:true,container:true,panel:true,window:true,delLanguageW:true},["widget.delLanguageW"],0,[Rd.view.i18n,"vWinLanguageDel"],0));(Ext.cmd.derive("Rd.view.i18n.vCmbPhraseKeys",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_key"),labelSeparator:"",store:"sI18nPhraseKeys",queryMode:"local",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",itemId:"cmbPhraseKey",listConfig:{getInnerTpl:function(){return'<div data-qtip="{name}"><div class="combo-wrapper"><div class="combo-country">{name}</div><div class="combo-language"> {comment}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPhraseKeys"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPhraseKeys"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPhraseKeys:true},["widget.cmbPhraseKeys"],0,[Rd.view.i18n,"vCmbPhraseKeys"],0));(Ext.cmd.derive("Rd.view.i18n.vWinKeyEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Key"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var e=this;var h=e.mkScrnEditKey();var g=e.mkScrnEditKeyDo();this.items=[h,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnEditKey:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_key_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbPhraseKeys"}],buttons:[{itemId:"btnEditKeyNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditKey",items:[g,h]});return e},mkScrnEditKeyDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",id:"name",fieldLabel:i18n("sKey_name"),itemId:"inpNewKey",allowBlank:false,emptyText:i18n("sKey_name"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{xtype:"textareafield",grow:true,name:"comment",id:"comment",fieldLabel:i18n("sComment"),anchor:"100%"}],buttons:[{itemId:"btnEditKeyDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnEditKeyDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditKeyDo",items:[g,h]});return e}},0,["editKeyW"],["component","box","container","panel","window","editKeyW"],{component:true,box:true,container:true,panel:true,window:true,editKeyW:true},["widget.editKeyW"],0,[Rd.view.i18n,"vWinKeyEdit"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpComment",Ext.window.Window,{title:i18n("sAdd_comment_to_msgid"),layout:"fit",autoShow:true,width:300,iconCls:"edit",glyph:Rd.config.icnEdit,msgid:"",initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"msgid",value:b.msgid,hidden:true},{xtype:"checkbox",boxLabel:i18n("sRemove_existing_comments"),name:"remove_existing",inputValue:"remove",checked:true},{xtype:"textfield",name:"comment",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please"),fieldLabel:i18n("sComment")}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpComment"],["component","box","container","panel","window","winPhpComment"],{component:true,box:true,container:true,panel:true,window:true,winPhpComment:true},["widget.winPhpComment"],0,[Rd.view.i18n,"winPhpComment"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageCopy",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sCopy_phrases_from_language"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"copy",glyph:Rd.config.icnCopy,defaults:{border:false},initComponent:function(){var e=this;var d=e.mkScrnLanguageCopy();this.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnLanguageCopy:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sChoose_an_existing_language_to_copy_the_phrases_from"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbLanguages",fieldLabel:i18n("sAvailable_languages"),allowBlank:false}],buttons:[{itemId:"btnLanguageCopyNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageCopy",items:[g,h]});return e}},0,["vWinLanguageCopy"],["component","box","container","panel","window","vWinLanguageCopy"],{component:true,box:true,container:true,panel:true,window:true,vWinLanguageCopy:true},["widget.vWinLanguageCopy"],0,[Rd.view.i18n,"vWinLanguageCopy"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguageEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sEdit_Languages"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var g=h.mkScrnLanguageEdit();var e=h.mkScrnLanguageEditDo();this.items=[g,e];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnLanguageEdit:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSelect_a_language_to_edit"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbJustLanguages"}],buttons:[{itemId:"btnLanguageEditNext",text:i18n("sNext"),scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageEdit",items:[g,h]});return e},mkScrnLanguageEditDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sLanguage"),itemId:"inpNewCountry",allowBlank:false,emptyText:i18n("sLanguage"),blankText:i18n("sSpecify_a_valid_name_please"),textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:i18n("sISO_code"),itemId:"inpNewIso",allowBlank:false,emptyText:i18n("seg_pt_or_de"),blankText:i18n("sSpecify_a_valid_iso_language_code"),textValid:true,maskRe:/[a-z]/i,minLength:2,maxLength:2,fieldStyle:"text-transform:lowercase",validator:function(){return this.textValid}},{xtype:"checkbox",boxLabel:i18n("sRight_to_left"),name:"rtl",inputValue:"rtl",checked:false}],buttons:[{itemId:"btnLanguageEditDoPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnLanguageEditDoNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnLanguageEditDo",items:[g,h]});return e}},0,["vWinLanguageEdit"],["component","box","container","panel","window","vWinLanguageEdit"],{component:true,box:true,container:true,panel:true,window:true,vWinLanguageEdit:true},["widget.vWinLanguageEdit"],0,[Rd.view.i18n,"vWinLanguageEdit"],0));(Ext.cmd.derive("Rd.view.i18n.vWinKeyAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_Key"),width:380,height:380,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var d=this;var e=d.mkScrnNewKey();this.items=[e];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnNewKey:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:i18n("sSupply_the_following_detail_please"),width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:i18n("sKey_name"),itemId:"inpNewKey",allowBlank:false,emptyText:i18n("sKey_name"),blankText:i18n("sSpecify_a_valid_name_for_the_key"),textValid:true,validator:function(){return this.textValid}},{xtype:"textareafield",grow:true,name:"comment",fieldLabel:i18n("sComment"),anchor:"100%"}],buttons:[{itemId:"btnNewKeyNext",text:i18n("sNext"),scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnNewKey",items:[g,h]});return e}},0,["addKeyW"],["component","box","container","panel","window","addKeyW"],{component:true,box:true,container:true,panel:true,window:true,addKeyW:true},["widget.addKeyW"],0,[Rd.view.i18n,"vWinKeyAdd"],0));(Ext.cmd.derive("Rd.view.i18n.vWinCountryDel",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sDelete_country"),width:380,height:300,plain:true,border:false,layout:"vbox",bodyCls:"bodyCls",iconCls:"delete",glyph:Rd.config.icnDelete,items:[{xtype:"panel",border:false,baseCls:"regMsg",html:i18n("sSelect_the_country_to_delete_fs_Make_sure_you_know_what_you_are_doing"),width:"100%"},{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},items:[{xtype:"vCmbCountries",name:"id"}],buttons:[{itemId:"btnCountryDelNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0",formBind:true}]}],defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["delCountryW"],["component","box","container","panel","window","delCountryW"],{component:true,box:true,container:true,panel:true,window:true,delCountryW:true},["widget.delCountryW"],0,[Rd.view.i18n,"vWinCountryDel"],0));(Ext.cmd.derive("Rd.view.i18n.winPhpEdit",Ext.window.Window,{title:i18n("sEdit_Msgid"),layout:"fit",autoShow:true,width:300,iconCls:"edit",glyph:Rd.config.icnEdit,old_msgid:"",initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"old_msgid",value:b.old_msgid,hidden:true},{xtype:"displayfield",fieldLabel:i18n("sPrevious_value"),value:b.old_msgid},{xtype:"textfield",fieldLabel:i18n("sMsgid"),name:"msgid",allowBlank:false,blankText:i18n("sSpecify_a_valid_name_please")}],buttons:[{itemId:"save",text:i18n("OK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 15 10 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPhpEdit"],["component","box","container","panel","window","winPhpEdit"],{component:true,box:true,container:true,panel:true,window:true,winPhpEdit:true},["widget.winPhpEdit"],0,[Rd.view.i18n,"winPhpEdit"],0));(Ext.cmd.derive("Rd.controller.cI18n",Ext.app.Controller,{actionIndex:function(){var g=this;var h=this.application.getController("cDesktop");var e=h.getWindow("i18nWin");if(!e){e=h.createWindow({id:"i18nWin",btnText:i18n("si18n_Manager"),width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"translate",glyph:Rd.config.icnTranslate,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"i18nWin",tools:[{type:"help",tooltip:i18n("sGet_Help")}],items:[{region:"north",xtype:"pnlBanner",heading:i18n("sTranslation_management"),image:"resources/images/48x48/i18n.png"},{xtype:"i18nP",region:"center"}]})}h.restoreWindow(e);return e},views:["components.pnlBanner","i18n.vPanI18n","i18n.vWinLanguageAdd","i18n.vWinKeyAdd","i18n.vWinCountryDel","i18n.vWinLanguageDel","i18n.vWinKeyEdit","i18n.vWinLanguageEdit","i18n.vWinCountryEdit","i18n.vWinLanguageCopy","i18n.gridPhpPhrases","i18n.gridJavascriptPhrases","i18n.winPhpAdd","i18n.winPhpEdit","i18n.winPhpComment","i18n.winPhpCopy","i18n.winPhpMeta","components.winHelp"],stores:["sI18nJsPhrases","sLanguages","sCountries","sJustLanguages","sI18nPhraseKeys","sI18nPhpPhrases"],models:["mI18nMeta"],config:{urlCountryAdd:"/cake2/rd_cake/countries/add",urlLanguageAdd:"/cake2/rd_cake/phrase_values/add_language.json",urlKeyAdd:"/cake2/rd_cake/phrase_values/add_key.json",urlCountryDel:"/cake2/rd_cake/countries/delete.json",urlLanguageDel:"/cake2/rd_cake/languages/delete.json",urlLanguageCopy:"/cake2/rd_cake/phrase_values/copy_phrases.json",urlPhpDel:"/cake2/rd_cake/php_phrases/delete.json",urlPhpAdd:"/cake2/rd_cake/php_phrases/add.json",urlPhpEditMsgid:"/cake2/rd_cake/php_phrases/update_msgid.json",urlPhpComment:"/cake2/rd_cake/php_phrases/comment.json",urlPhpCopy:"/cake2/rd_cake/php_phrases/copy.json",urlPhpMeta:"/cake2/rd_cake/php_phrases/save_meta.json",urlHelp:"http://sourceforge.net/p/radiusdesk/wiki/i18n/"},refs:[{ref:"vp",selector:"",xtype:"vp",autoCreate:true},{ref:"i18nW",selector:"",xtype:"i18nW",autoCreate:true},{ref:"i18nP",selector:"",xtype:"i18nP",autoCreate:true},{ref:"jsGrid",selector:"#JsPhrases",xtype:"grid",autoCreate:true},{ref:"phpGrid",selector:"#PhpPhrases",xtype:""}],selCountry:null,selLanguage:null,selPhpLanguage:null,init:function(){var b=this;if(b.inited){return}b.inited=true;b.getStore("sI18nPhpPhrases").addListener("load",b.onStorePhpPhrasesSizeChange,b);b.getStore("sI18nJsPhrases").addListener("load",b.onStoreJsPhrasesSizeChange,b);b.control({"#JsPhrases  #reload":{click:b.jsGridReload},"#JsPhrases cmbLanguages":{change:b.onCmbLanguagesChange},"#JsPhrases  #mnuLanguageNew":{click:b.newLanguageWin},"#JsPhrases  #mnuNewKey":{click:b.newKeyWin},"addLanguageW #btnIntroNext":{click:b.btnIntroNext},"addLanguageW #btnNewCountryPrev":{click:b.btnNewCountryPrev},"addLanguageW #btnNewCountryNext":{click:b.btnNewCountryNext},"addLanguageW #btnNewLanguagePrev":{click:b.btnNewLanguagePrev},"addLanguageW #btnNewLanguageNext":{click:b.btnNewLanguageNext},"addLanguageW vCmbCountries":{change:b.onCmbCountriesChange},"addKeyW #btnNewKeyNext":{click:b.btnNewKeyNext},"#JsPhrases  #mnuLanguageDel":{click:b.languageDel},"#JsPhrases  #mnuDelCountry":{click:b.delCountry},"#JsPhrases  #mnuDelKey":{click:b.delKey},"delCountryW #btnCountryDelNext":{click:b.btnCountryDelNext},"delLanguageW #btnLanguageDelNext":{click:b.btnLanguageDelNext},"#JsPhrases  #mnuLanguageEdit":{click:b.editLanguage},"#JsPhrases  #mnuCountryEdit":{click:b.countryEdit},"#JsPhrases  #mnuEditKey":{click:b.editKey},"editKeyW #btnEditKeyNext":{click:b.btnEditKeyNext},"editKeyW #btnEditKeyDoPrev":{click:b.btnEditKeyDoPrev},"editKeyW #btnEditKeyDoNext":{click:b.btnEditKeyDoNext},"vWinLanguageEdit #btnLanguageEditNext":{click:b.btnLanguageEditNext},"vWinLanguageEdit #btnLanguageEditDoPrev":{click:b.btnLanguageEditDoPrev},"vWinLanguageEdit #btnLanguageEditDoNext":{click:b.btnLanguageEditDoNext},"vWinCountryEdit #btnCountryEditNext":{click:b.btnCountryEditNext},"vWinCountryEdit #btnCountryEditDoPrev":{click:b.btnCountryEditDoPrev},"vWinCountryEdit #btnCountryEditDoNext":{click:b.btnCountryEditDoNext},"#JsPhrases  #mnuLanguageCopy":{click:b.languageCopy},"vWinLanguageCopy #btnLanguageCopyNext":{click:b.btnLanguageCopyNext},"#PhpPhrases  #reload":{click:b.phpGridReload},"#PhpPhrases cmbLanguages":{change:b.onPhpCmbLanguagesChange},"#PhpPhrases #delete":{click:b.phpDelete},"#PhpPhrases #add":{click:b.phpAdd},"winPhpAdd #save":{click:b.phpAddSubmit},"#PhpPhrases #edit":{click:b.phpEdit},"#PhpPhrases":{itemclick:b.phpGridClick},"winPhpEdit #save":{click:b.phpEditSubmit},"#PhpPhrases #comment":{click:b.phpComment},"winPhpComment #save":{click:b.phpCommentSubmit},"#PhpPhrases #copy":{click:b.phpCopy},"winPhpCopy #save":{click:b.phpCopySubmit},"#PhpPhrases #meta":{click:b.phpMeta},"winPhpMeta #save":{click:b.phpMetaSubmit},"#i18nWin tool[type=help]":{click:b.help}})},help:function(){var g=this;var j=g.application.runAction("cDesktop","AlreadyExist","winHelpId");var i=i18n("sOnline_help_for_Translation_Manager");if(!j){var h=Ext.widget("winHelp",{id:"winHelpId",title:i,srcUrl:g.getUrlHelp()});g.application.runAction("cDesktop","Add",h)}else{j.setSrc(g.getUrlHelp());j.setTitle(i)}},jsGridReload:function(){var b=this;this.getJsGrid().getStore().getProxy().setExtraParam("language",b.selLanguage);this.getJsGrid().getStore().load()},newLanguageWin:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","addLanguageWId")){var e=Ext.widget("addLanguageW",{id:"addLanguageWId"});d.application.runAction("cDesktop","Add",e)}},newKeyWin:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","addKeyWId")){var e=Ext.widget("addKeyW",{id:"addKeyWId"});d.application.runAction("cDesktop","Add",e)}},btnIntroNext:function(b){var h=this;var i=b.up("form");var j=b.up("addLanguageW");if(i.down("#chkNewCountry").getValue()){j.getLayout().setActiveItem("scrnNewCountry")}else{h.selCountry=i.down("vCmbCountries").getValue();if(h.selCountry==null){Ext.ux.Toaster.msg(i18n("sSelect_a_country"),i18n("sYou_are_required_to_select_a_country"),Ext.ux.Constants.clsError,Ext.ux.Constants.msgError)}else{j.getLayout().setActiveItem("scrnNewLanguage")}}},btnNewCountryPrev:function(b){var g=this;var h=b.up("addLanguageW");h.getLayout().setActiveItem("scrnIntro")},btnNewCountryNext:function(b){var h=this;var j=b.up("addLanguageW");var i=b.up("form");i.submit({url:h.getUrlCountryAdd(),waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){h.selCountry=d.result.id;Ext.ux.Toaster.msg(i18n("sCountry_added"),i18n("sNew_country_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore("sCountries").load();j.getLayout().setActiveItem("scrnNewLanguage")},failure:Ext.ux.formFail})},btnNewLanguagePrev:function(b){var g=this;var h=b.up("addLanguageW");h.getLayout().setActiveItem("scrnIntro")},btnNewLanguageNext:function(b){var i=this;var h=b.up("addLanguageW");var j=b.up("form");j.submit({url:i.getUrlLanguageAdd(),params:{country_id:i.selCountry},waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.completeReload();h.close()}})},onCmbCountriesChange:function(j,k,i){var l=this;var h=j.up("form");h.down("#chkNewCountry").setValue(false)},onCmbLanguagesChange:function(i,j,h){var g=this;g.selLanguage=j;g.jsGridReload()},btnNewKeyNext:function(b){var i=this;var j=b.up("form");var h=b.up("addKeyW");j.submit({url:i.getUrlKeyAdd(),waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.jsGridReload();h.close()},failure:Ext.ux.formFail})},delKey:function(){var b=this;if(b.getJsGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_a_key"),i18n("sYou_are_required_to_select_a_key_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){b.getJsGrid().getStore().remove(b.getJsGrid().getSelectionModel().getSelection());b.getJsGrid().getStore().sync({success:function(g,h){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(g,h){Ext.ux.Toaster.msg(i18n("sProblems_deleting_key"),i18n("sThere_were_some_problems_experienced_during_the_deleting_of_the_key"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}})}},languageDel:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","delLanguageWId")){var e=Ext.widget("delLanguageW",{id:"delLanguageWId"});d.application.runAction("cDesktop","Add",e)}},delCountry:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","delCountryWId")){var e=Ext.widget("delCountryW",{id:"delCountryWId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageDelNext:function(b){var h=this;var g=b.up("delLanguageW");Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=b.up("form");a.submit({url:h.getUrlLanguageDel(),waitMsg:i18n("sSending_the_info")+"...",success:function(j,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.completeReload();g.close()}})}})},btnCountryDelNext:function(b){var h=this;var g=b.up("delCountryW");Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=b.up("form");a.submit({url:h.getUrlCountryDel(),waitMsg:i18n("sSending_the_info")+"...",success:function(j,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.completeReload();g.close()}})}})},editKey:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","editKeyWId")){var e=Ext.widget("editKeyW",{id:"editKeyWId"});d.application.runAction("cDesktop","Add",e)}},btnEditKeyDoPrev:function(b){var g=this;var h=b.up("editKeyW");h.getLayout().setActiveItem("scrnEditKey")},btnEditKeyNext:function(m){var n=this;var s=m.up("form");var q=s.down("cmbPhraseKeys");var r=q.getValue();var t=q.findRecord("id",r);var b=m.up("editKeyW");var p=b.down("#scrnEditKeyDo");var o=p.down("form");o.loadRecord(t);b.getLayout().setActiveItem("scrnEditKeyDo")},btnEditKeyDoNext:function(b){var j=this;var m=b.up("editKeyW");var k=b.up("form");var n=k.getRecord();var l=k.getValues();n.set(l);j.completeReload();m.close()},editLanguage:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinLanguageEditId")){var e=Ext.widget("vWinLanguageEdit",{id:"vWinLanguageEditId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageEditNext:function(m){var n=this;var s=m.up("form");var r=s.down("cmbJustLanguages");var p=r.getValue();var t=r.findRecord("id",p);var b=m.up("vWinLanguageEdit");var q=b.down("#scrnLanguageEditDo");var o=q.down("form");o.loadRecord(t);b.getLayout().setActiveItem("scrnLanguageEditDo")},btnLanguageEditDoPrev:function(b){var g=this;var h=b.up("vWinLanguageEdit");h.getLayout().setActiveItem("scrnLanguageEdit")},btnLanguageEditDoNext:function(b){var j=this;var m=b.up("vWinLanguageEdit");var k=b.up("form");var n=k.getRecord();var l=k.getValues();if(l.rtl==undefined){l.rtl=false}n.set(l);j.completeReload();m.close()},countryEdit:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinCountryEditId")){var e=Ext.widget("vWinCountryEdit",{id:"vWinCountryEditId"});d.application.runAction("cDesktop","Add",e)}},btnCountryEditNext:function(n){var o=this;var s=n.up("form");var r=s.down("vCmbCountries");var b=r.getValue();var t=r.findRecord("id",b);var m=n.up("vWinCountryEdit");var q=m.down("#scrnCountryEditDo");var p=q.down("form");p.loadRecord(t);m.getLayout().setActiveItem("scrnCountryEditDo")},btnCountryEditDoPrev:function(b){var g=this;var h=b.up("vWinCountryEdit");h.getLayout().setActiveItem("scrnCountryEdit")},btnCountryEditDoNext:function(b){var k=this;var n=b.up("vWinCountryEdit");var l=b.up("form");var j=n.down("vCmbCountries");var m=j.getValue();l.submit({url:k.getUrlCountryAdd()+"/"+m,waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){k.selCountry=d.result.id;Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.completeReload();n.close()}})},languageCopy:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","vWinLanguageCopyId")){var e=Ext.widget("vWinLanguageCopy",{id:"vWinLanguageCopyId"});d.application.runAction("cDesktop","Add",e)}},btnLanguageCopyNext:function(b){var k=this;var n=b.up("vWinLanguageCopy");var l=b.up("form");var j=l.down("cmbLanguages");var m=j.getValue();if(k.selLanguage==null){Ext.ux.Toaster.msg(i18n("sNo_target_language"),i18n("sFirst_select_a_language_that_you_want_to_use_as_destination"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}if(k.selLanguage==m){Ext.ux.Toaster.msg(i18n("sFruitless_action"),i18n("sRefusing_this_action_since_source_and_destination_is_the_same"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}l.submit({url:k.getUrlLanguageCopy(),params:{source_id:m,destination_id:k.selLanguage},waitMsg:i18n("sSending_the_info")+"...",success:function(a,d){Ext.ux.Toaster.msg(i18n("sKey_added"),i18n("sNew_Key_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);k.jsGridReload();n.close()}})},completeReload:function(){var b=this;b.getStore("sJustLanguages").load();b.getStore("sCountries").load();b.getStore("sLanguages").load();b.jsGridReload()},phpGridReload:function(){var b=this;b.getPhpGrid().getStore().getProxy().setExtraParam("language",b.selPhpLanguage);this.getPhpGrid().getStore().load()},onPhpCmbLanguagesChange:function(i,j,h){var g=this;g.selPhpLanguage=j;g.phpGridReload()},phpAdd:function(){var d=this;if(d.selPhpLanguage==null){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!d.application.runAction("cDesktop","AlreadyExist","winPhpAddId")){var e=Ext.widget("winPhpAdd",{id:"winPhpAddId"});d.application.runAction("cDesktop","Add",e)}}},phpAddSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpAdd()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpDelete:function(){var b=this;if(b.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.Msg.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(j){if(j=="yes"){var m=b.getPhpGrid().getSelectionModel().getSelection();var k={};var l;var n;Ext.each(m,function(e,d){l=e.get("msgid");n="item_"+d;k[n]=l});var a=b.getUrlPhpDel()+"?language="+b.selPhpLanguage;Ext.Ajax.request({url:a,params:k,success:function(e){var d=Ext.JSON.decode(e.responseText);b.getPhpGrid().getStore().load();if(d.success){Ext.ux.Toaster.msg(i18n("sItem_br_s_br_removed"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}else{Ext.ux.Toaster.msg(i18n("sProblem_deleting"),i18n("sItems_could_not_be_deleted"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}})}},phpEdit:function(){var h=this;if(h.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getPhpGrid().getSelectionModel().getCount()<1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=h.phpSelectedRecord.get("msgid");if(!h.application.runAction("cDesktop","AlreadyExist","winPhpEditId")){var g=Ext.widget("winPhpEdit",{id:"winPhpEditId",old_msgid:e});h.application.runAction("cDesktop","Add",g)}}}},phpEditSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpEditMsgid()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpComment:function(){var h=this;if(h.getPhpGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(h.getPhpGrid().getSelectionModel().getCount()<1){Ext.ux.Toaster.msg(i18n("sSelect_one_only"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=h.phpSelectedRecord.get("msgid");if(!h.application.runAction("cDesktop","AlreadyExist","winPhpCommentId")){var g=Ext.widget("winPhpComment",{id:"winPhpCommentId",msgid:e});h.application.runAction("cDesktop","Add",g)}}}},phpCommentSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpComment()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sNew_item_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpCopy:function(){var d=this;if(!d.application.runAction("cDesktop","AlreadyExist","winPhpCopyId")){var e=Ext.widget("winPhpCopy",{id:"winPhpCopyId"});d.application.runAction("cDesktop","Add",e)}},phpCopySubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpCopy(),success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sLanguage_copied"),i18n("sLanguage_copied_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},phpMeta:function(){var d=this;if(d.selPhpLanguage==null){Ext.ux.Toaster.msg(i18n("sSelect_something"),i18n("sSelect_something_to_work_on"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var e=Ext.ModelManager.getModel("Rd.model.mI18nMeta");e.load(d.selPhpLanguage,{scope:d,failure:Ext.ux.formFail,success:function(h,b){var a=d.application.runAction("cDesktop","AlreadyExist","winPhpMetaId");if(!a){a=Ext.widget("winPhpMeta",{id:"winPhpMetaId"});d.application.runAction("cDesktop","Add",a)}form=a.down("form");form.loadRecord(h)}})}},phpMetaSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlPhpMeta()+"?language="+j.selPhpLanguage,success:function(b,a){i.close();j.getPhpGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStorePhpPhrasesSizeChange:function(){var d=this;var e=d.getStore("sI18nPhpPhrases").getTotalCount();d.getPhpGrid().down("#count").update({count:e})},phpGridClick:function(n,j,k,i,l){var m=this;m.phpSelectedRecord=j},onStoreJsPhrasesSizeChange:function(){var d=this;var e=d.getStore("sI18nJsPhrases").getTotalCount();d.getJsGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cI18n"],0));(Ext.cmd.derive("Rd.view.iPPools.gridIpPools",Ext.grid.Panel,{multiSelect:true,store:"sIpPools",stateful:true,stateId:"StateGridIpPools",stateEvents:["groupclick","columnhide"],border:true,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/ip_pools/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridIpPools1",width:Rd.config.buttonMargin},{text:"Name",dataIndex:"pool_name",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools2"},{text:"IP Address",dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools3"},{text:"Last NAS IP",dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools4"},{text:"Called ID (NAS MAC)",dataIndex:"calledstationid",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools5"},{text:"Calling ID (Client MAC)",dataIndex:"callingstationid",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools6"},{text:"Expiry time",dataIndex:"expiry_time",tdCls:"gridTree",flex:1,hidden:false,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools7"},{text:"Username",dataIndex:"username",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridIpPools8"},{text:"Pool key",dataIndex:"pool_key",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools9"},{text:"NAS ID",dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools10"},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools11"},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridIpPools12"},{text:"Active",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='active == true'><div class=\"hasRight\">"+i18n("sYes")+"</div></tpl>","<tpl if='active == false'><div class=\"noRight\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridIpPools13"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools14"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridIpPools15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridIpPools"],["component","box","container","panel","tablepanel","gridpanel","grid","gridIpPools"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridIpPools:true},["widget.gridIpPools"],0,[Rd.view.iPPools,"gridIpPools"],0));(Ext.cmd.derive("Rd.model.mIpPool",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"pool_name",type:"string"},{name:"framedipaddress",type:"string"},{name:"nasipaddress",type:"string"},{name:"calledstationid",type:"string"},{name:"callingstationid",type:"string"},{name:"expiry_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"username",type:"string"},{name:"pool_key",type:"string"},{name:"nasidentifier",type:"string"},{name:"extra_value",type:"string"},{name:"active",type:"bool"},{name:"permanent_user_id",type:"int"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mIpPool"],0));(Ext.cmd.derive("Rd.view.iPPools.winIpPoolEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit IP Pool entry",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,poolId:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",name:"id",hidden:true,value:e.poolId},{xtype:"textfield",name:"framedipaddress",hidden:true,value:e.record.get("framedipaddress")},{xtype:"displayfield",fieldLabel:"IP Address",value:e.record.get("framedipaddress"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Client MAC",name:"callingstationid",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",vtype:"MacAddress",value:e.record.get("callingstationid")},{xtype:"cmbPermanentUser",allowBlank:true,labelClsExtra:"lblRd",itemId:"permanent_user_id",fieldLabel:"Permanent user",name:"permanent_user_id"},{xtype:"checkbox",fieldLabel:i18n("sActive"),name:"active",inputValue:"active",checked:e.record.get("active"),cls:"lblRd"},{xtype:"checkbox",fieldLabel:"Clean other fields",name:"clean_up",inputValue:"clean_up",checked:true,cls:"lblRd"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winIpPoolEdit"],["component","box","container","panel","window","winIpPoolEdit"],{component:true,box:true,container:true,panel:true,window:true,winIpPoolEdit:true},["widget.winIpPoolEdit"],0,[Rd.view.iPPools,"winIpPoolEdit"],0));(Ext.cmd.derive("Rd.store.sIpPools",Ext.data.Store,{model:"Rd.model.mIpPool",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ip_pools/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sIpPools"],0));(Ext.cmd.derive("Rd.view.iPPools.cmbPool",Ext.form.ComboBox,{fieldLabel:"Pool",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"name",name:"name",value:"",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/ip_pools/list_of_pools.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPool"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPool"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPool:true},["widget.cmbPool"],0,[Rd.view.iPPools,"cmbPool"],0));(Ext.cmd.derive("Rd.view.iPPools.winIpPoolsAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New IP Pool",width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var g=this;var i=g.mkScrnChoice();var h=g.mkScrnNewPool();var j=g.mkScrnExistingPool();g.items=[i,h,j];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnChoice:function(){var e=this;var g=[{itemId:"btnScrnChoiceNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnChoice",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"radiogroup",fieldLabel:"Choose one",columns:1,vertical:true,items:[{boxLabel:"New IP pool",name:"rb",inputValue:"new_pool",checked:true},{boxLabel:"Add IP to pool",name:"rb",inputValue:"new_ip"}]}],buttons:g});return h},mkScrnNewPool:function(){var e=this;var g=[{itemId:"btnNewPoolPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnNewPoolNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnNewPool",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"New IP Pool",cls:"lblWizard"}],items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",value:"Test"},{xtype:"textfield",fieldLabel:"Start IP",name:"pool_start",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.1"},{xtype:"textfield",fieldLabel:"End IP",name:"pool_end",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.254"}],buttons:g});return h},mkScrnExistingPool:function(){var e=this;var g=[{itemId:"btnExistingPoolPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnExistingPoolNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnExistingPool",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Add IP to pool",cls:"lblWizard"}],items:[{xtype:"cmbPool",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"IP Address",name:"ip",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress",value:"192.168.1.255"}],buttons:g});return h}},0,["winIpPoolsAddWizard"],["component","box","container","panel","window","winIpPoolsAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winIpPoolsAddWizard:true},["widget.winIpPoolsAddWizard"],0,[Rd.view.iPPools,"winIpPoolsAddWizard"],0));(Ext.cmd.derive("Rd.controller.cIpPools",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridIpPools",border:true,itemId:"tabIpPools",plain:true});d.populated=true},views:["iPPools.gridIpPools","iPPools.winIpPoolsAddWizard","iPPools.winIpPoolEdit","components.cmbPermanentUser"],stores:["sIpPools","sPermanentUsers"],models:["mIpPool","mPermanentUser"],selectedRecord:null,config:{urlExportCsv:"/cake2/rd_cake/ip_pools/export_csv",urlAddPool:"/cake2/rd_cake/ip_pools/add_pool.json",urlAddIp:"/cake2/rd_cake/ip_pools/add_ip.json",urlDelete:"/cake2/rd_cake/ip_pools/delete.json",urlEdit:"/cake2/rd_cake/ip_pools/edit.json",urlView:"/cake2/rd_cake/ip_pools/view.json"},refs:[{ref:"grid",selector:"gridIpPools"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabIpPools":{destroy:b.appClose},"gridIpPools #reload":{click:b.reload},"gridIpPools #add":{click:b.add},"winIpPoolsAddWizard #btnScrnChoiceNext":{click:b.btnScrnChoiceNext},"winIpPoolsAddWizard #btnNewPoolPrev":{click:b.btnScrnBackToStart},"winIpPoolsAddWizard #btnExistingPoolPrev":{click:b.btnScrnBackToStart},"winIpPoolsAddWizard #btnNewPoolNext":{click:b.btnNewPoolNext},"winIpPoolsAddWizard #btnExistingPoolNext":{click:b.btnExistingPoolNext},"gridIpPools #edit":{click:b.edit},"gridIpPools #delete":{click:b.del},"gridIpPools #csv":{},"winIpPoolEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},onStoreIpPoolsLoaded:function(){var d=this;var e=d.getStore("sIpPools").getTotalCount();d.getGrid().down("#count").update({count:e})},add:function(d){if(!Ext.WindowManager.get("winIpPoolsAddWizardId")){var e=Ext.widget("winIpPoolsAddWizard",{id:"winIpPoolsAddWizardId"});e.show()}},btnScrnChoiceNext:function(i){var l=this;var k=i.up("winIpPoolsAddWizard");var h=i.up("form");var j=h.down("radiogroup");if(j.getValue().rb=="new_pool"){k.getLayout().setActiveItem("scrnNewPool")}if(j.getValue().rb=="new_ip"){k.getLayout().setActiveItem("scrnExistingPool")}},btnScrnBackToStart:function(g){var e=this;var h=g.up("winIpPoolsAddWizard");h.getLayout().setActiveItem("scrnChoice")},btnNewPoolNext:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlAddPool(),success:function(b,a){i.close();j.getStore("sIpPools").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},btnExistingPoolNext:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlAddIp(),success:function(b,a){i.close();j.getStore("sIpPools").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(n){var l=this;var i=l.getGrid().getStore();if(l.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();var k=m.getId();if(!Ext.WindowManager.get("winIpPoolEditId")){var j=Ext.widget("winIpPoolEdit",{id:"winIpPoolEditId",store:i,poolId:k,record:m});j.show()}else{var j=l.getEditWin();j.poolId=k;j.record=m;l.load(j)}}},btnEditSave:function(h){var j=this;var i=h.up("winIpPoolEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cIpPools"],0));(Ext.cmd.derive("Rd.view.logViewer.winRadiusInfo",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:i18n("sFreeRADIUS_info"),width:380,height:380,plain:true,border:false,layout:"fit",iconCls:"infoWin",glyph:Rd.config.icnInfo,defaults:{border:false},initComponent:function(){var l=this;var k=Ext.create("Ext.data.Store",{storeId:"frClientsStore",fields:["name"],data:{items:l.info.clients},proxy:{type:"memory",reader:{type:"json",root:"items"}}});var i=Ext.create("Ext.grid.Panel",{title:i18n("sClients"),store:Ext.data.StoreManager.lookup("frClientsStore"),columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",flex:1}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]});var m=k.getTotalCount();i.down("#count").update({count:m});var j=Ext.create("Ext.data.Store",{storeId:"frModulesStore",fields:["name"],data:{items:l.info.modules},proxy:{type:"memory",reader:{type:"json",rootProperty:"items"}}});var n=Ext.create("Ext.grid.Panel",{title:i18n("sModules"),store:Ext.data.StoreManager.lookup("frModulesStore"),columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",flex:1}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}]});var m=j.getTotalCount();n.down("#count").update({count:m});l.items={xtype:"tabpanel",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:i18n("sGeneral"),xtype:"panel",tpl:new Ext.XTemplate("<tpl>","<div style='padding:5px; margin: 5px;'>",'<div class="lblYfi">'+i18n("sUptime")+'</div><div class="txtGrey">{uptime}</div>','<div class="lblYfi">'+i18n("sVersion")+'</div><div class="txtGrey">{version}</div>',"</div>","</tpl>"),data:{uptime:l.info.uptime,version:l.info.version}},i,n]};Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winRadiusInfo"],["component","box","container","panel","window","winRadiusInfo"],{component:true,box:true,container:true,panel:true,window:true,winRadiusInfo:true},["widget.winRadiusInfo"],0,[Rd.view.logViewer,"winRadiusInfo"],0));(Ext.cmd.derive("Rd.controller.cLogViewer",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add([{xtype:"panel",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),width:200,items:[{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],layout:"fit",margins:"0 0 0 0",border:false,html:"",autoScroll:true,border:"5 5 5 5",bodyCls:"fileViewer",itemId:"pnlViewFile"}]);d.populated=true},views:["logViewer.winRadiusInfo"],stores:[],models:[],socket:undefined,showFirstTime:undefined,showDiv:undefined,htmlToAdd:"",renderFlag:undefined,config:{urlFrStatus:"/cake2/rd_cake/free_radius/status.json",urlFrStart:"/cake2/rd_cake/free_radius/start.json",urlFrStop:"/cake2/rd_cake/free_radius/stop.json",urlFrInfo:"/cake2/rd_cake/free_radius/info.json",portWebSocket:"8000"},refs:[{ref:"file",selector:"#pnlViewFile"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#pnlViewFile #clear":{click:b.clear},"#pnlViewFile #start":{click:b.start},"#pnlViewFile #stop":{click:b.stop},"#pnlViewFile #info":{click:b.info},"#pnlViewFile":{afterrender:b.onShow,render:b.onRender,destroy:b.onDestroy}})},clear:function(b){var e=this;e.showDiv.innerHTML=""},start:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStart(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){b.up("#pnlViewFile").down("#info").setDisabled(false);Ext.ux.Toaster.msg("FreeRADIUS service started","FreeRADIUS service started fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},stop:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrStop(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){b.up("#pnlViewFile").down("#info").setDisabled(true);Ext.ux.Toaster.msg("FreeRADIUS service stopped","FreeRADIUS service stopped fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:e})},info:function(b){var e=this;Ext.Ajax.request({url:e.getUrlFrInfo(),method:"GET",success:function(a){var d=Ext.JSON.decode(a.responseText);if(d.success){e.showInfo(d.data)}},scope:e})},showInfo:function(h){var e=this;if(!Ext.WindowManager.get("winRadiusInfo")){var g=Ext.widget("winRadiusInfo",{id:"winRadiusInfoId",info:h});g.show()}},ioLoaded:function(g){var i=this;var h=i.application.getDashboardData().token;var j=document.location.host;i.socket=io.connect("http://"+j+":"+i.getPortWebSocket()+"?token="+h);i.socket.on("connect",function(){});i.socket.on("message",function(l){if(Ext.isString(l)){var b=i18n("sReceiving_new_logfile_data");i.getFile().down("#feedback").update({message:b});var a=l.split("\n");var e=a.length-1;var d=false;a.forEach(function(k,o,p){if(o==e){d=true}i.newText(k,d)})}});i.socket.on("error",function(a){console.error("Unable to connect Socket.IO",a)})},onShow:function(g){var h=this;if(h.showFirstTime==undefined){h.showFirstTime=true;h.showDiv=h.getFile().body.dom;var e=document.location.host;Ext.Loader.loadScript({url:"http://"+e+":"+h.getPortWebSocket()+"/socket.io/socket.io.js",scope:this,onLoad:h.ioLoaded,onError:function(){console.log("Error loading Socket ")}})}else{if(h.renderFlag==true){h.showDiv=h.getFile().body.dom;h.socket.socket.reconnect();h.renderFlag=false}}},onRender:function(e){var d=this;if(d.showFirstTime==true){d.renderFlag=true}Ext.Ajax.request({url:d.getUrlFrStatus(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.data.running==true){d.getFile().down("#start").toggle(true);d.getFile().down("#info").setDisabled(false)}else{d.getFile().down("#stop").toggle(true);d.getFile().down("#info").setDisabled(true)}}},scope:d})},onDestroy:function(e){var d=this;d.populated=false;d.renderFlag=false;d.socket.disconnect()},newText:function(d,r){var t=this;var y="<br />";if(r==true){y=""}var w=d.split(": ");if(w.length>=3){var x="<span class='txtGrey'>"+w[0]+"</span> : ";var s=w[1];var C="txtGrey";var A=/Info/i;if(s.search(A)!=-1){C="txtBlue"}var u=/Error/i;if(s.search(u)!=-1){C="txtRed"}var q="<span class='"+C+"'>"+w[1]+"</span> : ";w.shift();w.shift();var B=w.toString();if(C=="txtRed"){B="<span class='txtBold'>"+B+"</span>"}t.htmlToAdd=t.htmlToAdd+x+q+B+y}else{t.htmlToAdd=t.htmlToAdd+d+y}if(r==true){t.showDiv.innerHTML=t.showDiv.innerHTML+t.htmlToAdd;t.htmlToAdd="";t.getFile().body.scrollTo("top",99999,true);var z=i18n("sAwaiting_new_logfile_data");t.getFile().down("#feedback").update({message:z})}}},0,0,0,0,0,0,[Rd.controller,"cLogViewer"],0));(Ext.cmd.derive("Rd.view.components.compWallpaper",Ext.Component,{cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',afterRender:function(){var b=this;b.setWallpaper();Ext.Component.prototype.afterRender.apply(this,arguments)},setWallpaper:function(){var e=this,d;if(e.rendered){d=e.el.dom.firstChild;d.src=e.url;Ext.fly(d).setStyle({width:"100%",height:"100%"}).show()}}},0,["compWallpaper"],["component","box","compWallpaper"],{component:true,box:true,compWallpaper:true},["widget.compWallpaper"],0,[Rd.view.components,"compWallpaper"],0));(Ext.cmd.derive("Rd.view.login.pnlLogin",Ext.panel.Panel,{border:false,autoCreate:false,layout:"fit",url:null,title:Rd.config.headerName,dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:["->","<b>"+Rd.config.footerName+"</b> "+Rd.config.footerLicense]}],initComponent:function(){var b=this;b.items=[{xtype:"compWallpaper",url:b.url}];b.add(b.loginWindow());Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},loginWindow:function(){var b=Ext.create("Ext.window.Window",{itemId:"winLogin",layout:"fit",autoShow:true,closable:false,draggable:false,resizable:false,title:i18n("sAuthenticate_please"),glyph:Rd.config.icnLock,width:300,height:310,plain:true,border:false,items:[{xtype:"form",border:false,layout:"anchor",height:"100%",bodyPadding:20,fieldDefaults:{msgTarget:"under",labelAlign:"top",anchor:"100%",labelSeparator:"",labelClsExtra:"lblRd"},defaultType:"textfield",items:[{itemId:"inpUsername",name:"username",fieldLabel:i18n("sUsername"),allowBlank:false,blankText:i18n("sEnter_username")},{itemId:"inpPassword",name:"password",fieldLabel:i18n("sPassword"),inputType:"password",allowBlank:false,blankText:i18n("sEnter_password")}],dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",padding:0,items:["->",{text:i18n("sOK"),margin:Rd.config.buttonMargin,action:"ok",type:"submit",formBind:true,scale:"large",glyph:Rd.config.icnYes}]}]}]})}},0,["pnlLogin"],["component","box","container","panel","pnlLogin"],{component:true,box:true,container:true,panel:true,pnlLogin:true},["widget.pnlLogin"],0,[Rd.view.login,"pnlLogin"],0));(Ext.cmd.derive("Rd.controller.cLogin",Ext.app.Controller,{views:["login.pnlLogin"],config:{urlLogin:"/cake3/rd_cake/dashboard/authenticate.json",urlWallpaper:"resources/images/wallpapers/3.jpg"},refs:[{ref:"viewP",selector:"viewP",xtype:"viewP",autoCreate:true},{ref:"pnlLogin",selector:"pnlLogin",xtype:"pnlLogin",autoCreate:false}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({'#winLogin button[type="submit"]':{click:me.login},"pnlLogin #cmbLanguage":{select:me.onLanguageSelect},"#inpPassword":{specialkey:function(i,j){if(j.getKey()==j.ENTER){var e=i.up("form");var h=e.down('button[type="submit"]');h.fireEvent("click",h)}}}})},actionIndex:function(){var h=this;var g=h.getView("login.pnlLogin").create({url:h.getUrlWallpaper()});var e=h.getViewP();e.removeAll(true);e.add([g])},login:function(i){var m=this;var k=i.up("window"),n=k.down("form");var j=Ext.getBody().getViewSize().width;var l=false;if(j<1000){l=true}n.submit({clientValidation:true,url:m.getUrlLogin(),params:{auto_compact:l},success:function(b,a){m.application.setDashboardData(a.result.data);var d=new Date();d.setDate(d.getDate()+1);Ext.util.Cookies.set("Token",a.result.data.token,d,"/",null,false);Ext.Ajax.setExtraParams({token:a.result.data.token,sel_language:m.application.getSelLanguage()});m.getViewP().removeAll(true);k.close();m.application.runAction("cDashboard","Index")},failure:Ext.ux.formFail})},actionExit:function(){var b=this;b.getViewP().removeAll(true);Ext.util.Cookies.clear("Token");b.actionIndex()}},0,0,0,0,0,0,[Rd.controller,"cLogin"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshEdit",Ext.tab.Panel,{border:true,meshId:undefined,meshName:undefined,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;console.log("Mesh ID is "+b.meshId);b.items=[{title:i18n("sEntry_points"),itemId:"tabEntryPoints",xtype:"gridMeshEntries",meshId:b.meshId},{title:i18n("sMesh_settings"),itemId:"tabMeshSettings",xtype:"pnlMeshSettings",meshId:b.meshId},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridMeshExits",meshId:b.meshId},{title:i18n("sNode_settings"),itemId:"tabNodeCommonSettings",xtype:"pnlNodeCommonSettings",meshId:b.meshId},{title:i18n("sNodes"),itemId:"tabNodes",xtype:"gridNodes",meshId:b.meshId}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshEdit"],["component","box","container","panel","tabpanel","pnlMeshEdit"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlMeshEdit:true},["widget.pnlMeshEdit"],0,[Rd.view.meshes,"pnlMeshEdit"],0));(Ext.cmd.derive("Rd.model.mMeshEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"encryption",type:"string"},{name:"hidden",type:"bool"},{name:"isolate",type:"bool"},{name:"apply_to_all",type:"bool"},{name:"connected_to_exit",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMeshEntry"],0));(Ext.cmd.derive("Rd.model.mMeshExit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"type",type:"string"},"connects_with",{name:"auto_detect",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMeshExit"],0));(Ext.cmd.derive("Rd.model.mMeshEntryPoint",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mMeshEntryPoint"],0));(Ext.cmd.derive("Rd.model.mNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},"static_entries","static_exits"]},0,0,0,0,0,0,[Rd.model,"mNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshMapPreferences",Ext.window.Window,{title:i18n("sPreferences"),layout:"fit",autoShow:false,width:350,height:350,glyph:Rd.config.icnSpanner,meshId:"",mapPanel:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"HYBRID",text:i18n("sHybrid")},{id:"ROADMAP",text:i18n("sRoadmap")},{id:"SATELLITE",text:i18n("sSatellite")},{id:"TERRAIN",text:i18n("sTerrain")}]});d.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"numberfield",name:"lng",itemId:"lng",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"lat",itemId:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"zoom",itemId:"zoom",fieldLabel:"Zoom level",value:17,maxValue:22,minValue:0,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"type",itemId:"type",fieldLabel:i18n("sType"),store:e,queryMode:"local",displayField:"text",valueField:"id",allowBlank:false,forceSelection:true,labelClsExtra:"lblRdReq"}],buttons:[{itemId:"snapshot",text:i18n("sSnapshot"),scale:"large",iconCls:"b-snapshot",glyph:Rd.config.icnSnapshot,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshMapPreferences"],["component","box","container","panel","window","winMeshMapPreferences"],{component:true,box:true,container:true,panel:true,window:true,winMeshMapPreferences:true},["widget.winMeshMapPreferences"],0,[Rd.view.meshes,"winMeshMapPreferences"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEncryptionOptions",Ext.form.ComboBox,{fieldLabel:i18n("sEncryption"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"encryption",name:"encryption",value:"none",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEncryptionOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEncryptionOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEncryptionOptions:true},["widget.cmbEncryptionOptions"],0,[Rd.view.meshes,"cmbEncryptionOptions"],0));(Ext.cmd.derive("Rd.model.mEncryptionOption",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mEncryptionOption"],0));(Ext.cmd.derive("Rd.store.sEncryptionOptions",Ext.data.Store,{model:"Rd.model.mEncryptionOption",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/encryption_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sEncryptionOptions"],0));(Ext.cmd.derive("Rd.view.meshes.vcMeshExitPoint",Ext.app.ViewController,{config:{urlCheckExperimental:"/cake2/rd_cake/meshes/mesh_experimental_check.json"},init:function(){var b=this},onChkDnsOverrideChange:function(i){var l=this;var m=i.up("form");var k=m.down("#txtDns1");var n=m.down("#txtDns2");var j=m.down("#chkDnsDesk");if(i.getValue()){k.enable();n.enable();j.setValue(false);j.disable()}else{k.disable();n.disable();j.enable()}},onChkDnsDeskChange:function(i){var k=this;var l=i.up("form");var h=l.down("#chkDnsOverride");var j=l.down("#chkAnyDns");if(i.getValue()){j.setValue(false);j.disable();h.setValue(false);h.disable()}else{j.enable();h.enable()}},onDnsDeskBeforeRender:function(e){var d=this;Ext.Ajax.request({url:d.getUrlCheckExperimental(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.active){e.show();e.enable()}else{e.hide();e.disable()}}},scope:d})}},0,0,0,0,["controller.vcMeshExitPoint"],0,[Rd.view.meshes,"vcMeshExitPoint"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sEdit_mesh_exit_point"),width:530,height:530,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,meshId:"",exitId:"",store:undefined,defaults:{border:false},controller:"vcMeshExitPoint",initComponent:function(){var k=this;var i=Ext.create("Rd.view.meshes.cmbMeshEntryPoints",{labelClsExtra:"lblRdReq"});var l=true;if(k.type=="captive_portal"){l=false}i.getStore().getProxy().setExtraParam("mesh_id",k.meshId);i.getStore().getProxy().setExtraParam("exit_id",k.exitId);i.getStore().load();var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:k.meshId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"checkbox",fieldLabel:i18n("sAuto_detect"),name:"auto_detect",inputValue:"auto_detect",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},i,{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",hidden:l,items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",cls:"subTab",border:false,items:[{title:"Basic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_NASID"),name:"radius_nasid",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:"Proxy",itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:"Enable",name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Upstream proxy",name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Upstream port",name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Auth name",name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:"Auth password",name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Coova Specific",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:"Optional config items",name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});var h=j.down("#tabCaptivePortal");if(k.type=="captive_portal"){h.setDisabled(false)}else{h.setDisabled(true)}k.items=j;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditExit"],["component","box","container","panel","window","winMeshEditExit"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditExit:true},["widget.winMeshEditExit"],0,[Rd.view.meshes,"winMeshEditExit"],0));(Ext.cmd.derive("Rd.view.meshes.cmbHardwareOptions",Ext.form.ComboBox,{fieldLabel:i18n("sHardware_model"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"hardware",name:"hardware",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name","radios"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/hardware_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbHardwareOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbHardwareOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbHardwareOptions:true},["widget.cmbHardwareOptions"],0,[Rd.view.meshes,"cmbHardwareOptions"],0));(Ext.cmd.derive("Rd.view.components.cmbMesh",Ext.form.ComboBox,{fieldLabel:"Mesh",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"mesh_id",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMesh"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMesh"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMesh:true},["widget.cmbMesh"],0,[Rd.view.components,"cmbMesh"],0));(Ext.cmd.derive("Rd.view.meshes.vcMeshNodeGeneric",Ext.app.ViewController,{config:{urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json"},init:function(){var b=this},onCmbHardwareOptionsChange:function(x){var r=this;var C=x.up("form");var q=C.down("#key");var p=C.down("#tabVoip");var A=C.down("#tabVoipAdvanced");var B=C.down("#tabRadio");var z=x.getValue();var t=1;var w=x.getSelection();if(w!=null){t=w.get("radios")}var u=C.down("#tabAdvWifiRadio1");var s=x.up("window");if(s.getItemId()!="winMeshEditNodeMain"){var y={model:z}}else{var y={model:z,node_id:s.nodeId}}C.load({url:r.getUrlAdvancedSettingsForModel(),method:"GET",params:y,success:function(b,d,a){if(d.result.data.device_type=="ac"){if(d.result.data.radio0_band==5){r.addAcHtMode(0);r.removeAcHtMode(1)}if(d.result.data.radio1_band==5){r.addAcHtMode(1);r.removeAcHtMode(0)}}else{r.removeAcHtMode(0);r.removeAcHtMode(1)}},listeners:{actioncomplete:function(){console.log("Action is complete")}}});if(t==2){B.setDisabled(false);B.tab.show();u.setDisabled(false);u.tab.show()}else{B.setDisabled(true);B.tab.hide();u.setDisabled(true);u.tab.hide()}},onChkRadioEnableChange:function(h){var k=this;var i=h.up("panel");var j=h.getValue();var l=Ext.ComponentQuery.query("field",i);Ext.Array.forEach(l,function(a){if(a!=h){a.setDisabled(!j)}})},onChkRadioMeshChange:function(i){var l=this;var j=i.up("panel");var n=j.down("#radio24");var k=j.down("#numRadioTwoChan");var m=j.down("#numRadioFiveChan");if(i.getValue()==false){if(n.getValue()){k.setVisible(true);k.setDisabled(false);m.setVisible(false);m.setDisabled(true)}else{k.setVisible(false);k.setDisabled(true);m.setVisible(true);m.setDisabled(false)}}else{k.setVisible(false);k.setDisabled(true);m.setVisible(false);m.setDisabled(true)}},onRadio_0_BandChange:function(o){var q=this;var n=o.getValue();var l=o.up("panel");var m=l.down("#chkRadio0Mesh");var k=l.down("#radio24");var p=l.down("#numRadioTwoChan");var r=l.down("#numRadioFiveChan");if(m.getValue()==false){if(k.getValue()){p.setVisible(true);p.setDisabled(false);r.setVisible(false);r.setDisabled(true)}else{p.setVisible(false);p.setDisabled(true);r.setVisible(true);r.setDisabled(false)}}},onRadio_1_BandChange:function(o){var q=this;var n=o.getValue();var l=o.up("panel");var m=l.down("#chkRadio1Mesh");var k=l.down("#radio24");var p=l.down("#numRadioTwoChan");var r=l.down("#numRadioFiveChan");if(m.getValue()==false){if(k.getValue()){p.setVisible(true);p.setDisabled(false);r.setVisible(false);r.setDisabled(true)}else{p.setVisible(false);p.setDisabled(true);r.setVisible(true);r.setDisabled(false)}}},addAcHtMode:function(e){var h=this;var g=h.getView();if(e==0){g.down("#radio0_htmode_vht20").setVisible(true);g.down("#radio0_htmode_vht40").setVisible(true);g.down("#radio0_htmode_vht80").setVisible(true);g.down("#radio0_htmode_vht160").setVisible(true)}if(e==1){g.down("#radio1_htmode_vht20").setVisible(true);g.down("#radio1_htmode_vht40").setVisible(true);g.down("#radio1_htmode_vht80").setVisible(true);g.down("#radio1_htmode_vht160").setVisible(true)}},removeAcHtMode:function(e){var h=this;var g=h.getView();if(e==0){g.down("#radio0_htmode_vht20").setVisible(false);g.down("#radio0_htmode_vht40").setVisible(false);g.down("#radio0_htmode_vht80").setVisible(false);g.down("#radio0_htmode_vht160").setVisible(false)}if(e==1){g.down("#radio1_htmode_vht20").setVisible(false);g.down("#radio1_htmode_vht40").setVisible(false);g.down("#radio1_htmode_vht80").setVisible(false);g.down("#radio1_htmode_vht160").setVisible(false)}}},0,0,0,0,["controller.vcMeshNodeGeneric"],0,[Rd.view.meshes,"vcMeshNodeGeneric"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit mesh node",width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnEdit,autoShow:false,nodeId:"",meshName:"",meshId:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;console.log(g.meshName);console.log(g.meshId);var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"node_id",xtype:"textfield",name:"id",hidden:true,value:g.nodeId},{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:"A8-40-41-13-60-E3"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId,nodeId:g.nodeId},{xtype:"cmbStaticExits",meshId:g.meshId,nodeId:g.nodeId}]},{title:"Radios",disabled:true,layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,hidden:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditNode"],["component","box","container","panel","window","winMeshEditNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditNode:true},["widget.winMeshEditNode"],0,[Rd.view.meshes,"winMeshEditNode"],0));(Ext.cmd.derive("Rd.store.sMeshEntries",Ext.data.Store,{model:"Rd.model.mMeshEntry",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entries_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_entry_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshEntries"],0));(Ext.cmd.derive("Rd.store.sMeshExits",Ext.data.Store,{model:"Rd.model.mMeshExit",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_exits_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/meshes/mesh_exit_delete.json"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshExits"],0));(Ext.cmd.derive("Rd.store.sMeshEntryPoints",Ext.data.Store,{model:"Rd.model.mMeshEntryPoint",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sMeshEntryPoints"],0));(Ext.cmd.derive("Rd.store.sNodes",Ext.data.Store,{model:"Rd.model.mNode",remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_nodes_index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodes"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshEditGMap",Ext.ux.GMapPanel,{markers:[],infoWindows:[],infowindow:undefined,editwindow:undefined,addwindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,meshId:"",mapPanel:"",e_pnl:false,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",iconCls:"b-settings",glyph:Rd.config.icnConfigure,scale:"large",itemId:"preferences",tooltip:i18n("sPreferences")},{xtype:"button",iconCls:"b-add",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",iconCls:"b-delete",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")},{xtype:"button",iconCls:"b-edit",glyph:Rd.config.icnEdit,scale:"large",itemId:"edit",tooltip:i18n("sEdit")}]}],initComponent:function(){var j=this;var g=j.centerLatLng.lat;var i=j.centerLatLng.lng;j.center=new google.maps.LatLng(g,i);j.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapEditDiv";j.editwindow=new google.maps.InfoWindow({content:h});j.infoWindows.push(j.editwindow);google.maps.event.addListener(j.editwindow,"domready",function(){var a=j.editwindow.getContent();if(j.e_pnl){j.e_pnl.destroy()}var b=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sNew_position")+"</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLatitude")+"  </label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>"+i18n("sLongitude")+"  </label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","</div>"]);j.e_pnl=Ext.create("Ext.panel.Panel",{title:i18n("sAction_required"),itemId:"pnlMapsEdit",height:170,tpl:b,layout:"fit",mapPanel:j,buttonAlign:"center",buttons:[{xtype:"button",itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes},{xtype:"button",itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose},{xtype:"button",itemId:"delete",text:i18n("sDelete"),scale:"large",glyph:Rd.config.icnDelete}],renderTo:a});j.e_pnl.update({lng:j.new_lng,lat:j.new_lat})});j.addwindow=new google.maps.InfoWindow({content:"<div style='padding:5px;margin:5px; height:100px; width:200px;'><div class='lblRdReq'>"+i18n("sAction_required")+"</div><div class='lblRd'>Drag and drop marker to required position</div></div>"});j.infoWindows.push(j.addwindow);Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}}},0,["pnlMeshEditGMap"],["component","box","container","panel","gmappanel","pnlMeshEditGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlMeshEditGMap:true},["widget.pnlMeshEditGMap"],0,[Rd.view.meshes,"pnlMeshEditGMap"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New mesh entry point",width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,mesh_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:e.meshId},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sApply_to_all_nodes"),name:"apply_to_all",inputValue:"apply_to_all",checked:true,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",minLength:8,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddEntry"],["component","box","container","panel","window","winMeshAddEntry"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddEntry:true},["widget.winMeshAddEntry"],0,[Rd.view.meshes,"winMeshAddEntry"],0));(Ext.cmd.derive("Rd.view.meshes.cmbMeshAddMapNodes",Ext.form.ComboBox,{fieldLabel:"Available",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:false,labelClsExtra:"lblRdReq",allowBlank:false,meshId:"",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId},url:"/cake2/rd_cake/meshes/nodes_avail_for_map.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMeshAddMapNodes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMeshAddMapNodes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMeshAddMapNodes:true},["widget.cmbMeshAddMapNodes"],0,[Rd.view.meshes,"cmbMeshAddMapNodes"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshMapNodeAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnNote,meshId:"",mapPanel:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:"Select a node to add",cls:"lblWizard"}],items:[{xtype:"cmbMeshAddMapNodes",meshId:b.meshId}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshMapNodeAdd"],["component","box","container","panel","window","winMeshMapNodeAdd"],{component:true,box:true,container:true,panel:true,window:true,winMeshMapNodeAdd:true},["widget.winMeshMapNodeAdd"],0,[Rd.view.meshes,"winMeshMapNodeAdd"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_mesh_node"),width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,meshId:"",meshName:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);h.setValue(g.meshId);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",glyph:Rd.config.icnStar,layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId},{xtype:"cmbStaticExits",meshId:g.meshId}]},{title:"Radios",layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddNode"],["component","box","container","panel","window","winMeshAddNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddNode:true},["widget.winMeshAddNode"],0,[Rd.view.meshes,"winMeshAddNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddExit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_mesh_exit_point"),width:530,height:530,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,store:undefined,defaults:{border:false},startScreen:"scrnType",controller:"vcMeshExitPoint",initComponent:function(){var e=this;var g=e.mkScrnType();var h=e.mkScrnData();e.items=[g,h];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(e.startScreen)},mkScrnType:function(){var l=this;var h=[{itemId:"btnTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];var i=false;l.store.each(function(a,e,b){var d=a.get("type");if(d=="bridge"){i=true;return false}});if(i==true){var j=[{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge",checked:true},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}else{var j=[{boxLabel:i18n("sEthernet_bridge"),name:"exit_type",inputValue:"bridge",checked:true},{boxLabel:i18n("sTagged_Ethernet_bridge"),name:"exit_type",inputValue:"tagged_bridge"},{boxLabel:i18n("sNAT_plus_DHCP"),name:"exit_type",inputValue:"nat"},{boxLabel:i18n("sCaptive_Portal"),name:"exit_type",inputValue:"captive_portal"},{boxLabel:i18n("sOpenVPN_Bridge"),name:"exit_type",inputValue:"openvpn_bridge"}]}var k=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSpecify_exit_point_type"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sExit_point_type"),columns:1,vertical:true,items:j}],buttons:h});return k},mkScrnData:function(){var e=this;var g=Ext.create("Rd.view.meshes.cmbMeshEntryPoints",{labelClsExtra:"lblRdReq"});g.getStore().getProxy().setExtraParam("mesh_id",e.meshId);g.getStore().load();var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sCommon_settings"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true,value:e.meshId},{itemId:"type",xtype:"textfield",name:"type",hidden:true},{xtype:"checkbox",fieldLabel:i18n("sAuto_detect"),name:"auto_detect",inputValue:"auto_detect",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"vlan",itemId:"vlan",fieldLabel:i18n("sVLAN_number"),value:0,maxValue:4095,step:1,minValue:0,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},g,{itemId:"chkNasClient",xtype:"checkbox",fieldLabel:"Add Dynamic RADIUS Client",name:"auto_dynamic_client",inputValue:"auto_dynamic_client",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbRealm",xtype:"cmbRealm",multiSelect:true,typeAhead:false,allowBlank:true,name:"realm_ids[]",emptyText:"Empty = Any Realm",blankText:"Empty = Any Realm"},{itemId:"chkLoginPage",xtype:"checkbox",fieldLabel:"Add Login Page",name:"auto_login_page",inputValue:"auto_login_page",checked:true,labelClsExtra:"lblRdReq"},{itemId:"cmbDynamicDetail",xtype:"cmbDynamicDetail",labelClsExtra:"lblRdReq"},{itemId:"cmbOpenVpnServers",xtype:"cmbOpenVpnServers",labelClsExtra:"lblRdReq",allowBlank:false}]},{title:i18n("sCaptive_Portal_settings"),layout:"fit",disabled:true,itemId:"tabCaptivePortal",items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",plain:true,tabPosition:"top",cls:"subTab",border:false,items:[{title:"Basic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sRADIUS_server1"),name:"radius_1",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server2"),name:"radius_2",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_secret"),name:"radius_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sRADIUS_NASID"),name:"radius_nasid",itemId:"radius_nasid",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sUAM_URL"),name:"uam_url",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUAM_Secret"),name:"uam_secret",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textareafield",grow:true,fieldLabel:i18n("sWalled_garden"),name:"walled_garden",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:i18n("sSwap_octets"),name:"swap_octet",inputValue:"swap_octet",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMAC_authentication"),name:"mac_auth",inputValue:"mac_auth",checked:true,labelClsExtra:"lblRdReq"}]},{title:"DNS",itemId:"tabDns",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkDnsOverride",xtype:"checkbox",fieldLabel:"Enable Override",name:"dns_manual",inputValue:"dns_manual",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsOverrideChange"}},{itemId:"txtDns1",xtype:"textfield",fieldLabel:"DNS-1",name:"dns1",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{itemId:"txtDns2",xtype:"textfield",fieldLabel:"DNS-2",name:"dns2",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{itemId:"chkAnyDns",xtype:"checkbox",fieldLabel:"Allow Any DNS",name:"uamanydns",inputValue:"uamanydns",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"DNS Paranoia",name:"dnsparanoia",inputValue:"dnsparanoia",checked:false,labelClsExtra:"lblRd"},{itemId:"chkDnsDesk",xtype:"checkbox",fieldLabel:"Use DNSdesk",name:"dnsdesk",inputValue:"dnsdesk",checked:false,labelClsExtra:"lblRd",listeners:{change:"onChkDnsDeskChange",beforerender:"onDnsDeskBeforeRender"}}]},{title:"Proxy",itemId:"tabProxy",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"chkProxyEnable",xtype:"checkbox",fieldLabel:"Enable",name:"proxy_enable",inputValue:"proxy_enable",checked:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Upstream proxy",name:"proxy_ip",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Upstream port",name:"proxy_port",allowBlank:false,labelClsExtra:"lblRdReq",disabled:true},{xtype:"textfield",fieldLabel:"Auth name",name:"proxy_auth_username",allowBlank:true,labelClsExtra:"lblRd",disabled:true},{xtype:"textfield",fieldLabel:"Auth password",name:"proxy_auth_password",allowBlank:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Coova Specific",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textareafield",grow:true,fieldLabel:"Optional config items",name:"coova_optional",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]}]}]}]}]});return h}},0,["winMeshAddExit"],["component","box","container","panel","window","winMeshAddExit"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddExit:true},["widget.winMeshAddExit"],0,[Rd.view.meshes,"winMeshAddExit"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEditEntry",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sEdit_mesh_entry_point"),width:500,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,mesh_id:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{itemId:"mesh_id",xtype:"textfield",name:"mesh_id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sSSID"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sHidden"),name:"hidden",inputValue:"hidden",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sClient_isolation"),name:"isolate",inputValue:"isolate",checked:false,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sApply_to_all_nodes"),name:"apply_to_all",inputValue:"apply_to_all",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sEncryption"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"cmbEncryptionOptions",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"textfield",fieldLabel:i18n("sKey"),name:"key",itemId:"key",allowBlank:false,minLength:8,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sRADIUS_server"),name:"auth_server",itemId:"auth_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true},{xtype:"textfield",fieldLabel:i18n("sShared_secret"),name:"auth_secret",itemId:"auth_secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",hidden:true,disabled:true}]},{title:i18n("sAdvanced"),layout:"anchor",itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:i18n("sLimitClients"),name:"chk_maxassoc",inputValue:"chk_maxassoc",checked:false,labelClsExtra:"lblRdReq",itemId:"chk_maxassoc"},{xtype:"numberfield",name:"maxassoc",fieldLabel:i18n("sMaxClients"),value:100,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",hidden:true,disabled:true,itemId:"maxassoc"},{xtype:"cmbMacFilter",labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sBYOD_Belonging_To"),labelClsExtra:"lblRdReq",name:"permanent_user_id",hidden:true,disabled:true}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEditEntry"],["component","box","container","panel","window","winMeshEditEntry"],{component:true,box:true,container:true,panel:true,window:true,winMeshEditEntry:true},["widget.winMeshEditEntry"],0,[Rd.view.meshes,"winMeshEditEntry"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_entries_grid.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshEntries,{listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshEntries2"},{text:i18n("sEncryption"),dataIndex:"encryption",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="encryption==\'none\'"><div class="fieldGreyWhite"><i class="fa fa-unlock"></i>  '+i18n("sNone")+"</div></tpl>",'<tpl if="encryption==\'wep\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWEP")+"</div></tpl>",'<tpl if="encryption==\'psk\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Personal")+"</div></tpl>",'<tpl if="encryption==\'psk2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Personal")+"</div></tpl>",'<tpl if="encryption==\'wpa\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA_Enterprise")+"</div></tpl>",'<tpl if="encryption==\'wpa2\'"><div class="fieldGreyWhite"><i class="fa fa-lock"></i>  '+i18n("sWPA2_Enterprise")+"</div></tpl>"),stateId:"StateGridMeshEntries3"},{text:i18n("sHidden"),dataIndex:"hidden",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries4",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="hidden"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sClient_isolation"),dataIndex:"isolate",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="isolate"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sApply_to_all_nodes"),dataIndex:"apply_to_all",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries6",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="apply_to_all"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")},{text:i18n("sConnected_to_Exit"),dataIndex:"connected_to_exit",tdCls:"gridTree",flex:1,stateId:"StateGridMeshEntries7",renderer:function(h,a,g){if(h==true){return'<div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>'}if(h==false){a.tdAttr="data-qtip=\"<div><label class='lblTipItem'>Go to Exit Points and connect this SSID to an Exit Point</label></div>\"";return'<div class="fieldRedWhite"><i class="fa  fa-exclamation-circle"></i> No</div>'}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshEntries:true},["widget.gridMeshEntries"],0,[Rd.view.meshes,"gridMeshEntries"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshSettings",Ext.panel.Panel,{border:false,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"anchor",autoScroll:true,frame:true,bodyPadding:10,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"fieldset",title:"Connectivity",defaultType:"textfield",defaults:{anchor:"100%"},items:[{xtype:"radio",fieldLabel:"Ad-hoc",name:"connectivity",inputValue:"IBSS",itemId:"con_ibss",labelClsExtra:"lblRdReq"},{xtype:"radio",fieldLabel:"802.11s",name:"connectivity",inputValue:"mesh_point",itemId:"con_mesh_point",labelClsExtra:"lblRdReq",checked:true,afterRender:function(e,a){new Ext.ToolTip({target:this.id,trackMouse:false,maxWidth:250,minWidth:100,html:"<label class='lblTipItem'>Recommended</label>"})}},{xtype:"checkbox",fieldLabel:"Encryption",name:"encryption",inputValue:"encryption",itemId:"encryption",checked:false,labelClsExtra:"lblRdReq",afterRender:function(e,a){new Ext.ToolTip({target:this.id,trackMouse:false,maxWidth:250,minWidth:100,html:"<label class='lblTipItem'>Does not work on devices with 4M Flash (entry level)</label>"})}},{xtype:"textfield",fieldLabel:"Key",name:"encryption_key",itemId:"encryption_key",allowBlank:false,minLength:8,hidden:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{xtype:"fieldset",title:"Batman-adv Settings",defaultType:"textfield",defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sAP_isolation"),name:"ap_isolation",inputValue:"ap_isolation",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sBridge_Loop_Avoidance"),name:"bridge_loop_avoidance",inputValue:"bridge_loop_avoidance",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sAggregation"),name:"aggregated_ogms",inputValue:"aggregated_ogms",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sBonding"),name:"bonding",inputValue:"bonding",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sFragmentation"),name:"fragmentation",inputValue:"fragmentation",checked:true,labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:"Distributed ARP table",name:"distributed_arp_table",inputValue:"distributed_arp_table",checked:true,labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"orig_interval",fieldLabel:i18n("sOGM_interval_br_ms_br"),value:1000,maxValue:20000,step:100,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")},{xtype:"numberfield",name:"gw_sel_class",fieldLabel:i18n("sGateway_switching"),value:20,maxValue:255,step:1,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,blankText:i18n("sSupply_a_value")}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshSettings"],["component","box","container","panel","pnlMeshSettings"],{component:true,box:true,container:true,panel:true,pnlMeshSettings:true},["widget.pnlMeshSettings"],0,[Rd.view.meshes,"pnlMeshSettings"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshExits",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshExitsId",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_exits_grid.json",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshExits,{listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshExitsId1"},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'bridge\'"><div class="fieldGreyWhite"><i class="fa fa-bars"></i>  Bridge</div></tpl>','<tpl if="type==\'captive_portal\'"><div class="fieldPurpleWhite"><i class="fa fa-key"></i>  Captive Portal</div></tpl>','<tpl if="type==\'nat\'"><div class="fieldGreenWhite"><i class="fa fa-arrows-alt"></i>  NAT+DHCP</div></tpl>','<tpl if="type==\'tagged_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-tag"></i>  Tagged Ethernet Bridge</div></tpl>','<tpl if="type==\'openvpn_bridge\'"><div class="fieldBlueWhite"><i class="fa fa-quote-right"></i>  OpenVPN Bridge</div></tpl>'),stateId:"StateGridMeshExitsId3"},{text:i18n("sConnects_with"),sortable:false,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(connects_with)"><div class="fieldRedWhite"><i class="fa fa-exclamation-circle"></i> '+i18n("sNo_one")+"</div></tpl>",'<tpl for="connects_with">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"connects_with",stateId:"StateGridMeshExitsId4"},{text:i18n("sAuto_detect"),dataIndex:"auto_detect",tdCls:"gridTree",flex:1,stateId:"StateGridMeshExitsId5",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="auto_detect"><div class="fieldGreen"><i class="fa fa-check-circle"></i> Yes</div>',"<tpl else>",'<div class="fieldRed"><i class="fa fa-times-circle"></i> No</div>',"</tpl>")}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshExits"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshExits"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshExits:true},["widget.gridMeshExits"],0,[Rd.view.meshes,"gridMeshExits"],0));(Ext.cmd.derive("Rd.view.meshes.cmbMeshEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"entry_points",name:"entry_points[]",multiSelect:true,labelClsExtra:"lblRdReq",allowBlank:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/mesh_entry_points.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbMeshEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbMeshEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbMeshEntryPoints:true},["widget.cmbMeshEntryPoints"],0,[Rd.view.meshes,"cmbMeshEntryPoints"],0));(Ext.cmd.derive("Rd.view.meshes.pnlNodeCommonSettings",Ext.panel.Panel,{border:false,layout:"hbox",align:"stretch",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:400,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"System",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"}]},{title:"WiFi",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",anchor:"100%",name:"two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,labelClsExtra:"lblRdReq"},{xtype:"cmbFiveGigChannels",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Client Key",name:"client_key",allowBlank:false,blankText:i18n.sSupply_a_value,labelClsExtra:"lblRdReq",minLength:8}]},{title:"Bridge",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Bridge Ethernet port",name:"eth_br_chk",inputValue:"eth_br_chk",itemId:"eth_br_chk",checked:true,labelClsExtra:"lblRd"},{xtype:"cmbEthBridgeOptions",meshId:b.meshId,disabled:true},{xtype:"checkbox",fieldLabel:"Apply bridge to all nodes",name:"eth_br_for_all",inputValue:"eth_br_for_all",itemId:"eth_br_for_all",checked:true,labelClsExtra:"lblRd",disabled:true}]},{title:"Monitor",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"numberfield",name:"heartbeat_interval",itemId:"heartbeat_interval",fieldLabel:i18n("sHeartbeat_interval"),value:60,maxValue:21600,minValue:60},{xtype:"numberfield",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:600,maxValue:21600,minValue:300}]},{title:"Gateway",layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{labelWidth:300},autoScroll:true,items:[{xtype:"numberfield",name:"gw_dhcp_timeout",itemId:"gw_dhcp_timeout",fieldLabel:"Wait time for DHCP IP",value:120,maxValue:600,minValue:120,labelWidth:280},{xtype:"checkbox",fieldLabel:"Use previous settings when DHCP fails",name:"gw_use_previous",inputValue:"gw_use_previous",itemId:"gw_use_previous",checked:true,labelClsExtra:"lblRd",labelWidth:280},{xtype:"checkbox",fieldLabel:"Reboot node if gateway is unreachable",name:"gw_auto_reboot",inputValue:"gw_auto_reboot",itemId:"gw_auto_reboot",checked:true,labelClsExtra:"lblRd",labelWidth:280},{xtype:"numberfield",name:"gw_auto_reboot_time",itemId:"gw_auto_reboot_time",fieldLabel:"Reboot trigger time",value:600,maxValue:3600,minValue:240,labelWidth:280}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNodeCommonSettings"],["component","box","container","panel","pnlNodeCommonSettings"],{component:true,box:true,container:true,panel:true,pnlNodeCommonSettings:true},["widget.pnlNodeCommonSettings"],0,[Rd.view.meshes,"pnlNodeCommonSettings"],0));(Ext.cmd.derive("Rd.view.meshes.gridNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_nodes_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodes,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.store.load();b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridNodes2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGridNodes3"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridNodes4"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,stateId:"StateGridNodes5"},{text:i18n("sPower"),dataIndex:"power",tdCls:"gridTree",flex:1,stateId:"StateGridNodes6"},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",flex:1,stateId:"StateGridNodes7"},{text:i18n("sStatic_entries"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(static_entries)"><div class="fieldBlue">'+i18n("sNone")+"</div></tpl>",'<tpl for="static_entries">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"static_entries",stateId:"StateGridNodes8"},{text:i18n("sStatic_exits"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(static_exits)"><div class="fieldBlue">'+i18n("sNone")+"</div></tpl>",'<tpl for="static_exits">','<tpl><div class="fieldGreyWhite">{name}</div></tpl>',"</tpl>"),dataIndex:"static_exits",stateId:"StateGridNodes9"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNodes:true},["widget.gridNodes"],0,[Rd.view.meshes,"gridNodes"],0));(Ext.cmd.derive("Rd.view.meshes.cmbStaticEntries",Ext.form.ComboBox,{fieldLabel:i18n("sStatic_entry_points"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",itemId:"static_entries",name:"static_entries[]",labelClsExtra:"lblRd",meshId:"",nodeId:"",multiSelect:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId,node_id:d.nodeId},url:"/cake2/rd_cake/meshes/static_entry_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbStaticEntries"],["component","box","field","textfield","pickerfield","combobox","combo","cmbStaticEntries"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbStaticEntries:true},["widget.cmbStaticEntries"],0,[Rd.view.meshes,"cmbStaticEntries"],0));(Ext.cmd.derive("Rd.view.meshes.cmbStaticExits",Ext.form.ComboBox,{fieldLabel:i18n("sStatic_exit_points"),labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:true,editable:false,mode:"local",itemId:"static_exits",name:"static_exits[]",labelClsExtra:"lblRd",meshId:"",nodeId:"",multiSelect:true,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId,node_id:d.nodeId},url:"/cake2/rd_cake/meshes/static_exit_options.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbStaticExits"],["component","box","field","textfield","pickerfield","combobox","combo","cmbStaticExits"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbStaticExits:true},["widget.cmbStaticExits"],0,[Rd.view.meshes,"cmbStaticExits"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEthBridgeOptions",Ext.form.ComboBox,{fieldLabel:"Bridge with",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"eth_br_with",name:"eth_br_with",value:"0",labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{mesh_id:d.meshId},url:"/cake2/rd_cake/meshes/mesh_exit_view_eth_br.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbEthBridgeOptions"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEthBridgeOptions"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEthBridgeOptions:true},["widget.cmbEthBridgeOptions"],0,[Rd.view.meshes,"cmbEthBridgeOptions"],0));(Ext.cmd.derive("Rd.controller.cMeshEdits",Ext.app.Controller,{views:["meshes.pnlMeshEdit","meshes.gridMeshEntries","meshes.winMeshAddEntry","meshes.cmbEncryptionOptions","meshes.winMeshEditEntry","meshes.pnlMeshSettings","meshes.gridMeshExits","meshes.winMeshAddExit","meshes.cmbMeshEntryPoints","meshes.winMeshEditExit","meshes.pnlNodeCommonSettings","meshes.gridNodes","meshes.winMeshAddNode","meshes.cmbHardwareOptions","meshes.cmbStaticEntries","meshes.cmbStaticExits","meshes.winMeshEditNode","meshes.pnlMeshEditGMap","meshes.winMeshMapPreferences","meshes.winMeshMapNodeAdd","meshes.cmbEthBridgeOptions","components.cmbFiveGigChannels","components.cmbTimezones","components.cmbCountries","components.cmbRealm"],stores:["sMeshEntries","sMeshExits","sMeshEntryPoints","sNodes","sRealms"],models:["mMeshEntry","mMeshExit","mMeshEntryPoint","mNode","mRealm","mDynamicDetail","mPermanentUser"],config:{urlAddEntry:"/cake2/rd_cake/meshes/mesh_entry_add.json",urlViewEntry:"/cake2/rd_cake/meshes/mesh_entry_view.json",urlEditEntry:"/cake2/rd_cake/meshes/mesh_entry_edit.json",urlViewMeshSettings:"/cake2/rd_cake/meshes/mesh_settings_view.json",urlEditMeshSettings:"/cake2/rd_cake/meshes/mesh_settings_edit.json",urlExitAddDefaults:"/cake2/rd_cake/meshes/mesh_exit_add_defaults.json",urlAddExit:"/cake2/rd_cake/meshes/mesh_exit_add.json",urlViewExit:"/cake2/rd_cake/meshes/mesh_exit_view.json",urlEditExit:"/cake2/rd_cake/meshes/mesh_exit_edit.json",urlViewNodeCommonSettings:"/cake2/rd_cake/meshes/node_common_settings_view.json",urlEditNodeCommonSettings:"/cake2/rd_cake/meshes/node_common_settings_edit.json",urlAddNode:"/cake2/rd_cake/meshes/mesh_node_add.json",urlViewNode:"/cake2/rd_cake/meshes/mesh_node_view.json",urlEditNode:"/cake2/rd_cake/meshes/mesh_node_edit.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlMapPrefEdit:"/cake2/rd_cake/meshes/map_pref_edit.json",urlMapSave:"/cake2/rd_cake/meshes/map_node_save.json",urlMapDelete:"/cake2/rd_cake/meshes/map_node_delete.json",urlMeshNodes:"/cake2/rd_cake/meshes/mesh_nodes_index.json",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json"},refs:[{ref:"editEntryWin",selector:"winMeshEditEntry"},{ref:"editExitWin",selector:"winMeshEditExit"},{ref:"tabMeshes",selector:"#tabMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({gridMeshEntries:{activate:b.gridActivate},"gridMeshEntries #reload":{click:b.reloadEntry},"gridMeshEntries #add":{click:b.addEntry},"gridMeshEntries #edit":{click:b.editEntry},"winMeshAddEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winMeshAddEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winMeshAddEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winMeshAddEntry #save":{click:b.btnAddEntrySave},"gridMeshEntries #delete":{click:b.delEntry},winMeshEditEntry:{beforeshow:b.loadEntry},"winMeshEditEntry cmbEncryptionOptions":{change:b.cmbEncryptionChange},"winMeshEditEntry #chk_maxassoc":{change:b.chkMaxassocChange},"winMeshEditEntry cmbMacFilter":{change:b.cmbMacFilterChange},"winMeshEditEntry #save":{click:b.btnEditEntrySave},"pnlMeshEdit #tabMeshSettings":{activate:b.frmMeshSettingsLoad},"pnlMeshSettings  #con_mesh_point":{change:b.radioMeshPointChange},"pnlMeshSettings  #encryption":{change:b.chkMeshEncryptionChange},"pnlMeshSettings #save":{click:b.btnMeshSettingsSave},gridMeshExits:{activate:b.gridActivate},"gridMeshExits #reload":{click:b.reloadExit},"gridMeshExits #add":{click:b.addExit},winMeshAddExit:{beforeshow:b.loadAddExit},"winMeshAddExit #btnTypeNext":{click:b.btnExitTypeNext},"winMeshAddExit #btnDataPrev":{click:b.btnExitDataPrev},"winMeshAddExit #save":{click:b.btnAddExitSave},"gridMeshExits #delete":{click:b.delExit},"gridMeshExits #edit":{click:b.editExit},winMeshEditExit:{beforeshow:b.loadExit},"winMeshEditExit #save":{click:b.btnEditExitSave},"#chkProxyEnable":{change:b.chkProxyEnableChange},"pnlMeshEdit #tabNodeCommonSettings":{activate:b.frmNodeCommonSettingsLoad},"pnlNodeCommonSettings #save":{click:b.btnNodeCommonSettingsSave},"pnlNodeCommonSettings  #eth_br_chk":{change:b.chkEthBrChange},"gridNodes #reload":{click:b.reloadNodes},"gridNodes #add":{click:b.addNode},"#winMeshAddNodeEdit #save":{click:b.btnAddNodeSave},"gridNodes #delete":{click:b.delNode},"gridNodes #edit":{click:b.editNode},"gridNodes #map":{click:b.mapLoadApi},"#winMeshEditNodeEdit":{beforeshow:b.loadNode},"#winMeshEditNodeEdit #save":{click:b.btnEditNodeSave},"pnlMeshEdit #mapTab":{activate:function(a){b.reloadMap(a)}},"pnlMeshEditGMap #reload":{click:function(g){var a=this;a.reloadMap(g.up("pnlMeshEditGMap"))}},"pnlMeshEditGMap #preferences":{click:b.mapPreferences},"winMeshMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMeshMapPreferences #save":{click:b.mapPreferencesSave},"pnlMeshEditGMap #add":{click:b.mapNodeAdd},"winMeshMapNodeAdd #save":{click:b.meshMapNodeAddSubmit},"pnlMeshEditGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlMeshEditGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave},"winMeshAddExit #chkNasClient":{change:b.chkNasClientChange},"winMeshAddExit #chkLoginPage":{change:b.chkLoginPageChange}})},actionIndex:function(m,j){var n=this;var k="tabMeshEdit"+m;var i=n.getTabMeshes();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnEdit,title:j,closable:true,layout:"fit",xtype:"pnlMeshEdit",itemId:k,border:false,meshId:m,meshName:j})}i.setActiveTab(l)},gridActivate:function(e){var d=this;e.getStore().reload()},reloadEntry:function(h){var j=this;var i=h.up("pnlMeshEdit");var g=i.down("gridMeshEntries");g.getStore().reload()},addEntry:function(l){var k=this;var j=l.up("pnlMeshEdit");var h=j.down("gridMeshEntries").getStore();if(!Ext.WindowManager.get("winMeshAddEntryId")){var i=Ext.widget("winMeshAddEntry",{id:"winMeshAddEntryId",store:h,meshId:j.meshId});i.show()}},cmbEncryptionChange:function(l){var o=this;var p=l.up("form");var j=p.down("#key");var k=p.down("#auth_server");var n=p.down("#auth_secret");var m=l.getValue();if(m=="none"){j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wep")|(m=="psk")|(m=="psk2")){j.setVisible(true);j.setDisabled(false);k.setVisible(false);k.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if((m=="wpa")|(m=="wpa2")){j.setVisible(false);j.setDisabled(true);k.setVisible(true);k.setDisabled(false);n.setVisible(true);n.setDisabled(false)}},chkMaxassocChange:function(i){var k=this;var l=i.up("form");var h=l.down("#maxassoc");var j=i.getValue();if(j){h.setVisible(true);h.setDisabled(false)}else{h.setVisible(false);h.setDisabled(true)}},cmbMacFilterChange:function(j){var h=this;var i=j.up("form");var l=i.down("cmbPermanentUser");var k=j.getValue();if(k=="disable"){l.setVisible(false);l.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false)}},btnAddEntrySave:function(h){var j=this;var i=h.up("winMeshAddEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sNew_mesh_entry_point_added"),i18n("sNew_mesh_enty_point_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},editEntry:function(p){var n=this;var m=p.up("pnlMeshEdit");var j=m.down("gridMeshEntries").getStore();if(m.down("gridMeshEntries").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var o=m.down("gridMeshEntries").getSelectionModel().getLastSelected();var l=o.getId();if(!Ext.WindowManager.get("winMeshEditEntryId")){var k=Ext.widget("winMeshEditEntry",{id:"winMeshEditEntryId",store:j,entryId:l});k.show()}else{var k=n.getEditEntryWin();k.entryId=l;n.loadEntry(k)}}},loadEntry:function(i){var j=this;var g=i.down("form");var h=i.entryId;g.load({url:j.getUrlViewEntry(),method:"GET",params:{entry_id:h},success:function(o,p,a){var n=g.down("cmbMacFilter");var b=n.getValue();if(b!="disable"){var d=g.down("cmbPermanentUser");var e=Ext.create("Rd.model.mPermanentUser",{username:p.result.data.username,id:p.result.data.permanent_user_id});d.getStore().loadData([e],false);d.setValue(p.result.data.permanent_user_id)}}})},btnEditEntrySave:function(h){var j=this;var i=h.up("winMeshEditEntry");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delEntry:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshEntries");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},frmMeshSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.meshId;j.load({url:i.getUrlViewMeshSettings(),method:"GET",params:{mesh_id:h}})},radioMeshPointChange:function(h){var k=this;var l=h.up("form");var i=l.down("#encryption");var j=l.down("#encryption_key");if(h.getValue()){i.setVisible(true);i.setDisabled(false);if(i.getValue()){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}}else{i.setVisible(false);i.setDisabled(true);j.setVisible(false);j.setDisabled(true)}},chkMeshEncryptionChange:function(h){var j=this;var g=h.up("form");var i=g.down("#encryption_key");if(h.getValue()){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},btnMeshSettingsSave:function(h){var j=this;var k=h.up("form");var l=h.up("#tabMeshSettings");var i=l.meshId;k.submit({clientValidation:true,url:j.getUrlEditMeshSettings(),params:{mesh_id:i},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},chkNasClientChange:function(i){var m=this;var n=i.up("form");var k=i.up("window");var j=k.down("#radius_nasid");var l=n.down("#cmbRealm");if(i.getValue()){j.setVisible(false);j.setDisabled(true);l.setVisible(true);l.setDisabled(false)}else{j.setVisible(true);j.setDisabled(false);l.setVisible(false);l.setDisabled(true)}},chkLoginPageChange:function(h){var i=this;var j=h.up("form");var g=j.down("#cmbDynamicDetail");if(h.getValue()){g.setVisible(true);g.setDisabled(false)}else{g.setVisible(false);g.setDisabled(true)}},reloadExit:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshExits");h.getStore().reload()},loadAddExit:function(h){var e=this;var g=h.down("#scrnData");g.load({url:e.getUrlExitAddDefaults(),method:"GET"})},addExit:function(m){var l=this;var k=m.up("pnlMeshEdit");var i=k.down("gridMeshEntries").getStore().count();if(i==0){Ext.ux.Toaster.msg(i18n("sNo_entry_points_defined"),i18n("sDefine_some_entry_points_first"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}var n=k.down("gridMeshExits").getStore();if(!Ext.WindowManager.get("winMeshAddExitId")){var j=Ext.widget("winMeshAddExit",{id:"winMeshAddExitId",store:n,meshId:k.meshId});j.show()}},btnExitTypeNext:function(y){var u=this;var x=y.up("winMeshAddExit");var t=x.down("radiogroup").getValue().exit_type;var z=x.down("#vlan");var r=x.down("#tabCaptivePortal");var w=x.down("#type");var q=x.down("#cmbOpenVpnServers");var o=x.down("#chkNasClient");var p=x.down("#cmbRealm");var A=x.down("#chkLoginPage");var s=x.down("cmbDynamicDetail");w.setValue(t);if(t=="openvpn_bridge"){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}if(t=="tagged_bridge"){z.setVisible(true);z.setDisabled(false)}else{z.setVisible(false);z.setDisabled(true)}if(t=="captive_portal"){r.setDisabled(false);r.tab.show();o.setVisible(true);o.setDisabled(false);A.setVisible(true);A.setDisabled(false);s.setVisible(true);s.setDisabled(false);p.setVisible(true);p.setDisabled(false)}else{r.setDisabled(true);r.tab.hide();o.setVisible(false);o.setDisabled(true);A.setVisible(false);A.setDisabled(true);s.setVisible(false);s.setDisabled(true);p.setVisible(false);p.setDisabled(true)}x.getLayout().setActiveItem("scrnData")},btnExitDataPrev:function(g){var e=this;var h=g.up("winMeshAddExit");h.getLayout().setActiveItem("scrnType")},btnAddExitSave:function(h){var j=this;var i=h.up("winMeshAddExit");var g=i.down("#scrnData");g.submit({clientValidation:true,url:j.getUrlAddExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delExit:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridMeshExits");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editExit:function(x){var t=this;var u=x.up("pnlMeshEdit");var p=u.down("gridMeshExits").getStore();if(u.down("gridMeshExits").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var A=u.down("gridMeshExits").getSelectionModel().getLastSelected();var z=A.getId();var w=A.get("mesh_id");var s=A.get("type");if(!Ext.WindowManager.get("winMeshEditExitId")){var q=Ext.widget("winMeshEditExit",{id:"winMeshEditExitId",store:p,exitId:z,meshId:w,type:s});q.show()}else{var q=t.getEditExitWin();var y=q.down("#vlan");var o=u.down("#cmbOpenVpnServers");var r=q.down("#tabCaptivePortal");q.exitId=z;q.meshId=w;if(s=="openvpn_bridge"){o.setVisible(true);o.setDisabled(false);y.setVisible(false);y.setDisabled(true)}else{o.setVisible(false);o.setDisabled(true)}if(s=="tagged_bridge"){y.setVisible(true);y.setDisabled(false);o.setVisible(false);o.setDisabled(true)}else{y.setVisible(false);y.setDisabled(true)}if(s=="captive_portal"){r.setDisabled(false);r.tab.show()}else{r.setDisabled(true);r.tab.hide()}t.loadExit(q)}}},loadExit:function(i){var g=this;var h=i.down("form");var j=i.exitId;h.load({url:g.getUrlViewExit(),method:"GET",params:{exit_id:j},success:function(d,e,q){var a=h.down("#type");var s=a.getValue();var w=h.down("#vlan");var b=h.down("#cmbOpenVpnServers");if(s=="openvpn_bridge"){b.setVisible(true);b.setDisabled(false);w.setVisible(false);w.setDisabled(true)}else{b.setVisible(false);b.setDisabled(true)}if(s=="tagged_bridge"){w.setVisible(true);w.setDisabled(false);b.setVisible(false);b.setDisabled(true)}else{w.setVisible(false);w.setDisabled(true)}var r=h.down("cmbMeshEntryPoints");r.setValue(e.result.data.entry_points);if(e.result.data.type=="captive_portal"){if((e.result.data.auto_login_page==true)&&(e.result.data.dynamic_detail!=null)){var t=h.down("cmbDynamicDetail");var u=Ext.create("Rd.model.mDynamicDetail",{name:e.result.data.dynamic_detail,id:e.result.data.dynamic_detail_id});t.getStore().loadData([u],false);t.setValue(e.result.data.dynamic_detail_id)}else{}}}})},btnEditExitSave:function(h){var j=this;var i=h.up("winMeshEditExit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditExit(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},frmNodeCommonSettingsLoad:function(g){var i=this;var j=g.down("form");var h=g.meshId;j.load({url:i.getUrlViewNodeCommonSettings(),method:"GET",params:{mesh_id:h}})},chkProxyEnableChange:function(g){var i=this;var h=g.up("panel");var j=Ext.ComponentQuery.query("textfield",h);if(g.getValue()){Ext.Array.each(j,function(a,d,b){a.setDisabled(false);a.setVisible(true)})}else{Ext.Array.each(j,function(a,d,b){a.setDisabled(true);a.setVisible(false)})}},chkEthBrChange:function(i){var k=this;var l=i.up("form");var h=l.down("#eth_br_with");var j=l.down("#eth_br_for_all");if(i.getValue()){h.setDisabled(false);j.setDisabled(false)}else{h.setDisabled(true);j.setDisabled(true)}},btnNodeCommonSettingsSave:function(h){var j=this;var k=h.up("form");var l=h.up("#tabNodeCommonSettings");var i=l.meshId;k.submit({clientValidation:true,url:j.getUrlEditNodeCommonSettings(),params:{mesh_id:i},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadNodes:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridNodes");h.getStore().reload()},addNode:function(l){var k=this;var j=l.up("pnlMeshEdit");var h=j.down("gridNodes").getStore();if(!Ext.WindowManager.get("winMeshAddNodeId")){var i=Ext.widget("winMeshAddNode",{id:"winMeshAddNodeId",store:h,meshId:j.meshId,meshName:j.meshName,itemId:"winMeshAddNodeEdit"});i.show()}},btnAddNodeSave:function(h){var j=this;var i=h.up("winMeshAddNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delNode:function(g){var j=this;var i=g.up("pnlMeshEdit");var h=i.down("gridNodes");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editNode:function(q){var o=this;var m=q.up("pnlMeshEdit");var k=m.down("gridNodes").getStore();if(m.down("gridNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=m.down("gridNodes").getSelectionModel().getLastSelected();var n=p.getId();var r=p.get("mesh_id");if(!Ext.WindowManager.get("winMeshEditNodeId")){var l=Ext.widget("winMeshEditNode",{id:"winMeshEditNodeId",store:k,nodeId:n,meshId:m.meshId,meshName:m.meshName,itemId:"winMeshEditNodeEdit"});l.show()}}},loadNode:function(k){var h=this;var i=k.down("form");var j=k.nodeId;i.load({url:h.getUrlViewNode(),method:"GET",params:{node_id:j}});var l=i.down("#tabAdvWifiRadio1");l.setDisabled(true);l.tab.hide()},btnEditNodeSave:function(h){var j=this;var i=h.up("winMeshEditNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(k){var r=this;var o=k.up("tabpanel");var m="mapTab";var l=o.down("#"+m);if(l){o.setActiveTab(m);return}var p=i18n("sGoogle_Maps");var n=o.up("pnlMeshEdit");var q=o.meshId;Ext.Ajax.request({url:r.getUrlMapPrefView(),method:"GET",params:{mesh_id:q},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){o.add({title:p,itemId:m,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshEditGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:q});o.setActiveTab(m)}},failure:function(a,b){Ext.ux.Toaster.msg("Problems getting the map preferences","Map preferences could not be fetched",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:r})},dragStart:function(i,g,h){var j=this;j.lastMovedMarker=h;j.lastOrigPosition=h.getPosition();j.editWindow=g.editwindow},dragEnd:function(j,l,i){var k=this;var h=i.getPosition();l.new_lng=h.lng();l.new_lat=h.lat();l.editwindow.open(l.gmap,i);k.lastLng=h.lng();k.lastLat=h.lat();k.lastDragId=j},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapDelete(),method:"GET",params:{id:j.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},btnMapSave:function(g){var j=this;var h=g.up("#pnlMapsEdit");var i=h.mapPanel;Ext.Ajax.request({url:j.getUrlMapSave(),method:"GET",params:{id:j.lastDragId,lat:j.lastLat,lon:j.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.editWindow.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.reloadMap(i)}},scope:j})},mapPreferences:function(o){var n=this;var l=o.up("pnlMeshEdit");var m=l.meshId;var j="winMeshMapPreferences_"+m;var p=l.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(j)){var k=Ext.widget("winMeshMapPreferences",{id:j,mapPanel:p,meshId:m});k.show();k.down("form").load({url:n.getUrlMapPrefView(),method:"GET",params:{mesh_id:m}})}},mapNodeAdd:function(o){var n=this;var l=o.up("pnlMeshEdit");var m=l.meshId;var k="winMeshMapNodeAdd_"+m;var p=l.down("pnlMeshEditGMap");if(!Ext.WindowManager.get(k)){var j=Ext.widget("winMeshMapNodeAdd",{id:k,mapPanel:p,meshId:m});j.show()}},meshMapNodeAddSubmit:function(r){var p=this;var n=r.up("winMeshMapNodeAdd");var q=n.down("cmbMeshAddMapNodes");var m=q.getValue();var k=n.mapPanel;n.close();var o=k.gmap.getCenter();var l=k.addMarker({lat:o.lat(),lng:o.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){p.dragEnd(m,k,l)},dragstart:function(){k.addwindow.close();p.dragStart(m,k,l)}}});k.addwindow.open(k.gmap,l)},mapPreferencesSnapshot:function(t){var r=this;var w=t.up("form");var n=t.up("winMeshMapPreferences");var u=n.mapPanel;var m=u.gmap.getZoom();var q=u.gmap.getMapTypeId();var o=u.gmap.getCenter();var s=o.lat();var p=o.lng();w.down("#lat").setValue(s);w.down("#lng").setValue(p);w.down("#zoom").setValue(m);w.down("#type").setValue(q.toUpperCase())},mapPreferencesSave:function(i){var l=this;var h=i.up("form");var j=i.up("winMeshMapPreferences");var k=j.meshId;h.submit({clientValidation:true,url:l.getUrlMapPrefEdit(),params:{mesh_id:k},success:function(b,a){j.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();var h=g.meshId;Ext.Ajax.request({url:e.getUrlMeshNodes(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var l=g.addMarker({lat:i.lat,lng:i.lng,icon:d,draggable:true,title:i.name,listeners:{dragend:function(){e.dragEnd(i.id,g,l)},dragstart:function(){e.dragStart(i.id,g,l)}}})});g.setLoading(false)}},scope:e})}},0,0,0,0,0,0,[Rd.controller,"cMeshEdits"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshView",Ext.tab.Panel,{meshId:undefined,meshName:undefined,plain:true,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sOverview"),itemId:"tabMeshViewOverwiew",xtype:"pnlMeshViewNodes",meshId:b.mesh_id},{title:"SSID &#8660; Device",itemId:"tabMeshViewEntries",xtype:"gridMeshViewEntries",meshId:b.mesh_id},{title:"Node &#8660; Device",itemId:"tabMeshViewNodes",xtype:"gridMeshViewNodes",meshId:b.mesh_id},{title:"Node &#8660; Nodes",itemId:"tabMeshViewNodeNodes",xtype:"gridMeshViewNodeNodes",meshId:b.mesh_id},{title:i18n("sNodes"),itemId:"tabMeshViewNodeDetails",xtype:"gridMeshViewNodeDetails",meshId:b.mesh_id}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlMeshView"],["component","box","container","panel","tabpanel","pnlMeshView"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlMeshView:true},["widget.pnlMeshView"],0,[Rd.view.meshes,"pnlMeshView"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddNodeAction",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:220,glyph:Rd.config.icnAdd,nodeId:null,grid:null,initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",name:"node_id",hidden:true,value:b.nodeId},{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAddNodeAction"],["component","box","container","panel","window","winMeshAddNodeAction"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddNodeAction:true},["widget.winMeshAddNodeAction"],0,[Rd.view.meshes,"winMeshAddNodeAction"],0));(Ext.cmd.derive("Rd.model.mMeshViewEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mesh_entry_id"},{name:"mac"},{name:"vendor"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_node"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewEntry"],0));(Ext.cmd.derive("Rd.store.sMeshViewEntries",Ext.data.Store,{model:"Rd.model.mMeshViewEntry",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_entries.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewEntries"],0));(Ext.cmd.derive("Rd.model.mMeshViewNodeNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mac"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_entry"},{name:"l_contact"},{name:"l_contact_human"},{name:"state"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNodeNode"],0));(Ext.cmd.derive("Rd.store.sMeshViewNodeNodes",Ext.data.Store,{model:"Rd.model.mMeshViewNodeNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_node_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewNodeNodes"],0));(Ext.cmd.derive("Rd.model.mMeshViewNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"mesh_entry_id"},{name:"mac"},{name:"vendor"},{name:"tx_bytes",type:"int"},{name:"rx_bytes",type:"int"},{name:"signal_avg"},{name:"signal_avg_bar"},{name:"signal"},{name:"signal_bar"},{name:"l_tx_bitrate",type:"int"},{name:"l_rx_bitrate",type:"int"},{name:"l_tx_bytes",type:"int"},{name:"l_rx_bytes",type:"int"},{name:"l_MFP"},{name:"l_tx_failed",type:"int"},{name:"l_tx_retries",type:"int"},{name:"l_modified"},{name:"l_modified_human"},{name:"l_authenticated"},{name:"l_authorized"},{name:"l_entry"},{name:"l_contact"},{name:"l_contact_human"},{name:"state"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNode"],0));(Ext.cmd.derive("Rd.store.sMeshViewNodes",Ext.data.Store,{model:"Rd.model.mMeshViewNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false,groupField:"name"},0,0,0,0,0,0,[Rd.store,"sMeshViewNodes"],0));(Ext.cmd.derive("Rd.model.mNodeDetail",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},"last_contact","state","hw_human","mem_free","mem_total","uptime","system_time","load_1","load_2","load_3","release","cpu","last_cmd","last_cmd_status","last_contact_human","gateway","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mNodeDetail"],0));(Ext.cmd.derive("Rd.store.sNodeDetails",Ext.data.Store,{model:"Rd.model.mNodeDetail",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/mesh_reports/view_node_details.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodeDetails"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshViewGMap",Ext.ux.GMapPanel,{markers:[],infoWindows:[],polyLines:[],infowindow:undefined,shadow:undefined,store:undefined,centerLatLng:undefined,meshId:"",mapPanel:"",e_pnl:false,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var j=this;var g=j.centerLatLng.lat;var i=j.centerLatLng.lng;j.center=new google.maps.LatLng(g,i);j.shadow=new google.maps.MarkerImage("resources/images/map_markers/shadow.png",null,null,new google.maps.Point(10,34));var h=document.createElement("div");h.className=h.className+"mapInfoDiv";j.infowindow=new google.maps.InfoWindow({content:h});j.infoWindows.push(j.infowindow);google.maps.event.addListener(j.infowindow,"domready",function(){var a=j.infowindow.getContent();if(j.i_pnl){j.i_pnl.destroy()}var d=new Ext.Template(["<div class='divMapAction'>","<label class='lblMap'>"+i18n("sName")+"  </label><label class='lblValue'>{name}</label>","<div style='clear:both;'></div>","<label class='lblMap'>MAC </label><label class='lblValue'> {mac}</label>","<div style='clear:both;'></div>","<label class='lblMap'>IP Address</label><label class='lblValue'> {ip}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Lat</label><label class='lblValue'> {lat}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Lng</label><label class='lblValue'> {lng}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Last contact</label><label class='lblValue'> {last_contact}</label><br>","</div>"]);var e=false;if(j.marker_data.state=="down"){e=true}var b=j.marker_data.id;j.i_pnl=Ext.create("Ext.tab.Panel",{itemId:"pnlMapsNodeInfo",width:350,height:250,layout:"fit",activeTab:0,nodeId:b,meshId:j.meshId,items:[{title:"Info",itemId:"tabMapsNodeInfo",bodyPadding:2,tpl:d,autoScroll:true,data:j.marker_data,buttonAlign:"center",buttons:[{xtype:"button",itemId:"restart",text:"Restart",scale:"large",glyph:Rd.config.icnPower,disabled:e}]}],renderTo:a});j.i_pnl.doLayout()});Ext.ux.GMapPanel.prototype.initComponent.apply(this,arguments)},addMarker:function(g){var e=this;g=Ext.apply({map:e.gmap,shadow:e.shadow},g);if(!g.position){g.position=new google.maps.LatLng(g.lat,g.lng)}var h=new google.maps.Marker(g);Ext.Object.each(g.listeners,function(b,a){google.maps.event.addListener(h,b,a)});e.markers.push(h);return h},clearMarkers:function(){var b=this;while(b.markers[0]){b.markers.pop().setMap(null)}},addPolyLine:function(h){var j=this;var g=[new google.maps.LatLng(h.from.lat,h.from.lng),new google.maps.LatLng(h.to.lat,h.to.lng)];var i=new google.maps.Polyline({path:g,geodesic:true,strokeColor:h.color,strokeOpacity:h.opacity,strokeWeight:h.weight});i.setMap(j.gmap);j.polyLines.push(i);return i},clearPolyLines:function(){var b=this;while(b.polyLines[0]){b.polyLines.pop().setMap(null)}}},0,["pnlMeshViewGMap"],["component","box","container","panel","gmappanel","pnlMeshViewGMap"],{component:true,box:true,container:true,panel:true,gmappanel:true,pnlMeshViewGMap:true},["widget.pnlMeshViewGMap"],0,[Rd.view.meshes,"pnlMeshViewGMap"],0));(Ext.cmd.derive("Rd.model.mMeshViewNodeAction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"action"},{name:"command",type:"string"},{name:"status",type:"string"},{name:"created"},{name:"modified"}]},0,0,0,0,0,0,[Rd.model,"mMeshViewNodeAction"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeActions",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGMVNA",nodeId:"",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/node_actions/menu_for_grid.json",urlIndex:"/cake2/rd_cake/node_actions/index.json",columns:[{xtype:"rownumberer",stateId:"StateGMVNA1"},{text:i18n("sAction"),dataIndex:"action",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA2"},{text:i18n("sCommand"),dataIndex:"command",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA3"},{text:i18n("sStatus"),flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> '+i18n("sAwaiting")+"</div></tpl>",'<tpl if=\'status == "fetched"\'><div class="fieldGreenWhite"><i class="fa fa-check-circle"></i> '+i18n("sFetched")+"</div></tpl>"),dataIndex:"status",stateId:"StateGMVNA4"},{text:i18n("sCreated"),dataIndex:"created",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA5"},{text:i18n("sModified"),dataIndex:"modified",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGMVNA6"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mMeshViewNodeAction",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/node_actions/delete.json"},simpleSortMode:true},autoLoad:false});b.store.getProxy().setExtraParam("node_id",b.nodeId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeActions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeActions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeActions:true},["widget.gridMeshViewNodeActions"],0,[Rd.view.meshes,"gridMeshViewNodeActions"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewEntries",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_e",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:"{name}",hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewEntries,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewEntries1"},{text:i18n("sSSID"),dataIndex:"name",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){if(a.firstRun==undefined){a.firstRun=true}if(a.firstRun){return}var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var t=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var B=k.get("l_tx_bitrate");var h=k.get("l_rx_bitrate");var y=k.get("l_modified_human");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var e=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var g=k.get("l_tx_failed");var A=k.get("l_tx_retries");var i=k.get("l_authenticated");var d=k.get("l_authorized");var p=k.get("l_node");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Node</label><label class='lblTipValue'>"+p+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+B+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+h+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewEntries:true},["widget.gridMeshViewEntries"],0,[Rd.view.meshes,"gridMeshViewEntries"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:['<span class="{children:this.formatColor}">{name}</span><span class="grpInfo"> {children:this.getLastContact}</span>',{formatColor:function(g){var e=g[0];var h=e.get("state");if(h=="never"){return"grpNever"}if(h=="down"){return"grpDown"}if(h=="up"){return"grpUp"}}},{getLastContact:function(g){var e=g[0];var h=e.get("l_contact_human");if(h==null){return"(never)"}return h}}],hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewNodes,{groupField:"name",listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg("Error encountered",j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.store=Ext.create(Rd.store.sMeshViewNodes,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodes2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodes3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No devices"}else{return((g===0||g>1)?"("+g+" Devices)":"(1 Device)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodes6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewNodes7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewNodes8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var x=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var d=k.get("l_tx_bitrate");var p=k.get("l_rx_bitrate");var y=k.get("l_modified_human");var z=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var g=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var i=k.get("l_tx_failed");var A=k.get("l_tx_retries");var t=k.get("l_authenticated");var e=k.get("l_authorized");var h=k.get("l_entry");var y=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>SSID</label><label class='lblTipValue'>"+h+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+d+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+p+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+z+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+A+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+t+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+e+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodes:true},["widget.gridMeshViewNodes"],0,[Rd.view.meshes,"gridMeshViewNodes"],0));(Ext.cmd.derive("Rd.view.meshes.pnlMeshViewNodes",Ext.panel.Panel,{border:false,urlOverview:"/cake2/rd_cake/mesh_reports/overview.json",meshId:"",config:{displayBugFix:false},viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}],initComponent:function(){var b=this;b.html="<div id='n_t_n_"+b.meshId+"' style='width:100%;height:100%;background-color:#aaf6be;'></div>";b.buffered=Ext.Function.createBuffered(function(){b.fd.computeIncremental({iter:40,property:["end"],onStep:function(a){},onComplete:function(){b.fd.animate({modes:["linear"],transition:$jit.Trans.Elastic.easeOut,duration:2500})}})},1000,b);b.listeners={afterrender:function(h,i,a){b.initCanvas()},afterlayout:function(m,o,a){var h=this;var n=h.getWidth();var l=h.getHeight()-90;h.fd.canvas.resize(n,l);h.buffered()},scope:b};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},getData:function(){var b=this;b.setLoading(true);Ext.Ajax.request({url:b.urlOverview,method:"GET",params:{mesh_id:b.meshId},success:function(a){var e=Ext.JSON.decode(a.responseText);if(e.success){b.fd.loadJSON(e.data);b.buffered();b.setLoading(false)}},scope:b})},initCanvas:function(){var n=this;var r,l,m,i;(function(){var b=navigator.userAgent,e=b.match(/iPhone/i)||b.match(/iPad/i),a=typeof HTMLCanvasElement,g=(a=="object"||a=="function"),d=g&&(typeof document.createElement("canvas").getContext("2d").fillText=="function");r=(!g||(d&&!e))?"Native":"HTML";m=r=="Native";l=g;i=!(e||!g)})();var o="n_t_n_"+n.meshId;var p=new $jit.ForceDirected({Canvas:{height:500,width:200},injectInto:o,Navigation:{enable:true,panning:"avoid nodes",zooming:10},Node:{overridable:true},Edge:{overridable:true,color:"red",lineWidth:0.4},Label:{type:r,size:15,style:"bold",color:"#434446"},Tips:{enable:true,onShow:function(a,b){var d=0;b.eachAdjacency(function(g,h,e){console.log(g);console.log(h);console.log(e);d++});a.innerHTML="<div class='divTip'><h2>"+b.name+"</h2><label class='lblTipItem'>MAC</label><label class='lblTipValue'>"+b.data.mac+"</label><div style='clear:both;'></div><label class='lblTipItem'>Description</label><label class='lblTipValue'>"+b.data.description+"</label><div style='clear:both;'></div><label class='lblTipItem'>Hardware</label><label class='lblTipValue'>"+b.data.hw_human+"</label><div style='clear:both;'></div><label class='lblTipItem'>IP Address</label><label class='lblTipValue'>"+b.data.ip+"</label><div style='clear:both;'></div><label class='lblTipItem'>Last contact</label><label class='lblTipValue'>"+b.data.last_contact_human+"</label><div style='clear:both;'></div></div>"}},Events:{enable:true,type:"Native",onMouseEnter:function(){p.canvas.getElement().style.cursor="move"},onMouseLeave:function(){p.canvas.getElement().style.cursor=""},onDragMove:function(d,b,a){var e=b.getPos();d.pos.setc(e.x,e.y);p.plot()},onTouchMove:function(d,b,a){$jit.util.event.stop(a);this.onDragMove(d,b,a)},onClick:function(a){if(!a){return}console.log(a);a.data["$color"]="#FF0000";p.plot()}},iterations:50,levelDistance:130,onCreateLabel:function(a,b){a.innerHTML=b.name;var d=a.style;d.fontSize="1.8em";d.color="black"}});var q=[{id:"graphnode1",name:".",data:{$color:"#117c25",$type:"circle",$dim:1}}];p.loadJSON(q);n.fd=p}},0,["pnlMeshViewNodes"],["component","box","container","panel","pnlMeshViewNodes"],{component:true,box:true,container:true,panel:true,pnlMeshViewNodes:true},["widget.pnlMeshViewNodes"],0,[Rd.view.meshes,"pnlMeshViewNodes"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridMeshViewNodeNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"splitbutton",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload"),menu:{items:['<b class="menu-title">Reload every:</b>',{text:"30 seconds",itemId:"mnuRefresh30s",group:"refresh",checked:false},{text:"1 minute",itemId:"mnuRefresh1m",group:"refresh",checked:false},{text:"5 minutes",itemId:"mnuRefresh5m",group:"refresh",checked:false},{text:"Stop auto reload",itemId:"mnuRefreshCancel",group:"refresh",checked:true}]}},{xtype:"button",text:"Past hour",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"hour",pressed:true},{xtype:"button",text:"Past day",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"day"},{xtype:"button",text:"Past week",toggleGroup:"time_n",enableToggle:true,scale:"large",itemId:"week"}]}],features:[{ftype:"groupingsummary",groupHeaderTpl:['<span class="{children:this.formatColor}">{name}</span><span class="grpInfo"> {children:this.getLastContact}</span>',{formatColor:function(g){var e=g[0];var h=e.get("state");if(h=="never"){return"grpNever"}if(h=="down"){return"grpDown"}if(h=="up"){return"grpUp"}}},{getLastContact:function(g){var e=g[0];var h=e.get("l_contact_human");if(h==null){return"(never)"}return h}}],hideGroupedHeader:true,enableGroupingMenu:false,startCollapsed:true}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sMeshViewNodeNodes,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshViewNodeNodes1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,stateId:"StateGridMeshViewNodeNodes2"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewNodeNodes3",summaryType:"count",summaryRenderer:function(g,a){var h=a.txBytes;if(h==0){return"No peers"}else{return((g===0||g>1)?"("+g+" Peers)":"(1 Peer)")}}},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries4"},{text:"Data Tx",dataIndex:"tx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries5",itemId:"txBytes",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Data Rx",dataIndex:"rx_bytes",tdCls:"gridTree",flex:1,stateId:"StateGridMeshViewEntries6",renderer:function(a){return Ext.ux.bytesToHuman(a)},summaryType:"sum",summaryRenderer:function(a){return Ext.ux.bytesToHuman(a)}},{text:"Signal avg",dataIndex:"signal_avg",tdCls:"gridTree",stateId:"StateGridMeshViewEntries7",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_avg_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>0.3)&(l<0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}},{text:"Latest signal",dataIndex:"signal",tdCls:"gridTree",stateId:"StateGridMeshViewEntries8",width:150,renderer:function(m,a,k){if(m!=null){var l=k.get("signal_bar");var n="wifigreen";if(l<0.3){n="wifired"}if((l>=0.3)&(l<=0.5)){n="wifiyellow"}var j=Ext.id();Ext.defer(function(){var w=Ext.widget("progressbar",{renderTo:j,value:l,width:140,text:m+" dBm",cls:n});var e=k.get("l_tx_bitrate");var p=k.get("l_rx_bitrate");var x=k.get("l_modified_human");var y=Ext.ux.bytesToHuman(k.get("l_tx_bytes"));var h=Ext.ux.bytesToHuman(k.get("l_rx_bytes"));var i=k.get("l_tx_failed");var d=k.get("l_tx_retries");var t=k.get("l_authenticated");var g=k.get("l_authorized");var x=Ext.create("Ext.tip.ToolTip",{target:j,border:true,anchor:"left",html:["<div>","<h2>Latest connection detail</h2>","<label class='lblTipItem'>Time</label><label class='lblTipValue'>"+x+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx Speed</label><label class='lblTipValue'>"+e+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx Speed</label><label class='lblTipValue'>"+p+"Mb/s</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx bytes</label><label class='lblTipValue'>"+y+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Rx bytes</label><label class='lblTipValue'>"+h+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx failed</label><label class='lblTipValue'>"+i+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Tx retries</label><label class='lblTipValue'>"+d+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authenticated</label><label class='lblTipValue'>"+t+"</label>","<div style='clear:both;'></div>","<label class='lblTipItem'>Authorized</label><label class='lblTipValue'>"+g+"</label>","<div style='clear:both;'></div>","</div>"]})},50);return Ext.String.format('<div id="{0}"></div>',j)}else{return"N/A"}}}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeNodes:true},["widget.gridMeshViewNodeNodes"],0,[Rd.view.meshes,"gridMeshViewNodeNodes"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshViewNodeDetails",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGMVND",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_node_details_grid.json",plugins:[{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<div style="color:grey;  background-color:white; padding:5px;">','<img src="resources/images/MESHdesk/{hardware}.png" alt="{hardware}" height="72" style="float: left; padding-right: 20px;">',"<h2>{name}</h2>","<span>{hw_human}</span>","</div>",'<div class="sectionHeader">',"<h2>DEVICE INFORMATION</h2>","</div>","<div style='background-color:white; padding:5px;'>","<label class='lblMap'>MESH IP  </label><label class='lblValue'>{ip}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Main MAC </label><label class='lblValue'> {mac}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Description </label><label class='lblValue'> {description}</label>","<div style='clear:both;'></div>","<label class='lblMap'>On public maps </label><label class='lblValue'> {on_public_maps}</label>","<div style='clear:both;'></div>","<label class='lblMap'>Status </label>","<tpl if='state == \"down\"'><label class='lblValue txtRed'><i class='fa fa-exclamation-circle'></i> Last contact {last_contact_human}</label></tpl>","<tpl if='state == \"up\"'><label class='lblValue txtGreen'><i class='fa fa-check-circle'></i> Last contact {last_contact_human}</label></tpl>","<div style='clear:both;'></div>","<label class='lblMap'>Uptime </label><label class='lblValue'> {uptime}</label><br>","</div>")}],initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodeDetails,{});b.store.getProxy().setExtraParam("mesh_id",b.meshId);b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGMVND1"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",width:130,renderer:function(i,j,a){var h=a.get("gateway");if(h=="yes"){return'<div class="fieldGreen" style="text-align:left;"> '+i+"</div>"}if(h=="no"){return'<div class="fieldGrey" style="text-align:left;"> '+i+"</div>"}},stateId:"StateGMVND2"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,stateId:"StateGMVND3",hidden:true},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",width:130,stateId:"StateGMVND4"},{text:i18n("sHardware"),dataIndex:"hw_human",tdCls:"gridTree",flex:1,stateId:"StateGMVND5",hidden:true},{text:i18n("sPower"),dataIndex:"power",tdCls:"gridTree",flex:1,stateId:"StateGMVND6",hidden:true},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",width:110,stateId:"StateGMVND7"},{text:i18n("sUptime"),dataIndex:"uptime",tdCls:"gridTree",width:110,stateId:"StateGMVND8"},{text:i18n("sSystem_time"),dataIndex:"system_time",tdCls:"gridTree",width:110,stateId:"StateGMVND9"},{text:i18n("sSystem_load"),dataIndex:"mem_total",tdCls:"gridTree",width:130,renderer:function(i,k,l){var a=l.get("mem_free");var j=l.get("load_1")+" "+l.get("load_2")+" "+l.get("load_3");return Ext.ux.bytesToHuman(a)+"/"+Ext.ux.bytesToHuman(i)+"<br>("+j+")"},stateId:"StateGMVND10",hidden:true},{text:i18n("sFirmware"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(release)"><div class="gridRealm noRight">Not available</div></tpl>','<tpl for="release">',"<tpl>{value}<br></tpl>","</tpl>"),dataIndex:"release",stateId:"StateGMVND11",hidden:true},{text:i18n("sCPU"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(cpu)"><div class="gridRealm noRight">Not available</div></tpl>','<tpl for="cpu">',"<tpl>{value}<br></tpl>","</tpl>"),dataIndex:"cpu",stateId:"StateGMVND12",hidden:true},{text:i18n("sLast_contact"),dataIndex:"state",tdCls:"gridTree",flex:1,renderer:function(i,j,a){if(i!="never"){var h=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreen">'+h+"</div>"}if(i=="down"){return'<div class="fieldRed">'+h+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGMVND13"},{text:i18n("sLast_command"),sortable:false,tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'last_cmd_status == ""\'><div class="fieldBlue">(nothing)</div></tpl>','<tpl if=\'last_cmd_status == "awaiting"\'><div class="fieldBlue"><i class="fa fa-clock-o"></i> {last_cmd}</div></tpl>','<tpl if=\'last_cmd_status == "fetched"\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> {last_cmd}</div></tpl>'),stateId:"StateGMVND14",hidden:false},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGMVND15"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshViewNodeDetails"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshViewNodeDetails"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshViewNodeDetails:true},["widget.gridMeshViewNodeDetails"],0,[Rd.view.meshes,"gridMeshViewNodeDetails"],0));(Ext.cmd.derive("Rd.controller.cMeshViews",Ext.app.Controller,{views:["meshes.pnlMeshView","meshes.gridMeshViewEntries","meshes.gridMeshViewNodes","meshes.pnlMeshViewNodes","meshes.gridMeshViewNodeNodes","meshes.gridMeshViewNodeDetails","meshes.pnlMeshViewGMap","meshes.gridMeshViewNodeActions","meshes.winMeshAddNodeAction"],stores:["sMeshViewEntries","sMeshViewNodeNodes","sMeshViewNodes","sNodeDetails"],models:[],config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlMapPrefView:"/cake2/rd_cake/meshes/map_pref_view.json",urlOverviewGoogleMap:"/cake2/rd_cake/mesh_reports/overview_google_map.json",urlRestartNodes:"/cake2/rd_cake/mesh_reports/restart_nodes.json",urlMeshAddNodeAction:"/cake2/rd_cake/node_actions/add.json",urlBlueMark:"resources/images/map_markers/mesh_blue_node.png",urlRedNode:"resources/images/map_markers/mesh_red_node.png",urlRedGw:"resources/images/map_markers/mesh_red_gw.png",urlGreenNode:"resources/images/map_markers/mesh_green_node.png",urlGreenGw:"resources/images/map_markers/mesh_green_gw.png",urlPhoneGreenGw:"resources/images/map_markers/phone_green_gw.png",urlPhoneGreenNode:"resources/images/map_markers/phone_green.png",urlPhoneRedGw:"resources/images/map_markers/phone_red_gw.png",urlPhoneRedNode:"resources/images/map_markers/phone_red.png",urlPhoneBlueGw:"resources/images/map_markers/phone_blue_gw.png",urlPhoneBlueNode:"resources/images/map_markers/phone_blue.png"},refs:[{ref:"tabMeshes",selector:"#tabMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"pnlMeshView gridMeshViewEntries #reload":{click:b.reloadViewEntry},"pnlMeshView gridMeshViewEntries button":{toggle:b.viewEntryTimeToggle},"pnlMeshView gridMeshViewNodes #reload":{click:b.reloadViewNode},"pnlMeshView gridMeshViewNodes button":{toggle:b.viewNodeTimeToggle},"pnlMeshView #tabMeshViewEntries":{activate:b.tabMeshViewEntriesActivate},"pnlMeshView #tabMeshViewNodes":{activate:b.tabMeshViewNodesActivate},"pnlMeshView #tabMeshViewNodeNodes":{activate:b.tabMeshViewNodeNodesActivate},"pnlMeshView #tabMeshViewNodeDetails":{activate:b.tabMeshViewNodeDetailsActivate},"pnlMeshView gridMeshViewEntries #reload menuitem[group=refresh]":{click:function(e){var a=this;a.autoRefresh(e,"entries")}},"pnlMeshView gridMeshViewNodes #reload menuitem[group=refresh]":{click:function(a){b.autoRefresh(a,"nodes")}},"pnlMeshView gridMeshViewNodeNodes #reload menuitem[group=refresh]":{click:function(a){b.autoRefresh(a,"node_nodes")}},pnlMeshView:{beforeshow:b.winViewClose,destroy:b.winViewClose},"pnlMeshView pnlMeshViewNodes":{activate:function(a){a.getData()}},"#pnlMapsNodeInfo #restart":{click:b.mapRestart},"pnlMeshView pnlMeshViewNodes #reload":{click:function(h){var g=this;var a=h.up("pnlMeshViewNodes");a.getData()}},"pnlMeshView gridMeshViewNodeNodes #reload":{click:b.reloadViewNodeNodes},"pnlMeshView gridMeshViewNodeNodes button":{toggle:b.viewNodeNodesTimeToggle},"gridMeshViewNodeDetails #map":{click:b.mapLoadApi},"pnlMeshView #mapTab":{activate:function(a){b.reloadMap(a)}},"pnlMeshViewGMap #reload":{click:function(g){var a=this;a.reloadMap(g.up("pnlMeshViewGMap"))}},"pnlMeshView gridMeshViewNodeDetails #reload":{click:b.reloadViewNodeDetails},"pnlMeshView gridMeshViewNodeDetails #execute":{click:b.execute},"pnlMeshView gridMeshViewNodeDetails #history":{click:b.history},"pnlMeshView gridMeshViewNodeDetails #restart":{click:b.restart},"winMeshAddNodeAction #save":{click:b.commitExecute},"pnlMeshView gridMeshViewNodeActions #reload":{click:b.reloadNodeActions},"pnlMeshView gridMeshViewNodeActions #add":{click:b.addNodeActions},"pnlMeshView gridMeshViewNodeActions #delete":{click:b.deleteNodeActions},"pnlMeshView gridMeshViewNodeActions":{activate:b.activateNodeActions}})},actionIndex:function(m,j){var n=this;var k="tabMeshView"+m;var i=n.getTabMeshes();var l=i.items.findBy(function(a){return a.getItemId()===k});if(!l){l=i.add({glyph:Rd.config.icnView,title:j,closable:true,layout:"fit",xtype:"pnlMeshView",itemId:k,mesh_id:m})}i.setActiveTab(l)},viewEntryTimeToggle:function(g,h){var e=this;if(h){e.reloadViewEntry(g)}},reloadViewEntry:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewEntries");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},viewNodeTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNode(g)}},reloadViewNode:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewNodes");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},viewNodeNodesTimeToggle:function(g,h){var e=this;if(h){e.reloadViewNodeNodes(g)}},reloadViewNodeNodes:function(p){var l=this;var n=p.up("pnlMeshView");var m=n.down("gridMeshViewNodeNodes");var k=m.down("#day");var j=m.down("#week");var o="hour";if(k.pressed){o="day"}if(j.pressed){o="week"}m.getStore().getProxy().setExtraParam("timespan",o);m.getStore().reload()},tabMeshViewNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNode(b)},tabMeshViewEntriesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewEntry(b)},tabMeshViewNodeNodesActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeNodes(b)},tabMeshViewNodeDetailsActivate:function(h){var g=this;var b=h.down("#reload");g.reloadViewNodeDetails(b)},autoRefresh:function(n,k){var l=this;var j=n.getItemId();var b=n.up("button");var m=30000;clearInterval(l.autoRefresInterval);b.setGlyph(Rd.config.icnTime);if(j=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(j=="mnuRefresh1m"){m=60000}if(j=="mnuRefresh5m"){m=360000}l.autoRefresInterval=setInterval(function(){if(k=="nodes"){l.reloadViewNode(b)}if(k=="node_nodes"){l.reloadViewNodeNodes(b)}if(k=="entries"){l.reloadViewEntry(b)}},m)},winViewClose:function(){var b=this;if(b.autoRefresInterval!=undefined){clearInterval(b.autoRefresInterval)}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(r){var q=this;var n=r.up("tabpanel");var m="mapTab";var k=n.down("#"+m);if(k){n.setActiveTab(m);return}var o=i18n("sGoogle_Maps");var l=n.up("pnlMeshView");var p=n.meshId;Ext.Ajax.request({url:q.getUrlMapPrefView(),method:"GET",params:{mesh_id:p},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){n.add({title:o,itemId:m,closable:true,glyph:Rd.config.icnMap,layout:"fit",xtype:"pnlMeshViewGMap",mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[],meshId:p});n.setActiveTab(m)}},failure:function(a,b){Ext.ux.Toaster.msg("Problems getting the map preferences","Map preferences could not be fetched",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)},scope:q})},reloadMap:function(g){var e=this;g.setLoading(true);g.clearMarkers();g.clearPolyLines();var h=g.meshId;Ext.Ajax.request({url:e.getUrlOverviewGoogleMap(),method:"GET",params:{mesh_id:h},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.each(a.items,function(i){var d=e.getUrlBlueMark();var m=false;if((i.hardware=="mp2_basic")||(i.hardware=="mp2_phone")){m=true}if(m){d=e.getUrlPhoneBlueNode()}if(i.state=="down"){if(m){d=e.getUrlPhoneRedNode()}else{d=e.getUrlRedNode()}}if((i.state=="down")&(i.gateway=="yes")){if(m){d=e.getUrlPhoneRedGw()}else{d=e.getUrlRedGw()}}if(i.state=="up"){if(m){d=e.getUrlPhoneGreenNode()}else{d=e.getUrlGreenNode()}}if((i.state=="up")&(i.gateway=="yes")){if(m){d=e.getUrlPhoneGreenGw()}else{d=e.getUrlGreenGw()}}var n=g.addMarker({lat:i.lat,lng:i.lng,icon:d,title:i.name,listeners:{click:function(j,k){e.markerClick(i,g,n)}}})});Ext.each(a.connections,function(d){var j=g.addPolyLine(d)});g.setLoading(false)}},scope:e})},reloadViewNodeDetails:function(g){var i=this;var j=g.up("pnlMeshView");var h=j.down("gridMeshViewNodeDetails");h.getStore().reload()},markerClick:function(i,g,h){var j=this;g.marker_data=i;g.infowindow.open(g.gmap,h)},execute:function(n){var l=this;var m=n.up("pnlMeshView");var i=m.down("gridMeshViewNodeDetails");var k=i.meshId;if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"Select an item on which to execute the command",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winMeshAddNodeActionId")){var j=Ext.widget("winMeshAddNodeAction",{id:"winMeshAddNodeActionId",grid:i});j.show()}}},commitExecute:function(j){var m=this;var k=j.up("winMeshAddNodeAction");var n=k.down("form");var i=k.grid.getSelectionModel().getSelection();var l=[];Ext.Array.forEach(i,function(b){var a=b.getId();Ext.Array.push(l,{id:a})});n.submit({clientValidation:true,url:m.getUrlMeshAddNodeAction(),params:l,success:function(b,a){k.grid.getStore().reload();k.close();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},history:function(i){var l=this;var m=i.up("pnlMeshView");var k=i.up("tabpanel");var j=m.down("gridMeshViewNodeDetails");if(j.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"Select an item to view the history",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=j.getSelectionModel().getSelection();Ext.Array.forEach(n,function(b){var h=b.getId();var a=b.get("name");var g="hTab_"+h;var e="History for "+a;var d=k.down("#"+g);if(d){k.setActiveTab(g)}else{k.add({title:e,itemId:g,closable:true,glyph:Rd.config.icnWatch,layout:"fit",xtype:"gridMeshViewNodeActions",nodeId:h});k.setActiveTab(g)}})}},restart:function(h){var k=this;var l=h.up("pnlMeshView");var i=l.down("gridMeshViewNodeDetails");var j=i.meshId;if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),"First select an item to restart",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=i.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(g){var e=g.getId();Ext.Array.push(b,{id:e})});Ext.Ajax.request({url:k.getUrlRestartNodes(),method:"POST",jsonData:{nodes:b,mesh_id:j},success:function(e,g){Ext.ux.Toaster.msg("Restart command queued","Command queued for execution",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.getStore().reload()},failure:function(e,g){Ext.ux.Toaster.msg("Problems restarting device",e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);i.getStore().reload()}})}})}},mapRestart:function(b){var k=this;var l=b.up("#pnlMapsNodeInfo");var j=l.nodeId;var i=l.meshId;Ext.Ajax.request({url:k.getUrlRestartNodes(),method:"POST",jsonData:{nodes:[{id:j}],mesh_id:i},success:function(d,a){Ext.ux.Toaster.msg("Restart command queued","Command queued for execution",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);c},failure:function(d,a){Ext.ux.Toaster.msg("Problems restarting device",d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},activateNodeActions:function(e){var d=this;e.getStore().reload()},reloadNodeActions:function(b){var g=this;var h=b.up("gridMeshViewNodeActions");h.getStore().reload()},addNodeActions:function(b){var j=this;var k=b.up("gridMeshViewNodeActions");var i=k.nodeId;if(!Ext.WindowManager.get("winMeshAddNodeAction_"+i)){var l=Ext.widget("winMeshAddNodeAction",{id:"winMeshAddNodeAction_"+i,grid:k,nodeId:i});l.show()}},deleteNodeActions:function(b){var i=this;var j=b.up("gridMeshViewNodeActions");var h=j.nodeId;if(j.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){j.getStore().remove(j.getSelectionModel().getSelection());j.getStore().sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);j.getStore().load()},failure:function(g,l,d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);j.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cMeshViews"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAttachNode",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach node to mesh",width:450,height:550,plain:true,border:false,layout:"fit",iconCls:"add",glyph:Rd.config.icnAttach,autoShow:false,nodeId:"",meshName:"",meshId:"",defaults:{border:false},controller:"vcMeshNodeGeneric",initComponent:function(){var g=this;console.log(g.meshName);console.log(g.meshId);var h=Ext.create("Rd.view.components.cmbMesh",{itemId:"mesh_id",labelClsExtra:"lblRdReq"});h.getStore().loadData([],false);h.getStore().loadData([{id:g.meshId,name:g.meshName}],true);var e=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",itemId:"tabRequired",glyph:Rd.config.icnStar,defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},{itemId:"ac_device",xtype:"textfield",name:"device_type",hidden:true,value:"standard"},h,{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:g.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbHardwareOptions",labelClsExtra:"lblRdReq",allowBlank:false,listeners:{change:"onCmbHardwareOptionsChange"}},{xtype:"cmbStaticEntries",meshId:g.meshId,nodeId:g.nodeId},{xtype:"cmbStaticExits",meshId:g.meshId,nodeId:g.nodeId}]},{title:"Radios",disabled:true,layout:"fit",itemId:"tabRadio",glyph:Rd.config.icnWifi,autoScroll:true,hidden:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio0Enable",name:"radio0_enable",inputValue:"radio0_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio0Mesh",name:"radio0_mesh",inputValue:"radio0_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio0Entry",name:"radio0_entry",inputValue:"radio0_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio0_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio0_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_0_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio0_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio0_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"checkbox",fieldLabel:"Enable",itemId:"chkRadio1Enable",name:"radio1_enable",inputValue:"radio1_enable",checked:true,labelClsExtra:"lblRdReq",listeners:{change:"onChkRadioEnableChange"}},{xtype:"checkbox",fieldLabel:"Mesh",itemId:"chkRadio1Mesh",name:"radio1_mesh",inputValue:"radio1_mesh",checked:true,labelClsExtra:"lblRd",listeners:{change:"onChkRadioMeshChange"}},{xtype:"checkbox",fieldLabel:"Entry point",itemId:"chkRadio1Entry",name:"radio1_entry",inputValue:"radio1_entry",checked:true,labelClsExtra:"lblRd"},{xtype:"radio",fieldLabel:"2.4G",name:"radio1_band",inputValue:"24",itemId:"radio24",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"radio",fieldLabel:"5G",name:"radio1_band",inputValue:"5",itemId:"radio5",labelClsExtra:"lblRd",listeners:{change:"onRadio_1_BandChange"}},{xtype:"numberfield",anchor:"100%",name:"radio1_two_chan",fieldLabel:i18n("s2_pt_4G_Channel"),value:5,maxValue:14,minValue:1,hidden:true,disabled:true,itemId:"numRadioTwoChan"},{xtype:"cmbFiveGigChannels",anchor:"100%",name:"radio1_five_chan",fieldLabel:i18n("s5G_Channel"),hidden:true,disabled:true,itemId:"numRadioFiveChan"}]}]}]},{title:"Advanced",layout:"anchor",glyph:Rd.config.icnSpanner,itemId:"tabAdvanced",defaults:{anchor:"100%"},autoScroll:true,items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"top",border:false,cls:"subTab",items:[{title:"Radio0",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio0_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio0_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio0_htmode",itemId:"radio0_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio0_htmode",itemId:"radio0_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio0_htmode",itemId:"radio0_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio0_htmode",itemId:"radio0_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio0_disable_b",inputValue:"radio0_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio0_diversity",inputValue:"radio0_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio0_noscan",inputValue:"radio0_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio0_ldpc",inputValue:"radio0_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio0_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio0_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio0_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio0_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"Radio1",xtype:"panel",baseCls:"tabRadio",layout:"anchor",itemId:"tabAdvWifiRadio1",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"radiogroup",fieldLabel:"HT-mode",columns:2,vertical:false,items:[{boxLabel:"HT20",name:"radio1_htmode",inputValue:"HT20"},{boxLabel:"HT40",name:"radio1_htmode",inputValue:"HT40"},{boxLabel:"VHT20",name:"radio1_htmode",itemId:"radio1_htmode_vht20",inputValue:"VHT20"},{boxLabel:"VHT40",name:"radio1_htmode",itemId:"radio1_htmode_vht40",inputValue:"VHT40"},{boxLabel:"VHT80",name:"radio1_htmode",itemId:"radio1_htmode_vht80",inputValue:"VHT80"},{boxLabel:"VHT160",name:"radio1_htmode",itemId:"radio1_htmode_vht160",inputValue:"VHT160"}]},{xtype:"checkbox",fieldLabel:"Disable 802.11b",boxLabel:"* Recommended on 2.4G",name:"radio1_disable_b",inputValue:"radio1_disable_b",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Diversity",name:"radio1_diversity",inputValue:"radio1_diversity",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Noscan",name:"radio1_noscan",inputValue:"radio1_noscan",labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"LDPC (Low Density Parity Check)",name:"radio1_ldpc",inputValue:"radio1_ldpc",labelClsExtra:"lblRd"},{xtype:"numberfield",anchor:"100%",name:"radio1_txpower",fieldLabel:"TX Power(dBm)",value:15,maxValue:35,minValue:0},{xtype:"numberfield",anchor:"100%",name:"radio1_beacon_int",fieldLabel:"Beacon Interval",value:100,maxValue:65535,minValue:15},{xtype:"numberfield",anchor:"100%",name:"radio1_distance",fieldLabel:"Distance",value:300,maxValue:3000,minValue:1},{xtype:"textareafield",grow:true,fieldLabel:"HT Capabilities",name:"radio1_ht_capab",anchor:"100%",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"LEDs",xtype:"panel",baseCls:"tabRadio",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"displayfield",fieldLabel:"(Future dev)"},{xtype:"checkbox",fieldLabel:"Neighbor Count",name:"led_neighbor",inputValue:"led_neighbor",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Mesh Traffic",name:"led_mesh",inputValue:"led_mesh",labelClsExtra:"lblRd",disabled:true},{xtype:"checkbox",fieldLabel:"Internet On/Off",name:"led_internet",inputValue:"led_internet",labelClsExtra:"lblRd",disabled:true}]}]}]}]}]});g.items=e;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshAttachNode"],["component","box","container","panel","window","winMeshAttachNode"],{component:true,box:true,container:true,panel:true,window:true,winMeshAttachNode:true},["widget.winMeshAttachNode"],0,[Rd.view.meshes,"winMeshAttachNode"],0));(Ext.cmd.derive("Rd.view.meshes.gridMeshes",Ext.grid.Panel,{multiSelect:true,store:"sMeshes",stateful:true,stateId:"StateGridMeshes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridMeshes1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridMeshes2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridMeshes3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSsids4"},{text:i18n("sSSID"),dataIndex:"ssid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridMeshes5"},{text:i18n("sBSSID"),dataIndex:"bssid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridMeshes6"},{text:i18n("sNode_count"),dataIndex:"node_count",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl><div class="fieldGreyWhite">{node_count}</div></tpl>'),stateId:"StateGridMeshes7",width:Rd.config.gridNumberCol},{text:i18n("sNodes_up"),dataIndex:"nodes_up",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='nodes_up &gt; 0'><div class=\"fieldGreenWhite\">{nodes_up}</div>",'<tpl else><div class="fieldBlue">{nodes_up}</div></tpl>'),stateId:"StateGridMeshes8",width:Rd.config.gridNumberCol},{text:i18n("sNodes_down"),dataIndex:"nodes_down",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='nodes_down &gt; 0'><div class=\"fieldRedWhite\">{nodes_down}</div>",'<tpl else><div class="fieldBlue">{nodes_down}</div></tpl>'),stateId:"StateGridMeshes9",width:Rd.config.gridNumberCol},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridMeshes10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridMeshes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridMeshes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridMeshes:true},["widget.gridMeshes"],0,[Rd.view.meshes,"gridMeshes"],0));(Ext.cmd.derive("Rd.view.meshes.gridNodeLists",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridNodeLists",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/meshes/menu_for_nodes_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sNodeLists,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridNodeLists1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,stateId:"StateGridNodeLists2",sortable:false,hidden:true},{text:"Mesh",dataIndex:"mesh",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists3"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",width:130,renderer:function(i,j,a){var h=a.get("gateway");if(h=="yes"){return'<div class="fieldGreen" style="text-align:left;"> '+i+"</div>"}if(h=="no"){return'<div class="fieldGrey" style="text-align:left;"> '+i+"</div>"}},stateId:"StateGridNodeLists4",flex:1,filter:{type:"string"}},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists5"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists6"},{text:i18n("sHardware"),dataIndex:"hardware",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists7"},{text:"Last contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(k,l,a){var i=a.get("state");if(i!="never"){var j=a.get("last_contact_human");if(i=="up"){return'<div class="fieldGreenWhite">'+j+"</div>"}if(i=="down"){return'<div class="fieldRedWhite">'+j+"</div>"}}else{return'<div class="fieldBlue">Never</div>'}},stateId:"StateGridNodeLists8"},{text:i18n("sIP_Address"),dataIndex:"ip",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNodeLists9"},{text:"OpenVPN Connections",sortable:false,width:150,hidden:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl for="openvpn_list">','<tpl if=\'lc_human == "never"\'><div class="fieldBlue">{name}</div>','<div style="font-size: 12px;">(Never tested {name})</div>',"<tpl else>","<tpl if='state == true'>",'<div class="fieldGreen">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested up {lc_human}</div>',"</tpl>","<tpl if='state == false'>",'<div class="fieldRed">{name}</div>','<div style="font-size: 12px; color:#4d4d4d;">Tested down {lc_human}</div>',"</tpl>","</tpl>","</tpl>"),dataIndex:"openvpn_list",stateId:"StateGridNodeLists10"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNodeLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNodeLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNodeLists:true},["widget.gridNodeLists"],0,[Rd.view.meshes,"gridNodeLists"],0));(Ext.cmd.derive("Rd.view.meshes.gridUnknownNodes",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUnknownNodes",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/node_lists/menu_for_unknown_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.store=Ext.create(Rd.store.sUnknownNodes,{listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg(i18n("sError_encountered"),h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(j,a,h,i){j.sync({success:function(d,e){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridUnknownNodes1"},{text:"MAC Address",dataIndex:"mac",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUnknownNodes2"},{text:"Vendor",dataIndex:"vendor",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUnknownNodes3"},{text:"Last contact",dataIndex:"last_contact",tdCls:"gridTree",flex:1,renderer:function(j,k,l){if(l.get("last_contact")==null){return'<div class="fieldBlueWhite">Never</div>'}var i=l.get("last_contact_human");var a=false;if((i.match(/just now/g))||(i.match(/minute/g))||(i.match(/second/g))){a=true}if(a){return'<div class="fieldGreenWhite">'+i+"</div>"}else{return'<div class="fieldPurpleWhite">'+i+"</div>"}},stateId:"StateGridUnknownNodes4"},{text:"From IP",dataIndex:"from_ip",tdCls:"gridTree",flex:1,hidden:false,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldGreyWhite">{from_ip}</div>',"<tpl if='Ext.isEmpty(city)'><tpl else>","<div><b>{city}</b>  ({postal_code})</div>","</tpl>","<tpl if='Ext.isEmpty(country_name)'><tpl else>","<div><b>{country_name}</b> ({country_code})</div>","</tpl>"),filter:{type:"string"},stateId:"StateGridUnknownNodes5"},{text:"Gateway",flex:1,hidden:false,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='gateway == true'><div class=\"fieldGreenWhite\">"+i18n("sYes")+"</div></tpl>","<tpl if='gateway == false'><div class=\"fieldRedWhite\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"gateway",filter:{type:"boolean"},stateId:"StateGridUnknownNodes6"},{text:"Redirect To",flex:1,hidden:false,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='new_server'>",'<tpl if=\'new_server_status == "awaiting"\'><div class="fieldBlueWhite">{new_server}</div></tpl>','<tpl if=\'new_server_status == "fetched"\'><div class="fieldGreenWhite">{new_server}</div></tpl>',"</tpl>"),dataIndex:"new_server",filter:{type:"boolean"},stateId:"StateGridUnknownNodes7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUnknownNodes"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUnknownNodes"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUnknownNodes:true},["widget.gridUnknownNodes"],0,[Rd.view.meshes,"gridUnknownNodes"],0));(Ext.cmd.derive("Rd.model.mMesh",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"ssid",type:"string"},{name:"bssid",type:"string"},{name:"owner",type:"string"},{name:"node_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"nodes_up",type:"int"},{name:"nodes_down",type:"int"},{name:"connected_users",type:"int"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"view",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mMesh"],0));(Ext.cmd.derive("Rd.model.mNodeList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mesh_id",type:"int"},{name:"mesh",type:"string"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"mac",type:"string"},{name:"hardware",type:"string"},{name:"power",type:"int"},{name:"ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"},"last_contact_human","state","gateway","openvpn_list"]},0,0,0,0,0,0,[Rd.model,"mNodeList"],0));(Ext.cmd.derive("Rd.model.mUnknownNode",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"},{name:"vendor",type:"string"},{name:"from_ip",type:"string"},{name:"vendor",type:"string"},{name:"gateway",type:"bool"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},"last_contact_human","new_server","new_server_status","country_code","country_name","city","postal_code"]},0,0,0,0,0,0,[Rd.model,"mUnknownNode"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshUnknownRedirect",Ext.window.Window,{title:"Redirect To Another Server",layout:"fit",autoShow:false,width:350,height:250,glyph:Rd.config.icnRedirect,unknownNodeId:"",new_server:"",initComponent:function(){var b=this;b.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"unknown_node_id",xtype:"textfield",name:"id",hidden:true,value:b.unknownNodeId},{xtype:"textfield",fieldLabel:"IP Address / FQDN",name:"new_server",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",value:b.new_server}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshUnknownRedirect"],["component","box","container","panel","window","winMeshUnknownRedirect"],{component:true,box:true,container:true,panel:true,window:true,winMeshUnknownRedirect:true},["widget.winMeshUnknownRedirect"],0,[Rd.view.meshes,"winMeshUnknownRedirect"],0));(Ext.cmd.derive("Rd.store.sMeshes",Ext.data.Store,{model:"Rd.model.mMesh",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/meshes/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sMeshes"],0));(Ext.cmd.derive("Rd.store.sNodeLists",Ext.data.Store,{model:"Rd.model.mNodeList",remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/node_lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/meshes/mesh_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNodeLists"],0));(Ext.cmd.derive("Rd.store.sUnknownNodes",Ext.data.Store,{model:"Rd.model.mUnknownNode",remoteSort:false,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/node_lists/unknown_nodes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/node_lists/unknown_node_delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sUnknownNodes"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_mesh"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winMeshAddWizard"],["component","box","container","panel","window","winMeshAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winMeshAddWizard:true},["widget.winMeshAddWizard"],0,[Rd.view.meshes,"winMeshAddWizard"],0));(Ext.cmd.derive("Rd.controller.cMeshes",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:true,itemId:"tabMeshes",items:[{title:i18n("sMeshes"),xtype:"gridMeshes",glyph:Rd.config.icnMesh},{title:i18n("sKnown_Nodes"),xtype:"gridNodeLists",glyph:Rd.config.icnCheck},{title:i18n("sUnknown_Nodes"),xtype:"gridUnknownNodes",glyph:Rd.config.icnQuestion}]});d.populated=true},views:["meshes.gridMeshes","meshes.winMeshAddWizard","meshes.gridNodeLists","meshes.winMeshEditNode","meshes.gridUnknownNodes","meshes.winMeshAttachNode","meshes.winMeshUnknownRedirect","meshes.cmbHardwareOptions","meshes.cmbStaticEntries","meshes.cmbStaticExits"],stores:["sMeshes","sAccessProvidersTree","sNodeLists","sUnknownNodes","sMeshEntries","sMeshExits","sMeshEntryPoints"],models:["mMesh","mAccessProviderTree","mNodeList","mUnknownNode"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/meshes/add.json",urlDelete:"/cake2/rd_cake/meshes/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlNoteAdd:"/cake2/rd_cake/meshes/note_add.json",urlAddNode:"/cake2/rd_cake/meshes/mesh_node_add.json",urlViewNode:"/cake2/rd_cake/meshes/mesh_node_view.json",urlEditNode:"/cake2/rd_cake/meshes/mesh_node_edit.json",urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json",urlRedirectNode:"/cake2/rd_cake/nodes/redirect_unknown.json"},refs:[{ref:"grid",selector:"gridMeshes"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabMeshes":{destroy:b.appClose},"#tabMeshes gridMeshes":{activate:b.gridActivate},"#tabMeshes gridNodeLists":{activate:b.gridActivate},"#tabMeshes gridUnknownNodes":{activate:b.gridActivate},"gridMeshes #reload":{click:b.reload},"gridMeshes #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridMeshes #add":{click:b.add},"gridMeshes #delete":{click:b.del},"gridMeshes #edit":{click:b.edit},"gridMeshes #view":{click:b.view},"gridMeshes #note":{click:b.note},gridMeshes:{select:b.select},"gridNote[noteForGrid=meshes] #reload":{click:b.noteReload},"gridNote[noteForGrid=meshes] #add":{click:b.noteAdd},"gridNote[noteForGrid=meshes] #delete":{click:b.noteDelete},"gridNote[noteForGrid=meshes]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=meshes] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=meshes] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=meshes] #btnNoteAddNext":{click:b.btnNoteAddNext},"winMeshAddWizard #btnTreeNext":{click:b.btnTreeNext},"winMeshAddWizard #btnDataPrev":{click:b.btnDataPrev},"winMeshAddWizard #btnDataNext":{click:b.btnDataNext},"gridNodeLists #reload":{click:b.gridNodeListsReload},"gridNodeLists #reload menuitem[group=refresh]":{click:b.reloadNodeListsOptionClick},"gridNodeLists #add":{click:b.addNode},"#winMeshAddNodeMain #save":{click:b.btnAddNodeSave},"gridNodeLists #delete":{click:b.delNode},"gridNodeLists #edit":{click:b.editNode},"#winMeshEditNodeMain":{beforeshow:b.loadNode},"#winMeshEditNodeMain #save":{click:b.btnEditNodeSave},"gridUnknownNodes #reload":{click:b.gridUnknownNodesReload},"gridUnknownNodes #reload menuitem[group=refresh]":{click:b.reloadUnknownNodesOptionClick},"gridUnknownNodes #attach":{click:b.attachNode},"winMeshAttachNode #save":{click:b.btnAttachNodeSave},"gridUnknownNodes #delete":{click:b.delUnknownNode},"gridUnknownNodes #redirect":{click:b.redirectNode},"winMeshUnknownRedirect #save":{click:b.btnRedirectNodeSave}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}if(b.autoReloadNodeLists!=undefined){clearInterval(b.autoReloadNodeLists)}if(b.autoReloadUnknownNodes!=undefined){clearInterval(b.autoReloadUnknownNodes)}},gridActivate:function(d){var e=this;d.getStore().load()},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winMeshAddWizardId")){var h=Ext.widget("winMeshAddWizard",{id:"winMeshAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winMeshAddWizardId")){var h=Ext.widget("winMeshAddWizard",{id:"winMeshAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winMeshAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winMeshAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sMeshes").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(m,n){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=n.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=n.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var j=n.get("view");if(j==true){if(tb.down("#view")!=null){tb.down("#view").setDisabled(false)}}else{if(tb.down("#view")!=null){tb.down("#view").setDisabled(true)}}},view:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cMeshViews","Index",k,j)}}},edit:function(i){var l=this;var m=l.getGrid().getSelectionModel().getCount();if(m==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(m>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=l.getGrid().getSelectionModel().getLastSelected();var k=n.getId();var j=n.get("name");l.application.runAction("cMeshEdits","Index",k,j)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteMeshes"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteMeshes"+m.getId(),noteForId:m.getId(),noteForGrid:"meshes",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteMeshesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteMeshesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteMeshesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteMeshesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},gridNodeListsReload:function(g){var h=this;var e=g.up("gridNodeLists");e.getStore().load()},reloadNodeListsOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadNodeLists);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadNodeLists=setInterval(function(){j.gridNodeListsReload(b)},k)},addNode:function(n){var m=this;var k=n.up("#tabMeshes");var i=k.down("gridNodeLists").getStore();var l=true;if(!Ext.WindowManager.get("winMeshAddNodeId")){var j=Ext.widget("winMeshAddNode",{id:"winMeshAddNodeId",store:i,meshId:"",meshName:"",itemId:"winMeshAddNodeMain"});j.show()}},btnAddNodeSave:function(h){var j=this;var i=h.up("winMeshAddNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delNode:function(g){var i=this;var j=g.up("#tabMeshes");var h=j.down("gridNodeLists");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},editNode:function(s){var p=this;var q=s.up("#tabMeshes");var m=q.down("gridNodeLists").getStore();if(q.down("gridNodeLists").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var w=q.down("gridNodeLists").getSelectionModel().getLastSelected();var u=w.getId();var r=w.get("mesh_id");var n=w.get("mesh");var t=true;if(!Ext.WindowManager.get("winMeshEditNodeId")){var o=Ext.widget("winMeshEditNode",{id:"winMeshEditNodeId",store:m,nodeId:u,meshId:r,meshName:n,hidePower:t,itemId:"winMeshEditNodeMain"});o.show()}}},loadNode:function(k){var h=this;var i=k.down("form");var j=k.nodeId;i.load({url:h.getUrlViewNode(),method:"GET",params:{node_id:j}});var l=i.down("#tabAdvWifiRadio1");l.setDisabled(true);l.tab.hide()},btnEditNodeSave:function(h){var j=this;var i=h.up("winMeshEditNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEditNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridUnknownNodesReload:function(g){var h=this;var e=g.up("gridUnknownNodes");e.getStore().load()},reloadUnknownNodesOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReloadUnknownNodes);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReloadUnknownNodes=setInterval(function(){j.gridUnknownNodesReload(b)},k)},attachNode:function(u){var q=this;var s=u.up("#tabMeshes");var n=s.down("gridUnknownNodes").getStore();if(s.down("gridUnknownNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var y=s.down("gridUnknownNodes").getSelectionModel().getLastSelected();var x=y.getId();var t="";var o="";var r=y.get("mac");var w=true;if(!Ext.WindowManager.get("winMeshAttachNodeId")){var p=Ext.widget("winMeshAttachNode",{id:"winMeshAttachNodeId",store:n,mac:r});p.show()}}},btnAttachNodeSave:function(h){var j=this;var i=h.up("winMeshAttachNode");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},delUnknownNode:function(g){var i=this;var j=g.up("#tabMeshes");var h=j.down("gridUnknownNodes");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},redirectNode:function(q){var o=this;var n=q.up("#tabMeshes");var r=n.down("gridUnknownNodes").getStore();if(n.down("gridUnknownNodes").getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var p=n.down("gridUnknownNodes").getSelectionModel().getLastSelected();var m=p.getId();var l=p.get("new_server");if(!Ext.WindowManager.get("winMeshUnknownRedirectId")){var k=Ext.widget("winMeshUnknownRedirect",{id:"winMeshUnknownRedirectId",unknownNodeId:m,new_server:l,store:r});k.show()}}},btnRedirectNodeSave:function(h){var j=this;var i=h.up("winMeshUnknownRedirect");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlRedirectNode(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},0,0,0,0,0,0,[Rd.controller,"cMeshes"],0));(Ext.cmd.derive("Rd.model.mRealmForNasOwner",Ext.data.Model,{fields:["id","name","selected"]},0,0,0,0,0,0,[Rd.model,"mRealmForNasOwner"],0));(Ext.cmd.derive("Rd.model.mTag",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTag"],0));(Ext.cmd.derive("Rd.model.mDynamicAttribute",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mDynamicAttribute"],0));(Ext.cmd.derive("Rd.model.mNasType",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mNasType"],0));(Ext.cmd.derive("Rd.model.mNaState",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"state",type:"bool"},{name:"time",type:"string"},{name:"start",type:"string"},{name:"end",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mNaState"],0));(Ext.cmd.derive("Rd.model.mAction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"action"},{name:"command",type:"string"},{name:"status",type:"string"},{name:"created"},{name:"modified"}]},0,0,0,0,0,0,[Rd.model,"mAction"],0));(Ext.cmd.derive("Rd.view.nas.pnlNas",Ext.tab.Panel,{border:false,nas_id:null,url:null,plain:true,cls:"subTab",initComponent:function(){var b=this;Ext.Ajax.request({url:b.url+"?nas_id="+b.nas_id,method:"GET",success:b.buildPanel,scope:b});Ext.tab.Panel.prototype.initComponent.apply(this,arguments)},buildPanel:function(p){var l=this;var j=[];var n=Ext.JSON.decode(p.responseText);if(n.success){l.add(n.items);l.setActiveTab(0);var m=l.down("gridRealmsForNasOwner");m.getStore().getProxy().setExtraParam("nas_id",l.nas_id);m.getStore().getProxy().setExtraParam("owner_id",l.record.get("user_id"));m.getStore().getProxy().setExtraParam("available_to_siblings",l.record.get("available_to_siblings"));var k=l.down("gridNasAvailability");k.getStore().getProxy().setExtraParam("nas_id",l.nas_id);var o=l.down("gridNasActions");if(o!=undefined){o.getStore().getProxy().setExtraParam("nas_id",l.nas_id)}}}},0,["pnlNas"],["component","box","container","panel","tabpanel","pnlNas"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlNas:true},["widget.pnlNas"],0,[Rd.view.nas,"pnlNas"],0));(Ext.cmd.derive("Rd.store.sDynamicAttributes",Ext.data.Store,{model:"Rd.model.mDynamicAttribute",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/dynamic_attributes.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sDynamicAttributes"],0));(Ext.cmd.derive("Rd.view.nas.winNasAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sAdd_NAS_device"),width:500,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",urlConnTypes:"/cake2/rd_cake/nas/conn_types_available.json",defaults:{border:false},initComponent:function(){var o=this;var l=o.mkScrnApTree();var m=o.mkScrnConType();var k=o.mkScrnOpenvpn();var n=o.mkScrnDynamic();var p=o.mkScrnDirect();var j=o.mkScrnPptp();this.items=[l,m,k,n,p,j];Ext.window.Window.prototype.initComponent.apply(this,arguments);Ext.Ajax.request({url:o.urlConnTypes,method:"GET",success:o.addConnTypes,scope:o});o.getLayout().setActiveItem(o.startScreen)},addConnTypes:function(h){var i=this;var j=Ext.JSON.decode(h.responseText);var g=i.down("radiogroup");if(j.success){Ext.Array.each(j.items,function(a,b){if(b==0){g.add({boxLabel:a.name,name:"rb",inputValue:a.id,checked:true})}else{g.add({boxLabel:a.name,name:"rb",inputValue:a.id})}})}},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnConType:function(){var h=this;var e=[{itemId:"btnConTypePrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnConTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(h.no_tree){e=[{itemId:"btnConTypeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var g=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnConType",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:"15 10 15 10"},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sChoose_a_connection_type"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sConnection_type"),columns:1,vertical:true}],buttons:e});return g},mkScrnOpenvpn:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnOpenvpn",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",buttons:[{itemId:"btnOpenvpnPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnOpenvpnNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sOpenVPN"),layout:"anchor",itemId:"tabVpn",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sOpenVPN_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",labelClsExtra:"lblRd"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}]});return d},mkScrnPptp:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnPptp",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",buttons:[{itemId:"btnPptpPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnPptpNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sPPTP"),layout:"anchor",itemId:"tabVpn",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sPPTP_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}]});return d},mkScrnDynamic:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnDynamic",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sDynamic_AVP_detail"),layout:"anchor",itemId:"tabDynamic",defaults:{anchor:"100%"},tbar:[{xtype:"tbtext",text:i18n("sUnique_AVP_combination"),cls:"lblWizard"}],items:[{xtype:"combo",fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sDynamicAttributes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"dynamic_attribute",name:"dynamic_attribute"},{itemId:"dynamic_value",xtype:"textfield",fieldLabel:i18n("sValue"),name:"dynamic_value",allowBlank:false,blankText:i18n("sValue_to_identify_the_NAS_with"),labelClsExtra:"lblRdReq"}]},{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,value:i18n("sSet_by_server"),disabled:true,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}],buttons:[{itemId:"btnDynamicPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDynamicNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]});return d},mkScrnDirect:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnDirect",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:10},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sNAS"),layout:"anchor",itemId:"tabNas",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"IPAddress"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sRealms"),itemId:"tabRealms",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll",name:"available_to_all",inputValue:true}],layout:"fit",items:{xtype:"gridRealmsForNasOwner",realFlag:true}}]}],buttons:[{itemId:"btnDirectPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDirectNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]});return d}},0,["winNasAddWizard"],["component","box","container","panel","window","winNasAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winNasAddWizard:true},["widget.winNasAddWizard"],0,[Rd.view.nas,"winNasAddWizard"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",nas_id:undefined,cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.nas_id,type:"nas"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.nas_id,type:"nas"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.nas_id,type:"nas"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasGraphs"],["component","box","container","panel","tabpanel","pnlNasGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlNasGraphs:true},["widget.pnlNasGraphs"],0,[Rd.view.nas,"pnlNasGraphs"],0));(Ext.cmd.derive("Rd.view.nas.winNasActionAdd",Ext.window.Window,{title:i18n("sAdd_a_command"),layout:"fit",autoShow:false,width:350,height:200,iconCls:"add",glyph:Rd.config.icnAdd,nas_id:null,grid:null,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",name:"na_id",hidden:true,value:b.nas_id},{fieldLabel:i18n("sCommand"),name:"command",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winNasActionAdd"],["component","box","container","panel","window","winNasActionAdd"],{component:true,box:true,container:true,panel:true,window:true,winNasActionAdd:true},["widget.winNasActionAdd"],0,[Rd.view.nas,"winNasActionAdd"],0));(Ext.cmd.derive("Rd.view.nas.gridNas",Ext.grid.Panel,{store:"sNas",stateful:true,multiSelect:true,stateId:"StateGridNas",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},border:false,urlMenu:"/cake2/rd_cake/nas/menu_for_grid.json",urlTagFilter:"/cake3/rd_cake/tags/index-for-filter.json",urlRealmFilter:"/cake3/rd_cake/realms/index-for-filter.json",plugins:"gridfilters",initComponent:function(){var g=this;g.bbar=[{xtype:"pagingtoolbar",store:g.store,dock:"bottom",displayInfo:true}];g.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:g.urlMenu});var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"direct",text:"Direct"},{id:"openvpn",text:"OpenVPN"},{id:"pptp",text:"PPTP"},{id:"dynamic",text:"Dynamic"}]});options:["direct","openvpn","pptp","dynamic"];var j=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:g.urlTagFilter,reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});var i=Ext.create(Ext.data.Store,{model:"Rd.model.mGenericList",extend:"Ext.data.Store",proxy:{type:"ajax",format:"json",batchActions:true,url:g.urlRealmFilter,reader:{type:"json",keepRawData:true,rootProperty:"items",messageProperty:"message"}},autoLoad:true});g.columns=[{xtype:"rownumberer",stateId:"StateGridNas1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridNas2",hidden:true},{text:i18n("sIP_Address"),dataIndex:"nasname",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridNas3"},{text:i18n("sName"),dataIndex:"shortname",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridNas4"},{text:i18n("sNAS-Identifier"),dataIndex:"nasidentifier",tdCls:"gridMain",flex:1,filter:{type:"string"},hidden:false,stateId:"StateGridNas5"},{text:i18n("sConnection_type"),dataIndex:"connection_type",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"list",store:h},stateId:"StateGridNas6"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridNas7"},{text:i18n("sRealms"),sortable:false,flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(realms)"><div class="fieldBlueWhite">Available to all!</div></tpl>','<tpl for="realms">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"realms",filter:{type:"list",store:i},stateId:"StateGridNas8"},{text:i18n("sTags"),sortable:false,flex:1,hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(tags)"><div"></div></tpl>','<tpl for="tags">',"<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">{name}</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">{name}</div></tpl>","</tpl>"),dataIndex:"tags",filter:{type:"list",store:j},stateId:"StateGridNas9"},{text:i18n("sStatus"),dataIndex:"status",flex:1,renderer:function(a,d,e){if(a!="unknown"){var b=e.get("status_time");if(a=="up"){return'<div class="fieldGreen">'+i18n("sUp")+" "+Ext.ux.secondsToHuman(b)+"</div>"}if(a=="down"){return'<div class="fieldRed">'+i18n("sDown")+" "+Ext.ux.secondsToHuman(b)+"</div>"}}else{return'<div class="fieldBlue">'+i18n("sUnknown")+"</div>"}},stateId:"StateGridNas10"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridNas11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNas"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNas"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNas:true},["widget.gridNas"],0,[Rd.view.nas,"gridNas"],0));(Ext.cmd.derive("Rd.view.nas.gridRealmsForNasOwner",Ext.grid.Panel,{border:false,realFlag:false,columns:[{xtype:"rownumberer"},{text:i18n("sName"),dataIndex:"name",tdCls:"gridTree",flex:1},{xtype:"advCheckColumn",text:"Include",dataIndex:"selected",renderer:function(m,l,i){var k="x-",j=[k+"grid-checkheader"],n=false;if(m&&n){j.push(k+"grid-checkheader-checked-disabled")}else{if(m){j.push(k+"grid-checkheader-checked")}else{if(n){j.push(k+"grid-checkheader-disabled")}}}return'<div class="'+j.join(" ")+'">&#160;</div>'}}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;if(b.realFlag){urlUpdate="/cake3/rd_cake/realms/update-na-realm.json";b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbseparator"},{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_sub_providers"),cls:"lblRd",itemId:"chkAvailSub",name:"available_to_siblings",inputValue:true}]}else{b.tbar=[{xtype:"button",iconCls:"b-reload",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")}]}b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRealmForNasOwner",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/realms/list_realms-for-nas-owner.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{read:"/cake3/rd_cake/realms/list_realms-for-nas-owner.json",update:"/cake3/rd_cake/realms/update-na-realm.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg("Updated Realm","Updated Realm",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d){Ext.ux.Toaster.msg("Problems Updating Realm","Problems Updating Realm",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}})}},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealmsForNasOwner"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealmsForNasOwner"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealmsForNasOwner:true},["widget.gridRealmsForNasOwner"],0,[Rd.view.nas,"gridRealmsForNasOwner"],0));(Ext.cmd.derive("Rd.view.nas.winTagManage",Ext.window.Window,{title:i18n("sAdd_or_remove_tags"),layout:"fit",autoShow:false,width:350,height:300,iconCls:"tags",glyph:Rd.config.icnTags,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSelect_an_action_and_a_tag"),cls:"lblWizard"}],items:[{xtype:"radiogroup",fieldLabel:i18n("sAction"),columns:1,vertical:true,items:[{boxLabel:i18n("sAdd"),name:"rb",inputValue:"add",checked:true},{boxLabel:i18n("sRemove"),name:"rb",inputValue:"remove"}]},{xtype:"combo",fieldLabel:i18n("sTags"),store:"sTags",queryMode:"local",editable:false,allowBlank:false,name:"tag_id",displayField:"name",valueField:"id"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winTagManage"],["component","box","container","panel","window","winTagManage"],{component:true,box:true,container:true,panel:true,window:true,winTagManage:true},["widget.winTagManage"],0,[Rd.view.nas,"winTagManage"],0));(Ext.cmd.derive("Rd.view.nas.pnlRealmsForNasOwner",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"fit",tbar:[{xtype:"checkboxfield",boxLabel:i18n("sMake_available_to_any_realm"),cls:"lblRd",itemId:"chkAvailForAll"}],initComponent:function(){var d=this;var e=Ext.create("Rd.view.nas.gridRealmsForNasOwner",{realFlag:true});d.items=e;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmsForNasOwner"],["component","box","container","panel","pnlRealmsForNasOwner"],{component:true,box:true,container:true,panel:true,pnlRealmsForNasOwner:true},["widget.pnlRealmsForNasOwner"],0,[Rd.view.nas,"pnlRealmsForNasOwner"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasOpenVpn",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sOpenVPN_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",labelClsExtra:"lblRd"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasOpenVpn"],["component","box","container","panel","pnlNasOpenVpn"],{component:true,box:true,container:true,panel:true,pnlNasOpenVpn:true},["widget.pnlNasOpenVpn"],0,[Rd.view.nas,"pnlNasOpenVpn"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasNas",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",nn_disabled:true,bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var h=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"ping",text:i18n("sPing")},{id:"heartbeat",text:i18n("sHeartbeat")}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:e,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id"});h.items={xtype:"form",height:"100%",width:500,layout:"fit",autoScroll:true,frame:false,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",disabled:h.nn_disabled,allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sOptional_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sNAS-Identifier"),name:"nasidentifier",labelClsExtra:"lblRd"},{xtype:"cmbNasTypes"},{xtype:"textfield",fieldLabel:i18n("sPorts"),name:"ports",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sCommunity"),name:"community",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sServer"),name:"server",labelClsExtra:"lblRd"},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRd"}]},{title:i18n("sMonitor_settings"),layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true},{xtype:"numberfield",anchor:"100%",name:"ping_interval",itemId:"ping_interval",fieldLabel:i18n("sPing_interval"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:i18n("sMaps_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin}]},{title:i18n("sEnhancements"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sRecord_authentication_requests"),name:"record_auth",inputValue:"record_auth",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"checkbox",boxLabel:i18n("sIgnore_accounting_requests"),name:"ignore_acct",inputValue:"ignore_acct",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",inputValue:"session_auto_close",checked:false,cls:"lblRd",margin:Rd.config.fieldMargin},{xtype:"numberfield",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasNas"],["component","box","container","panel","pnlNasNas"],{component:true,box:true,container:true,panel:true,pnlNasNas:true},["widget.pnlNasNas"],0,[Rd.view.nas,"pnlNasNas"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasPptp",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sPPTP_credentials"),cls:"lblWizard"}],items:[{itemId:"username",xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{itemId:"password",xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasPptp"],["component","box","container","panel","pnlNasPptp"],{component:true,box:true,container:true,panel:true,pnlNasPptp:true},["widget.pnlNasPptp"],0,[Rd.view.nas,"pnlNasPptp"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasDynamic",Ext.panel.Panel,{border:false,nas_id:null,url:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:"fit",items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},tbar:[{xtype:"tbtext",text:i18n("sUnique_AVP_combination"),cls:"lblWizard"}],items:[{xtype:"combo",fieldLabel:i18n("sAttribute"),labelSeparator:"",store:"sDynamicAttributes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"dynamic_attribute",name:"dynamic_attribute"},{itemId:"dynamic_value",xtype:"textfield",fieldLabel:i18n("sValue"),name:"dynamic_value",allowBlank:false,blankText:i18n("sValue_to_identify_the_NAS_with"),labelClsExtra:"lblRdReq"}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasDynamic"],["component","box","container","panel","pnlNasDynamic"],{component:true,box:true,container:true,panel:true,pnlNasDynamic:true},["widget.pnlNasDynamic"],0,[Rd.view.nas,"pnlNasDynamic"],0));(Ext.cmd.derive("Rd.view.nas.cmbNasTypes",Ext.form.ComboBox,{fieldLabel:i18n("sType"),labelSeparator:"",store:"sNasTypes",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"type",name:"type",labelClsExtra:"lblRd",initComponent:function(){var b=this;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbNasTypes"],["component","box","field","textfield","pickerfield","combobox","combo","cmbNasTypes"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbNasTypes:true},["widget.cmbNasTypes"],0,[Rd.view.nas,"cmbNasTypes"],0));(Ext.cmd.derive("Rd.view.nas.winMapNasAdd",Ext.window.Window,{title:i18n("sAdd_a_marker"),layout:"fit",autoShow:false,width:500,height:300,iconCls:"note",glyph:Rd.config.icnNote,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",tbar:[{xtype:"tbtext",text:i18n("sSelect_a_NAS_device"),cls:"lblWizard"}],items:[{xtype:"cmbNas"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMapNasAdd"],["component","box","container","panel","window","winMapNasAdd"],{component:true,box:true,container:true,panel:true,window:true,winMapNasAdd:true},["widget.winMapNasAdd"],0,[Rd.view.nas,"winMapNasAdd"],0));(Ext.cmd.derive("Rd.view.nas.pnlNasPhoto",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},items:{xtype:"panel",frame:true,height:"100%",width:400,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:"Current Photo",flex:1,border:false,items:[{xtype:"cmpImg"}]},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:"Select an image",fieldLabel:"New photo",allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]},initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlNasPhoto"],["component","box","container","panel","pnlNasPhoto"],{component:true,box:true,container:true,panel:true,pnlNasPhoto:true},["widget.pnlNasPhoto"],0,[Rd.view.nas,"pnlNasPhoto"],0));(Ext.cmd.derive("Rd.view.nas.gridNasAvailability",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridNasAvailability",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/na_states/menu_for_grid.json",urlIndex:"/cake2/rd_cake/na_states/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridNasAvailability1"},{text:i18n("sState"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='state == true'><div class=\"fieldGreen\">"+i18n("sUp")+"</div></tpl>","<tpl if='state == false'><div class=\"fieldRed\">"+i18n("sDown")+"</div></tpl>"),dataIndex:"state",stateId:"StateGridNasAvailability2"},{text:i18n("sDuration"),dataIndex:"time",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability3"},{text:i18n("sStarted"),dataIndex:"start",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability4"},{text:i18n("sEnded"),dataIndex:"end",tdCls:"gridTree",flex:1,sortable:false,stateId:"StateGridNasAvailability5"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mNaState",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/na_states/delete.json"}},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNasAvailability"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNasAvailability"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNasAvailability:true},["widget.gridNasAvailability"],0,[Rd.view.nas,"gridNasAvailability"],0));(Ext.cmd.derive("Rd.view.nas.gridNasActions",Ext.grid.Panel,{border:false,stateful:true,multiSelect:true,stateId:"StateGridNasActions",stateEvents:["groupclick","columnhide"],viewConfig:{preserveScrollOnRefresh:true},urlMenu:"/cake2/rd_cake/actions/menu_for_grid.json",urlIndex:"/cake2/rd_cake/actions/index.json",columns:[{xtype:"rownumberer",stateId:"StateGridNasActions1"},{text:i18n("sAction"),dataIndex:"action",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions2"},{text:i18n("sCommand"),dataIndex:"command",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions3"},{text:i18n("sStatus"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "awaiting"\'><div class="fieldBlue">'+i18n("sAwaiting")+"</div></tpl>",'<tpl if=\'status == "fetched"\'><div class="fieldGreen">'+i18n("sFetched")+"</div></tpl>"),dataIndex:"status",stateId:"StateGridNasActions4"},{text:i18n("sCreated"),dataIndex:"created",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions5"},{text:i18n("sModified"),dataIndex:"modified",tdCls:"gridTree",flex:1,sortable:true,stateId:"StateGridNasActions6"}],bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mAction",proxy:{type:"ajax",format:"json",batchActions:true,url:b.urlIndex,reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{destroy:"/cake2/rd_cake/actions/delete.json"},simpleSortMode:true},listeners:{load:function(j,a,h){if(!h){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var i=b.getStore().getTotalCount();b.down("#count").update({count:i})}},update:function(j,a,h,i){j.sync({success:function(d,e){},failure:function(d,e){}})},scope:this},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridNasActions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridNasActions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridNasActions:true},["widget.gridNasActions"],0,[Rd.view.nas,"gridNasActions"],0));(Ext.cmd.derive("Rd.store.sNas",Ext.data.Store,{model:"Rd.model.mNas",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/nas/delete.json"},simpleSortMode:true},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sNas"],0));(Ext.cmd.derive("Rd.store.sTags",Ext.data.Store,{model:"Rd.model.mTag",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/tags/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTags"],0));(Ext.cmd.derive("Rd.store.sNasTypes",Ext.data.Store,{model:"Rd.model.mNasType",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/nas/nas_types.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sNasTypes"],0));(Ext.cmd.derive("Rd.controller.cNas",Ext.app.Controller,{owner:undefined,user_id:undefined,actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabNas",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridNas",glyph:Rd.config.icnHome}]});d.populated=true},views:["nas.gridNas","nas.winNasAddWizard","nas.gridRealmsForNasOwner","nas.winTagManage","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","nas.pnlNas","nas.pnlRealmsForNasOwner","nas.pnlNasOpenVpn","nas.pnlNasNas","nas.pnlNasPptp","nas.pnlNasDynamic","nas.cmbNasTypes","components.pnlGMap","components.cmbNas","nas.winMapNasAdd","nas.pnlNasPhoto","nas.winMapPreferences","nas.gridNasAvailability","nas.gridNasActions","nas.winNasActionAdd","components.pnlUsageGraph","nas.pnlNasGraphs"],stores:["sNas","sTags","sDynamicAttributes","sAccessProvidersTree","sTags","sNasTypes"],models:["mNas","mRealmForNasOwner","mApRealms","mTag","mDynamicAttribute","mGenericList","mAccessProviderTree","mTag","mNasType","mNaState","mAction","mUserStat"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/nas/add.json",urlAddDirect:"/cake2/rd_cake/nas/add_direct.json",urlAddOpenVpn:"/cake2/rd_cake/nas/add_open_vpn.json",urlAddDynamic:"/cake2/rd_cake/nas/add_dynamic.json",urlAddPptp:"/cake2/rd_cake/nas/add_pptp.json",urlDelete:"/cake2/rd_cake/nas/delete.json",urlEditPanelCfg:"/cake2/rd_cake/nas/edit_panel_cfg.json",urlManageTags:"/cake2/rd_cake/nas/manage_tags.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/nas/export_csv",urlNoteAdd:"/cake2/rd_cake/nas/note_add.json",urlViewOpenVpn:"/cake2/rd_cake/nas/view_openvpn.json",urlEditOpenVpn:"/cake2/rd_cake/nas/edit_openvpn.json",urlViewDynamic:"/cake2/rd_cake/nas/view_dynamic.json",urlEditDynamic:"/cake2/rd_cake/nas/edit_dynamic.json",urlViewPptp:"/cake2/rd_cake/nas/view_pptp.json",urlEditPptp:"/cake2/rd_cake/nas/edit_pptp.json",urlViewNas:"/cake2/rd_cake/nas/view_nas.json",urlEditNas:"/cake2/rd_cake/nas/edit_nas.json",urlMapDelete:"/cake2/rd_cake/nas/delete_map.json",urlMapSave:"/cake2/rd_cake/nas/edit_map.json",urlViewPhoto:"/cake2/rd_cake/nas/view_photo.json",urlPhotoBase:"/cake2/rd_cake/webroot/img/nas/",urlUploadPhoto:"/cake2/rd_cake/nas/upload_photo/",urlGreenMark:"resources/images/map_markers/green-dot.png",urlRedMark:"resources/images/map_markers/red-dot.png",urlBlueMark:"resources/images/map_markers/blue-dot.png",urlYellowMark:"resources/images/map_markers/yellow-dot.png",urlViewMapPref:"/cake2/rd_cake/nas/view_map_pref.json",urlEditMapPref:"/cake2/rd_cake/nas/edit_map_pref.json",urlNasActionsAdd:"/cake2/rd_cake/actions/add.json"},refs:[{ref:"gridNas",selector:"gridNas"},{ref:"pnlGMap",selector:"pnlGMap"},{ref:"grid",selector:"gridNas"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabNas":{destroy:b.appClose},"gridNas #reload":{click:b.reload},"gridNas #add":{click:b.add},"gridNas #delete":{click:b.del},"gridNas #edit":{click:b.edit},"gridNas #note":{click:b.note},"gridNas #csv":{click:b.csvExport},"gridNas #tag":{click:b.tag},"gridNas #map":{click:b.mapLoadApi},"gridNas #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridNas #graph":{click:b.graph},gridNas:{select:b.select,activate:b.gridActivate},"winNasAddWizard #btnTreeNext":{click:b.btnTreeNext},"winNasAddWizard #btnConTypePrev":{click:b.btnConTypePrev},"winNasAddWizard #btnConTypeNext":{click:b.btnConTypeNext},"winNasAddWizard #btnOpenvpnPrev":{click:b.btnOpenvpnPrev},"winNasAddWizard #btnOpenvpnNext":{click:b.btnOpenvpnNext},"winNasAddWizard #btnPptpPrev":{click:b.btnPptpPrev},"winNasAddWizard #btnPptpNext":{click:b.btnPptpNext},"winNasAddWizard #btnDynamicPrev":{click:b.btnDynamicPrev},"winNasAddWizard #btnDynamicNext":{click:b.btnDynamicNext},"winNasAddWizard #btnDirectPrev":{click:b.btnDirectPrev},"winNasAddWizard #btnDirectNext":{click:b.btnDirectNext},"winNasAddWizard gridRealmsForNasOwner #reload":{click:b.gridRealmsForNasOwnerReload},"winNasAddWizard #tabRealms":{activate:b.gridRealmsForNasOwnerActivate},"winNasAddWizard #tabRealms #chkAvailForAll":{change:b.chkAvailForAllChange},"winNasAddWizard gridRealmsForNasOwner #chkAvailSub":{change:b.gridRealmsForNasOwnerChkAvailSub},"winTagManage #save":{click:b.btnTagManageSave},"#winCsvColumnSelectNas #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=nas] #reload":{click:b.noteReload},"gridNote[noteForGrid=nas] #add":{click:b.noteAdd},"gridNote[noteForGrid=nas] #delete":{click:b.noteDelete},"gridNote[noteForGrid=nas]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=nas] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=nas] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=nas] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlNasNas #save":{click:b.pnlNasNasSave},"pnlNasNas #monitorType":{change:b.monitorTypeChange},"pnlRealmsForNasOwner #chkAvailForAll":{change:b.chkAvailForAllChangeTab},"pnlRealmsForNasOwner gridRealmsForNasOwner #reload":{click:b.gridRealmsForNasOwnerReload},"pnlRealmsForNasOwner #chkAvailSub":{change:b.chkAvailSubTab},"pnlNas #tabOpenVpn":{beforerender:b.tabOpenVpnRender,activate:b.tabOpenVpnActivate},"pnlNas #tabOpenVpn #save":{click:b.saveOpenVpn},"pnlNas #tabPptp":{beforerender:b.tabPptpActivate,activate:b.tabPptpActivate},"pnlNas #tabPptp #save":{click:b.savePptp},"pnlNas #tabDynamic":{beforerender:b.tabDynamicActivate,activate:b.tabDynamicActivate},"pnlNas #tabDynamic #save":{click:b.saveDynamic},"pnlNas #tabNas":{beforerender:b.tabNasActivate,activate:b.tabNasActivate},"pnlNas #tabRealms":{activate:b.tabRealmsActivate},"pnlGMap #preferences":{click:b.mapPreferences},"pnlGMap #add":{click:b.mapNasAdd},"winMapNasAdd #save":{click:b.mapNasAddSubmit},"pnlGMap #edit":{click:function(){Ext.Msg.alert(i18n("sEdit_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_save_button_in_the_info_window"))}},"pnlGMap #delete":{click:function(){Ext.Msg.alert(i18n("sDelete_a_marker"),i18n("sSimply_drag_a_marker_to_a_different_postition_and_click_the_delete_button_in_the_info_window"))}},"#pnlMapsEdit #cancel":{click:b.btnMapCancel},"#pnlMapsEdit #delete":{click:b.btnMapDelete},"#pnlMapsEdit #save":{click:b.btnMapSave},"pnlNas #tabPhoto":{activate:b.tabPhotoActivate},"pnlNas #tabPhoto #save":{click:b.photoSave},"pnlNas #tabPhoto #cancel":{click:b.photoCancel},"winMapPreferences #snapshot":{click:b.mapPreferencesSnapshot},"winMapPreferences #save":{click:b.mapPreferencesSave},"pnlNas #tabAvailability":{activate:b.tabAvailabilityActivate},"gridNasAvailability #reload":{click:b.gridNasAvailabilityReload},"gridNasAvailability #delete":{click:b.gridNasAvailabilityDelete},"pnlNas #tabActions":{activate:b.tabActionsActivate},"gridNasActions #reload":{click:b.gridNasActionsReload},"gridNasActions #add":{click:b.gridNasActionsAdd},"gridNasActions #delete":{click:b.gridNasActionsDelete},"winNasActionAdd #save":{click:b.gridNasActionsAddSubmit},"#tabNas pnlNasGraphs #daily":{activate:b.loadGraph},"#tabNas pnlNasGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabNas pnlNasGraphs #daily #day":{change:b.changeDailyGraph},"#tabNas pnlNasGraphs #weekly":{activate:b.loadGraph},"#tabNas pnlNasGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabNas pnlNasGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabNas pnlNasGraphs #monthly":{activate:b.loadGraph},"#tabNas pnlNasGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabNas pnlNasGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;if(b.getGrid()==undefined){clearInterval(b.autoReload);return}b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNasAddWizardId")){var h=Ext.widget("winNasAddWizard",{id:"winNasAddWizardId",startScreen:"scrnApTree"});h.show()}}else{if(!Ext.WindowManager.get("winNasAddWizardId")){d.user_id=0;var h=Ext.widget("winNasAddWizard",{id:"winNasAddWizardId",startScreen:"scrnConType",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNasAddWizard");k.username=l.get("username");k.user_id=l.getId();j.getLayout().setActiveItem("scrnConType")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnConTypePrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnConTypeNext:function(i){var m=this;var l=i.up("winNasAddWizard");var n=i.up("form");var k=n.down("radiogroup");if(k.getValue().rb=="direct"){var j=l.down("#scrnDirect");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnDirect")}if(k.getValue().rb=="openvpn"){var j=l.down("#scrnOpenvpn");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnOpenvpn")}if(k.getValue().rb=="dynamic"){var j=l.down("#scrnDynamic");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnDynamic")}if(k.getValue().rb=="pptp"){var j=l.down("#scrnPptp");j.down("#owner").setValue(m.username);j.down("#user_id").setValue(m.user_id);l.getLayout().setActiveItem("scrnPptp")}},btnOpenvpnPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnOpenvpnNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddOpenVpn())},btnDynamicPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnDynamicNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddDynamic())},btnPptpPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnPptpNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddPptp())},btnDirectPrev:function(g){var e=this;var h=g.up("winNasAddWizard");h.getLayout().setActiveItem("scrnConType")},btnDirectNext:function(e){var d=this;d.addSubmit(e,d.getUrlAddDirect())},chkAvailForAllChange:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForNasOwner");if(h.getValue()==true){g.hide()}else{g.show()}},chkAvailForAllChangeTab:function(h){var i=this;var j=h.up("panel");var g=j.down("gridRealmsForNasOwner");if(h.getValue()==true){g.hide()}else{g.show()}g.getStore().getProxy().setExtraParam("clear_flag",true);g.getStore().load();g.getStore().getProxy().setExtraParam("clear_flag",false)},gridRealmsForNasOwnerReload:function(e){var h=this;var g=e.up("gridRealmsForNasOwner");g.getStore().load()},gridRealmsForNasOwnerActivate:function(g){var j=this;var i=g.down("#chkAvailSub").getValue();var h=g.down("gridRealmsForNasOwner");h.getStore().getProxy().setExtraParam("owner_id",j.owner_id);h.getStore().getProxy().setExtraParam("available_to_siblings",i);h.getStore().load()},gridRealmsForNasOwnerChkAvailSub:function(h){var j=this;var i=h.getValue();var g=h.up("gridRealmsForNasOwner");g.getStore().getProxy().setExtraParam("owner_id",j.owner_id);g.getStore().getProxy().setExtraParam("available_to_siblings",i);g.getStore().load()},addSubmit:function(r,u){var o=this;var q=r.up("winNasAddWizard");var t=r.up("form");var m=t.down("tabpanel");var w=t.down("gridRealmsForNasOwner");var s={};var n=false;var p=t.down("#chkAvailForAll");if(p.getValue()==true){s.avail_for_all=true}else{w.getStore().each(function(a){if(a.get("selected")==true){n=true;s[a.getId()]=a.get("selected")}},o)}if(s.avail_for_all==undefined){if(n!=true){var m=t.down("tabpanel");m.setActiveTab("tabRealms");Ext.ux.Toaster.msg(i18n("sSelect_at_least_one_realm"),i18n("sSelect_one_or_more_realms"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}t.submit({clientValidation:true,url:u,params:s,success:function(a,b){q.close();o.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,d,a,b){if(d.result.errors.username!=undefined){m.setActiveTab(0)}else{m.setActiveTab("tabNas")}Ext.ux.formFail(e,d)}})},tag:function(e){var h=this;if(h.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_tag"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winNasAddWizardId")){var g=Ext.widget("winTagManage",{id:"winTagManageId"});g.show()}}},btnTagManageSave:function(l){var p=this;var o=l.up("window");var q=o.down("form");var n=q.down("combo");var m=q.down("radiogroup");if(n.getValue()==null){Ext.ux.Toaster.msg(i18n("sSelect_a_tag"),i18n("sSelect_a_tag_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var r={};var k=p.getGrid().getSelectionModel().getSelection();Ext.Array.each(k,function(b){var a=b.getId();r[a]=a});q.submit({clientValidation:true,url:p.getUrlManageTags(),params:r,success:function(b,a){o.close();p.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sTags_modified"),i18n("sTags_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})}},select:function(n,i){var k=this;tb=k.getGrid().down("toolbar[dock=top]");var l=i.get("update");if(l==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var j=i.get("delete");if(j==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}var m=i.get("manage_tags");if(j==true){if(tb.down("#tag")!=null){tb.down("#tag").setDisabled(false)}}else{if(tb.down("#tag")!=null){tb.down("#tag").setDisabled(true)}}},onStoreNasLoaded:function(o,t,n,m){var p=this;var s=p.getStore("sNas").getTotalCount();p.getGrid().down("#count").update({count:s});var l=p.getGrid().up("tabpanel");var r=l.down("#mapTab");if(r!=null){var q=r.down("gmappanel");q.clearMarkers();Ext.each(t,function(j){var g=j.get("lat");var i=j.get("lon");var a=j.get("status");if((g!=null)&(i!=null)){var h=p.getUrlBlueMark();if(a=="up"){h=p.getUrlGreenMark()}if(a=="down"){h=p.getUrlRedMark()}var e=j.get("nasname");var d=j.get("shortname");var b=q.addMarker({lat:g,lng:i,icon:h,draggable:true,title:e,listeners:{click:function(k,w){p.markerClick(j,q,b)},dragend:function(){p.dragEnd(j,q,b)},dragstart:function(){p.dragStart(j,q,b)}}})}},p)}},markerClick:function(w,s,x){var q=this;var u=w.get("nasname");var y=w.get("shortname");s.marker_record=w;var p=Ext.ComponentQuery.query("#pnlMapsInfo");if(p[0]){var n="N/A";if(w.get("status")!="unknown"){if(w.get("status")=="up"){var d=i18n("sUp")}if(w.get("status")=="down"){var d=i18n("sDown")}n=d+" "+Ext.ux.secondsToHuman(w.get("status_time"))}var t=Ext.apply({time_in_state:n},w.data);p[0].down("#tabMapInfo").update(t);var r=q.getUrlPhotoBase()+w.get("photo_file_name");p[0].down("#tabMapPhoto").update({image:r})}s.infowindow.open(s.gmap,x)},dragStart:function(g,j,h){var i=this;i.lastMovedMarker=h;i.lastOrigPosition=h.getPosition();i.editWindow=j.editwindow},dragEnd:function(l,k,i){var j=this;var h=i.getPosition();k.new_lng=h.lng();k.new_lat=h.lat();k.editwindow.open(k.gmap,i);j.lastLng=h.lng();j.lastLat=h.lat();j.lastDragId=l.getId()},btnMapCancel:function(e){var d=this;d.editWindow.close();d.lastMovedMarker.setPosition(d.lastOrigPosition)},btnMapDelete:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapDelete(),method:"GET",params:{id:d.lastDragId},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},btnMapSave:function(e){var d=this;Ext.Ajax.request({url:d.getUrlMapSave(),method:"GET",params:{id:d.lastDragId,lat:d.lastLat,lon:d.lastLng},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){d.editWindow.close();d.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:d})},mapPreferences:function(e){var h=this;if(!Ext.WindowManager.get("winMapPreferencesId")){var g=Ext.widget("winMapPreferences",{id:"winMapPreferencesId"});g.show();g.down("form").load({url:h.getUrlViewMapPref(),method:"GET"})}},mapNasAdd:function(e){var h=this;if(!Ext.WindowManager.get("winMapNasAddId")){var g=Ext.widget("winMapNasAdd",{id:"winMapNasAddId"});g.show()}},mapNasAddSubmit:function(t){var o=this;var r=t.up("window");var w=r.down("cmbNas");var x=w.getValue();var s=w.getStore().getById(x);r.close();var n=o.getGrid().up("tabpanel");var q=n.down("#mapTab");if(q!=null){var p=q.down("gmappanel");var y=p.gmap.getCenter();var u=p.addMarker({lat:y.lat(),lng:y.lng(),icon:"resources/images/map_markers/yellow-dot.png",draggable:true,title:"New Marker",listeners:{dragend:function(){o.dragEnd(s,p,u)},dragstart:function(){p.addwindow.close();o.dragStart(s,p,u)}}});p.addwindow.open(p.gmap,u)}},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectNas")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectNas",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){console.log(y.getAt(G).serialize());A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteNas"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteNas"+m.getId(),noteForId:m.getId(),noteForGrid:"nas",noteForName:m.get("nasname")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteNasAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteNasAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteNasAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteNasAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},edit:function(h){var j=this;var i=h.up("gridNas");if(i.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=i.getSelectionModel().getSelection();var k=l.length;Ext.each(i.getSelectionModel().getSelection(),function(b,g){var p=i.up("tabpanel");var o=b.getId();var a="nasTab_"+o;var e=p.down("#"+a);if(e){p.setActiveTab(a);return}var d=b.get("nasname");p.add({title:d,itemId:a,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlNas",nas_id:o,url:j.getUrlEditPanelCfg(),record:b}});p.setActiveTab(a)})}},tabOpenVpnRender:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewOpenVpn(),method:"GET",params:{nas_id:h}})},tabOpenVpnActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewOpenVpn(),method:"GET",params:{nas_id:h}})},saveOpenVpn:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditOpenVpn(),params:{nas_id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabPptpActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewPptp(),method:"GET",params:{nas_id:h}})},savePptp:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditPptp(),params:{nas_id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabDynamicActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewDynamic(),method:"GET",params:{nas_id:h}})},saveDynamic:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas").nas_id;j.submit({clientValidation:true,url:i.getUrlEditDynamic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},tabNasActivate:function(g){var i=this;var j=g.down("form");var h=g.up("pnlNas").nas_id;j.load({url:i.getUrlViewNas(),method:"GET",params:{nas_id:h}})},tabAvailabilityActivate:function(e){var d=this;e.getStore().load()},pnlNasNasSave:function(g){var i=this;var j=g.up("form");var h=g.up("pnlNas");j.submit({clientValidation:true,url:i.getUrlEditNas(),params:{id:h.nas_id},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},monitorTypeChange:function(k){var n=this;var i=k.up("form");var m=i.down("#ping_interval");var j=i.down("#heartbeat_dead_after");var l=k.getValue();if(l=="off"){m.setVisible(false);j.setVisible(false)}if(l=="ping"){m.setVisible(true);j.setVisible(false)}if(l=="heartbeat"){m.setVisible(false);j.setVisible(true)}},chkAvailSubTab:function(g){var h=this;var e=g.up("gridRealmsForNasOwner");if(g.getValue()==true){e.getStore().getProxy().setExtraParam("available_to_siblings",true)}else{e.getStore().getProxy().setExtraParam("available_to_siblings",false)}e.getStore().getProxy().setExtraParam("clear_flag",true);e.getStore().load();e.getStore().getProxy().setExtraParam("clear_flag",false)},tabPhotoActivate:function(e){var h=this;var g=e.up("pnlNas");Ext.Ajax.request({url:h.getUrlViewPhoto(),method:"GET",params:{id:g.nas_id},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var j=e.down("cmpImg");var a=h.getUrlPhotoBase()+b.data.photo_file_name;j.setImage(a)}},scope:h})},photoSave:function(l){var j=this;var k=l.up("form");var i=k.up("pnlNas");var h=i.down("pnlNasPhoto");k.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:j.getUrlUploadPhoto(),params:{id:i.nas_id},success:function(d,b){if(b.result.success){var e=b.result.photo_file_name;var g=h.down("cmpImg");var a=j.getUrlPhotoBase()+e;g.setImage(a)}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},photoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},del:function(e){var h=this;var g=e.up("gridNas");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=h.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDelete(),method:"POST",jsonData:b,success:function(k,l){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.reload()}})}})}},mapLoadApi:function(e){var d=this;Ext.ux.Toaster.msg("Loading Google Maps API","Please be patient....",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);Ext.Loader.loadScript({url:"https://www.google.com/jsapi",scope:this,onLoad:function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){d.mapCreatePanel(e)}})},onError:function(){console.log("Error loading Google script")}})},mapCreatePanel:function(p){var o=this;var j=p.up("gridNas");var m=j.up("tabpanel");var l="mapTab";var k=m.down("#"+l);if(k){m.setActiveTab(l);return}var n=i18n("sGoogle_Maps");Ext.Ajax.request({url:o.getUrlViewMapPref(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){m.add({title:n,itemId:l,closable:true,iconCls:"map",glyph:Rd.config.icnMap,layout:"fit",items:{xtype:"pnlGMap",store:o.getStore("sNas"),mapOptions:{zoom:a.data.zoom,mapTypeId:google.maps.MapTypeId[a.data.type]},centerLatLng:{lat:a.data.lat,lng:a.data.lng},markers:[]}});m.setActiveTab(l)}},scope:o})},mapPreferencesSnapshot:function(r){var p=this;var t=r.up("form");var s=p.getPnlGMap();var l=s.gmap.getZoom();var o=s.gmap.getMapTypeId();var m=s.gmap.getCenter();var q=m.lat();var n=m.lng();t.down("#lat").setValue(q);t.down("#lng").setValue(n);t.down("#zoom").setValue(l);t.down("#type").setValue(o.toUpperCase())},mapPreferencesSave:function(h){var j=this;var g=h.up("form");var i=h.up("window");g.submit({clientValidation:true,url:j.getUrlEditMapPref(),success:function(b,a){i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridNasAvailabilityReload:function(e){var h=this;var g=e.up("gridNasAvailability");g.getStore().load()},tabRealmsActivate:function(g){var h=this;var e=g.down("gridRealmsForNasOwner");e.getStore().load()},gridNasAvailabilityDelete:function(e){var h=this;var g=e.up("gridNasAvailability");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},gridNasActionsReload:function(e){var h=this;var g=e.up("gridNasActions");g.getStore().load()},tabActionsActivate:function(e){var d=this;e.getStore().load()},gridNasActionsAdd:function(l){var k=this;var j=l.up("pnlNas");var m=l.up("gridNasActions");var n=j.nas_id;if(!Ext.WindowManager.get("winNasActionAddId")){var i=Ext.widget("winNasActionAdd",{id:"winNasActionAddId",nas_id:n,grid:m});i.show()}},gridNasActionsAddSubmit:function(h){var j=this;var g=h.up("form");var i=h.up("winNasActionAdd");g.submit({clientValidation:true,url:j.getUrlNasActionsAdd(),success:function(b,a){i.grid.getStore().load();i.close();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},gridNasActionsDelete:function(e){var h=this;var g=e.up("gridNasActions");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="nasTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("nasname");console.log(l);n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlNasGraphs",nas_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;console.log("Reload hom");tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;console.log("Gooi hom");var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cNas"],0));(Ext.cmd.derive("Rd.view.openvpnServers.gridOpenvpnServers",Ext.grid.Panel,{multiSelect:true,store:"sOpenvpnServers",stateful:true,stateId:"StateGridOpenvpnServers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/openvpn_servers/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridOpenvpnServers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers4"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridOpenvpnServers5",tdCls:"gridTree"},{text:i18n("sLocal_slash_Remote"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="local_remote ==\'local\'"><div class="fieldGreen">'+i18n("sLocal")+"</div></tpl>",'<tpl if="local_remote ==\'remote\'"><div class="fieldBlue">'+i18n("sRemote")+"</div></tpl>"),dataIndex:"local_remote",stateId:"StateGridOpenvpnServers6",tdCls:"gridTree"},{text:"Protocol",dataIndex:"protocol",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers7",hidden:true},{text:"IP Address",dataIndex:"ip_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers8",hidden:false},{text:"Port",dataIndex:"port",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers9",hidden:false},{text:"Gateway IP",dataIndex:"vpn_gateway_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers10",hidden:true},{text:"Bridge Start IP",dataIndex:"vpn_bridge_start_address",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers11",hidden:true},{text:"Bridge Mask",dataIndex:"vpn_mask",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers12",hidden:true},{text:"Config Preset",dataIndex:"config_preset",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers13",hidden:true},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers14",hidden:true},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridOpenvpnServers15",hidden:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridOpenvpnServers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridOpenvpnServers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridOpenvpnServers:true},["widget.gridOpenvpnServers"],0,[Rd.view.openvpnServers,"gridOpenvpnServers"],0));(Ext.cmd.derive("Rd.model.mOpenvpnServer",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"description",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"local_remote",type:"string"},{name:"protocol",type:"string"},{name:"ip_address",type:"string"},{name:"port",type:"int"},{name:"vpn_gateway_address",type:"string"},{name:"vpn_bridge_start_address",type:"string"},{name:"vpn_mask",type:"string"},{name:"config_preset",type:"string"},{name:"ca_crt",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mOpenvpnServer"],0));(Ext.cmd.derive("Rd.view.openvpnServers.winOpenvpnServerEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit OpenVPN Server",width:450,height:500,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"General",layout:"anchor",itemId:"tabGeneral",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]},{title:"VPN Basic",layout:"anchor",itemId:"tabVpnBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Local/Remote",value:"local",name:"local_remote",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"local",name:"Local"},{id:"remote",name:"Remote"}]}},{xtype:"combobox",name:"protocol",value:"udp",fieldLabel:"Protocol",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"udp",name:"UDP"},{id:"tcp",name:"TCP"}]}},{xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"ip_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"port",fieldLabel:"Port",value:1194,maxValue:64000,minValue:1025,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"config_preset",value:"default",fieldLabel:"Config Preset",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"default",name:"Default"}]}}]},{title:"VPN IPs",layout:"anchor",itemId:"tabVpnIp",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Gateway IP",name:"vpn_gateway_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Start IP",name:"vpn_bridge_start_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Mask",name:"vpn_mask",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Certs etc",layout:"anchor",itemId:"tabVpnCerts",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textareafield",grow:true,fieldLabel:"ca.crt",name:"ca_crt",anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}]}]}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winOpenvpnServerEdit"],["component","box","container","panel","window","winOpenvpnServerEdit"],{component:true,box:true,container:true,panel:true,window:true,winOpenvpnServerEdit:true},["widget.winOpenvpnServerEdit"],0,[Rd.view.openvpnServers,"winOpenvpnServerEdit"],0));(Ext.cmd.derive("Rd.store.sOpenvpnServers",Ext.data.Store,{model:"Rd.model.mOpenvpnServer",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/openvpn_servers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/openvpn_servers/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sOpenvpnServers"],0));(Ext.cmd.derive("Rd.view.openvpnServers.winOpenvpnServerAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New OpenVPN Server",width:450,height:500,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"General",layout:"anchor",itemId:"tabGeneral",autoScroll:true,defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]},{title:"VPN Basic",layout:"anchor",itemId:"tabVpnBasic",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Local/Remote",value:"local",name:"local_remote",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"local",name:"Local"},{id:"remote",name:"Remote"}]}},{xtype:"combobox",name:"protocol",value:"udp",fieldLabel:"Protocol",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"udp",name:"UDP"},{id:"tcp",name:"TCP"}]}},{xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"ip_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"numberfield",name:"port",fieldLabel:"Port",value:1194,maxValue:64000,minValue:1025,labelClsExtra:"lblRdReq"},{xtype:"combobox",name:"config_preset",value:"default",fieldLabel:"Config Preset",displayField:"name",editable:false,queryMode:"local",valueField:"id",labelClsExtra:"lblRdReq",store:{fields:["id","name"],data:[{id:"default",name:"Default"}]}}]},{title:"VPN IPs",layout:"anchor",itemId:"tabVpnIp",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Gateway IP",name:"vpn_gateway_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Start IP",name:"vpn_bridge_start_address",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Bridge Mask",name:"vpn_mask",allowBlank:false,vtype:"IPAddress",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:"Certs etc",layout:"anchor",itemId:"tabVpnCerts",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textareafield",grow:true,fieldLabel:"ca.crt",name:"ca_crt",anchor:"100%",allowBlank:false,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}]}]}],buttons:g});return h}},0,["winOpenvpnServerAddWizard"],["component","box","container","panel","window","winOpenvpnServerAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winOpenvpnServerAddWizard:true},["widget.winOpenvpnServerAddWizard"],0,[Rd.view.openvpnServers,"winOpenvpnServerAddWizard"],0));(Ext.cmd.derive("Rd.controller.cOpenvpnServers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridOpenvpnServers",border:true,itemId:"tabOpenvpnServers",plain:true});d.populated=true},views:["openvpnServers.gridOpenvpnServers","openvpnServers.winOpenvpnServerEdit","openvpnServers.winOpenvpnServerAddWizard"],stores:["sAccessProvidersTree","sOpenvpnServers"],models:["mAccessProviderTree","mOpenvpnServer"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/openvpn_servers/export_csv",urlAdd:"/cake2/rd_cake/openvpn_servers/add.json",urlDelete:"/cake2/rd_cake/openvpn_servers/delete.json",urlEdit:"/cake2/rd_cake/openvpn_servers/edit.json"},refs:[{ref:"grid",selector:"gridOpenvpnServers"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabOpenvpnServers":{destroy:b.appClose},"gridOpenvpnServers #reload":{click:b.reload},"gridOpenvpnServers #add":{click:b.add},"gridOpenvpnServers #delete":{click:b.del},"gridOpenvpnServers #edit":{click:b.edit},gridOpenvpnServers:{select:b.select},"winOpenvpnServerAddWizard #btnTreeNext":{click:b.btnTreeNext},"winOpenvpnServerAddWizard #btnDataPrev":{click:b.btnDataPrev},"winOpenvpnServerAddWizard #btnDataNext":{click:b.btnDataNext},"winOpenvpnServerEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winOpenvpnServerAddWizardId")){var h=Ext.widget("winOpenvpnServerAddWizard",{id:"winOpenvpnServerAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winOpenvpnServerAddWizardId")){var h=Ext.widget("winOpenvpnServerAddWizard",{id:"winOpenvpnServerAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winOpenvpnServerAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winOpenvpnServerAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sOpenvpnServers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winOpenvpnServerEditId")){var i=Ext.widget("winOpenvpnServerEdit",{id:"winOpenvpnServerEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winOpenvpnServerEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreOpenvpnServersLoaded:function(){var d=this;var e=d.getStore("sOpenvpnServers").getTotalCount();d.getGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cOpenvpnServers"],0));(Ext.cmd.derive("Rd.view.password.frmPassword",Ext.form.Panel,{autoScroll:true,autoCreate:true,border:false,layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},buttons:[{itemId:"save",formBind:true,text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],initComponent:function(){var e=this;var g=new Date();var h=new Date();h.setDate(h.getDate()+7);e.items=[{xtype:"cmbPermanentUser",fieldLabel:i18n("sUsername")},{xtype:"displayfield",value:i18n("s_br_select_user_first_br"),fieldLabel:i18n("sCurrent_password"),fieldCls:"green_round",itemId:"currentPwd"},{xtype:"textfield",name:"password",fieldLabel:i18n("sNew_password"),allowBlank:false,minLength:4},{xtype:"checkbox",fieldLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:g},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:h}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmPassword"],["component","box","container","panel","form","frmPassword"],{component:true,box:true,container:true,panel:true,form:true,frmPassword:true},["widget.frmPassword"],0,[Rd.view.password,"frmPassword"],0));(Ext.cmd.derive("Rd.controller.cPassword",Ext.app.Controller,{actionIndex:function(){var e=this;if(!Ext.WindowManager.get("passwordWin")){var d=Ext.widget({xtype:"window",id:"passwordWin",title:"Password manager",width:600,height:450,resizable:true,iconCls:"rights",glyph:Rd.config.icnKey,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"passwordWin",items:[{region:"center",layout:{type:"hbox",align:"stretch"},margins:"0 0 0 0",border:false,items:[{flex:1,xtype:"frmPassword"}]}]});d.show()}},views:["password.frmPassword"],stores:[],models:["mPermanentUser"],selectedRecord:null,config:{urlGetPwd:"/cake3/rd_cake/permanent-users/view-password.json",urlChangePassword:"/cake3/rd_cake/permanent-users/change-password.json"},refs:[],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"frmPassword cmbPermanentUser":{change:b.userChanged},"frmPassword #always_active":{change:b.chkAlwaysActiveChange},"frmPassword #save":{click:b.changePasswordSubmit}})},userChanged:function(o){var q=this;var p=o.getValue();var r=o.up("form");var k=r.down("#currentPwd");var m=r.down("#from_date");var n=r.down("#to_date");var l=r.down("checkbox");Ext.Ajax.request({url:q.getUrlGetPwd(),method:"GET",params:{user_id:p},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){k.setValue(a.value);if((a.activate==false)&&(a.expire==false)){l.setValue(true)}else{n.setValue(a.expire);m.setValue(a.activate);l.setValue(false)}Ext.ux.Toaster.msg(i18n("sFetched password"),i18n("sPassword_fetched_for_selected_user"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:q})},changePasswordSubmit:function(j){var l=this;var m=j.up("window");var n=j.up("form");var k=n.down("cmbPermanentUser");var i={};i.user_id=k.getValue();m.setLoading(true);n.submit({clientValidation:true,url:l.getUrlChangePassword(),params:i,success:function(b,a){l.userChanged(k);m.setLoading(false);Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}}},0,0,0,0,0,0,[Rd.controller,"cPassword"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridPermanentUsers",Ext.grid.Panel,{multiSelect:true,store:"sPermanentUsers",stateful:true,stateId:"StateGridPermanentUsers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridPermanentUsers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers2",hidden:true},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers3"},{text:i18n("sAuth_type"),dataIndex:"auth_type",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPermanentUsers4",hidden:true},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridPermanentUsers5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridPermanentUsers6"},{text:i18n("sName"),flex:1,dataIndex:"name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers7"},{text:i18n("sSurname"),flex:1,dataIndex:"surname",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers8"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers9"},{text:i18n("s_email"),flex:1,dataIndex:"email",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers10"},{text:i18n("sAddress"),flex:1,dataIndex:"address",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers11"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridPermanentUsers12"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers13"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers14"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers15"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers16"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers17"},{header:i18n("sData_used"),hidden:true,dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_data_used");i.toggleCls("wifigreen",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridPermanentUsers18"},{header:i18n("sTime_used"),hidden:true,dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(j,i,l){var k=l.get("perc_time_used");i.toggleCls("wifired",true);if(k==null){i.setText("")}else{var a="wifigreen";if(k>70){a="wifiyellow"}if(k>90){a="wifired"}i.setValue(k/100);i.setText(k+" %");i.toggleCls(a,true)}},stateId:"StateGridPermanentUsers19"},{text:"Static IP",flex:1,dataIndex:"static_ip",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers20"},{text:"Extra name",flex:1,dataIndex:"extra_name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers21"},{text:"Extra value",flex:1,dataIndex:"extra_value",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridPermanentUsers22"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridPermanentUsers23",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridPermanentUsers24"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridPermanentUsers25"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPermanentUsers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPermanentUsers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPermanentUsers:true},["widget.gridPermanentUsers"],0,[Rd.view.permanentUsers,"gridPermanentUsers"],0));(Ext.cmd.derive("Rd.view.permanentUsers.pnlPermanentUser",Ext.tab.Panel,{border:false,pu_id:null,pu_name:null,record:null,plain:true,cls:"subTab",initComponent:function(){var g=this;var h=new Date();var j=new Date();j.setYear(j.getFullYear()+1);var i=g.record.get("owner_id");g.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:i},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:i},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"time_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"data_cap_type"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date("May 20, 2013 00:00:00"),hidden:true,disabled:true,value:h},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date("May 21, 2013 00:00:00"),hidden:true,disabled:true,value:j},{xtype:"textfield",fieldLabel:"Static IP",name:"static_ip",allowBlank:true},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.ap_id}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},{title:i18n("sPersonal_info"),layout:"hbox",itemId:"tabPersonalInfo",items:{xtype:"form",height:"100%",width:400,autoScroll:true,layout:"anchor",frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname",allowBlank:true},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",value:g.selLanguage,allowBlank:false,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]}},{title:i18n("sDevices"),layout:"fit",xtype:"gridUserDevices",user_id:g.pu_id,username:g.pu_name},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridUserPrivate",username:g.pu_name},{title:i18n("sAuthentication_data"),layout:"fit",xtype:"gridUserRadpostauths",username:g.pu_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridUserRadaccts",username:g.pu_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPermanentUser"],["component","box","container","panel","tabpanel","pnlPermanentUser"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPermanentUser:true},["widget.pnlPermanentUser"],0,[Rd.view.permanentUsers,"pnlPermanentUser"],0));(Ext.cmd.derive("Rd.view.permanentUsers.winPermanentUserAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:i18n("sNew_permanent_user"),width:500,height:550,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",selLanguage:null,initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];console.log(g.selLanguage);Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var l=this;var i=new Date();var k=new Date();k.setYear(k.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(l.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var j=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:15},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",cls:"subTab",border:false,items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true},{xtype:"checkbox",boxLabel:"Create multiple users",name:"multiple",inputValue:"multiple",checked:false,cls:"lblRd",itemId:"multiple"},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:l.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sUsername"),name:"username",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sPassword"),name:"password",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:l.user_id},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:l.user_id},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_data"),itemId:"cmbDataCap",name:"data_cap_type"},{xtype:"cmbCap",allowBlank:false,labelClsExtra:"lblRdReq",hidden:true,value:"hard",fieldLabel:i18n("sCap_type_for_time"),itemId:"cmbTimeCap",name:"time_cap_type"}]},{title:i18n("sPersonal_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sSurname"),name:"surname",allowBlank:true},{xtype:"cmbLanguages",width:350,fieldLabel:i18n("sLanguage"),name:"language",value:l.selLanguage,allowBlank:false,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textareafield",grow:true,name:"address",fieldLabel:i18n("sAddress"),anchor:"100%"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sActivate"),name:"active",inputValue:"active",checked:true,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlways_active"),name:"always_active",inputValue:"always_active",itemId:"always_active",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sFrom"),name:"from_date",itemId:"from_date",minValue:new Date(),hidden:true,disabled:true,value:i},{xtype:"datefield",fieldLabel:i18n("sTo"),name:"to_date",itemId:"to_date",minValue:new Date(),hidden:true,disabled:true,value:k}]},{title:"SSIDs",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:l.user_id}]},{title:"Optional fields",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Static IP",name:"static_ip",allowBlank:true},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Auto-add device after authentication",name:"auto_add",inputValue:"auto_add",checked:false,cls:"lblRd",itemId:"auto_add"}]}]}],buttons:h});return j}},0,["winPermanentUserAddWizard"],["component","box","container","panel","window","winPermanentUserAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winPermanentUserAddWizard:true},["widget.winPermanentUserAddWizard"],0,[Rd.view.permanentUsers,"winPermanentUserAddWizard"],0));(Ext.cmd.derive("Rd.view.permanentUsers.pnlPermanentUserGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",pu_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.pu_name,type:"permanent"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.pu_name,type:"permanent"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.pu_name,type:"permanent"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPermanentUserGraphs"],["component","box","container","panel","tabpanel","pnlPermanentUserGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPermanentUserGraphs:true},["widget.pnlPermanentUserGraphs"],0,[Rd.view.permanentUsers,"pnlPermanentUserGraphs"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-accounting-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StateGridUserRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StateGridUserRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridUserRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StateGridUserRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridUserRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:100,remoteSort:true,proxy:{type:"ajax",keepRawData:true,format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(n,a,j){if(!j){Ext.ux.Toaster.msg("Error encountered",n.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var k=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#totals").update({"in":l,out:m,total:k})}},scope:this}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserRadaccts:true},["widget.gridUserRadaccts"],0,[Rd.view.permanentUsers,"gridUserRadaccts"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserRadpostauths",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadpostauths",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-authentication-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadpostauths1"},{text:i18n("sUsername"),dataIndex:"username",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths2"},{text:i18n("sPassword"),dataIndex:"pass",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths3"},{text:i18n("sReply"),dataIndex:"reply",tdCls:"gridTree",flex:1,filter:{type:"string"},xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'reply == "Access-Reject"\'><div class="noRight">{reply}</div>',"<tpl else>","{reply}","</tpl>"),stateId:"StateGridUserRadpostauths4"},{text:i18n("sNasname"),dataIndex:"nasname",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadpostauths5"},{text:i18n("sDate"),dataIndex:"authdate",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadpostauths6"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadpostauth",buffered:false,leadingBufferZone:450,pageSize:150,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/radpostauths/index.json",extraParams:{username:b.username},reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radpostauths/delete.json"},simpleSortMode:true},listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg("Error encountered",h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserRadpostauths"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserRadpostauths"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserRadpostauths:true},["widget.gridUserRadpostauths"],0,[Rd.view.permanentUsers,"gridUserRadpostauths"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserPrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserPrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridUserPrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridUserPrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridUserPrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridUserPrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridUserPrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/permanent-users/private-attr-add.json",read:"/cake3/rd_cake/permanent-users/private-attr-index.json",update:"/cake3/rd_cake/permanent-users/private-attr-edit.json",destroy:"/cake3/rd_cake/permanent-users/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserPrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserPrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserPrivate:true},["widget.gridUserPrivate"],0,[Rd.view.permanentUsers,"gridUserPrivate"],0));(Ext.cmd.derive("Rd.view.permanentUsers.gridUserDevices",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridUserRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/permanent-users/menu-for-user-devices.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StateGridUserRadaccts1"},{text:i18n("sOwner"),dataIndex:"permanent_user",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts2"},{text:i18n("sMAC_address"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridUserRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridUserRadaccts5"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridUserRadaccts6"},{text:i18n("sActive"),tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'active == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'active == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"active",filter:{type:"boolean"},stateId:"StateGridUserRadaccts7"},{text:i18n("sLast_accept_time"),flex:1,dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,filter:{type:"date",dateFormat:"Y-m-d"}},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts8"},{text:i18n("sLast_reject_time"),flex:1,dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridUserRadaccts9"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts10"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridUserRadaccts11"},{header:i18n("sData_used"),dataIndex:"perc_data_used",width:110,hidden:true,renderer:function(g,h,j){if(g!=null){var i=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:i,value:g/100,width:100,text:g+" %"})},50);return Ext.String.format('<div id="{0}"></div>',i)}else{return"N/A"}},stateId:"StateGridUserRadaccts12"},{header:i18n("sTime_used"),dataIndex:"perc_time_used",width:110,hidden:true,renderer:function(g,h,j){if(g!=null){var i=Ext.id();Ext.defer(function(){Ext.widget("progressbar",{renderTo:i,value:g/100,width:100,text:g+" %"})},50);return Ext.String.format('<div id="{0}"></div>',i)}else{return"N/A"}},stateId:"StateGridUserRadaccts13"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><div class=\"note\">"+i18n("sExisting_Notes")+"</div></tpl>"),dataIndex:"notes",stateId:"StateGridUserRadaccts14"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu+"?user_id="+b.user_id+"&username="+b.username});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mDevice",pageSize:100,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",extraParams:{permanent_user_id:b.user_id},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridUserDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridUserDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridUserDevices:true},["widget.gridUserDevices"],0,[Rd.view.permanentUsers,"gridUserDevices"],0));(Ext.cmd.derive("Rd.view.components.cmbSsid",Ext.form.ComboBox,{fieldLabel:"SSIDs",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",allowBlank:false,multiSelect:true,mode:"local",name:"ssid_list[]",labelClsExtra:"lblRd",extraParam:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","name"],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/ssids/index-ap.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:false});if(d.extraParam){e.getProxy().setExtraParam("ap_id",d.extraParam)}d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbSsid"],["component","box","field","textfield","pickerfield","combobox","combo","cmbSsid"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbSsid:true},["widget.cmbSsid"],0,[Rd.view.components,"cmbSsid"],0));(Ext.cmd.derive("Rd.controller.cPermanentUsers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabPermanentUsers",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridPermanentUsers",glyph:Rd.config.icnHome}]});d.populated=true},views:["permanentUsers.gridPermanentUsers","permanentUsers.winPermanentUserAddWizard","components.cmbRealm","components.cmbProfile","components.cmbCap","components.winNote","components.winNoteAdd","components.winCsvColumnSelect","permanentUsers.pnlPermanentUser","permanentUsers.gridUserRadaccts","permanentUsers.gridUserRadpostauths","permanentUsers.winPermanentUserPassword","components.winEnableDisable","permanentUsers.gridUserPrivate","components.cmbVendor","components.cmbAttribute","permanentUsers.gridUserDevices","components.pnlUsageGraph","components.cmbSsid","permanentUsers.pnlPermanentUserGraphs"],stores:["sLanguages","sAccessProvidersTree","sPermanentUsers","sRealms","sProfiles","sAttributes","sVendors"],models:["mAccessProviderTree","mPermanentUser","mRealm","mProfile","mUserStat","mRadacct","mRadpostauth","mAttribute","mVendor","mPrivateAttribute","mDevice"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/permanent-users/add.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/permanent-users/export-csv",urlNoteAdd:"/cake3/rd_cake/permanent-users/note-add.json",urlViewBasic:"/cake3/rd_cake/permanent-users/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/permanent-users/edit-basic-info.json",urlViewPersonal:"/cake3/rd_cake/permanent-users/view-personal-info.json",urlEditPersonal:"/cake3/rd_cake/permanent-users/edit-personal-info.json",urlEnableDisable:"/cake3/rd_cake/permanent-users/enable-disable.json",urlChangePassword:"/cake3/rd_cake/permanent-users/change-password.json",urlDelete:"/cake3/rd_cake/permanent-users/delete.json",urlDevicesListedOnly:"/cake3/rd_cake/permanent-users/restrict-list-of-devices.json",urlAutoAddMac:"/cake3/rd_cake/permanent-users/auto-mac-on-off.json",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridPermanentUsers"},{ref:"privateGrid",selector:"gridUserPrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabPermanentUsers":{destroy:b.appClose},"gridPermanentUsers #reload":{click:b.reload},"gridPermanentUsers #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridPermanentUsers #add":{click:b.add},"gridPermanentUsers #delete":{click:b.del},"gridPermanentUsers #edit":{click:b.edit},"gridPermanentUsers #note":{click:b.note},"gridPermanentUsers #csv":{click:b.csvExport},"gridPermanentUsers #password":{click:b.changePassword},"gridPermanentUsers #enable_disable":{click:b.enableDisable},"gridPermanentUsers #test_radius":{click:b.testRadius},"gridPermanentUsers #graph":{click:b.graph},gridPermanentUsers:{select:b.select,activate:b.gridActivate},"winPermanentUserAddWizard #btnTreeNext":{click:b.btnTreeNext},"winPermanentUserAddWizard #btnDataPrev":{click:b.btnDataPrev},"winPermanentUserAddWizard #btnDataNext":{click:b.btnDataNext},"winPermanentUserAddWizard #profile":{change:b.cmbProfileChange},"winPermanentUserAddWizard #always_active":{change:b.chkAlwaysActiveChange},"winPermanentUserAddWizard #to_date":{change:b.toDateChange},"winPermanentUserAddWizard #from_date":{change:b.fromDateChange},"winPermanentUserAddWizard #ssid_only":{change:b.chkSsidOnlyChange},"#winCsvColumnSelectPermanentUsers #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=permanentUsers] #reload":{click:b.noteReload},"gridNote[noteForGrid=permanentUsers] #add":{click:b.noteAdd},"gridNote[noteForGrid=permanentUsers] #delete":{click:b.noteDelete},"gridNote[noteForGrid=permanentUsers]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=permanentUsers] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=permanentUsers] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=permanentUsers] #btnNoteAddNext":{click:b.btnNoteAddNext},"pnlPermanentUser gridUserRadpostauths #reload":{click:b.gridUserRadpostauthsReload},"pnlPermanentUser gridUserRadpostauths #delete":{click:b.deletePostAuths},"pnlPermanentUser gridUserRadpostauths":{activate:b.gridActivate},"pnlPermanentUser gridUserRadaccts #reload":{click:b.gridUserRadacctsReload},"pnlPermanentUser gridUserRadaccts #delete":{click:b.deleteRadaccts},"pnlPermanentUser gridUserRadaccts":{activate:b.gridActivate},"pnlPermanentUser gridUserDevices":{activate:b.gridActivate},"pnlPermanentUser gridUserDevices #reload":{click:b.gridUserDevicesReload},"pnlPermanentUser gridUserDevices #chkListedOnly":{change:b.gridUserDevicesListedOnly},"pnlPermanentUser gridUserDevices #chkAutoAddMac":{change:b.gridUserDevicesAutoAddMac},"pnlPermanentUser gridUserPrivate":{select:b.selectUserPrivate,activate:b.gridActivate},"pnlPermanentUser #profile":{change:b.cmbProfileChange,render:b.renderEventProfile},"pnlPermanentUser #realm":{render:b.renderEventRealm},"pnlPermanentUser #always_active":{change:b.chkAlwaysActiveChange},"pnlPermanentUser #to_date":{change:b.toDateChange},"pnlPermanentUser #from_date":{change:b.fromDateChange},"pnlPermanentUser #ssid_only":{change:b.chkSsidOnlyChange},"pnlPermanentUser #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlPermanentUser #tabBasicInfo #save":{click:b.saveBasicInfo},"pnlPermanentUser #tabPersonalInfo":{activate:b.onTabPersonalInfoActive},"pnlPermanentUser #tabPersonalInfo #save":{click:b.savePersonalInfo},"#tabPermanentUsers pnlPermanentUserGraphs #daily":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #daily #day":{change:b.changeDailyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly":{activate:b.loadGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabPermanentUsers pnlPermanentUserGraphs #monthly #day":{change:b.changeMonthlyGraph},"#winEnableDisablePermanentUser #save":{click:b.enableDisableSubmit},"winPermanentUserPassword #save":{click:b.changePasswordSubmit},gridUserPrivate:{beforeedit:b.onBeforeEditUserPrivate},"gridUserPrivate  #cmbVendor":{change:b.cmbVendorChange},"gridUserPrivate  #add":{click:b.attrAdd},"gridUserPrivate  #reload":{click:b.attrReload},"gridUserPrivate  #delete":{click:b.attrDelete}})},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winPermanentUserAddWizardId")){var h=Ext.widget("winPermanentUserAddWizard",{id:"winPermanentUserAddWizardId",selLanguage:d.application.getSelLanguage()});h.show()}}else{if(!Ext.WindowManager.get("winPermanentUserAddWizardId")){var h=Ext.widget("winPermanentUserAddWizard",{id:"winPermanentUserAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,selLanguage:d.application.getSelLanguage()});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winPermanentUserAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#realm").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#realm").getStore().load();j.down("#profile").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#profile").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winPermanentUserAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(i){var l=this;var j=i.up("window");var h=j.down("form");var k=j.down("#multiple").getValue();h.submit({clientValidation:true,url:l.getUrlAdd(),success:function(b,a){if(k!=true){j.close()}l.getStore("sPermanentUsers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=j.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},cmbProfileChange:function(r){var p=this;var s=r.up("form");var q=s.down("#cmbDataCap");var t=s.down("#cmbTimeCap");var o=r.getValue();var m=r.getStore();var u=m.getById(o);if(u!=null){var n=u.get("data_cap_in_profile");if(n){q.setVisible(true);q.setDisabled(false)}else{q.setVisible(false);q.setDisabled(true)}var w=u.get("time_cap_in_profile");if(w){t.setVisible(true);t.setDisabled(false)}else{t.setVisible(false);t.setDisabled(true)}}},chkAlwaysActiveChange:function(j){var n=this;var i=j.up("form");var k=i.down("#from_date");var l=i.down("#to_date");var m=j.getValue();if(m){l.setVisible(false);l.setDisabled(true);k.setVisible(false);k.setDisabled(true)}else{l.setVisible(true);l.setDisabled(false);k.setVisible(true);k.setDisabled(false)}},toDateChange:function(k,l,j){var n=this;var d=k.up("form");var m=d.down("#from_date");if(l<=m.getValue()){Ext.ux.Toaster.msg(i18n("sEnd_date_wrong"),i18n("sThe_end_date_should_be_after_the_start_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},fromDateChange:function(k,l,d){var m=this;var n=k.up("form");var j=n.down("#to_date");if(l>=j.getValue()){Ext.ux.Toaster.msg(i18n("sStart_date_wrong"),i18n("sThe_start_date_should_be_before_the_end_date"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},chkSsidOnlyChange:function(i){var l=this;var h=i.up("form");var j=h.down("#ssid_list");var k=i.getValue();if(k){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}},select:function(q,k,m,r,n){var o=this;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false);tb.down("#password").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true);tb.down("#password").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var d=e.getId();var b="puTab_"+d;var n=a.down("#"+b);if(n){a.setActiveTab(b);return}var p=e.get("username");a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlPermanentUser",pu_id:d,pu_name:p,record:e}});a.setActiveTab(b)})}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});k.push({boxLabel:"Cleartext Password",name:"cleartext_password",checked:false});if(!Ext.WindowManager.get("winCsvColumnSelectPermanentUsers")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectPermanentUsers",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNotePermananetUsers"+m.getId())){var j=Ext.widget("winNote",{id:"winNotePermananetUsers"+m.getId(),noteForId:m.getId(),noteForGrid:"permanentUsers",noteForName:m.get("username")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNotePermananetUsersAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNotePermananetUsersAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNotePermananetUsersAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNotePermananetUsersAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPermanentUsersPassword"+j.getId())){var h=Ext.widget("winPermanentUserPassword",{id:"winPermanentUsersPassword"+j.getId(),user_id:j.getId(),username:j.get("username"),title:i18n("sChange_password_for")+" "+j.get("username")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.user_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},enableDisable:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winEnableDisablePermanentUser")){var h=Ext.widget("winEnableDisable",{id:"winEnableDisablePermanentUser"});h.show()}}},enableDisableSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getSelection();Ext.Array.each(i,function(b){var a=b.getId();n[a]=a});m.submit({clientValidation:true,url:l.getUrlEnableDisable(),params:n,success:function(b,a){k.close();l.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestPermanent",j)}},gridUserRadpostauthsReload:function(g){var h=this;var e=g.up("gridUserRadpostauths");e.getStore().load()},gridUserDevicesReload:function(g){var h=this;var e=g.up("gridUserDevices");e.getStore().load()},gridUserRadacctsReload:function(g){var h=this;var e=g.up("gridUserRadaccts");e.getStore().load()},gridUserDevicesListedOnly:function(j){var n=this;var k=j.up("gridUserDevices").username;var m=j.up("gridUserDevices");var i=m.down("#chkAutoAddMac");var l=j.getValue();if(l){if(i.getValue()){console.log("Disable auto add check");i.setValue(false)}}Ext.Ajax.request({url:n.getUrlDevicesListedOnly(),method:"GET",params:{username:k,restrict:j.getValue()},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:n})},gridUserDevicesAutoAddMac:function(j){var n=this;var k=j.up("gridUserDevices").username;var m=j.up("gridUserDevices");var l=m.down("#chkListedOnly");var i=j.getValue();if(i){if(l.getValue()){console.log("Disable only listed check");l.setValue(false)}}Ext.Ajax.request({url:n.getUrlAutoAddMac(),method:"GET",params:{username:k,auto_mac:j.getValue()},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:n})},deletePostAuths:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeletePostAuths(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},onTabBasicInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlPermanentUser").pu_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{user_id:h},success:function(e,m){if(m.result.data.data_cap_type!=undefined){var a=j.down("#cmbDataCap");a.setVisible(true);a.setDisabled(false);a.setValue(m.result.data.data_cap_type)}if(m.result.data.time_cap_type!=undefined){var d=j.down("#cmbTimeCap");d.setVisible(true);d.setDisabled(false);d.setValue(m.result.data.time_cap_type)}if(m.result.data.ssid_list!=undefined){var b=j.down("#ssid_list");var n=[];b.getStore().loadData([],false);Ext.Array.forEach(m.result.data.ssid_list,function(k){var l=k.id;n.push(l);b.getStore().loadData([k],true)});b.setValue(n)}}})},saveBasicInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlPermanentUser").pu_id;j.submit({clientValidation:true,url:i.getUrlEditBasic(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onTabPersonalInfoActive:function(g){var i=this;var j=g.down("form");var h=g.up("pnlPermanentUser").pu_id;j.load({url:i.getUrlViewPersonal(),method:"GET",params:{user_id:h}})},savePersonalInfo:function(g){var i=this;var j=g.up("form");var h=g.up("pnlPermanentUser").pu_id;j.submit({clientValidation:true,url:i.getUrlEditPersonal(),params:{id:h},success:function(b,a){i.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},selectUserPrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditUserPrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridUserPrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridUserPrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridUserPrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridUserPrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},renderEventRealm:function(k){var i=this;var m=k.up("pnlPermanentUser");m.cmbRealmRendered=true;if(m.record!=undefined){var n=m.record.get("realm");var j=m.record.get("realm_id");var l=Ext.create("Rd.model.mRealm",{name:n,id:j});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var i=this;var n=k.up("pnlPermanentUser");n.cmbProfileRendered=true;if(n.record!=undefined){var j=n.record.get("profile");var l=n.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="permanentUserTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("username");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlPermanentUserGraphs",pu_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cPermanentUsers"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicies",Ext.grid.Panel,{multiSelect:true,store:"sPolicies",stateful:true,stateId:"StateGridPol",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/policies/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridPol1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridPol3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPol5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridPol6",tdCls:"gridTree"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicies"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicies"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicies:true},["widget.gridPolicies"],0,[Rd.view.policies,"gridPolicies"],0));(Ext.cmd.derive("Rd.model.mPolicy",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPolicy"],0));(Ext.cmd.derive("Rd.model.mPolicyEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"type",type:"string"},{name:"name",type:"string"},{name:"schedule",type:"string"},{name:"schedule_id",type:"int"},{name:"filter_id",type:"int"},{name:"white_list_id",type:"int"},{name:"black_list_id",type:"int"},{name:"policy_id",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mPolicyEntry"],0));(Ext.cmd.derive("Rd.model.mGenericCombo",Ext.data.Model,{fields:["id","text"]},0,0,0,0,0,0,[Rd.model,"mGenericCombo"],0));(Ext.cmd.derive("Rd.view.policies.pnlPolicyDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",policy_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Policy Entries",layout:"fit",xtype:"gridPolicyEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPolicyDetail"],["component","box","container","panel","tabpanel","pnlPolicyDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlPolicyDetail:true},["widget.pnlPolicyDetail"],0,[Rd.view.policies,"pnlPolicyDetail"],0));(Ext.cmd.derive("Rd.store.sPolicies",Ext.data.Store,{model:"Rd.model.mPolicy",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/policies/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sPolicies"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Policy",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winPolicyAddWizard"],["component","box","container","panel","window","winPolicyAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winPolicyAddWizard:true},["widget.winPolicyAddWizard"],0,[Rd.view.policies,"winPolicyAddWizard"],0));(Ext.cmd.derive("Rd.view.policies.vcPolicyEntry",Ext.app.ViewController,{init:function(){},onSelectedTypeChange:function(j){var n=this;var m=j.getValue();var o=j.up("form");var l=o.down("#cmbPolicyFilter");var p=o.down("#cmbPolicyWhiteList");var k=o.down("#cmbPolicyBlackList");if(m.type=="filter"){l.setHidden(false);l.setDisabled(false);p.setHidden(true);p.setDisabled(true);k.setHidden(true);k.setDisabled(true)}if(m.type=="white_list"){l.setHidden(true);l.setDisabled(true);p.setHidden(false);p.setDisabled(false);k.setHidden(true);k.setDisabled(true)}if(m.type=="black_list"){l.setHidden(true);l.setDisabled(true);p.setHidden(true);p.setDisabled(true);k.setHidden(false);k.setDisabled(false)}},onAfterEditRender:function(A){var z=this;var H=A.down("form");var I=A.record;var y=I.get("type");var s=H.down("#rgType");var D={type:y};s.setValue(D);var F=H.down("#cmbPolicySchedule");var x=H.down("#cmbPolicyFilter");var J=H.down("#cmbPolicyWhiteList");var r=H.down("#cmbPolicyBlackList");var w=I.get("schedule_id");var K=I.get("schedule");var B=Ext.create("Rd.model.mGenericCombo",{name:K,id:w});F.getStore().loadData([B],false);F.setValue(w);if(y=="filter"){var G=I.get("filter_id");var C=I.get("name");var E=Ext.create("Rd.model.mGenericCombo",{name:C,id:G});x.getStore().loadData([E],false);x.setValue(G)}}},0,0,0,0,["controller.vcPolicyEntry"],0,[Rd.view.policies,"vcPolicyEntry"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Schedule Entry",width:400,height:400,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},controller:"vcPolicyEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:15},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:3,vertical:false,items:[{boxLabel:"Filter",name:"type",inputValue:"filter",checked:true},{boxLabel:"White List",name:"type",inputValue:"white_list"},{boxLabel:"Black List",name:"type",inputValue:"black_list"}],listeners:{change:"onSelectedTypeChange"}},{xtype:"cmbPolicyGenericList",fieldLabel:"Filter",itemId:"cmbPolicyFilter",name:"filter_id",url:"/cake3/rd_cake/filters/index-for-list.json"},{xtype:"cmbPolicyGenericList",fieldLabel:"White List",itemId:"cmbPolicyWhiteList",name:"white_list_id",url:"/cake3/rd_cake/white-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Black List",itemId:"cmbPolicyBlackList",name:"black_list_id",url:"/cake3/rd_cake/black-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Schedule",itemId:"cmbPolicySchedule",name:"schedule_id",url:"/cake3/rd_cake/schedules/index-for-list.json"},{itemId:"policy_id",xtype:"textfield",name:"policy_id",hidden:true,value:e.policy_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEntryAdd"],["component","box","container","panel","window","winPolicyEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEntryAdd:true},["widget.winPolicyEntryAdd"],0,[Rd.view.policies,"winPolicyEntryAdd"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Policy Entry",width:400,height:400,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},listeners:{afterrender:"onAfterEditRender"},controller:"vcPolicyEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:15},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:3,vertical:false,itemId:"rgType",items:[{boxLabel:"Filter",name:"type",inputValue:"filter",checked:true},{boxLabel:"White List",name:"type",inputValue:"white_list"},{boxLabel:"Black List",name:"type",inputValue:"black_list"}],listeners:{change:"onSelectedTypeChange"}},{xtype:"cmbPolicyGenericList",fieldLabel:"Filter",itemId:"cmbPolicyFilter",name:"filter_id",url:"/cake3/rd_cake/filters/index-for-list.json"},{xtype:"cmbPolicyGenericList",fieldLabel:"White List",itemId:"cmbPolicyWhiteList",name:"white_list_id",url:"/cake3/rd_cake/white-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Black List",itemId:"cmbPolicyBlackList",name:"black_list_id",url:"/cake3/rd_cake/black-lists/index-for-list.json",hidden:true,disabled:true},{xtype:"cmbPolicyGenericList",fieldLabel:"Schedule",itemId:"cmbPolicySchedule",name:"schedule_id",url:"/cake3/rd_cake/schedules/index-for-list.json"},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEntryEdit"],["component","box","container","panel","window","winPolicyEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEntryEdit:true},["widget.winPolicyEntryEdit"],0,[Rd.view.policies,"winPolicyEntryEdit"],0));(Ext.cmd.derive("Rd.view.policies.winPolicyEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Policy",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winPolicyEdit"],["component","box","container","panel","window","winPolicyEdit"],{component:true,box:true,container:true,panel:true,window:true,winPolicyEdit:true},["widget.winPolicyEdit"],0,[Rd.view.policies,"winPolicyEdit"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicyEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"PE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/policies/menu-for-policy-entries.json",initComponent:function(){var e=this;var d=e.record.getId();e.columns=[{xtype:"rownumberer",stateId:"PE1"},{text:"Entry",dataIndex:"name",tdCls:"gridTree",flex:1,renderer:function(a,i,j){var b=j.get("type");if(b=="white_list"){return'<div class="fieldGreenWhite"><i class="fa  fa-check-circle"></i>  '+a+"</div>"}if(b=="black_list"){return'<div class="fieldGreyWhite"><i class="fa fa-ban"></i>  '+a+"</div>"}if(b=="filter"){return'<div class="fieldBlueWhite"><i class="fa fa-filter"></i>  '+a+"</div>"}return a},stateId:"PE2"},{text:"Schedule",dataIndex:"schedule",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"PE3"}];e.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:e.urlMenu});e.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPolicyEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/policies/index-policy-entry.json",extraParams:{policy_id:d},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicyEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicyEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicyEntries:true},["widget.gridPolicyEntries"],0,[Rd.view.policies,"gridPolicyEntries"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicyGenericList",Ext.form.ComboBox,{labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:d.url,reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicyGenericList"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicyGenericList"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicyGenericList:true},["widget.cmbPolicyGenericList"],0,[Rd.view.policies,"cmbPolicyGenericList"],0));(Ext.cmd.derive("Rd.controller.cPolicies",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabPolicies",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridPolicies",glyph:Rd.config.icnHome}]});d.populated=true},views:["policies.gridPolicies","policies.winPolicyEdit","policies.winPolicyAddWizard","policies.pnlPolicyDetail","policies.gridPolicyEntries","policies.winPolicyEntryAdd","policies.winPolicyEntryEdit","policies.cmbPolicyGenericList"],stores:["sAccessProvidersTree","sPolicies"],models:["mAccessProviderTree","mPolicy","mPolicyEntry","mGenericCombo"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/policies/add.json",urlDelete:"/cake3/rd_cake/policies/delete.json",urlEdit:"/cake3/rd_cake/policies/edit.json",urlAddEntry:"/cake3/rd_cake/policies/add-policy-entry.json",urlEditEntry:"/cake3/rd_cake/policies/edit-policy-entry.json",urlDeleteEntry:"/cake3/rd_cake/policies/delete-policy-entry.json"},refs:[{ref:"grid",selector:"gridPolicies"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabPolicies":{destroy:b.appClose},"gridPolicies #reload":{click:b.reload},"gridPolicies #add":{click:b.add},"gridPolicies #delete":{click:b.del},"gridPolicies #edit":{click:b.edit},gridPolicies:{select:b.select},"winPolicyAddWizard #btnTreeNext":{click:b.btnTreeNext},"winPolicyAddWizard #btnDataPrev":{click:b.btnDataPrev},"winPolicyAddWizard #btnDataNext":{click:b.btnDataNext},"pnlPolicyDetail gridPolicyEntries":{activate:b.gridActivate},"#tabPolicies gridPolicies":{activate:b.gridActivate},"pnlPolicyDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridPolicyEntries #reload":{click:b.reloadEntries},"gridPolicyEntries #add":{click:b.addEntry},"gridPolicyEntries #edit":{click:b.editEntry},"gridPolicyEntries #delete":{click:b.deleteEntry},"winPolicyEntryAdd  #save":{click:b.savePolicyEntryAdd},"winPolicyEntryEdit  #save":{click:b.savePolicyEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winPolicyAddWizardId")){var h=Ext.widget("winPolicyAddWizard",{id:"winPolicyAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winPolicyAddWizardId")){var h=Ext.widget("winPolicyAddWizard",{id:"winPolicyAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winPolicyAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winPolicyAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sPolicies").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(n,p){var a=i.getGrid().up("tabpanel");var b=n.getId();var d="pTab_"+b;var o=a.down("#"+d);if(o){a.setActiveTab(d);return}var e=n.get("name");a.add({title:e,itemId:d,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlPolicyDetail",policy_id:b,record:n}});a.setActiveTab(d)})}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlPolicyDetail").policy_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winPolicyEntryAdd"+k)){var j=Ext.widget("winPolicyEntryAdd",{id:"winPolicyEntryAdd"+k,policy_id:k,store:i});j.show()}},savePolicyEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winPolicyEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winPolicyEntryEditId")){var j=Ext.widget("winPolicyEntryEdit",{id:"winPolicyEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},savePolicyEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winPolicyEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cPolicies"],0));(Ext.cmd.derive("Rd.view.profileComponents.gridProfileComponents",Ext.grid.Panel,{multiSelect:true,store:"sProfileComponents",stateful:true,stateId:"StateGridProfileComponents",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake2/rd_cake/profile_components/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridProfileComponents1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridProfileComponents2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridProfileComponents3"},{text:i18n("sCheck_attribute_count"),dataIndex:"check_attribute_count",tdCls:"gridTree",flex:1,stateId:"StateGridProfileComponents4"},{text:i18n("sReply_attribute_count"),dataIndex:"reply_attribute_count",tdCls:"gridTree",flex:1,stateId:"StateGridProfileComponents5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridProfileComponents6"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridProfileComponents7"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfileComponents"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfileComponents"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfileComponents:true},["widget.gridProfileComponents"],0,[Rd.view.profileComponents,"gridProfileComponents"],0));(Ext.cmd.derive("Rd.model.mProfileComponent",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"check_attribute_count",type:"int"},{name:"reply_attribute_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mProfileComponent"],0));(Ext.cmd.derive("Rd.model.mProfileComponentEdit",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"type",type:"string"},{name:"groupname",type:"string"},{name:"attribute",type:"string"},{name:"op",type:"string"},{name:"value",type:"string"},{name:"comment",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mProfileComponentEdit"],0));(Ext.cmd.derive("Rd.view.profileComponents.gridProfileComponent",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridProfileComponent",stateEvents:["groupclick","columnhide"],border:false,comp_id:null,tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mProfileComponentEdit",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{comp_id:b.comp_id},reader:{type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake2/rd_cake/profile_components/add_comp.json",read:"/cake2/rd_cake/profile_components/index_comp.json",update:"/cake2/rd_cake/profile_components/edit_comp.json",destroy:"/cake2/rd_cake/profile_components/delete_comp.json"}},listeners:{load:function(h,a,g){if(!g){Ext.ux.Toaster.msg("Error encountered",h.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:true,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridProfileComponent1"},{header:i18n("sType"),dataIndex:"type",width:130,tdCls:"grdEditable",editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridProfileComponent2"},{text:i18n("sAttribute_name"),dataIndex:"attribute",tdCls:"gridMain",flex:1,stateId:"StateGridProfileComponent3"},{header:i18n("sOperator"),dataIndex:"op",width:100,tdCls:"grdEditable",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"},stateId:"StateGridProfileComponent4"},{text:i18n("sValue"),dataIndex:"value",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridProfileComponent5"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"grdEditable",flex:1,editor:{xtype:"textfield",allowBlank:true},stateId:"StateGridProfileComponent6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfileComponent"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfileComponent"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfileComponent:true},["widget.gridProfileComponent"],0,[Rd.view.profileComponents,"gridProfileComponent"],0));(Ext.cmd.derive("Rd.store.sProfileComponents",Ext.data.Store,{model:"Rd.model.mProfileComponent",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake2/rd_cake/profile_components/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/profile_components/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sProfileComponents"],0));(Ext.cmd.derive("Rd.view.profileComponents.winProfileComponentAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_profile_component"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winProfileComponentAddWizard"],["component","box","container","panel","window","winProfileComponentAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winProfileComponentAddWizard:true},["widget.winProfileComponentAddWizard"],0,[Rd.view.profileComponents,"winProfileComponentAddWizard"],0));(Ext.cmd.derive("Rd.controller.cProfileComponents",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabProfileComponents",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridProfileComponents",glyph:Rd.config.icnHome}]});d.populated=true},views:["profileComponents.gridProfileComponents","profileComponents.winProfileComponentAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","profileComponents.gridProfileComponent","components.cmbVendor","components.cmbAttribute"],stores:["sProfileComponents","sAccessProvidersTree","sAttributes","sVendors"],models:["mProfileComponent","mAccessProviderTree","mAttribute","mVendor","mProfileComponentEdit"],selectedRecord:null,config:{urlAdd:"/cake2/rd_cake/profile_components/add.json",urlEdit:"/cake2/rd_cake/profile_components/edit.json",urlDelete:"/cake2/rd_cake/profile_components/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake2/rd_cake/profile_components/export_csv",urlNoteAdd:"/cake2/rd_cake/profile_components/note_add.json"},refs:[{ref:"grid",selector:"gridProfileComponents"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabProfileComponents":{destroy:b.appClose},"gridProfileComponents #reload":{click:b.reload},"gridProfileComponents #add":{click:b.add},"gridProfileComponents #delete":{click:b.del},"gridProfileComponents #edit":{click:b.edit},"gridProfileComponents #note":{click:b.note},"gridProfileComponents #csv":{click:b.csvExport},gridProfileComponents:{select:b.select},"winProfileComponentAddWizard #btnTreeNext":{click:b.btnTreeNext},"winProfileComponentAddWizard #btnDataPrev":{click:b.btnDataPrev},"winProfileComponentAddWizard #btnDataNext":{click:b.btnDataNext},"#winCsvColumnSelectProfileComponents #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=profile_components] #reload":{click:b.noteReload},"gridNote[noteForGrid=profile_components] #add":{click:b.noteAdd},"gridNote[noteForGrid=profile_components] #delete":{click:b.noteDelete},"gridNote[noteForGrid=profile_components]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=profile_components] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=profile_components] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=profile_components] #btnNoteAddNext":{click:b.btnNoteAddNext},"gridProfileComponent  #cmbVendor":{change:b.cmbVendorChange},"gridProfileComponent  #add":{click:b.attrAdd},"gridProfileComponent  #reload":{click:b.attrReload},"gridProfileComponent  #delete":{click:b.attrDelete}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winProfileComponentAddWizardId")){var h=Ext.widget("winProfileComponentAddWizard",{id:"winProfileComponentAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winProfileComponentAddWizardId")){var h=Ext.widget("winProfileComponentAddWizard",{id:"winProfileComponentAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winProfileComponentAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winProfileComponentAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sProfileComponents").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){console.log("Edit node");var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(e,o){var a=i.getGrid().up("tabpanel");var b=e.getId();var p="compTab_"+b;var n=a.down("#"+p);if(n){a.setActiveTab(p);return}var d=e.get("name");a.add({title:d,itemId:p,closable:true,glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"gridProfileComponent",comp_id:b}});a.setActiveTab(p)})}},onStoreProfileComponentsLoaded:function(){var d=this;var e=d.getStore("sProfileComponents").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectProfileComponents")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectProfileComponents",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteProfileComponents"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteProfileComponents"+m.getId(),noteForId:m.getId(),noteForGrid:"profile_components",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteProfileComponentsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfileComponentsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteProfileComponentsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfileComponentsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},cmbVendorChange:function(j){var l=this;console.log("Combo thing changed");var k=j.getValue();var h=j.up("gridProfileComponent");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;console.log("Add to specific template");var m=n.up("gridProfileComponent");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mProfileComponentEdit",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value")}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridProfileComponent");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridProfileComponent");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cProfileComponents"],0));(Ext.cmd.derive("Rd.view.profiles.gridProfiles",Ext.grid.Panel,{multiSelect:true,store:"sProfiles",stateful:true,stateId:"StateGridProfiles",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/profiles/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridProfiles1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridProfiles2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridProfiles3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate('<tpl if=\'available_to_siblings == true\'><div class="fieldGreen"><i class="fa fa-check-circle"></i> '+i18n("sYes")+"</div></tpl>",'<tpl if=\'available_to_siblings == false\'><div class="fieldRed"><i class="fa fa-times-circle"></i> '+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridProfiles4"},{text:i18n("sProfile_components"),sortable:false,flex:1,xtype:"templatecolumn",tdCls:"gridTree",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(profile_components)"><div"></div></tpl>','<tpl for="profile_components">','<div class="fieldGreyWhite">{groupname} <small><i>(priority => {priority})</i></small></div>',"</tpl>"),dataIndex:"profile_components",stateId:"StateGridProfiles5"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridProfiles6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridProfiles"],["component","box","container","panel","tablepanel","gridpanel","grid","gridProfiles"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridProfiles:true},["widget.gridProfiles"],0,[Rd.view.profiles,"gridProfiles"],0));(Ext.cmd.derive("Rd.view.profiles.winComponentManage",Ext.window.Window,{title:i18n("sEdit_profile"),layout:"fit",autoShow:false,width:450,height:410,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:i18n("sAdd_component"),name:"rb",inputValue:"add",checked:true},{boxLabel:i18n("sRemove_component"),name:"rb",inputValue:"remove"},{boxLabel:i18n("sAvailable_to_sub_providers"),name:"rb",inputValue:"sub"},{boxLabel:i18n("sPrivate"),name:"rb",inputValue:"no_sub"}]},{xtype:"combo",fieldLabel:i18n("sProfile_component"),store:"sProfileComponents",queryMode:"local",editable:false,allowBlank:false,disabled:false,name:"component_id",displayField:"name",valueField:"id"},{xtype:"numberfield",anchor:"100%",name:"priority",fieldLabel:"Priority <br><small><i>(Higher takes priority)</i></small>",value:5,maxValue:5,minValue:1,itemId:"priority"}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winComponentManage"],["component","box","container","panel","window","winComponentManage"],{component:true,box:true,container:true,panel:true,window:true,winComponentManage:true},["widget.winComponentManage"],0,[Rd.view.profiles,"winComponentManage"],0));(Ext.cmd.derive("Rd.view.profiles.winProfileAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_profile"),width:400,height:400,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winProfileAddWizard"],["component","box","container","panel","window","winProfileAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winProfileAddWizard:true},["widget.winProfileAddWizard"],0,[Rd.view.profiles,"winProfileAddWizard"],0));(Ext.cmd.derive("Rd.controller.cProfiles",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridProfiles",border:true,itemId:"tabProfiles",plain:true});d.populated=true},views:["profiles.gridProfiles","profiles.winProfileAddWizard","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","profiles.winComponentManage"],stores:["sProfiles","sAccessProvidersTree","sProfileComponents"],models:["mProfile","mAccessProviderTree"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/profiles/add.json",urlDelete:"/cake3/rd_cake/profiles/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/profiles/export-csv",urlNoteAdd:"/cake3/rd_cake/profiles/note_add.json",urlManageComponents:"/cake3/rd_cake/profiles/manage-components.json"},refs:[{ref:"grid",selector:"gridProfiles"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabProfiles":{destroy:b.appClose},"gridProfiles #reload":{click:b.reload},"gridProfiles #add":{click:b.add},"gridProfiles #delete":{click:b.del},"gridProfiles #edit":{click:b.edit},"gridProfiles #note":{click:b.note},"gridProfiles #csv":{click:b.csvExport},gridProfiles:{select:b.select},"winProfileAddWizard #btnTreeNext":{click:b.btnTreeNext},"winProfileAddWizard #btnDataPrev":{click:b.btnDataPrev},"winProfileAddWizard #btnDataNext":{click:b.btnDataNext},"#winCsvColumnSelectProfiles #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=profiles] #reload":{click:b.noteReload},"gridNote[noteForGrid=profiles] #add":{click:b.noteAdd},"gridNote[noteForGrid=profiles] #delete":{click:b.noteDelete},"gridNote[noteForGrid=profiles]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=profiles] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=profiles] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=profiles] #btnNoteAddNext":{click:b.btnNoteAddNext},"winComponentManage #save":{click:b.btnComponentManageSave},"winComponentManage radiogroup":{change:b.radioComponentManage}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winProfileAddWizardId")){var h=Ext.widget("winProfileAddWizard",{id:"winProfileAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winProfileAddWizardId")){var h=Ext.widget("winProfileAddWizard",{id:"winProfileAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winProfileAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winProfileAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sProfiles").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(j){var i=this;var g=j.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winComponentManageId")){var h=Ext.widget("winComponentManage",{id:"winComponentManageId"});h.show()}}},radioComponentManage:function(j){var l=this;var h=j.up("form");var k=h.down("combo");var i=h.down("numberfield");if((j.getValue().rb=="add")||(j.getValue().rb=="remove")){k.setVisible(true);k.setDisabled(false)}else{k.setVisible(false);k.setDisabled(true)}if(j.getValue().rb=="add"){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},btnComponentManageSave:function(l){var p=this;var o=l.up("window");var q=o.down("form");var n=q.down("combo");var m=q.down("radiogroup");if((m.getValue().rb=="add")||(m.getValue().rb=="remove")){if(n.getValue()==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sSelect_a_component_to_add_or_remove"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}}var r={};var k=p.getGrid().getSelectionModel().getSelection();Ext.Array.each(k,function(b){var a=b.getId();r[a]=a});q.submit({clientValidation:true,url:p.getUrlManageComponents(),params:r,success:function(b,a){o.close();p.getGrid().getStore().load();Ext.ux.Toaster.msg(i18n("sProfiles_modified"),i18n("sProfiles_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectProfiles")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectProfiles",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteProfiles"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteProfiles"+m.getId(),noteForId:m.getId(),noteForGrid:"profiles",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteProfilesAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteProfilesAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cProfiles"],0));(Ext.cmd.derive("Rd.view.radiusClient.cmbRequestType",Ext.form.ComboBox,{fieldLabel:i18n("sRequest_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"request_type",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"auth",text:i18n("sAuthentication")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbRequestType"],["component","box","field","textfield","pickerfield","combobox","combo","cmbRequestType"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbRequestType:true},["widget.cmbRequestType"],0,[Rd.view.radiusClient,"cmbRequestType"],0));(Ext.cmd.derive("Rd.view.radiusClient.cmbUserType",Ext.form.ComboBox,{fieldLabel:i18n("sUser_type"),labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"user_type",labelClsExtra:"lblRdReq",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"voucher",text:i18n("sVoucher")},{id:"permanent",text:i18n("sPermanent_user")},{id:"device",text:i18n("sDevice")}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbUserType"],["component","box","field","textfield","pickerfield","combobox","combo","cmbUserType"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbUserType:true},["widget.cmbUserType"],0,[Rd.view.radiusClient,"cmbUserType"],0));(Ext.cmd.derive("Rd.view.components.cmbDevice",Ext.form.ComboBox,{fieldLabel:"Device",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"device_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mDevice",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/devices/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDevice"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDevice"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDevice:true},["widget.cmbDevice"],0,[Rd.view.components,"cmbDevice"],0));(Ext.cmd.derive("Rd.view.components.cmbVoucher",Ext.form.ComboBox,{fieldLabel:i18n("sVoucher"),labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,queryMode:"remote",mode:"remote",name:"voucher_id",pageSize:1,labelClsExtra:"lblRd",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{model:"Rd.model.mVoucher",buffered:false,remoteSort:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/vouchers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:false});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbVoucher"],["component","box","field","textfield","pickerfield","combobox","combo","cmbVoucher"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbVoucher:true},["widget.cmbVoucher"],0,[Rd.view.components,"cmbVoucher"],0));(Ext.cmd.derive("Rd.view.radiusClient.frmRadiusRequest",Ext.form.Panel,{autoScroll:true,autoCreate:true,frame:true,layout:"anchor",defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin},buttons:[{itemId:"send",formBind:true,text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],initComponent:function(){var b=this;b.items=[{xtype:"cmbRequestType",value:"auth"},{xtype:"cmbUserType",value:"permanent"},{xtype:"cmbPermanentUser",fieldLabel:i18n("sUsername")},{xtype:"cmbDevice",hidden:true,disabled:true},{xtype:"cmbVoucher",hidden:true,disabled:true}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmRadiusRequest"],["component","box","container","panel","form","frmRadiusRequest"],{component:true,box:true,container:true,panel:true,form:true,frmRadiusRequest:true},["widget.frmRadiusRequest"],0,[Rd.view.radiusClient,"frmRadiusRequest"],0));(Ext.cmd.derive("Rd.view.radiusClient.pnlRadiusReply",Ext.form.Panel,{autoScroll:true,autoCreate:true,frame:true,initComponent:function(){var b=this;b.tpl=new Ext.XTemplate("<div class='blue_round'>","<h1>"+i18n("sRequest_Attributes")+"</h1>","<ul>",'<tpl for="send">',"<li>{.}</li>","</tpl>","</ul>","</div>","<tpl if='failed'>","<div class='red_round'>","<tpl else>","<div class='green_round'>","</tpl>","<h1>"+i18n("sReply_Attributes")+"</h1>","<ul>",'<tpl for="received">',"<li>{.}</li>","</tpl>","</ul>","</div>");Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRadiusReply"],["component","box","container","panel","form","pnlRadiusReply"],{component:true,box:true,container:true,panel:true,form:true,pnlRadiusReply:true},["widget.pnlRadiusReply"],0,[Rd.view.radiusClient,"pnlRadiusReply"],0));(Ext.cmd.derive("Rd.model.mVoucher",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"user_id",type:"int"},{name:"realm",type:"string"},{name:"realm_id"},{name:"profile",type:"string"},{name:"profile_id"},"name","password",{name:"batch",type:"string"},"perc_time_used","perc_data_used",{name:"status",type:"string"},{name:"last_accept_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_accept_time_in_words",type:"string"},{name:"last_accept_nas"},{name:"last_reject_time",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"last_reject_time_in_words",type:"string"},{name:"last_reject_nas"},{name:"last_reject_message"},{name:"from_date"},{name:"to_date"},"data_usage","time_usage",{name:"update",type:"bool"},{name:"delete",type:"bool"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mVoucher"],0));(Ext.cmd.derive("Rd.controller.cRadiusClient",Ext.app.Controller,{cmbVRendered:false,vRecord:undefined,cmbPuRendered:false,puRecord:undefined,cmbDRendered:false,dRecord:undefined,views:["radiusClient.frmRadiusRequest","radiusClient.pnlRadiusReply"],stores:[],models:["mPermanentUser","mDevice","mVoucher"],config:{urlRequest:"/cake2/rd_cake/free_radius/test_radius.json"},refs:[{ref:"cmbVoucher",selector:"cmbVoucher"},{ref:"cmbPermanent",selector:"cmbPermanentUser"},{ref:"cmbDevice",selector:"cmbDevice"},{ref:"cmbUserType",selector:"cmbUserType"},{ref:"pnlRadiusReply",selector:"pnlRadiusReply"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"frmRadiusRequest cmbUserType":{change:b.userTypeChange},"frmRadiusRequest cmbPermanentUser":{afterrender:b.renderEventPu},"frmRadiusRequest cmbDevice":{afterrender:b.renderEventD},"frmRadiusRequest cmbVoucher":{afterrender:b.renderEventV},"frmRadiusRequest #send":{click:b.submitRequest},"#radiusClientWin":{destroy:b.onDestroy}})},actionIndex:function(){var e=this;if(!Ext.WindowManager.get("radiusClientWin")){var d=Ext.widget("window",{id:"radiusClientWin",title:i18n("sRADIUS_client"),width:700,height:450,glyph:Rd.config.icnRadius,animCollapse:false,border:false,constrainHeader:true,layout:"border",stateful:true,stateId:"radiusClientWin",items:[{region:"center",layout:{type:"hbox",align:"stretch"},margins:"0 0 0 0",border:false,items:[{title:i18n("sRequest"),flex:1,xtype:"frmRadiusRequest",ui:"light",glyph:Rd.config.icnQuestion,margin:5},{title:i18n("sReply"),flex:1,xtype:"pnlRadiusReply",ui:"light",glyph:Rd.config.icnBullhorn,margin:5}]}]});d.show()}},actionTestVoucher:function(e){var d=this;d.vRecord=e;if(d.cmbVRendered==true){console.log("Combo already rendered... set it");d.getCmbUserType().setValue("voucher");d.getCmbVoucher().getStore().loadData([d.vRecord],false);d.getCmbVoucher().setValue(d.vRecord.getId())}d.actionIndex()},actionTestPermanent:function(d){var e=this;e.puRecord=d;if(e.cmbPuRendered==true){console.log("Combo already rendered... set it");e.getCmbUserType().setValue("permanent");e.getCmbPermanent().getStore().loadData([e.puRecord],false);e.getCmbPermanent().setValue(e.puRecord.getId())}e.actionIndex()},actionTestDevice:function(e){var d=this;d.dRecord=e;if(d.cmbDRendered==true){console.log("Combo already rendered... set it");d.getCmbUserType().setValue("device");d.getCmbDevice().getStore().loadData([d.dRecord],false);d.getCmbDevice().setValue(d.dRecord.getId())}d.actionIndex()},renderEventV:function(d){var e=this;e.cmbVRendered=true;if(e.vRecord!=undefined){console.log("Voucher detail present first time combo render");e.getCmbUserType().setValue("voucher");e.getCmbVoucher().getStore().loadData([e.vRecord],false);e.getCmbVoucher().setValue(e.vRecord.getId())}},renderEventPu:function(d){var e=this;e.cmbPuRendered=true;if(e.puRecord!=undefined){console.log("Permanent detail present first time combo render");e.getCmbUserType().setValue("permanent");e.getCmbPermanent().getStore().loadData([e.puRecord],false);e.getCmbPermanent().setValue(e.puRecord.getId())}},renderEventD:function(d){var e=this;e.cmbDRendered=true;if(e.dRecord!=undefined){console.log("Permanent detail present first time combo render");e.getCmbUserType().setValue("device");e.getCmbDevice().getStore().loadData([e.dRecord],false);e.getCmbDevice().setValue(e.dRecord.getId())}},onDestroy:function(e){var d=this;d.puRecord=undefined;d.cmbPuRendered=false;d.dRecord=undefined;d.cmbDRendered=false;d.vRecord=undefined;d.cmbVRendered=false},userTypeChange:function(l,k,p){var o=this;var n=l.up("form").down("cmbPermanentUser");var m=l.up("form").down("cmbDevice");var d=l.up("form").down("cmbVoucher");if(k=="voucher"){d.setVisible(true);d.setDisabled(false);m.setVisible(false);m.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if(k=="device"){m.setVisible(true);m.setDisabled(false);d.setVisible(false);d.setDisabled(true);n.setVisible(false);n.setDisabled(true)}if(k=="permanent"){n.setVisible(true);n.setDisabled(false);d.setVisible(false);d.setDisabled(true);m.setVisible(false);m.setDisabled(true)}},submitRequest:function(b){me=this;var e=b.up("form");me.getPnlRadiusReply().setLoading(true,true);e.submit({clientValidation:true,url:me.getUrlRequest(),success:function(j,d,k,a){me.getPnlRadiusReply().setLoading(false);me.getPnlRadiusReply().update(d.result.data);console.log(d.result)},failure:function(a,d){me.getPnlRadiusReply().setLoading(false);console.log(a);console.log(d)}})}},0,0,0,0,0,0,[Rd.controller,"cRadiusClient"],0));(Ext.cmd.derive("Rd.view.realms.gridRealms",Ext.grid.Panel,{multiSelect:true,store:"sRealms",stateful:true,stateId:"StateGridRealms",stateEvents:["groupclick","columnhide"],border:false,urlMenu:"/cake3/rd_cake/realms/menu-for-grid.json",plugins:"gridfilters",viewConfig:{loadMask:true},bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.columns=[{xtype:"rownumberer",stateId:"StateGridRealms1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridRealms2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridRealms3"},{text:i18n("sPhone"),dataIndex:"phone",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms4"},{text:i18n("sFax"),dataIndex:"fax",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms5"},{text:i18n("sCell"),dataIndex:"cell",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms6"},{text:i18n("s_email"),dataIndex:"email",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms7"},{text:i18n("sURL"),dataIndex:"url",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGridRealms8"},{text:"Twitter",dataIndex:"twitter",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR9"},{text:"Facebook",dataIndex:"facebook",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR10"},{text:"Youtube",dataIndex:"youtube",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR11"},{text:"Google+",dataIndex:"google_plus",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR12"},{text:"LinkedIn",dataIndex:"linkedin",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR13"},{text:"T&C Title",dataIndex:"t_c_title",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR14"},{text:"T&C Content",dataIndex:"t_c_content",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StateGR15"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean"},stateId:"StateGR16"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGR17",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGR18"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGR19"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridRealms"],["component","box","container","panel","tablepanel","gridpanel","grid","gridRealms"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridRealms:true},["widget.gridRealms"],0,[Rd.view.realms,"gridRealms"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmDetail",Ext.panel.Panel,{border:false,realm_id:null,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var b=this;b.items={xtype:"form",height:"100%",width:450,layout:"fit",autoScroll:true,frame:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth},items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:b.owner,name:"owner",labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sSuffix"),name:"suffix",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",regex:/^[\w\-_\.]+$/,regexText:"Only words, underscores, dashes and full stops allowed"},{xtype:"checkbox",boxLabel:i18n("sAdd_suffix_when_creating_Permanent_Users"),name:"suffix_permanent_users",inputValue:"suffix_permanent_users",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAdd_suffix_when_creating_Vouchers"),name:"suffix_vouchers",inputValue:"suffix_vouchers",checked:false,cls:"lblRd"},{xtype:"checkbox",boxLabel:"Add suffix when creating BYOD",name:"suffix_devices",inputValue:"suffix_devices",checked:false,cls:"lblRd"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]},{title:"Social media",layout:"anchor",itemId:"tabSocial",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:"Twitter",name:"twitter",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Facebook",name:"facebook",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Youtube",name:"youtube",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"Google+",name:"google_plus",allowBlank:true,vtype:"url"},{xtype:"textfield",fieldLabel:"LinkedIn",name:"linkedin",allowBlank:true,vtype:"url"}]},{title:"T&C",layout:"anchor",itemId:"tabTandC",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:"Title",name:"t_c_title",allowBlank:true},{xtype:"textareafield",grow:true,name:"t_c_content",allowBlank:true,fieldLabel:"Content",anchor:"100%"}]}]}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmDetail"],["component","box","container","panel","pnlRealmDetail"],{component:true,box:true,container:true,panel:true,pnlRealmDetail:true},["widget.pnlRealmDetail"],0,[Rd.view.realms,"pnlRealmDetail"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmLogo",Ext.panel.Panel,{border:false,nas_id:null,url:Ext.BLANK_IMAGE_URL,layout:"hbox",bodyStyle:{backgroundColor:Rd.config.panelGrey},initComponent:function(){var d=this;var e=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='Realm logo'>","</div>"]);d.items={xtype:"panel",frame:false,padding:5,height:"100%",width:450,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",title:i18n("sCurrent_logo"),flex:1,border:false,itemId:"pnlImg",tpl:e,data:{img:d.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",iconCls:"b-close",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]}]};Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmLogo"],["component","box","container","panel","pnlRealmLogo"],{component:true,box:true,container:true,panel:true,pnlRealmLogo:true},["widget.pnlRealmLogo"],0,[Rd.view.realms,"pnlRealmLogo"],0));(Ext.cmd.derive("Rd.view.realms.frmDetail",Ext.form.Panel,{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",owner:"",user_id:"",no_tree:false,initComponent:function(){var d=this;var e=[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}];if(d.no_tree){e=[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}d.buttons=e;d.items=[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:d.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:d.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,cls:"lblRd"},{xtype:"fieldset",title:i18n("sOptional_Info"),collapsible:true,border:false,collapsed:true,defaults:{anchor:"100%"},items:[{xtype:"displayfield",fieldLabel:i18n("sContact_detail"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sAddress"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"displayfield",fieldLabel:i18n("sLocation"),labelClsExtra:"lblRdGrouping"},{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",allowBlank:true}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmRealmDetail"],["component","box","container","panel","form","frmRealmDetail"],{component:true,box:true,container:true,panel:true,form:true,frmRealmDetail:true},["widget.frmRealmDetail"],0,[Rd.view.realms,"frmDetail"],0));(Ext.cmd.derive("Rd.view.realms.winRealmAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_realm"),width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,startScreen:"scrnApTree",owner:"",user_id:"",no_tree:false,defaults:{border:false},initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var d=this;var e=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return e},mkScrnRealmDetail:function(){me=this;var b=Ext.create("Rd.view.realms.frmDetail",{itemId:"scrnRealmDetail",user_id:me.user_id,owner:me.owner,no_tree:true});return b},mkScrnData:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"btnDetailPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sRequired_info"),layout:"anchor",itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",fieldLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",checked:false,labelClsExtra:"lblRdReq"}]},{title:i18n("sContact_detail"),layout:"anchor",itemId:"tabContact",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sPhone"),name:"phone",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sFax"),name:"fax",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("sCell"),name:"cell",allowBlank:true,vtype:"Numeric"},{xtype:"textfield",fieldLabel:i18n("s_email"),name:"email",allowBlank:true,vtype:"email"},{xtype:"textfield",fieldLabel:i18n("sURL"),name:"url",allowBlank:true,vtype:"url"}]},{title:i18n("sAddress"),layout:"anchor",itemId:"tabAddress",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"textfield",fieldLabel:i18n("sStreet_Number"),name:"street_no",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sStreet"),name:"street",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sTown_fs_Suburb"),name:"town_suburb",allowBlank:true,margin:15},{xtype:"textfield",fieldLabel:i18n("sCity"),name:"city",allowBlank:true},{xtype:"textfield",fieldLabel:i18n("sCountry"),name:"country",allowBlank:true},{xtype:"numberfield",name:"lon",fieldLabel:i18n("sLongitude"),value:0,maxValue:180,minValue:-180,decimalPrecision:14,labelClsExtra:"lblRd"},{xtype:"numberfield",name:"lat",fieldLabel:i18n("sLatitude"),value:0,maxValue:90,minValue:-90,decimalPrecision:14,labelClsExtra:"lblRd"}]}]}]});return d}},0,["winRealmAddWizard"],["component","box","container","panel","window","winRealmAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winRealmAddWizard:true},["widget.winRealmAddWizard"],0,[Rd.view.realms,"winRealmAddWizard"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealmGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.realm_id,type:"realm"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealmGraphs"],["component","box","container","panel","tabpanel","pnlRealmGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlRealmGraphs:true},["widget.pnlRealmGraphs"],0,[Rd.view.realms,"pnlRealmGraphs"],0));(Ext.cmd.derive("Rd.view.realms.winRealmAdd",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sAdd_realm"),width:300,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,defaults:{border:false},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winRealmAdd"],["component","box","container","panel","window","winRealmAdd"],{component:true,box:true,container:true,panel:true,window:true,winRealmAdd:true},["widget.winRealmAdd"],0,[Rd.view.realms,"winRealmAdd"],0));(Ext.cmd.derive("Rd.view.realms.pnlRealm",Ext.tab.Panel,{border:false,realm_id:null,plain:true,initComponent:function(){var b=this;b.items=[{title:i18n("sDetail"),xtype:"pnlRealmDetail",itemId:"tabDetail"},{title:i18n("sLogo"),itemId:"tabLogo",xtype:"pnlRealmLogo"},{title:i18n("sUsage_graphs"),layout:"fit",xtype:"tabpanel",itemId:"pnlUsageGraphs",margins:"0 0 0 0",plain:true,border:true,tabPosition:"bottom",items:[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.realm_id,type:"realm"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.realm_id,type:"realm"}]}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlRealm"],["component","box","container","panel","tabpanel","pnlRealm"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlRealm:true},["widget.pnlRealm"],0,[Rd.view.realms,"pnlRealm"],0));(Ext.cmd.derive("Rd.controller.cRealms",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabRealms",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridRealms",glyph:Rd.config.icnHome}]});d.populated=true},views:["realms.gridRealms","realms.winRealmAddWizard","realms.winRealmAdd","realms.pnlRealm","components.winCsvColumnSelect","components.winNote","components.winNoteAdd","realms.pnlRealmDetail","realms.pnlRealmLogo","components.pnlUsageGraph","realms.pnlRealmGraphs"],stores:["sRealms","sAccessProvidersTree"],models:["mRealm","mAccessProviderTree","mUserStat"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/realms/add.json",urlEdit:"/cake3/rd_cake/realms/edit.json",urlDelete:"/cake3/rd_cake/realms/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/realms/export-csv",urlNoteAdd:"/cake3/rd_cake/realms/note-add.json",urlViewRealmDetail:"/cake3/rd_cake/realms/view.json",urlLogoBase:"/cake3/rd_cake/img/realms/",urlUploadLogo:"/cake3/rd_cake/realms/upload-logo/"},refs:[{ref:"gridRealms",selector:"gridRealms"},{ref:"gridAdvancedRealms",selector:"gridAdvancedRealms"},{ref:"grid",selector:"gridRealms"}],init:function(){me=this;if(me.inited){return}me.inited=true;me.control({"#tabRealms":{destroy:me.appClose},"gridRealms #reload":{click:me.reload},"gridRealms #add":{click:me.add},"gridRealms #delete":{click:me.del},"gridRealms #edit":{click:me.edit},"gridRealms #note":{click:me.note},"gridRealms #csv":{click:me.csvExport},"gridRealms #logo":{click:me.logo},"gridRealms #graph":{click:me.graph},gridRealms:{itemclick:me.gridClick},"winRealmAddWizard #btnTreeNext":{click:me.btnTreeNext},"winRealmAddWizard #btnRealmDetailPrev":{click:me.btnRealmDetailPrev},"winRealmAddWizard #save":{click:me.addSubmit},"#tabRealms pnlRealmDetail #save":{click:me.editSubmit},"#winCsvColumnSelectRealms #save":{click:me.csvExportSubmit},"gridNote[noteForGrid=realms] #reload":{click:me.noteReload},"gridNote[noteForGrid=realms] #add":{click:me.noteAdd},"gridNote[noteForGrid=realms] #delete":{click:me.noteDelete},"gridNote[noteForGrid=realms]":{itemclick:me.gridNoteClick},"winNoteAdd[noteForGrid=realms] #btnTreeNext":{click:me.btnNoteTreeNext},"winNoteAdd[noteForGrid=realms] #btnNoteAddPrev":{click:me.btnNoteAddPrev},"winNoteAdd[noteForGrid=realms] #btnNoteAddNext":{click:me.btnNoteAddNext},"#tabRealms pnlRealmDetail":{activate:me.tabDetailActivate},"#tabRealms pnlRealmLogo":{activate:me.tabLogoActivate},"#tabRealms pnlRealmLogo #save":{click:me.logoSave},"#tabRealms pnlRealmLogo #cancel":{click:me.logoCancel},"#tabRealms pnlRealmGraphs #daily":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #daily #reload":{click:me.reloadDailyGraph},"#tabRealms pnlRealmGraphs #daily #day":{change:me.changeDailyGraph},"#tabRealms pnlRealmGraphs #weekly":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #weekly #reload":{click:me.reloadWeeklyGraph},"#tabRealms pnlRealmGraphs #weekly #day":{change:me.changeWeeklyGraph},"#tabRealms pnlRealmGraphs #monthly":{activate:me.loadGraph},"#tabRealms pnlRealmGraphs #monthly #reload":{click:me.reloadMonthlyGraph},"#tabRealms pnlRealmGraphs #monthly #day":{change:me.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridClick:function(q,k,m,r,n){var o=this;o.selectedRecord=k;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winApAddWizardId")){var h=Ext.widget("winRealmAddWizard",{id:"winRealmAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winApAddWizardId")){var h=Ext.widget("winRealmAddWizard",{id:"winRealmAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winRealmAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnRealmDetailPrev:function(g){var e=this;var h=g.up("winRealmAddWizard");h.getLayout().setActiveItem("scrnApTree")},addSubmit:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sRealms").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(d,b){var a=i.down("tabpanel");a.setActiveTab(0);Ext.ux.formFail(d,b)}})},del:function(e){var d=this;if(d.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var h=d.getGrid().getSelectionModel().getSelection();var b=[];Ext.Array.forEach(h,function(j){var g=j.getId();Ext.Array.push(b,{id:g})});Ext.Ajax.request({url:d.getUrlDelete(),method:"POST",jsonData:b,success:function(g,j){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);d.reload()},failure:function(g,j){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),g.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);d.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=o.selectedRecord.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlRealmDetail",realm_id:m});n.setActiveTab(l)}},editSubmit:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.getStore("sRealms").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectRealms")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectRealms",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteRealms"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteRealms"+m.getId(),noteForId:m.getId(),noteForGrid:"realms",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteRealmsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteRealmsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteRealmsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteRealmsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},tabDetailActivate:function(h){var j=this;var g=h.down("form");var i=h.realm_id;g.load({url:j.getUrlViewRealmDetail(),method:"GET",params:{realm_id:i}})},logo:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTabLogo_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=o.selectedRecord.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnCamera,xtype:"pnlRealmLogo",realm_id:m});n.setActiveTab(l)}},tabLogoActivate:function(g){var j=this;var i=g.realm_id;var h=g.down("#pnlImg");Ext.Ajax.request({url:j.getUrlViewRealmDetail(),method:"GET",params:{realm_id:i},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=j.getUrlLogoBase()+b.data.icon_file_name;h.update({image:a})}},scope:j})},logoSave:function(n){var l=this;var m=n.up("form");var k=m.up("pnlRealmLogo");var i=m.up("panel");var j=i.down("#pnlImg");m.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:l.getUrlUploadLogo(),params:{id:k.realm_id},success:function(d,b){if(b.result.success){var e=b.result.icon_file_name;var a=l.getUrlLogoBase()+e;j.update({image:a})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},logoCancel:function(g){var h=this;var e=g.up("form");e.getForm().reset()},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="realmTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlRealmGraphs",realm_id:m});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cRealms"],0));(Ext.cmd.derive("Rd.view.schedules.gridSchedules",Ext.grid.Panel,{multiSelect:true,store:"sSchedules",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/schedules/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridSch1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridSch3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSch5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSch6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridSchedules"],["component","box","container","panel","tablepanel","gridpanel","grid","gridSchedules"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridSchedules:true},["widget.gridSchedules"],0,[Rd.view.schedules,"gridSchedules"],0));(Ext.cmd.derive("Rd.model.mSchedule",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mSchedule"],0));(Ext.cmd.derive("Rd.model.mScheduleEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"every_day",type:"bool"},{name:"monday",type:"bool"},{name:"tuesday",type:"bool"},{name:"wednesday",type:"bool"},{name:"thursday",type:"bool"},{name:"friday",type:"bool"},{name:"saturday",type:"bool"},{name:"sunday",type:"bool"},{name:"always",type:"bool"},{name:"start",type:"int"},{name:"stop",type:"int"}]},0,0,0,0,0,0,[Rd.model,"mScheduleEntry"],0));(Ext.cmd.derive("Rd.view.schedules.pnlScheduleDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",schedule_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"Schedule Entries",layout:"fit",xtype:"gridScheduleEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlScheduleDetail"],["component","box","container","panel","tabpanel","pnlScheduleDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlScheduleDetail:true},["widget.pnlScheduleDetail"],0,[Rd.view.schedules,"pnlScheduleDetail"],0));(Ext.cmd.derive("Rd.store.sSchedules",Ext.data.Store,{model:"Rd.model.mSchedule",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sSchedules"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New Schedule",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winScheduleAddWizard"],["component","box","container","panel","window","winScheduleAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winScheduleAddWizard:true},["widget.winScheduleAddWizard"],0,[Rd.view.schedules,"winScheduleAddWizard"],0));(Ext.cmd.derive("Rd.view.schedules.vcScheduleEntry",Ext.app.ViewController,{init:function(){},onSelectedDaysChange:function(i){var l=this;var k=i.getValue();var h=i.up("form");var j=h.down("#chkGrpWeekDays");if(k.selected_days=="every_day"){j.disable()}if(k.selected_days=="specific_days"){j.enable()}},onSelectedTimeChange:function(j){var m=this;var l=j.getValue();var n=j.up("form");var k=n.down("#slideTime");var i=n.down("#cmpTimeDisplay");if(l.time_slot=="always"){k.disable();i.hide(true)}if(l.time_slot=="specific_time"){k.enable();i.show(true)}},onTimeSlideChange:function(t,u,w){var n=this;var s=t.up("form");var m=s.down("#cmpTimeDisplay");var q=n.timeFormat(u);if(w.index==0){var p=m.getData();var r=p.stop_time;m.setData({start_time:q,stop_time:r})}if(w.index==1){var p=m.getData();var o=p.start_time;m.setData({start_time:o,stop_time:q})}},onAfterEditRender:function(z){var y=this;var E=z.down("form");var G=z.record;var s=E.down("#rgDay");var B=E.down("#rgTime");var r=E.down("#chkGrpWeekDays");var A=E.down("multislider");var w=G.get("every_day");if(w){var D={selected_days:"every_day"};s.setValue(D)}else{var D={selected_days:"specific_days"};s.setValue(D);var u=[];var t=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];t.forEach(function(b,e,a){var d=G.get(b);if(d){u.push(b)}});r.setValue({"weekday[]":u})}var C=G.get("always");if(C){var D={time_slot:"always"};B.setValue(D)}else{var D={time_slot:"specific_time"};B.setValue(D);var F=G.get("start");var x=G.get("stop");A.setValue([F,x])}},onTipText:function(g){var h=this;var e=h.timeFormat(g.value);return Ext.String.format("<b>{0}</b>",e)},timeFormat:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,0,0,0,["controller.vcScheduleEntry"],0,[Rd.view.schedules,"vcScheduleEntry"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add Schedule Entry",width:600,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},controller:"vcScheduleEntry",initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:"Every Day",name:"selected_days",inputValue:"every_day",checked:true},{boxLabel:"Selected Days",name:"selected_days",inputValue:"specific_days"}],listeners:{change:"onSelectedDaysChange"}},{xtype:"checkboxgroup",columns:4,vertical:false,itemId:"chkGrpWeekDays",items:[{boxLabel:"Monday",name:"weekday[]",inputValue:"monday",checked:true},{boxLabel:"Tuesday",name:"weekday[]",inputValue:"tuesday",checked:true},{boxLabel:"Wednesday",name:"weekday[]",inputValue:"wednesday",checked:true},{boxLabel:"Thursday",name:"weekday[]",inputValue:"thursday",checked:true},{boxLabel:"Friday",name:"weekday[]",inputValue:"friday",checked:true},{boxLabel:"Saturday",name:"weekday[]",inputValue:"saturday"},{boxLabel:"Sunday",name:"weekday[]",inputValue:"sunday"}],disabled:true},{xtype:"radiogroup",columns:2,vertical:false,items:[{boxLabel:"Always",name:"time_slot",inputValue:"always",checked:true},{boxLabel:"Specific Time Slot",name:"time_slot",inputValue:"specific_time"}],listeners:{change:"onSelectedTimeChange"}},{xtype:"multislider",width:500,itemId:"slideTime",values:[0,1440],increment:5,minValue:0,maxValue:1440,constrainThumbs:true,fieldLabel:"Time Slot",disabled:true,useTips:true,html:"<h1>Gooi Hom</h1>",name:"start_and_stop[]",listeners:{change:"onTimeSlideChange"},tipText:"onTipText"},{xtype:"component",itemId:"cmpTimeDisplay",hidden:true,tpl:'<div class="fieldBlue"><b>Start Time:</b> {start_time} <b>Stop Time:</b> {stop_time}</div>',data:{start_time:"00:00",stop_time:"24:00"}},{itemId:"schedule_id",xtype:"textfield",name:"schedule_id",hidden:true,value:e.schedule_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winScheduleEntryAdd"],["component","box","container","panel","window","winScheduleEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winScheduleEntryAdd:true},["widget.winScheduleEntryAdd"],0,[Rd.view.schedules,"winScheduleEntryAdd"],0));(Ext.cmd.derive("Rd.view.schedules.winScheduleEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit Schedule Entry",width:600,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},controller:"vcScheduleEntry",listeners:{afterrender:"onAfterEditRender"},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"radiogroup",columns:2,vertical:false,itemId:"rgDay",items:[{boxLabel:"Every Day",name:"selected_days",inputValue:"every_day",checked:true},{boxLabel:"Selected Days",name:"selected_days",inputValue:"specific_days"}],listeners:{change:"onSelectedDaysChange"}},{xtype:"checkboxgroup",columns:4,vertical:false,itemId:"chkGrpWeekDays",items:[{boxLabel:"Monday",name:"weekday[]",inputValue:"monday",checked:true},{boxLabel:"Tuesday",name:"weekday[]",inputValue:"tuesday",checked:true},{boxLabel:"Wednesday",name:"weekday[]",inputValue:"wednesday",checked:true},{boxLabel:"Thursday",name:"weekday[]",inputValue:"thursday",checked:true},{boxLabel:"Friday",name:"weekday[]",inputValue:"friday",checked:true},{boxLabel:"Saturday",name:"weekday[]",inputValue:"saturday"},{boxLabel:"Sunday",name:"weekday[]",inputValue:"sunday"}],disabled:true},{xtype:"radiogroup",columns:2,vertical:false,itemId:"rgTime",items:[{boxLabel:"Always",name:"time_slot",inputValue:"always",checked:true},{boxLabel:"Specific Time Slot",name:"time_slot",inputValue:"specific_time"}],listeners:{change:"onSelectedTimeChange"}},{xtype:"multislider",width:500,itemId:"slideTime",values:[0,1440],increment:5,minValue:0,maxValue:1440,constrainThumbs:true,fieldLabel:"Time Slot",disabled:true,useTips:false,name:"start_and_stop[]",listeners:{change:"onTimeSlideChange"}},{xtype:"component",itemId:"cmpTimeDisplay",hidden:true,tpl:'<div class="fieldBlue"><b>Start Time:</b> {start_time} <b>Stop Time:</b> {stop_time}</div>',data:{start_time:"00:00",stop_time:"24:00"}},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winScheduleEntryEdit"],["component","box","container","panel","window","winScheduleEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winScheduleEntryEdit:true},["widget.winScheduleEntryEdit"],0,[Rd.view.schedules,"winScheduleEntryEdit"],0));(Ext.cmd.derive("Rd.view.schedules.gridScheduleEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/schedules/menu-for-schedule-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"SSE1"},{text:"Everyday",dataIndex:"every_day",tdCls:"gridTree",flex:1,stateId:"SSE2",xtype:"templatecolumn",hidden:true,tpl:new Ext.XTemplate("<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='every_day == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>")},{text:"Monday",dataIndex:"monday",tdCls:"gridTree",flex:1,stateId:"SSE3",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='monday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='monday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Tuesday",dataIndex:"tuesday",tdCls:"gridTree",flex:1,stateId:"SSE4",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='tuesday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='tuesday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Wednesday",dataIndex:"wednesday",tdCls:"gridTree",flex:1,stateId:"SSE5",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='wednesday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='wednesday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Thursday",dataIndex:"thursday",tdCls:"gridTree",flex:1,stateId:"SSE6",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='thursday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='thursday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Friday",dataIndex:"friday",tdCls:"gridTree",flex:1,stateId:"SSE7",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='friday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='friday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Saturday",dataIndex:"saturday",tdCls:"gridTree",flex:1,stateId:"SSE8",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='saturday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='saturday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Sunday",dataIndex:"sunday",tdCls:"gridTree",flex:1,stateId:"SSE9",xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='every_day == false'>","<tpl if='sunday == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='sunday == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>","</tpl>","<tpl if='every_day == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>")},{text:"Start",dataIndex:"start",tdCls:"gridTree",flex:1,renderer:function(a,b,i){var j=i.get("always");if(j){return'<div class="fieldGreen"> (ALWAYS) </div>'}else{return'<div class="fieldBlue"> '+d.convertMinutesToTime(a)+"</div>"}},stateId:"SSE10"},{text:"Stop",dataIndex:"stop",tdCls:"gridTree",flex:1,renderer:function(a,b,i){var j=i.get("always");if(j){return'<div class="fieldGreen"> (ALWAYS) </div>'}else{return'<div class="fieldBlue"> '+d.convertMinutesToTime(a)+"</div>"}},stateId:"SSE11"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mScheduleEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index-schedule-entry.json",extraParams:{schedule_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridScheduleEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridScheduleEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridScheduleEntries:true},["widget.gridScheduleEntries"],0,[Rd.view.schedules,"gridScheduleEntries"],0));(Ext.cmd.derive("Rd.controller.cSchedules",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabSchedules",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridSchedules",glyph:Rd.config.icnHome}]});d.populated=true},views:["schedules.gridSchedules","schedules.winScheduleAddWizard","schedules.pnlScheduleDetail","schedules.gridScheduleEntries","schedules.winScheduleEntryAdd","schedules.winScheduleEntryEdit"],stores:["sAccessProvidersTree","sSchedules"],models:["mAccessProviderTree","mSchedule","mScheduleEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/schedules/add.json",urlDelete:"/cake3/rd_cake/schedules/delete.json",urlEdit:"/cake3/rd_cake/schedules/edit.json",urlAddEntry:"/cake3/rd_cake/schedules/add-schedule-entry.json",urlEditEntry:"/cake3/rd_cake/schedules/edit-schedule-entry.json",urlDeleteEntry:"/cake3/rd_cake/schedules/delete-schedule-entry.json"},refs:[{ref:"grid",selector:"gridSchedules"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabSchedules":{destroy:b.appClose},"gridSchedules #reload":{click:b.reload},"gridSchedules #add":{click:b.add},"gridSchedules #delete":{click:b.del},"gridSchedules #edit":{click:b.edit},gridSchedules:{select:b.select},"winScheduleAddWizard #btnTreeNext":{click:b.btnTreeNext},"winScheduleAddWizard #btnDataPrev":{click:b.btnDataPrev},"winScheduleAddWizard #btnDataNext":{click:b.btnDataNext},"winScheduleEdit #save":{click:b.btnEditSave},"pnlScheduleDetail gridScheduleEntries":{activate:b.gridActivate},"#tabSchedules gridSchedules":{activate:b.gridActivate},"pnlScheduleDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridScheduleEntries #reload":{click:b.reloadEntries},"gridScheduleEntries #add":{click:b.addEntry},"gridScheduleEntries #edit":{click:b.editEntry},"gridScheduleEntries #delete":{click:b.deleteEntry},"winScheduleEntryAdd  #save":{click:b.saveScheduleEntryAdd},"winScheduleEntryEdit  #save":{click:b.saveScheduleEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winScheduleAddWizardId")){var h=Ext.widget("winScheduleAddWizard",{id:"winScheduleAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winScheduleAddWizardId")){var h=Ext.widget("winScheduleAddWizard",{id:"winScheduleAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winScheduleAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winScheduleAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sSchedules").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="scheduleTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlScheduleDetail",schedule_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlScheduleDetail").schedule_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winScheduleEntryAdd",{id:"winScheduleEntryAdd"+k,schedule_id:k,store:i});j.show()}},saveScheduleEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winScheduleEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winScheduleEntryEditId")){var j=Ext.widget("winScheduleEntryEdit",{id:"winScheduleEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveScheduleEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winScheduleEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cSchedules"],0));(Ext.cmd.derive("Rd.view.wizard.vcWizardNewSite",Ext.app.ViewController,{config:{urlAdvancedSettingsForModel:"/cake2/rd_cake/meshes/advanced_settings_for_model.json",urlOneSubmit:"/cake2/rd_cake/wizards/new_site_step_one.json",urlTwoSubmit:"/cake2/rd_cake/wizards/new_site_step_two.json",urlViewDynamicDetail:"/cake2/rd_cake/wizards/view_logo.json",urlLogoBase:"/cake3/rd_cake/img/dynamic_details/",urlUploadLogo:"/cake2/rd_cake/wizards/upload_logo/",UrlPnlTwo:"/cake2/rd_cake/wizards/view_country_and_timezone.json",UrlChangeTheme:"/cake2/rd_cake/wizards/change_theme.json",UrlPreviewMobile:"/cake3/rd_cake/dynamic-details/preview-chilli-mobile",UrlPreviewDesktop:"/cake3/rd_cake/dynamic-details/preview-chilli-desktop",infoOne:'            <h2>Step 1 What does the Setup Wizard do?</h2>            <b>Step 1</b> contains the basic information needed to create an account.            When the wizard is complete you can simply add Access Points to your  account and you are good to go!            <p>            <font color="green"><big><b>Signing up a new business or property should take no longer than 5 minutes!</b></big>!</font>            </p>            <p>            <big><b>The wizard creates the following items automatically so you don\u2019t have to. The default values work out of the box but if you require something different you can always edit these items later.</b></big><br>            Let\u2019s assume you sign up a hotel called <big><b>The Hilton</b></big>. Then the following items will be created.            <ul>            <li><b>Operator</b> called <b>the_hilton</b> with password as <b>designated</b></li>            <li><b>Realm</b> called <b>The Hilton</b>.</li>            <li><b>Dynamic RADIUS Client</b> called <b>The Hilton</b>.</li>            <li><b>Dynamic Logn Page</b> called <b>The Hilton</b>.</li>            <li><b>Access Point Profile</b> called <b>The Hilton</b> (APdesk).</li>                <ul>                <li>Open SSID callled <b>The Hilton Guest</b> that has a login page (Captive Portal).</li>                <li>Secure SSID called <b>The Hilton Wireless</b> that is bridged to the LAN.</li>                </ul>            <li><b>Mesh network</b> called <b>The Hilton</b> (MESHdesk).</li>                <ul>                <li>Open SSID callled <b>The Hilton Guest</b> that has a login page (Captive Portal).</li>                <li>Secure SSID called <b>The Hilton Wireless</b> that is bridged to the LAN.</li>                </ul>            <li><b>Permanent User</b> called <b>the_hilton</b> with password as <b>designated</b></li>            <li><b>Permanent User</b> called <b>click_to_connect@the_hilton</b> with password <b>click_to_connect</b>.</li>            </ul>            </p>        ',infoTwo:'            <h2>Step 2 Location and Customer Options</h2>            <big><font color="green"><b>Here specify the location and decide how the customers access your Hotspot.</big></b></font><br>            Select one or more            <p>            <big><b>Vouchers</big></b><br>            Select this option if your require your customers to use an easy to remember voucher.            This option is for situations where customers are not likely to be regulars.            </p>            <p>            <big><b>Permanent Users</big></b><br>            Permanent users will use a username and password combination. Emails can be used as a username.            Permanent users are normally allowed where a customer will regularly use your hotspot.            Permanent user can self register if this option is configured on the login page.            </p>            <p>            <big><b>Click-To-Connect</big></b><br>            Allows customers to connect by just accepting terms and conditions.            </p>        ',infoThree:"            <h2>Step 3 Branding</h2>            <p>            Here you can upload a Logo to brand your account.<br>            A .png or .jpg file with a height of 100px is recommended.<br>            The width can vary from 100px to 200px.            </p>        ",infoFour:'            <h2>Step 4 Login Page Customisation</h2>            <p>            Here you can upload images that will appear on your login page.            We recommend .png or .jpeg format with file sizes of 400Kb or less each.            </p>            <p>            The first image will be the background image on your login page.            </p>            <p>            The first image and subsequent images will also appear in the gallery application which is built into the login page.            </p>            <p>            <big><b><font color="green">When you press Finish the wizard will be complete.            We recommend you follow the simple setup checklist available here to complete your account setup.</font></b></big>            </p>        ',infoFive:'            <h2>Step 5 Select a Theme</h2>            <p>            Here you can upload images that will appear on your login page.            We recommend .png or .jpeg format with file sizes of 400Kb or less each.            </p>            <p>            The first image will be the background image on your login page.            </p>            <p>            The first image and subsequent images will also appear in the gallery application which is built into the login page.            </p>            <p>            <big><b><font color="green">When you press Finish the wizard will be complete.            We recommend you follow the simple setup checklist available here to complete your account setup.</font></b></big>            </p>        ',realmId:undefined,dynamicDetailId:undefined},init:function(){var b=this},onTxtNameChange:function(n){var l=this;var k=n.up("form");var m=k.down("#ssid_guest");var j=k.down("#ssid_wireless");var g=n.getValue().trim();if(g==""){m.setValue("Guest");j.setValue("Wireless")}else{m.setValue(g+" Guest");j.setValue(g+" Wireless")}},onPnlInfoAfterrender:function(d){var e=this;d.setHtml(e.getInfoOne())},onBtnOneNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoTwo());i.setLoading(true);i.submit({clientValidation:true,url:k.getUrlOneSubmit(),success:function(a,d){i.setLoading(false);n.step_one_done=true;Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.setActiveItem(l.getLayout().getNext())},failure:function(){i.setLoading(false);Ext.ux.formFail}})},onBtnCancelClick:function(b){var g=this;var h=b.up("window");h.close()},onBtnTwoNextClick:function(i){var n=this;var s=i.up("#pnlCardNewSite");var b=i.up("window");var r=b.down("#pnlInfo");var q=i.up("form");var t=b.down("#txtName");var w=t.getValue();var u=b.down("#txtPassword");var p=u.getValue();r.setHtml(n.getInfoThree());q.setLoading(true);q.submit({clientValidation:true,url:n.getUrlTwoSubmit(),params:{name:w,password:p},success:function(a,d){q.setLoading(false);Ext.ux.Toaster.msg("User type adjustments made","User type adjustments completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);s.setActiveItem(s.getLayout().getNext())},failure:function(){q.setLoading(false);Ext.ux.formFail}})},pnlTwoActivate:function(e){var d=this;e.load({url:d.getUrlPnlTwo(),method:"GET"})},onBtnThreeNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoFour());l.setActiveItem(l.getLayout().getNext())},pnlThreeActivate:function(m){var l=this;var j=m.up("window");var k=j.down("#txtName");var i=k.getValue();var n=m.down("#pnlImg");Ext.Ajax.request({url:l.getUrlViewDynamicDetail(),method:"GET",params:{name:i},success:function(d){var b=Ext.JSON.decode(d.responseText);if(b.success){var a=l.getUrlLogoBase()+b.data.icon_file_name;n.update({image:a})}},scope:l})},onBtnLogoSaveClick:function(o){var n=this;var r=o.up("form");var t=r.up("pnlDynamicDetail");var p=r.up("panel");var l=p.down("#pnlImg");var m=o.up("window");var q=m.down("#txtName");var s=q.getValue();r.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:n.getUrlUploadLogo(),params:{name:s},success:function(a,e){if(e.result.success){var b=e.result.icon_file_name;var d=n.getUrlLogoBase()+b;l.update({image:d})}Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},pnlFourActivate:function(l){var k=this;var i=l.up("window");var j=i.down("#txtName");var h=j.getValue();l.up("window").down("#dvPhotos").getStore().getProxy().setExtraParam("name",h);l.up("window").down("#dvPhotos").getStore().load()},onBtnPhotoReloadClick:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();b.up("window").down("#dvPhotos").getStore().getProxy().setExtraParam("name",k);b.up("window").down("#dvPhotos").getStore().load()},onBtnPhotoAddClick:function(b){var k=this;var m=b.up("window");var j=m.down("#txtName");var l=j.getValue();var n=b.up("window").down("#dvPhotos");if(!Rd.getApplication().runAction("cDesktop","AlreadyExist","winWizardPhotoAddId")){var m=Ext.widget("winWizardPhotoAdd",{id:"winWizardPhotoAddId",new_name:l,data_view:n});Rd.getApplication().runAction("cDesktop","Add",m)}},onBtnPhotoDeleteClick:function(b){console.log("Delete Click")},onBtnFourNextClick:function(b){var k=this;var l=b.up("#pnlCardNewSite");var n=b.up("window");var m=n.down("#pnlInfo");var i=b.up("form");m.setHtml(k.getInfoFive());l.setActiveItem(l.getLayout().getNext())},onCmbThemesChange:function(l){var m=this;var n=l.getValue();var j=l.up("window");var k=j.down("#txtName");var i=k.getValue();Ext.Ajax.request({url:m.getUrlChangeTheme(),method:"POST",params:{name:i,theme:n},success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){Ext.ux.Toaster.msg("Theme changed","Theme changed fine - Try the Preview",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},scope:m})},previewMobile:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();window.open(j.getUrlPreviewMobile()+"?wizard_name="+k)},previewDesktop:function(b){var j=this;var l=b.up("window");var i=l.down("#txtName");var k=i.getValue();window.open(j.getUrlPreviewDesktop()+"?wizard_name="+k)},onBtnFiveNextClick:function(b){var g=b.up("#pnlCardNewSite");var h=b.up("window");h.step_one_done=false;h.close()}},0,0,0,0,["controller.vcWizardNewSite"],0,[Rd.view.wizard,"vcWizardNewSite"],0));(Ext.cmd.derive("Rd.view.wizard.pnlWizardNewSite",Ext.panel.Panel,{border:false,layout:"border",controller:"vcWizardNewSite",initComponent:function(){var i=this;var h=new Ext.Template(["<div class='divMapAction'>","<img src='{image}' alt='DynamicDetail logo'>","</div>"]);var j=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap">',"<div>",'<img src="{img}" />',"</div>","</div>","</tpl>");i.store=Ext.create(Ext.data.Store,{fields:["id","img"],proxy:{type:"ajax",url:"/cake2/rd_cake/wizards/index_photo.json",format:"json",reader:{keepRawData:true,type:"json",rootProperty:"items"},api:{destroy:"/cake2/rd_cake/wizards/delete_photo.json"}},listeners:{load:function(b,d,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});var g=Ext.create("Ext.view.View",{store:i.store,multiSelect:true,tpl:j,itemId:"dvPhotos",width:450,itemSelector:"div.thumb-wrap",emptyText:i18n("sNo_images_available")});i.items=[{xtype:"panel",layout:"card",region:"center",itemId:"pnlCardNewSite",ui:"light",margin:5,items:[{xtype:"form",itemId:"pnlOne",title:"Step 1 of 5",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"textfield",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The business or property you are signing up"},{name:"name",itemId:"txtName",allowBlank:false,emptyText:"Specify a value to continue",regex:/^[\w\-\s]+$/,regexText:"Only words allowed",listeners:{change:"onTxtNameChange"}},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Password for Operator"},{name:"password",itemId:"txtPassword",allowBlank:false,emptyText:"Specify a value to continue",minLength:5},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The SSID used by guests (open)"},{name:"ssid_guest",itemId:"ssid_guest",value:"Guest",allowBlank:false,maxLength:31,regex:/^[\w\-\s]+$/,regexText:"Only words allowed",emptyText:"Specify a value to continue"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"The SSID used by staff (secure)"},{name:"ssid_wireless",itemId:"ssid_wireless",value:"Wireless",maxLength:31,allowBlank:false,regex:/^[\w\-\s]+$/,regexText:"Only words allowed",emptyText:"Specify a value to continue"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Secure SSID passphrase"},{name:"key_wireless",itemId:"key_wireless",value:"12345678",minLength:8,allowBlank:false,emptyText:"Specify a value to continue"}],buttons:[{itemId:"btnOneNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnOneNextClick"}}]},{xtype:"form",itemId:"pnlTwo",title:"Step 2 of 5",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"checkbox",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},listeners:{activate:"pnlTwoActivate"},items:[{xtype:"cmbCountries",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"cmbTimezones",anchor:"100%",labelClsExtra:"lblRdReq"},{xtype:"label",margin:Rd.config.fieldMargin,cls:"lblRdReq",text:"Select the user types you want to use"},{boxLabel:"Vouchers",name:"voucher_login_check",cls:"lblRd",checked:true},{boxLabel:"Permanent Users",name:"user_login_check",cls:"lblRd",checked:true},{boxLabel:"Click to connect",name:"connect_check",cls:"lblRd",checked:true}],buttons:[{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnTwoNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnTwoNextClick"}}]},{xtype:"panel",frame:true,title:"Step 3 of 5 -> Select Logo",height:"100%",width:450,autoScroll:true,layout:{type:"vbox",align:"stretch"},listeners:{activate:"pnlThreeActivate"},items:[{xtype:"panel",flex:1,border:false,itemId:"pnlImg",tpl:h,data:{img:i.url}},{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sNew_logo"),allowBlank:false,name:"photo",buttonText:"",buttonConfig:{glyph:Rd.config.icnFolder}}],buttons:[{itemId:"btnLogoSave",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin,listeners:{click:"onBtnLogoSaveClick"}},{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnThreeNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,margin:Rd.config.buttonMargin,listeners:{click:"onBtnThreeNextClick"}}]}]},{xtype:"panel",itemId:"pnlFour",title:"Step 4 of 5 -> Upload Images",autoScroll:true,xtype:"panel",frame:false,height:"100%",width:550,layout:{type:"vbox",align:"begin"},listeners:{activate:"pnlFourActivate"},items:g,tbar:[{xtype:"buttongroup",items:[{xtype:"button",glyph:"xf021@FontAwesome",scale:"large",tooltip:"Reload",listeners:{click:"onBtnPhotoReloadClick"}},{xtype:"button",glyph:"xf067@FontAwesome",scale:"large",tooltip:"Add",listeners:{click:"onBtnPhotoAddClick"}},{xtype:"button",glyph:"xf1f8@FontAwesome",scale:"large",tooltip:"Delete",itemId:"photoDelete",listeners:{click:"onBtnPhotoDeleteClick"}}]}],buttons:[{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnFourNext",text:"Next",scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnFourNextClick"}}]},{xtype:"form",itemId:"pnlFive",title:"Step 5 of 5 -> Select a Theme",autoScroll:true,layout:"anchor",defaults:{anchor:"100%"},bodyPadding:10,defaultType:"checkbox",fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,maxWidth:Rd.config.maxWidth},items:[{xtype:"cmbThemes",anchor:"100%",labelClsExtra:"lblRdReq",allowBlank:false,excludeCustom:true,listeners:{change:"onCmbThemesChange"}}],buttons:[{text:"Preview Mobile",scale:"large",glyph:Rd.config.icnMobile,margin:Rd.config.buttonMargin,listeners:{click:"previewMobile"}},{text:"Preview Desktop",scale:"large",glyph:Rd.config.icnDesktop,margin:Rd.config.buttonMargin,listeners:{click:"previewDesktop"}},"->",{text:"Cancel",scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin,listeners:{click:"onBtnCancelClick"}},{itemId:"btnFiveNext",text:"Finish",scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin,listeners:{click:"onBtnFiveNextClick"}}]}]},{xtype:"panel",title:"Info",itemId:"pnlInfo",glyph:Rd.config.icnInfo,autoScroll:true,width:400,margin:5,bodyPadding:10,region:"east",ui:"light",layout:{type:"fit"},collapsible:true,collapsed:false,collapseDirection:"right",listeners:{afterrender:"onPnlInfoAfterrender"}}];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},mkScrnOne:function(){}},0,["pnlWizardNewSite"],["component","box","container","panel","pnlWizardNewSite"],{component:true,box:true,container:true,panel:true,pnlWizardNewSite:true},["widget.pnlWizardNewSite"],0,[Rd.view.wizard,"pnlWizardNewSite"],0));(Ext.cmd.derive("Rd.view.wizard.winWizardPhotoAdd",Ext.window.Window,{title:i18n("sAdd_photo"),layout:"fit",autoShow:false,width:400,height:250,glyph:Rd.config.icnAdd,data_view:undefined,new_name:undefined,items:{xtype:"form",layout:"anchor",autoScroll:true,frame:false,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:Rd.config.fieldMargin,labelWidth:Rd.config.labelWidth},items:[{xtype:"filefield",itemId:"form-file",emptyText:i18n("sSelect_an_image"),fieldLabel:i18n("sPhoto"),allowBlank:false,labelClsExtra:"lblRdReq",name:"photo",buttonText:"",buttonConfig:{glyph:Rd.config.icnFolder}}],buttons:[{itemId:"save",formBind:true,text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin},{itemId:"cancel",text:i18n("sCancel"),scale:"large",glyph:Rd.config.icnClose,margin:Rd.config.buttonMargin}]},initComponent:function(){var b=this;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWizardPhotoAdd"],["component","box","container","panel","window","winWizardPhotoAdd"],{component:true,box:true,container:true,panel:true,window:true,winWizardPhotoAdd:true},["widget.winWizardPhotoAdd"],0,[Rd.view.wizard,"winWizardPhotoAdd"],0));(Ext.cmd.derive("Rd.controller.cSetupWizard",Ext.app.Controller,{actionIndex:function(){var e=this;if(!Ext.WindowManager.get("sSetupWizard")){var d=Ext.widget("window",{id:"sSetupWizard",title:"Setup Wizard",width:Rd.config.winWidth,height:Rd.config.winHeight,glyph:Rd.config.icnWizard,maximizable:true,maximized:true,animCollapse:false,border:false,constrainHeader:true,layout:"fit",items:[{xtype:"pnlWizardNewSite",ui:"light",border:false}]});d.show()}},views:["wizard.pnlWizardNewSite","wizard.winWizardPhotoAdd"],stores:[],models:[],selectedRecord:null,config:{urlCancel:"/cake2/rd_cake/wizards/cancel.json",urlUploadPhoto:"/cake2/rd_cake/wizards/upload_photo/"},refs:[{ref:"grid",selector:"gridSsids"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#sSetupWizard":{beforeclose:b.onBeforeClose},"winWizardPhotoAdd #save":{click:b.onBtnPhotoAddSaveClick},"winWizardPhotoAdd #cancel":{click:b.onBtnPhotoAddCancelClick},"#photoDelete":{click:b.onBtnPhotoDeleteClick}})},onBeforeClose:function(d){var e=this;if(d.step_one_done){if(d.closeMe){d.closeMe=false;return true}Ext.Msg.show({title:"Confirm this action please",msg:"Remove items created in <b>step One</b>?",buttons:Ext.Msg.YESNO,callback:function(b){if("yes"===b){var a=d.down("#txtName");var h=a.getValue();Ext.Ajax.request({url:e.getUrlCancel(),method:"POST",jsonData:{name:h},success:function(g,j){d.closeMe=true;d.close();Ext.ux.Toaster.msg("Clean up complete","Clean up completed fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}})}}});return false}else{return true}},onBtnPhotoAddSaveClick:function(h){var i=this;var j=h.up("form");var g=j.up("window");j.submit({clientValidation:true,waitMsg:"Uploading your photo...",url:i.getUrlUploadPhoto(),params:{name:g.new_name},success:function(b,a){Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.data_view.getStore().load();g.close()},failure:Ext.ux.formFail})},onBtnPhotoAddCancelClick:function(g){var h=this;var e=g.up("form");e.getForm().reset()},onBtnPhotoDeleteClick:function(e){var h=this;var g=e.up("window").down("dataview");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cSetupWizard"],0));(Ext.cmd.derive("Rd.view.ssids.gridSsids",Ext.grid.Panel,{multiSelect:true,store:"sSids",stateful:true,stateId:"StateGridSsids",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/ssids/menu_for_grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridSsids1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridSsids3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridSsids4"},{text:"Extra name",dataIndex:"extra_name",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids5"},{text:"Extra value",dataIndex:"extra_value",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridSsids6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridSsids"],["component","box","container","panel","tablepanel","gridpanel","grid","gridSsids"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridSsids:true},["widget.gridSsids"],0,[Rd.view.ssids,"gridSsids"],0));(Ext.cmd.derive("Rd.model.mSsid",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"extra_name",type:"string"},{name:"extra_value",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mSsid"],0));(Ext.cmd.derive("Rd.view.ssids.winSsidEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit SSID",width:400,height:400,plain:true,border:false,layout:"fit",iconCls:"edit",glyph:Rd.config.icnEdit,autoShow:false,record:"",defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}]});e.items=d;d.loadRecord(e.record);Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winSsidEdit"],["component","box","container","panel","window","winSsidEdit"],{component:true,box:true,container:true,panel:true,window:true,winSsidEdit:true},["widget.winSsidEdit"],0,[Rd.view.ssids,"winSsidEdit"],0));(Ext.cmd.derive("Rd.store.sSids",Ext.data.Store,{model:"Rd.model.mSsid",buffered:true,leadingBufferZone:150,pageSize:50,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/ssids/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake3/rd_cake/ssids/delete.json"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sSids"],0));(Ext.cmd.derive("Rd.view.ssids.winSsidAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New SSID",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Extra name",name:"extra_name",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Extra value",name:"extra_value",allowBlank:true,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winSsidAddWizard"],["component","box","container","panel","window","winSsidAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winSsidAddWizard:true},["widget.winSsidAddWizard"],0,[Rd.view.ssids,"winSsidAddWizard"],0));(Ext.cmd.derive("Rd.controller.cSsids",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridSsids",border:true,itemId:"tabSsids",plain:true});d.populated=true},views:["ssids.gridSsids","ssids.winSsidEdit","ssids.winSsidAddWizard"],stores:["sAccessProvidersTree","sSids"],models:["mAccessProviderTree","mSsid"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/ssids/add.json",urlDelete:"/cake3/rd_cake/ssids/delete.json",urlEdit:"/cake3/rd_cake/ssids/edit.json"},refs:[{ref:"grid",selector:"gridSsids"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabSsids":{destroy:b.appClose},"gridSsids #reload":{click:b.reload},"gridSsids #add":{click:b.add},"gridSsids #delete":{click:b.del},"gridSsids #edit":{click:b.edit},gridSsids:{select:b.select},"winSsidAddWizard #btnTreeNext":{click:b.btnTreeNext},"winSsidAddWizard #btnDataPrev":{click:b.btnDataPrev},"winSsidAddWizard #btnDataNext":{click:b.btnDataNext},"winSsidEdit #save":{click:b.btnEditSave}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winSsidAddWizardId")){var h=Ext.widget("winSsidAddWizard",{id:"winSsidAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winSsidAddWizardId")){var h=Ext.widget("winSsidAddWizard",{id:"winSsidAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winSsidAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winSsidAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sSids").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(l){var j=this;var h=l.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winSsidEditId")){var i=Ext.widget("winSsidEdit",{id:"winSsidEditId",record:k});i.show()}}},btnEditSave:function(h){var j=this;var i=h.up("winSsidEdit");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreSsidsLoaded:function(){var d=this;var e=d.getStore("sSids").getTotalCount();d.getGrid().down("#count").update({count:e})}},0,0,0,0,0,0,[Rd.controller,"cSsids"],0));(Ext.cmd.derive("Rd.controller.cStartup",Ext.app.Controller,{config:{urlCheckToken:"/cake3/rd_cake/dashboard/check_token.json"},actionIndex:function(){var b=this;b.application.setSelLanguage(Rd.config.selLanguage);Ext.Ajax.setExtraParams({sel_language:b.application.getSelLanguage()});b.checkToken()},checkToken:function(){var j=this;var g=Ext.util.Cookies.get("Token");if(g==null){j.application.runAction("cLogin","Index")}else{var h=Ext.getBody().getViewSize().width;var i=false;if(h<1000){i=true}Ext.Ajax.request({url:j.getUrlCheckToken(),params:{token:g,auto_compact:i},method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){j.application.applyVtypes();Ext.Ajax.setExtraParams({token:g,sel_language:j.application.getSelLanguage()});j.application.setDashboardData(a.data);j.application.runAction("cDashboard","Index")}else{j.application.runAction("cLogin","Exit")}}})}}},0,0,0,0,0,0,[Rd.controller,"cStartup"],0));(Ext.cmd.derive("Rd.view.tags.gridTags",Ext.grid.Panel,{multiSelect:true,store:"sTags",stateful:true,stateId:"StateGridTags",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridTags1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridTags2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridTags3"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridTags4"},{text:i18n("sNotes"),sortable:false,width:130,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='notes == true'><span class=\"fa fa-thumb-tack fa-lg txtGreen\"></tpl>"),dataIndex:"notes",stateId:"StateGridTags5"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTags:true},["widget.gridTags"],0,[Rd.view.tags,"gridTags"],0));(Ext.cmd.derive("Rd.view.tags.winTagEdit",Ext.window.Window,{title:i18n("sEdit_tag_for_NAS_device"),layout:"fit",autoShow:false,width:400,height:400,iconCls:"edit",glyph:Rd.config.icnEdit,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",itemId:"scrnDirect",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"hiddenfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sMake_available_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winTagEdit"],["component","box","container","panel","window","winTagEdit"],{component:true,box:true,container:true,panel:true,window:true,winTagEdit:true},["widget.winTagEdit"],0,[Rd.view.tags,"winTagEdit"],0));(Ext.cmd.derive("Rd.view.tags.winTagAddWizard",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:i18n("sNew_tag_for_NAS_devices"),width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRdCheck"}],buttons:g});return h}},0,["winTagAddWizard"],["component","box","container","panel","window","winTagAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winTagAddWizard:true},["widget.winTagAddWizard"],0,[Rd.view.tags,"winTagAddWizard"],0));(Ext.cmd.derive("Rd.controller.cTags",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"gridTags",border:true,itemId:"tabTags",plain:true});d.populated=true},views:["tags.gridTags","tags.winTagAddWizard","tags.winTagEdit","components.winCsvColumnSelect","components.winNote","components.winNoteAdd"],stores:["sTags","sAccessProvidersTree"],models:["mTag","mAccessProviderTree"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/tags/add.json",urlEdit:"/cake3/rd_cake/tags/edit.json",urlDelete:"/cake3/rd_cake/tags/delete.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/tags/export_csv",urlNoteAdd:"/cake3/rd_cake/tags/note_add.json"},refs:[{ref:"grid",selector:"gridTags"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabTags":{destroy:b.appClose},"gridTags #reload":{click:b.reload},"gridTags #add":{click:b.add},"gridTags #delete":{click:b.del},"gridTags #edit":{click:b.edit},"gridTags #note":{click:b.note},"gridTags #csv":{click:b.csvExport},gridTags:{select:b.select},"winTagAddWizard #btnTreeNext":{click:b.btnTreeNext},"winTagAddWizard #btnDataPrev":{click:b.btnDataPrev},"winTagAddWizard #btnDataNext":{click:b.btnDataNext},"winTagEdit #save":{click:b.editSubmit},"#winCsvColumnSelectTags #save":{click:b.csvExportSubmit},"gridNote[noteForGrid=tags] #reload":{click:b.noteReload},"gridNote[noteForGrid=tags] #add":{click:b.noteAdd},"gridNote[noteForGrid=tags] #delete":{click:b.noteDelete},"gridNote[noteForGrid=tags]":{itemclick:b.gridNoteClick},"winNoteAdd[noteForGrid=tags] #btnTreeNext":{click:b.btnNoteTreeNext},"winNoteAdd[noteForGrid=tags] #btnNoteAddPrev":{click:b.btnNoteAddPrev},"winNoteAdd[noteForGrid=tags] #btnNoteAddNext":{click:b.btnNoteAddNext}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winTagAddWizardId")){var h=Ext.widget("winTagAddWizard",{id:"winTagAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winTagAddWizardId")){var h=Ext.widget("winTagAddWizard",{id:"winTagAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winTagAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winTagAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sTags").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(h){var j=this;var k=j.getGrid().getSelectionModel().getCount();if(k==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(k>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(!Ext.WindowManager.get("winTagEditId")){var i=Ext.widget("winTagEdit",{id:"winTagEditId"});i.show();var l=j.getGrid().getSelectionModel().getLastSelected();i.down("form").loadRecord(l)}}}},editSubmit:function(h){var j=this;var i=h.up("window");var g=h.up("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.getStore("sTags").load();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},onStoreTagsLoaded:function(){var d=this;var e=d.getStore("sTags").getTotalCount();d.getGrid().down("#count").update({count:e})},csvExport:function(n,l){var m=this;var i=m.getGrid().columns;var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k[b]=d}});if(!Ext.WindowManager.get("winCsvColumnSelectTags")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectTags",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},note:function(n,k){var l=this;var i=l.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=l.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winNoteTags"+m.getId())){var j=Ext.widget("winNote",{id:"winNoteTags"+m.getId(),noteForId:m.getId(),noteForGrid:"tags",noteForName:m.get("name")});j.show()}}}},noteReload:function(e){var h=this;var g=e.up("gridNote");g.getStore().load()},noteAdd:function(e){var h=this;var g=e.up("gridNote");Ext.Ajax.request({url:h.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winNoteTagsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteTagsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g});d.show()}}else{if(!Ext.WindowManager.get("winNoteTagsAdd"+g.noteForId)){var d=Ext.widget("winNoteAdd",{id:"winNoteTagsAdd"+g.noteForId,noteForId:g.noteForId,noteForGrid:g.noteForGrid,refreshGrid:g,startScreen:"scrnNote",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});d.show()}}}},scope:h})},gridNoteClick:function(i,g){var j=this;grid=i.up("gridNote");tb=grid.down("toolbar[dock=top]");var h=g.get("delete");if(h==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},btnNoteTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winNoteAdd");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnNote")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnNoteAddPrev:function(g){var e=this;var h=g.up("winNoteAdd");h.getLayout().setActiveItem("scrnApTree")},btnNoteAddNext:function(h){var j=this;var i=h.up("winNoteAdd");console.log(i.noteForId);console.log(i.noteForGrid);i.refreshGrid.getStore().load();var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlNoteAdd(),params:{for_id:i.noteForId},success:function(b,a){i.close();i.refreshGrid.getStore().load();j.reload();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},noteDelete:function(e){var h=this;var g=e.up("gridNote");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load();h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cTags"],0));(Ext.cmd.derive("Rd.view.topUps.gridTopUps",Ext.grid.Panel,{multiSelect:true,store:"sTopUps",stateful:true,stateId:"StateGridTopUps",stateEvents:["groupclick","columnhide"],border:true,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/top-ups/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"data",text:"Data"},{id:"time",text:"Time"},{id:"days_to_use",text:"Days To Use"}]});d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridTopUps1"},{text:"Owner",dataIndex:"user",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTopUps2",hidden:true},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'data\'"><div class="fieldGreyWhite"><i class="fa fa-database"></i>  Data</div></tpl>','<tpl if="type==\'days_to_use\'"><div class="fieldPurpleWhite"><i class="fa fa-clock-o"></i>  Days To Use</div></tpl>','<tpl if="type==\'time\'"><div class="fieldBlueWhite"><i class="fa fa-hourglass"></i>  Time</div></tpl>'),stateId:"StateGridTopUps3",filter:{type:"list",store:e}},{text:"Permanent user",dataIndex:"permanent_user",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTopUps4"},{text:"TopUp ID",dataIndex:"id",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"number"},stateId:"StateGridTopUps5"},{text:"Data",dataIndex:"data",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.bytesToHuman(a)},stateId:"StateGridTopUps6"},{text:"Time",dataIndex:"time",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(a){return Ext.ux.secondsToHuman(a)},stateId:"StateGridTopUps7"},{text:"Days to use",dataIndex:"days_to_use",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTopUps8"},{text:"Comment",dataIndex:"comment",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTopUps9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridTopUps10",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},width:200},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridTopUps11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTopUps"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTopUps"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTopUps:true},["widget.gridTopUps"],0,[Rd.view.topUps,"gridTopUps"],0));(Ext.cmd.derive("Rd.view.topUps.gridTopUpTransactions",Ext.grid.Panel,{multiSelect:true,store:"sTopUpTransactions",stateful:true,stateId:"StateGridTut",stateEvents:["groupclick","columnhide"],border:true,padding:10,viewConfig:{loadMask:true},plugins:"gridfilters",initComponent:function(){var e=this;e.bbar=[{xtype:"pagingtoolbar",store:e.store,dock:"bottom",displayInfo:true}];var g=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"data",text:"Data"},{id:"time",text:"Time"},{id:"days_to_use",text:"Days To Use"}]});var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"create",text:"Create"},{id:"update",text:"Update"},{id:"delete",text:"Delete"}]});e.columns=[{xtype:"rownumberer",stateId:"StateGridTut1"},{text:"Owner",dataIndex:"user",tdCls:"gridTree",flex:1,hidden:true,filter:{type:"string"},stateId:"StateGridTut2",hidden:true},{text:i18n("sType"),dataIndex:"type",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="type==\'data\'"><div class="fieldGreyWhite"><i class="fa fa-database"></i>  Data</div></tpl>','<tpl if="type==\'days_to_use\'"><div class="fieldPurpleWhite"><i class="fa fa-clock-o"></i>  Days To Use</div></tpl>','<tpl if="type==\'time\'"><div class="fieldBlueWhite"><i class="fa fa-hourglass"></i>  Time</div></tpl>'),stateId:"StateGridTut3",filter:{type:"list",store:g}},{text:"Permanent user",dataIndex:"permanent_user",tdCls:"gridMain",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut4"},{text:"Action",dataIndex:"action",tdCls:"gridTree",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="action==\'create\'"><div class="fieldGreenWhite"><i class="fa fa-star"></i>  Create</div></tpl>','<tpl if="action==\'update\'"><div class="fieldBlueWhite"><i class="fa fa-pencil"></i> Update</div></tpl>','<tpl if="action==\'delete\'"><div class="fieldRedWhite"><i class="fa fa-trash"></i> Delete</div></tpl>'),stateId:"StateGridTut5",filter:{type:"list",store:h}},{text:"RADIUS Attribute",dataIndex:"radius_attribute",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut6"},{text:"Old Value",dataIndex:"old_value",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut7"},{text:"New Value",dataIndex:"new_value",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"string"},stateId:"StateGridTut8"},{text:"TopUp ID",dataIndex:"top_up_id",tdCls:"gridTree",flex:1,hidden:false,filter:{type:"number"},stateId:"StateGridTut9"},{text:"Created",dataIndex:"created",tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridTut10",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},width:200},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridTut11"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridTopUpTransactions"],["component","box","container","panel","tablepanel","gridpanel","grid","gridTopUpTransactions"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridTopUpTransactions:true},["widget.gridTopUpTransactions"],0,[Rd.view.topUps,"gridTopUpTransactions"],0));(Ext.cmd.derive("Rd.model.mTopUp",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user_id",type:"int"},{name:"user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"data",type:"int"},{name:"time",type:"int"},{name:"days_to_use",type:"int"},{name:"comment",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"type",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTopUp"],0));(Ext.cmd.derive("Rd.model.mTopUpTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user_id",type:"int"},{name:"user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"top_up_id",type:"int"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"created_in_words",type:"string"},{name:"modified_in_words",type:"string"},{name:"type",type:"string"},{name:"radius_attribute",type:"string"},{name:"action",type:"string"},{name:"old_value",type:"string"},{name:"new_value",type:"string"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTopUpTransaction"],0));(Ext.cmd.derive("Rd.view.topUps.winTopUpEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit TopUp",width:500,height:400,plain:true,border:false,layout:"card",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},comment:"",initComponent:function(){var e=this;var d=e.mkScrnData();e.items=[d];Ext.window.Window.prototype.initComponent.apply(this,arguments);e.getLayout().setActiveItem(d)},mkScrnData:function(){var t=this;var r=0;var p=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"mb",name:"MB"},{id:"gb",name:"GB"}]});var i=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:p,queryMode:"local",displayField:"name",valueField:"id",name:"data_unit",itemId:"cmbDataUnit",labelClsExtra:"lblRdReq",hidden:true,disabled:true,allowBlank:false,forceSelection:true});var A=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"minutes",name:"Minutes"},{id:"hours",name:"Hours"},{id:"days",name:"Days"}]});var q=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:A,queryMode:"local",displayField:"name",valueField:"id",name:"time_unit",itemId:"cmbTimeUnit",hidden:true,disabled:true,labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});var w=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"data",name:"Data"},{id:"time",name:"Time"},{id:"days_to_use",name:"Days to use"}]});var s=Ext.create("Ext.form.ComboBox",{fieldLabel:"Type",store:w,queryMode:"local",displayField:"name",valueField:"id",name:"type",itemId:"cmbType",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});if(t.data>0){s.select(s.getStore().getAt(0));var z=-1;fileSizeInBytes=t.data;do{fileSizeInBytes=fileSizeInBytes/1024;z++}while(fileSizeInBytes>=1024);var x=z-1;i.select(i.getStore().getAt(x));r=fileSizeInBytes;i.setVisible(true);i.setDisabled(false)}if(t.time>0){s.select(s.getStore().getAt(1));if(t.time>86400){r=t.time/86400;q.select(q.getStore().getAt(2))}else{if(t.time>3600){r=t.time/3600;q.select(q.getStore().getAt(1))}else{r=t.time/60;q.select(q.getStore().getAt(0))}}q.setVisible(true);q.setDisabled(false)}if(t.days_to_use>0){s.select(s.getStore().getAt(2));r=t.days_to_use}var u=[{itemId:"save",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}];var y=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"textfield",name:"id",itemId:"topUpId",hidden:true},{xtype:"textfield",fieldLabel:"Type",name:"type",itemId:"dispType",editable:false},{xtype:"displayfield",fieldLabel:"Permanet User",name:"permanent_user"},{xtype:"numberfield",name:"value",fieldLabel:"Amount",value:r,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,itemId:"txtAmount"},i,q,{xtype:"textfield",fieldLabel:"Comment",name:"comment",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd",value:t.comment}],buttons:u});return y}},0,["winTopUpEdit"],["component","box","container","panel","window","winTopUpEdit"],{component:true,box:true,container:true,panel:true,window:true,winTopUpEdit:true},["widget.winTopUpEdit"],0,[Rd.view.topUps,"winTopUpEdit"],0));(Ext.cmd.derive("Rd.store.sTopUps",Ext.data.Store,{model:"Rd.model.mTopUp",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/top-ups/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTopUps"],0));(Ext.cmd.derive("Rd.store.sTopUpTransactions",Ext.data.Store,{model:"Rd.model.mTopUpTransaction",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/top-up-transactions/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sTopUpTransactions"],0));(Ext.cmd.derive("Rd.view.topUps.winTopUpAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New TopUp",width:500,height:500,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var q=this;var r=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"data",name:"Data"},{id:"time",name:"Time"},{id:"days_to_use",name:"Days to use"}]});var o=Ext.create("Ext.form.ComboBox",{fieldLabel:"Type",store:r,queryMode:"local",displayField:"name",valueField:"id",name:"type",itemId:"cmbType",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});o.select(o.getStore().getAt(0));var m=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"mb",name:"MB"},{id:"gb",name:"GB"}]});var l=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:m,queryMode:"local",displayField:"name",valueField:"id",name:"data_unit",itemId:"cmbDataUnit",labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});l.select(l.getStore().getAt(0));var t=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"minutes",name:"Minutes"},{id:"hours",name:"Hours"},{id:"days",name:"Days"}]});var n=Ext.create("Ext.form.ComboBox",{fieldLabel:"Unit",store:t,queryMode:"local",displayField:"name",valueField:"id",name:"time_unit",itemId:"cmbTimeUnit",hidden:true,disabled:true,labelClsExtra:"lblRdReq",allowBlank:false,forceSelection:true});n.select(n.getStore().getAt(0));var p=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(q.no_tree==true){var p=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var s=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:q.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:q.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbPermanentUser",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"permanent_user_id",fieldLabel:"Permanent user",name:"permanent_user_id"},o,{xtype:"numberfield",name:"value",fieldLabel:"Amount",value:1,maxValue:1000,minValue:1,labelClsExtra:"lblRdReq",allowBlank:false,itemId:"txtAmount"},l,n,{xtype:"textfield",fieldLabel:"Comment",name:"comment",blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRd"}],buttons:p});return s}},0,["winTopUpAddWizard"],["component","box","container","panel","window","winTopUpAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winTopUpAddWizard:true},["widget.winTopUpAddWizard"],0,[Rd.view.topUps,"winTopUpAddWizard"],0));(Ext.cmd.derive("Rd.controller.cTopUps",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabTopUps",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridTopUps",border:false,plain:true,glyph:Rd.config.icnHome},{title:"Transaction History",xtype:"gridTopUpTransactions",glyph:Rd.config.icnHistory}]});d.populated=true},views:["topUps.gridTopUps","topUps.winTopUpAddWizard","components.cmbPermanentUser","topUps.winTopUpEdit","components.winCsvColumnSelect","topUps.gridTopUpTransactions"],stores:["sTopUps","sAccessProvidersTree","sPermanentUsers","sTopUpTransactions"],models:["mTopUp","mAccessProviderTree","mPermanentUser","mTopUpTransaction"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/top-ups/export_csv",urlAdd:"/cake3/rd_cake/top-ups/add.json",urlExportCsv:"/cake3/rd_cake/top-ups/export_csv",urlDelete:"/cake3/rd_cake/top-ups/delete.json",urlEdit:"/cake3/rd_cake/top-ups/edit.json"},refs:[{ref:"grid",selector:"gridTopUps"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabTopUps":{destroy:b.appClose},"gridTopUps #reload":{click:b.reload},"gridTopUps #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridTopUps #add":{click:b.add},"gridTopUps #edit":{click:b.edit},"gridTopUps #delete":{click:b.del},"gridTopUps #csv":{click:b.csvExport},gridTopUps:{select:b.select},"winTopUpAddWizard #btnTreeNext":{click:b.btnTreeNext},"winTopUpAddWizard #btnDataPrev":{click:b.btnDataPrev},"winTopUpAddWizard #btnDataNext":{click:b.btnDataNext},"winTopUpAddWizard #cmbType":{change:b.cmbTopUpTypeChanged},"#winCsvColumnSelectTopUps #save":{click:b.csvExportSubmit},"winTopUpEdit #dispType":{change:b.editDispTypeChanged},"winTopUpEdit #save":{click:b.btnEditSave},"#tabTopUps gridTopUpTransactions":{activate:b.gridActivate},"#tabTopUps gridTopUps":{activate:b.gridActivate}})},gridActivate:function(d){var e=this;d.getStore().load()},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},select:function(e,g){var h=this},onStoreTopUpsLoaded:function(){var d=this;var e=d.getStore("sTopUps").getTotalCount();d.getGrid().down("#count").update({count:e})},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winTopUpAddWizardId")){var h=Ext.widget("winTopUpAddWizard",{id:"winTopUpAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winTopUpAddWizardId")){var h=Ext.widget("winTopUpAddWizard",{id:"winTopUpAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winTopUpAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#permanent_user_id").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#permanent_user_id").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winTopUpAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sTopUps").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},cmbTopUpTypeChanged:function(l,j){var o=this;var p=l.up("form");var k=p.down("#cmbDataUnit");var m=p.down("#cmbTimeUnit");var n=p.down("#txtAmount");if(j=="data"){k.setVisible(true);k.setDisabled(false);m.setVisible(false);m.setDisabled(true);n.setFieldLabel("Amount")}if(j=="time"){k.setVisible(false);k.setDisabled(true);m.setVisible(true);m.setDisabled(false);n.setFieldLabel("Amount")}if(j=="days_to_use"){k.setVisible(false);k.setDisabled(true);m.setVisible(false);m.setDisabled(true);n.setFieldLabel("Days")}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(h){var j=this;var k=j.getGrid().getSelectionModel().getCount();if(k==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(k>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=j.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winTopUpEditId")){var i=Ext.widget("winTopUpEdit",{id:"winTopUpEditId",record:l});i.down("form").loadRecord(l);i.show()}}}},editDispTypeChanged:function(u,E,G){var w=this;var D=u.up("form");var z=u.up("window");new_value=u.getValue();var r=D.down("#cmbDataUnit");var t=D.down("#cmbTimeUnit");var F=D.down("#txtAmount");if(new_value=="data"){r.setVisible(true);r.setDisabled(false);t.setVisible(false);t.setDisabled(true);F.setFieldLabel("Amount");var A=z.record.get("data");var x=A/(1024*1024*1024);var C=A/(1024*1024);if(x<1){r.setValue("mb");F.setValue(C)}else{r.setValue("gb");F.setValue(x)}}if(new_value=="time"){r.setVisible(false);r.setDisabled(true);t.setVisible(true);t.setDisabled(false);F.setFieldLabel("Amount");var A=z.record.get("time");var y=A/(60);var B=A/(60*60);var s=A/(60*60*24);if(B<1){t.setValue("minutes");F.setValue(y)}if(s<1){t.setValue("hours");F.setValue(B)}else{t.setValue("days");F.setValue(s)}}if(new_value=="days_to_use"){r.setVisible(false);r.setDisabled(true);t.setVisible(false);t.setDisabled(true);F.setFieldLabel("Days");var A=z.record.get("days_to_use");F.setValue(A)}},btnEditSave:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlEdit(),success:function(b,a){i.close();j.reload();Ext.ux.Toaster.msg(i18n("sItem_updated"),i18n("sItem_updated_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectTopUps")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectTopUps",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}}},0,0,0,0,0,0,[Rd.controller,"cTopUps"],0));(Ext.cmd.derive("Rd.view.utilities.pnlUtilities",Ext.panel.Panel,{scrollable:true,border:false,ui:"light",frame:false,config:{urlUtilitiesItems:"/cake2/rd_cake/dashboard/utilities_items.json"},initComponent:function(){var b=this;Ext.Ajax.request({url:b.getUrlUtilitiesItems(),method:"GET",success:function(a){var e=Ext.JSON.decode(a.responseText);if(e.success){b.addDocked({dock:"left",xtype:"toolbar",border:false,frame:false,items:e.data})}}});Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlUtilities"],["component","box","container","panel","pnlUtilities"],{component:true,box:true,container:true,panel:true,pnlUtilities:true},["widget.pnlUtilities"],0,[Rd.view.utilities,"pnlUtilities"],0));(Ext.cmd.derive("Rd.controller.cUtilities",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"pnlUtilities",border:true,itemId:"tabUtilities",plain:true});d.populated=true},views:["utilities.pnlUtilities"],stores:[],models:[],config:{},refs:[{ref:"pnlUtilities",selector:"pnlUtilities"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabUtilities":{destroy:b.appClose},"pnlUtilities #btnRadiusClient":{click:function(a){b.application.runAction("cRadiusClient","Index")}},"pnlUtilities #btnPassword":{click:function(a){b.application.runAction("cPassword","Index")}},"pnlUtilities #btnActivityMonitor":{click:b.openActivityMonitor},"pnlUtilities #btnDataUsage":{click:b.openDataUsage},"pnlUtilities #btnSetupWizard":{click:function(a){b.application.runAction("cSetupWizard","Index")}}})},appClose:function(){var b=this;b.populated=false},openActivityMonitor:function(e){var h=this;var g=h.getPnlUtilities();h.application.runAction("cActivityMonitor","Index",g)},openDataUsage:function(h){var l=this;var i=l.getPnlUtilities();var k=i.up("tabpanel");var j=k.down("#cDataUsage");if(j){k.setActiveTab("cDataUsage");return}k.add({title:"Data Usage",glyph:Rd.config.icnData,id:"cDataUsage",layout:"fit"});k.setActiveTab("cDataUsage");l.application.runAction("cDataUsage","Index",k)}},0,0,0,0,0,0,[Rd.controller,"cUtilities"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVouchers",Ext.grid.Panel,{multiSelect:true,store:"sVouchers",stateful:true,stateId:"StateGridVouchers",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/vouchers/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"new",text:"New"},{id:"used",text:"Used"},{id:"depleted",text:"Depleted"},{id:"expired",text:"Expired"}]});d.columns=[{xtype:"rownumberer",stateId:"StateGridVouchers1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridVouchers2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridVouchers3"},{text:i18n("sPassword"),dataIndex:"password",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers4",hidden:true},{text:i18n("sBatch"),sortable:true,flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if="Ext.isEmpty(batch)"><div class="fieldBlue">'+i18n("s_br_Single_voucher_br")+"</div>",'<tpl else><div class="fieldGrey">',"{batch}","</div></tpl>"),dataIndex:"batch",filter:{type:"string"},stateId:"StateGridVouchers5"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers6"},{text:i18n("sProfile"),dataIndex:"profile",tdCls:"gridTree",flex:1,filter:{type:"string"},sortable:false,stateId:"StateGridVouchers7"},{header:i18n("sData_used"),dataIndex:"perc_data_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(b,a,k){var j=k.get("perc_data_used");a.toggleCls("wifigreen",true);if(j==null){a.setText("")}else{if(j<70){var l="wifigreen";a.toggleCls("wifiyellow",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=70&&j<90){l="wifiyellow";a.toggleCls("wifigreen",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=90){l="wifired";a.toggleCls("wifigreen",false);a.toggleCls("wifiyellow",false);a.toggleCls(l,true)}a.setValue(j/100);a.setText(j+" %")}},stateId:"StateGridVouchers8"},{header:i18n("sTime_used"),dataIndex:"perc_time_used",width:110,xtype:"widgetcolumn",tdCls:"gridTree",widget:{xtype:"progressbarwidget"},onWidgetAttach:function(b,a,k){var j=k.get("perc_time_used");a.toggleCls("wifired",true);if(j==null){a.setText("")}else{if(j<70){var l="wifigreen";a.toggleCls("wifiyellow",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=70&&j<90){l="wifiyellow";a.toggleCls("wifigreen",false);a.toggleCls("wifired",false);a.toggleCls(l,true)}if(j>=90){l="wifired";a.toggleCls("wifigreen",false);a.toggleCls("wifiyellow",false);a.toggleCls(l,true)}a.setValue(j/100);a.setText(j+" %");a.toggleCls(l,true)}},stateId:"StateGridVouchers9"},{text:i18n("sStatus"),flex:1,tdCls:"gridTree",xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'status == "new"\'><div class="fieldGreen">'+i18n("sNew")+"</div></tpl>",'<tpl if=\'status == "used"\'><div class="fieldYellow">'+i18n("sUsed")+"</div></tpl>",'<tpl if=\'status == "depleted"\'><div class="fieldOrange">'+i18n("sDepleted")+"</div></tpl>",'<tpl if=\'status == "expired"\'><div class="fieldRed">'+i18n("sExpired")+"</div></tpl>"),dataIndex:"status",filter:{type:"list",store:e},stateId:"StateGridVouchers10"},{text:i18n("sLast_accept_time"),dataIndex:"last_accept_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_accept_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers11"},{text:i18n("sLast_accept_nas"),flex:1,dataIndex:"last_accept_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers12"},{text:i18n("sLast_reject_time"),dataIndex:"last_reject_time",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{last_reject_time_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers13"},{text:i18n("sLast_reject_nas"),flex:1,dataIndex:"last_reject_nas",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers14"},{text:i18n("sLast_reject_message"),flex:1,dataIndex:"last_reject_message",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers15"},{text:"Extra field name",flex:1,dataIndex:"extra_name",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers16"},{text:"Extra field value",flex:1,dataIndex:"extra_value",tdCls:"gridTree",hidden:true,filter:{type:"string"},stateId:"StateGridVouchers17"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{created_in_words}</div>'),stateId:"StateGridVouchers18",filter:{type:"date",dateFormat:"Y-m-d"},flex:1},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:true,xtype:"templatecolumn",tpl:new Ext.XTemplate('<div class="fieldBlue">{modified_in_words}</div>'),flex:1,filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StateGridVouchers19"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVouchers"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVouchers"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVouchers:true},["widget.gridVouchers"],0,[Rd.view.vouchers,"gridVouchers"],0));(Ext.cmd.derive("Rd.model.mPdfFormat",Ext.data.Model,{fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"active",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPdfFormat"],0));(Ext.cmd.derive("Rd.model.mVoucherDevice",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"mac",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mVoucherDevice"],0));(Ext.cmd.derive("Rd.view.vouchers.pnlVoucher",Ext.tab.Panel,{border:false,v_id:null,v_name:null,record:null,plain:true,cls:"subTab",initComponent:function(){var g=this;var h=new Date();var j=new Date();j.setYear(j.getFullYear()+1);var i=g.record.get("user_id");g.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:150},items:[{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:i},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:i},{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,cls:"lblRd"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:366,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j},{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.ap_id}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",iconCls:"b-save",glyph:Rd.config.icnYes,margin:"0 20 40 0"}]}},{title:i18n("sPrivate_attributes"),layout:"fit",xtype:"gridVoucherPrivate",username:g.v_name},{title:i18n("sDevices"),layout:"fit",xtype:"gridVoucherDevices",username:g.v_name},{title:i18n("sAccounting_data"),layout:"fit",xtype:"gridVoucherRadaccts",username:g.v_name}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlVoucher"],["component","box","container","panel","tabpanel","pnlVoucher"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlVoucher:true},["widget.pnlVoucher"],0,[Rd.view.vouchers,"pnlVoucher"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherEmailDetail",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"e-mail voucher detail",width:400,height:350,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEmail,autoShow:false,voucherId:undefined,paypalId:undefined,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"send",text:i18n("sOK"),scale:"large",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"voucher_id",xtype:"textfield",name:"id",hidden:true,value:e.voucherId},{xtype:"displayfield",fieldLabel:"Voucher",name:"voucher",value:e.voucher_name},{xtype:"textfield",fieldLabel:"e-mail",name:"email",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"email",value:e.email},{xtype:"textareafield",grow:true,name:"message",fieldLabel:"Extra message"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherEmailDetail"],["component","box","container","panel","window","winVoucherEmailDetail"],{component:true,box:true,container:true,panel:true,window:true,winVoucherEmailDetail:true},["widget.winVoucherEmailDetail"],0,[Rd.view.vouchers,"winVoucherEmailDetail"],0));(Ext.cmd.derive("Rd.store.sVouchers",Ext.data.Store,{model:"Rd.model.mVoucher",pageSize:100,remoteSort:true,remoteFilter:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/vouchers/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},listeners:{load:function(l,h,j,i){if(!j){var k=i.getError();Ext.ux.Toaster.msg("Warning",k,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}},autoLoad:false},0,0,0,0,0,0,[Rd.store,"sVouchers"],0));(Ext.cmd.derive("Rd.store.sPdfFormats",Ext.data.Store,{model:"Rd.model.mPdfFormat",proxy:{type:"ajax",format:"json",url:"/cake3/rd_cake/vouchers/pdfVoucherFormats.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sPdfFormats"],0));(Ext.cmd.derive("Rd.view.vouchers.cmbPdfFormats",Ext.form.ComboBox,{fieldLabel:i18n("sOutput_format"),labelSeparator:"",store:"sPdfFormats",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"pdf_format",name:"pdf_format",value:"a4",labelClsExtra:"lblRd"},0,["cmbPdfFormats"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPdfFormats"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPdfFormats:true},["widget.cmbPdfFormats"],0,[Rd.view.vouchers,"cmbPdfFormats"],0));(Ext.cmd.derive("Rd.view.components.vLanguagesCmb",Ext.form.ComboBox,{fieldLabel:i18n("sChoose_a_language"),labelSeparator:"",store:"sLanguages",queryMode:"local",valueField:"id",displayField:"text",typeAhead:true,mode:"local",itemId:"cmbLanguage",listConfig:{getInnerTpl:function(){return'<div data-qtip="{country} : {language}"><div class="combo-wrapper"><div class="combo-country">{country}<img src="{icon_file}" /></div><div class="combo-language"> {language}</div></div></div>'}},initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbLanguage"],["component","box","field","textfield","pickerfield","combobox","combo","cmbLanguage"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbLanguage:true},["widget.cmbLanguage"],0,[Rd.view.components,"vLanguagesCmb"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherPdf",Ext.window.Window,{title:i18n("sGenerate_pdf"),layout:"fit",autoShow:false,width:450,height:350,iconCls:"pdf",glyph:Rd.config.icnPdf,initComponent:function(){var j=this;var g=Ext.create("Ext.data.Store",{fields:["id","name"],data:[{id:"P",name:"Portrait"},{id:"L",name:"Landscape"}]});var h=[{xtype:"cmbPdfFormats",name:"format",labelClsExtra:"lblRdReq",allowBlank:false},{xtype:"cmbLanguages",fieldLabel:i18n("sLanguage"),name:"language",allowBlank:false,labelClsExtra:"lblRdReq",allowBlank:false}];if(j.selecteds==true){Ext.Array.push(h,{xtype:"checkbox",fieldLabel:i18n("sOnly_selected"),name:"selected_only",inputValue:"selected_only",itemId:"selected_only",checked:true,labelClsExtra:"lblRd"})}var i=[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:"Basic",itemId:"tabBasic",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:h},{title:"Advanced",itemId:"tabAdvanced",layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{xtype:"combobox",fieldLabel:"Orientation",store:g,queryMode:"local",displayField:"name",valueField:"id",name:"orientation"},{xtype:"checkbox",fieldLabel:"Include QR code",name:"q_r",inputValue:"q_r",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include date",name:"date",inputValue:"date",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Include T&C",name:"t_and_c",inputValue:"t_and_c",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Social media links",name:"social_media",inputValue:"social_media",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Realm detail",name:"realm_detail",inputValue:"realm_detail",checked:true,labelClsExtra:"lblRd"},{xtype:"checkbox",fieldLabel:"Profile detail",name:"profile_detail",inputValue:"profile_detail",checked:true,labelClsExtra:"lblRd"}]}]}];j.items=[{xtype:"form",border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15,labelWidth:170},defaultType:"textfield",items:i,buttons:[{itemId:"save",text:i18n("sOK"),formBind:true,scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 10 20 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherPdf"],["component","box","container","panel","window","winVoucherPdf"],{component:true,box:true,container:true,panel:true,window:true,winVoucherPdf:true},["widget.winVoucherPdf"],0,[Rd.view.vouchers,"winVoucherPdf"],0));(Ext.cmd.derive("Rd.view.components.pnlAccessProvidersTree",Ext.tree.Panel,{useArrows:true,store:"sAccessProvidersTree",rootVisible:true,rowLines:true,layout:"fit",stripeRows:true,border:false,tbar:[{xtype:"tbtext",text:i18n("sSelect_the_owner"),cls:"lblWizard"}],columns:[{xtype:"treecolumn",text:i18n("sOwner"),sortable:true,flex:1,dataIndex:"username",tdCls:"gridTree"}],buttons:[{itemId:"btnTreeNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,margin:"0 20 40 0"}],listeners:{beforerender:function(b){console.log(" Before render");b.getStore().load()}}},0,["pnlAccessProvidersTree"],["component","box","container","panel","tablepanel","treepanel","pnlAccessProvidersTree"],{component:true,box:true,container:true,panel:true,tablepanel:true,treepanel:true,pnlAccessProvidersTree:true},["widget.pnlAccessProvidersTree"],0,[Rd.view.components,"pnlAccessProvidersTree"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:i18n("sNew_voucher"),width:400,height:470,plain:true,border:false,layout:"card",glyph:Rd.config.icnAdd,autoShow:false,apId:false,singleField:true,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var g=this;var j=new Date();j.setYear(j.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",glyph:Rd.config.icnBack,margin:Rd.config.buttonMargin},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}];if(g.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",glyph:Rd.config.icnNext,formBind:true,margin:Rd.config.buttonMargin}]}var i=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:g.user_id},{itemId:"single_field",xtype:"textfield",name:"single_field",hidden:true,value:g.singleField},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:g.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",name:"precede",fieldLabel:i18n("sPrecede_string"),allowBlank:true,labelClsExtra:"lblRd",hidden:g.singleField,disabled:g.singleField},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:g.apId},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:g.apId},{xtype:"numberfield",name:"quantity",fieldLabel:i18n("sHow_many_qm"),value:1,maxValue:5000,minValue:1,labelClsExtra:"lblRdReq",itemId:"quantity"},{xtype:"textfield",name:"batch",fieldLabel:i18n("sBatch_name"),allowBlank:false,labelClsExtra:"lblRdReq",itemId:"batch",disabled:true,hidden:true},{xtype:"slider",name:"pwd_length",fieldLabel:i18n("sPassword_length"),width:200,value:3,increment:1,minValue:3,maxValue:15,hidden:g.singleField,disabled:g.singleField}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,cls:"lblRd"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:366,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,cls:"lblRd"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j}]},{title:"SSIDs",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:"Connect only from selected SSIDs",name:"ssid_only",inputValue:"ssid_only",itemId:"ssid_only",checked:false,cls:"lblRd"},{xtype:"cmbSsid",labelClsExtra:"lblRdReq",itemId:"ssid_list",hidden:true,disabled:true,extraParam:g.user_id}]},{title:"Extra field",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"}]}]}],buttons:h});return i}},0,["winVoucherAddWizard"],["component","box","container","panel","window","winVoucherAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winVoucherAddWizard:true},["widget.winVoucherAddWizard"],0,[Rd.view.vouchers,"winVoucherAddWizard"],0));(Ext.cmd.derive("Rd.view.vouchers.pnlVoucherGraphs",Ext.tab.Panel,{layout:"fit",margin:"0 0 0 0",plain:true,border:false,tabPosition:"top",cls:"subTab",v_name:undefined,initComponent:function(){var b=this;b.items=[{title:i18n("sDaily"),itemId:"daily",xtype:"pnlUsageGraph",span:"daily",layout:"fit",username:b.v_name,type:"voucher"},{title:i18n("sWeekly"),itemId:"weekly",xtype:"pnlUsageGraph",span:"weekly",layout:"fit",username:b.v_name,type:"voucher"},{title:i18n("sMonthly"),itemId:"monthly",layout:"fit",xtype:"pnlUsageGraph",span:"monthly",username:b.v_name,type:"voucher"}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlVoucherGraphs"],["component","box","container","panel","tabpanel","pnlVoucherGraphs"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlVoucherGraphs:true},["widget.pnlVoucherGraphs"],0,[Rd.view.vouchers,"pnlVoucherGraphs"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherPrivate",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridVoucherPrivate",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",disabled:true,tooltip:i18n("sDelete")}]},{xtype:"buttongroup",title:i18n("sSelection"),items:[{xtype:"cmbVendor",itemId:"cmbVendor",emptyText:i18n("sSelect_a_vendor")},{xtype:"cmbAttribute",itemId:"cmbAttribute",emptyText:i18n("sSelect_an_attribute")},{glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")}]}],username:"nobody",initComponent:function(){var b=this;b.plugins=[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})];b.columns=[{xtype:"rownumberer",stateId:"StateGridVoucherPrivate1"},{header:i18n("sType"),dataIndex:"type",width:130,editor:{xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["check","Check"],["reply","Reply"]],lazyRender:true,listClass:"x-combo-list-small"},renderer:function(a){if(a=="check"){return i18n("sCheck")}else{return i18n("sReply")}},stateId:"StateGridVoucherPrivate2"},{header:i18n("sAttribute"),xtype:"templatecolumn",tdCls:"gridTree",flex:1,stateId:"StateGridVoucherPrivate3",tpl:new Ext.XTemplate('<tpl if=\'edit == true\'><div class="fieldBlue"><i class="fa fa-edit"></i> {attribute}</div></tpl>','<tpl if=\'edit == false\'><div class="fieldGreyWhite"><i class="fa fa-ban"></i> {attribute}</div></tpl>'),dataIndex:"attribute"},{header:i18n("sOperator"),dataIndex:"op",width:100,stateId:"StateGridVoucherPrivate4",editor:{allowBlank:false,xtype:"combobox",typeAhead:true,triggerAction:"all",selectOnTab:true,store:[["=","="],[":=",":="],["+=","+="],["==","=="],["-=","-="],["<=","<="],[">=",">="],["!*","!*"]],lazyRender:true,listClass:"x-combo-list-small"}},{text:i18n("sValue"),dataIndex:"value",flex:1,editor:{xtype:"textfield",allowBlank:false},stateId:"StateGridVoucherPrivate5"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPrivateAttribute",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message"},writer:{writeAllFields:true},api:{create:"/cake3/rd_cake/vouchers/private-attr-add.json",read:"/cake3/rd_cake/vouchers/private-attr-index.json",update:"/cake3/rd_cake/vouchers/private-attr-edit.json",destroy:"/cake3/rd_cake/vouchers/private-attr-delete.json"}},listeners:{update:function(l,m,a,k,n,o){if(a=="edit"){l.sync({success:function(e,d){Ext.ux.Toaster.msg(i18n("sUpdated_item"),i18n("sItem_has_been_updated"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);l.load()},failure:function(e,d){Ext.ux.Toaster.msg(i18n("sProblems_updating_the_item"),i18n("sItem_could_not_be_updated"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);l.load()}})}},scope:this},autoLoad:false,autoSync:false});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherPrivate"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherPrivate"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherPrivate:true},["widget.gridVoucherPrivate"],0,[Rd.view.vouchers,"gridVoucherPrivate"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherRadaccts",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StGVoucherRadaccts",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/vouchers/menu-for-accounting-data.json",plugins:"gridfilters",columns:[{xtype:"rownumberer",stateId:"StGVoucherRadaccts1"},{text:i18n("sAcct_session_id"),dataIndex:"acctsessionid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts2"},{text:i18n("sAcct_unique_id"),dataIndex:"acctuniqueid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts3"},{text:i18n("sGroupname"),dataIndex:"groupname",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts4"},{text:i18n("sRealm"),dataIndex:"realm",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts5"},{text:i18n("sNAS_IP_Address"),dataIndex:"nasipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts6"},{text:i18n("sNAS_Identifier"),dataIndex:"nasidentifier",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts7"},{text:i18n("sNAS_port_id"),dataIndex:"nasportid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts8"},{text:i18n("sNAS_port_type"),dataIndex:"nasporttype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts9"},{text:i18n("sStart_time"),dataIndex:"acctstarttime",tdCls:"gridTree",flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"StGVoucherRadaccts10"},{text:i18n("sStop_time"),dataIndex:"acctstoptime",tdCls:"gridTree",flex:1,filter:{type:"date",dateFormat:"Y-m-d"},renderer:function(i,g,h){if(h.get("active")==true){var j=h.get("online_human");return'<div class="fieldGreen">'+j+" "+i18n("sOnline")+"</div>"}else{return i}},stateId:"StGVoucherRadaccts11"},{text:i18n("sSession_time"),dataIndex:"acctsessiontime",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.secondsToHuman(b)},stateId:"StGVoucherRadaccts12"},{text:i18n("sAccount_authentic"),dataIndex:"acctauthentic",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts13"},{text:i18n("sConnect_info_start"),dataIndex:"connectinfo_start",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts14"},{text:i18n("sConnect_info_stop"),dataIndex:"connectinfo_stop",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts15"},{text:i18n("sData_in"),dataIndex:"acctinputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StGVoucherRadaccts16"},{text:i18n("sData_out"),dataIndex:"acctoutputoctets",tdCls:"gridTree",flex:1,filter:{type:"string"},renderer:function(b){return Ext.ux.bytesToHuman(b)},stateId:"StGVoucherRadaccts17"},{text:i18n("sCalled_station_id"),dataIndex:"calledstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts18"},{text:i18n("sCalling_station_id_MAC"),dataIndex:"callingstationid",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts19"},{text:i18n("sTerminate_cause"),dataIndex:"acctterminatecause",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts20"},{text:i18n("sService_type"),dataIndex:"servicetype",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts21"},{text:i18n("sFramed_protocol"),dataIndex:"framedprotocol",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts22"},{text:i18n("sFramed_ipaddress"),dataIndex:"framedipaddress",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StGVoucherRadaccts23"},{text:i18n("sAcct_start_delay"),dataIndex:"acctstartdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts24"},{text:i18n("sAcct_stop_delay"),dataIndex:"acctstopdelay",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts25"},{text:i18n("sX_Ascend_session_svr_key"),dataIndex:"xascendsessionsvrkey",tdCls:"gridTree",flex:1,filter:{type:"string"},hidden:true,stateId:"StGVoucherRadaccts26"}],username:"nobody",initComponent:function(){var b=this;b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mRadacct",pageSize:100,remoteSort:true,proxy:{type:"ajax",keepRawData:true,format:"json",batchActions:true,url:"/cake2/rd_cake/radaccts/index.json",extraParams:{username:b.username},reader:{keepRawData:true,type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},api:{destroy:"/cake2/rd_cake/radaccts/delete.json"},simpleSortMode:true},listeners:{load:function(n,a,j){if(!j){Ext.ux.Toaster.msg("Error encountered",n.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalIn);var m=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalOut);var k=Ext.ux.bytesToHuman(b.getStore().getProxy().getReader().rawData.totalInOut);b.down("#totals").update({"in":l,out:m,total:k})}},scope:this}});b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true},"->",{xtype:"component",itemId:"totals",tpl:i18n("tpl_In_{in}_Out_{out}_Total_{total}"),style:"margin-right:5px",cls:"lblRd"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherRadaccts"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherRadaccts"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherRadaccts:true},["widget.gridVoucherRadaccts"],0,[Rd.view.vouchers,"gridVoucherRadaccts"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherPassword",Ext.window.Window,{title:i18n("sChange_password"),layout:"fit",autoShow:false,width:350,height:250,iconCls:"rights",glyph:Rd.config.icnLock,initComponent:function(){var b=this;this.items=[{xtype:"form",border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:i18n("sPassword"),allowBlank:false,labelClsExtra:"lblRdReq",name:"password",allowBlank:false}],buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherPassword"],["component","box","container","panel","window","winVoucherPassword"],{component:true,box:true,container:true,panel:true,window:true,winVoucherPassword:true},["widget.winVoucherPassword"],0,[Rd.view.vouchers,"winVoucherPassword"],0));(Ext.cmd.derive("Rd.view.components.winPdf",Ext.window.Window,{title:i18n("sOnline_help"),layout:"fit",autoShow:false,width:600,height:400,iconCls:"pdf",glyph:Rd.config.icnPdf,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true,stateful:true,stateId:"winPdfState",srcUrl:"https://sourceforge.net/p/radiusdesk/wiki/",initComponent:function(){var b=this;b.items=[{xtype:"component",itemId:"ifrm",autoEl:{tag:"iframe",src:b.srcUrl}}];Ext.window.Window.prototype.initComponent.apply(this,arguments)},setSrc:function(d){console.log("change");me=this;var e=me.down("#ifrm");console.log(e);e.getEl().dom.src=d}},0,["winPdf"],["component","box","container","panel","window","winPdf"],{component:true,box:true,container:true,panel:true,window:true,winPdf:true},["widget.winPdf"],0,[Rd.view.components,"winPdf"],0));(Ext.cmd.derive("Rd.view.vouchers.gridVoucherDevices",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"StateGridVoucherDevice",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},plugins:"gridfilters",bbar:[{xtype:"component",itemId:"count",tpl:i18n("sResult_count_{count}"),style:"margin-right:5px",cls:"lblYfi"}],tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"button",glyph:Rd.config.icnAdd,scale:"large",itemId:"add",tooltip:i18n("sAdd")},{xtype:"button",glyph:Rd.config.icnDelete,scale:"large",itemId:"delete",tooltip:i18n("sDelete")}]}],username:"nobody",initComponent:function(){var b=this;b.columns=[{xtype:"rownumberer",stateId:"StateGridVoucherDevice1"},{text:i18n("sMAC_address"),dataIndex:"mac",tdCls:"gridTree",flex:1,stateId:"StateGridVoucherDevice2"}];b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mVoucherDevice",proxy:{type:"ajax",format:"json",batchActions:true,extraParams:{username:b.username},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{create:"/cake2/rd_cake/vouchers/voucher_device_add.json",read:"/cake2/rd_cake/vouchers/voucher_device_index.json",update:"/cake2/rd_cake/vouchers/voucher_device_edit.json",destroy:"/cake2/rd_cake/vouchers/voucher_device_delete.json"}},autoLoad:false});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridVoucherDevices"],["component","box","container","panel","tablepanel","gridpanel","grid","gridVoucherDevices"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridVoucherDevices:true},["widget.gridVoucherDevices"],0,[Rd.view.vouchers,"gridVoucherDevices"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherAddDevice",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New whitelisted device for voucher",width:300,height:250,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,usernamed:"",hidePower:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{itemId:"username",xtype:"textfield",name:"username",hidden:true,value:e.username},{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:"A8-40-41-13-60-E3"}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winVoucherAddDevice"],["component","box","container","panel","window","winVoucherAddDevice"],{component:true,box:true,container:true,panel:true,window:true,winVoucherAddDevice:true},["widget.winVoucherAddDevice"],0,[Rd.view.vouchers,"winVoucherAddDevice"],0));(Ext.cmd.derive("Rd.view.vouchers.winVoucherCsvImport",Ext.window.Window,{closable:true,draggable:true,resizable:false,title:"Add from CSV Import",width:450,height:500,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,apId:false,singleField:true,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var g=this;var j=new Date();j.setYear(j.getFullYear()+1);var h=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(g.no_tree==true){var h=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var i=Ext.create("Ext.form.Panel",{border:false,layout:"fit",itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:150,margin:15},defaultType:"textfield",items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,cls:"subTab",items:[{title:i18n("sBasic_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:g.user_id},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:g.owner,labelClsExtra:"lblRdReq"},{xtype:"cmbRealm",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"realm",extraParam:g.apId},{xtype:"cmbProfile",allowBlank:false,labelClsExtra:"lblRdReq",itemId:"profile",extraParam:g.apId},{xtype:"textfield",name:"batch",fieldLabel:i18n("sBatch_name"),allowBlank:false,labelClsExtra:"lblRdReq",itemId:"batch"},{xtype:"filefield",itemId:"csv_file",emptyText:"Select CSV File..",fieldLabel:"CSV List",allowBlank:false,name:"csv_file",buttonText:"",buttonConfig:{iconCls:"upload-icon",glyph:Rd.config.icnFolder},regex:/^.*\.(csv|CSV)$/,regexText:"Only CSV files allowed",labelClsExtra:"lblRdReq"}]},{title:i18n("sActivate_and_Expire"),layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"checkbox",fieldLabel:i18n("sActivate_upon_first_login"),name:"activate_on_login",inputValue:"activate_on_login",itemId:"activate_on_login",checked:false,boxLabelCls:"lblRdCheck"},{xtype:"numberfield",name:"days_valid",fieldLabel:i18n("sDays_available_after_first_login"),value:0,maxValue:90,minValue:0,itemId:"days_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"hours_valid",fieldLabel:"Hours",labelAlign:"right",value:0,maxValue:23,minValue:0,itemId:"hours_valid",hidden:true,disabled:true},{xtype:"numberfield",name:"minutes_valid",fieldLabel:"Minutes",labelAlign:"right",value:0,maxValue:59,minValue:0,itemId:"minutes_valid",hidden:true,disabled:true},{xtype:"checkbox",fieldLabel:i18n("sNever_expire"),name:"never_expire",inputValue:"never_expire",itemId:"never_expire",checked:true,boxLabelCls:"lblRdCheck"},{xtype:"datefield",fieldLabel:i18n("sExpire"),name:"expire",itemId:"expire",minValue:new Date(),disabled:true,value:j}]},{title:"Extra field",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"extra_name",fieldLabel:"Extra field name",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",name:"extra_value",fieldLabel:"Extra field value",allowBlank:true,labelClsExtra:"lblRd"}]},{title:"e-Mail",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",name:"email_title",fieldLabel:"Title",allowBlank:true},{xtype:"textareafield",grow:true,name:"email_message",allowBlank:true,fieldLabel:"Message"}]}]}],buttons:h});return i}},0,["winVoucherCsvImport"],["component","box","container","panel","window","winVoucherCsvImport"],{component:true,box:true,container:true,panel:true,window:true,winVoucherCsvImport:true},["widget.winVoucherCsvImport"],0,[Rd.view.vouchers,"winVoucherCsvImport"],0));(Ext.cmd.derive("Rd.controller.cVouchers",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabVouchers",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridVouchers",glyph:Rd.config.icnHome}]});d.populated=true},views:["vouchers.gridVouchers","vouchers.winVoucherAddWizard","components.cmbRealm","components.cmbProfile","vouchers.pnlVoucher","vouchers.gridVoucherPrivate","components.cmbVendor","components.cmbAttribute","vouchers.gridVoucherRadaccts","vouchers.winVoucherPassword","components.winPdf","vouchers.winVoucherPdf","vouchers.cmbPdfFormats","components.vCmbLanguages","components.winCsvColumnSelect","components.pnlUsageGraph","vouchers.winVoucherEmailDetail","vouchers.gridVoucherDevices","vouchers.winVoucherAddDevice","components.cmbSsid","vouchers.pnlVoucherGraphs","vouchers.winVoucherCsvImport"],stores:["sVouchers","sAccessProvidersTree","sRealms","sProfiles","sAttributes","sVendors","sPdfFormats","sLanguages"],models:["mAccessProviderTree","mVoucher","mRealm","mProfile","mPrivateAttribute","mRadacct","mPdfFormat","mUserStat","mVoucherDevice"],selectedRecord:null,config:{urlAdd:"/cake3/rd_cake/vouchers/add.json",urlDelete:"/cake3/rd_cake/vouchers/delete.json",urlBulkDelete:"/cake3/rd_cake/vouchers/bulk-delete.json",urlViewBasic:"/cake3/rd_cake/vouchers/view-basic-info.json",urlEditBasic:"/cake3/rd_cake/vouchers/edit_basic_info.json",urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlExportCsv:"/cake3/rd_cake/vouchers/export_csv",urlPdfExportLoad:"/cake3/rd_cake/vouchers/pdf-export-settings.json",urlChangePassword:"/cake3/rd_cake/vouchers/change-password.json",urlPdfBase:"/cake3/rd_cake/vouchers/export-pdf",urlEmailSend:"/cake3/rd_cake/vouchers/email-voucher-details.json",urlAddDevice:"/cake2/rd_cake/vouchers/voucher_device_add.json",urlAddCsv:"/cake2/rd_cake/vouchers/add_csv/",urlDeleteRadaccts:"/cake2/rd_cake/radaccts/delete.json",urlDeletePostAuths:"/cake2/rd_cake/radpostauths/delete.json"},refs:[{ref:"grid",selector:"gridVouchers"},{ref:"privateGrid",selector:"gridVoucherPrivate"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.singleField=true;b.addCsvList=false;b.simpleDel=true;b.control({"#tabDevices":{destroy:b.appClose},"gridVouchers #reload":{click:b.reload},"gridVouchers #reload menuitem[group=refresh]":{click:b.reloadOptionClick},"gridVouchers #add":{click:b.add},"gridVouchers #add menuitem[group=add]":{click:b.addOptionClick},"gridVouchers #delete":{click:b.del},"gridVouchers #delete menuitem[group=delete]":{click:b.delOptionClick},"gridVouchers #edit":{click:b.edit},"gridVouchers #pdf":{click:b.pdfExport},"gridVouchers #csv":{click:b.csvExport},"gridVouchers #password":{click:b.changePassword},"gridVouchers #test_radius":{click:b.testRadius},"gridVouchers #email":{click:b.email},"gridVouchers #graph":{click:b.graph},gridVouchers:{select:b.select,activate:b.gridActivate},"winVoucherEmailDetail #send":{click:b.emailSend},"winVoucherAddWizard #btnTreeNext":{click:b.btnTreeNext},"winVoucherAddWizard #quantity":{change:b.quantityChange},"winVoucherAddWizard #activate_on_login":{change:b.chkActivateOnLoginChange},"winVoucherAddWizard #never_expire":{change:b.chkNeverExpireChange},"winVoucherAddWizard #ssid_only":{change:b.chkSsidOnlyChange},"winVoucherAddWizard #btnDataPrev":{click:b.btnDataPrev},"winVoucherAddWizard #btnDataNext":{click:b.btnDataNext},"winVoucherCsvImport #btnTreeNext":{click:b.btnTreeNext},"winVoucherCsvImport #btnDataPrev":{click:b.btnDataPrev},"winVoucherCsvImport #activate_on_login":{change:b.chkActivateOnLoginChange},"winVoucherCsvImport #never_expire":{change:b.chkNeverExpireChange},"winVoucherCsvImport #btnDataNext":{click:b.btnDataNextCsv},"pnlVoucher #tabBasicInfo":{activate:b.onTabBasicInfoActive},"pnlVoucher #profile":{render:b.renderEventProfile},"pnlVoucher #realm":{render:b.renderEventRealm},"pnlVoucher #activate_on_login":{change:b.chkActivateOnLoginChange},"pnlVoucher #never_expire":{change:b.chkNeverExpireChange},"pnlVoucher #ssid_only":{change:b.chkSsidOnlyChange},"pnlVoucher #tabBasicInfo #save":{click:b.saveBasicInfo},"pnlVoucher gridVoucherPrivate":{select:b.selectVoucherPrivate,activate:b.gridActivate},gridVoucherPrivate:{beforeedit:b.onBeforeEditVoucherPrivate},"gridVoucherPrivate  #cmbVendor":{change:b.cmbVendorChange},"gridVoucherPrivate  #add":{click:b.attrAdd},"gridVoucherPrivate  #reload":{click:b.attrReload},"gridVoucherPrivate  #delete":{click:b.attrDelete},"pnlVoucher gridVoucherDevices":{activate:b.gridActivate},"winVoucherAddDevice #save":{click:b.btnDeviceAddSave},"gridVoucherDevices  #add":{click:b.deviceAdd},"gridVoucherDevices  #reload":{click:b.deviceReload},"gridVoucherDevices  #delete":{click:b.deviceDelete},"#winCsvColumnSelectVouchers #save":{click:b.csvExportSubmit},"pnlVoucher gridVoucherRadaccts #reload":{click:b.gridVoucherRadacctsReload},"pnlVoucher gridVoucherRadaccts #delete":{click:b.deleteRadaccts},"pnlVoucher gridVoucherRadaccts":{activate:b.gridActivate},"winVoucherPassword #save":{click:b.changePasswordSubmit},"winVoucherPdf  #save":{click:b.pdfExportSubmit},winVoucherPdf:{beforeshow:b.frmPdfExportLoad},"#tabVouchers pnlVoucherGraphs #daily":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #daily #reload":{click:b.reloadDailyGraph},"#tabVouchers pnlVoucherGraphs #daily #day":{change:b.changeDailyGraph},"#tabVouchers pnlVoucherGraphs #weekly":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #weekly #reload":{click:b.reloadWeeklyGraph},"#tabVouchers pnlVoucherGraphs #weekly #day":{change:b.changeWeeklyGraph},"#tabVouchers pnlVoucherGraphs #monthly":{activate:b.loadGraph},"#tabVouchers pnlVoucherGraphs #monthly #reload":{click:b.reloadMonthlyGraph},"#tabVouchers pnlVoucherGraphs #monthly #day":{change:b.changeMonthlyGraph}})},appClose:function(){var b=this;b.populated=false;if(b.autoReload!=undefined){clearInterval(b.autoReload)}},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getStore("sVouchers").load()},reloadOptionClick:function(l){var j=this;var i=l.getItemId();var b=l.up("button");var k=30000;clearInterval(j.autoReload);b.setGlyph(Rd.config.icnTime);if(i=="mnuRefreshCancel"){b.setGlyph(Rd.config.icnReload);return}if(i=="mnuRefresh1m"){k=60000}if(i=="mnuRefresh5m"){k=360000}j.autoReload=setInterval(function(){j.reload()},k)},addOptionClick:function(g){var e=this;var h=g.getItemId();if(h=="addSingle"){e.singleField=true}else{e.singleField=false}if(h=="addCsvList"){e.addCsvList=true}else{e.addCsvList=false}},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;if(d.addCsvList){d.addCsvImport()}else{Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winVoucherAddWizardId")){var h=Ext.widget("winVoucherAddWizard",{id:"winVoucherAddWizardId",singleField:d.singleField});h.show()}}else{if(!Ext.WindowManager.get("winVoucherAddWizardId")){var h=Ext.widget("winVoucherAddWizard",{id:"winVoucherAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,apId:"0",singleField:d.singleField});h.show()}}}},scope:d})}},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("window");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.down("#realm").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#realm").getStore().load();j.down("#profile").getStore().getProxy().setExtraParam("ap_id",l.getId());j.down("#profile").getStore().load();j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("window");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sVouchers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},addCsvImport:function(){var b=this;console.log("We need to import from CSV");Ext.Ajax.request({url:b.getUrlApChildCheck(),method:"GET",success:function(h){var g=Ext.JSON.decode(h.responseText);if(g.success){if(g.items.tree==true){if(!Ext.WindowManager.get("winVoucherCsvImportId")){var a=Ext.widget("winVoucherCsvImport",{id:"winVoucherCsvImportId"});a.show()}}else{if(!Ext.WindowManager.get("winVoucherCsvImportId")){var a=Ext.widget("winVoucherCsvImport",{id:"winVoucherCsvImportId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true,apId:"0"});a.show()}}}},scope:b})},btnDataNextCsv:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,waitMsg:"Uploading your CSV File...",url:j.getUrlAddCsv(),success:function(b,a){i.close();j.getStore("sVouchers").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(q,k,m,r,n){var o=this;tb=o.getGrid().down("toolbar[dock=top]");var p=k.get("update");if(p==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false);tb.down("#password").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true);tb.down("#password").setDisabled(true)}}var l=k.get("delete");if(l==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},delOptionClick:function(g){var e=this;var h=g.getItemId();if(h=="deleteSimple"){e.simpleDel=true}if(h=="deleteBulk"){e.simpleDel=false}},delInBulk:function(){var o=this;var s=[];var t=0;var p=false;var m="";var r="This will delete <b>ALL</b> the <b>CURRENT</b> listed items<br><br>Are you <b>VERY</b> sure?";var i=o.getGrid().getStore().getFilters();if(i.count()>0){var q=0;while(t<i.count()){p=true;var n=i.getAt(t).serialize();n.field=n.property;s[t]=n;t=t+1}}if(p){m="?filter="+encodeURIComponent(Ext.JSON.encode(s));r="A <b>FILTER</b> is applied on the grid and the <b>DELETE</b> will be according to this filter.<br><br>Are you <b>VERY</b> sure?"}Ext.MessageBox.confirm(i18n("sConfirm"),r,function(a){if(a=="yes"){console.log("You choose YES");Ext.Ajax.request({url:o.getUrlBulkDelete()+m,method:"POST",success:function(d,b){Ext.ux.Toaster.msg("Bulk delete completed","Bulk delete completed",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);o.reload()},failure:function(d,b){Ext.ux.Toaster.msg("Problems with bulk delete",d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);o.reload()}})}})},del:function(){var b=this;if(b.simpleDel==false){b.delInBulk();return}if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(){var i=this;var h=i.getGrid().getSelectionModel().getCount();if(h==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var g=i.getGrid().getSelectionModel().getSelection();var j=g.length;Ext.each(i.getGrid().getSelectionModel().getSelection(),function(d,n){var a=i.getGrid().up("tabpanel");var o=d.getId();var b="vTab_"+o;var e=a.down("#"+b);if(e){a.setActiveTab(b);return}var p=d.get("name");a.add({title:p,itemId:b,closable:true,iconCls:"edit",glyph:Rd.config.icnEdit,layout:"fit",items:{xtype:"pnlVoucher",v_id:o,v_name:p,record:d}});a.setActiveTab(b)})}},onTabBasicInfoActive:function(h){var i=this;var j=h.down("form");var g=h.up("pnlVoucher").v_id;j.load({url:i.getUrlViewBasic(),method:"GET",params:{voucher_id:g},success:function(b,d){if(d.result.data.ssid_list!=undefined){var a=j.down("#ssid_list");var e=[];a.getStore().loadData([],false);Ext.Array.forEach(d.result.data.ssid_list,function(n){var m=n.id;e.push(m);a.getStore().loadData([n],true)});a.setValue(e)}}})},saveBasicInfo:function(h){var j=this;var i=h.up("form");var g=h.up("pnlVoucher").v_id;i.submit({clientValidation:true,url:j.getUrlEditBasic(),params:{id:g},success:function(b,a){j.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},pdfExport:function(g){var i=this;var j=false;if(i.getGrid().getStore().getCount()==0){Ext.ux.Toaster.msg(i18n("sNothing_to_export"),i18n("sList_is_empty"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);return}if(i.getGrid().getSelectionModel().getCount()>0){j=true}if(!Ext.WindowManager.get("winVoucherPdfId")){var h=Ext.widget("winVoucherPdf",{id:"winVoucherPdfId",selecteds:j});h.show()}},pdfExportSubmit:function(z){var w=this;var G=z.up("form");var y=G.up("window");form_to_string=G.getForm().getValues(true);var D=Ext.util.Cookies.get("Token");var x=form_to_string+"&token="+D+"&";var E=[];var H=0;var A=false;var t="";var i=w.getGrid().getStore().getFilters();if(i.count()>0){var B=0;while(H<i.count()){A=true;var u=i.getAt(H).serialize();u.field=u.property;E[H]=u;H=H+1}}if(A){t="filter="+encodeURIComponent(Ext.JSON.encode(E));x=x+t+"&"}var G=z.up("form");if(G.down("#selected_only")!=undefined){if(G.down("#selected_only").getValue()){var C=[];Ext.each(w.getGrid().getSelectionModel().getSelection(),function(a,d){var b=a.getId();Ext.Array.push(C,b)});if(C.length>0){var F=Ext.encode(C);x=x+"selected="+encodeURIComponent(F)}}}var I=w.getUrlPdfBase()+"?"+x;window.open(I);y.close()},frmPdfExportLoad:function(g){var h=this;var e=g.down("form");e.load({url:h.getUrlPdfExportLoad(),method:"GET"})},csvExport:function(n,l){var m=this;var i=m.getGrid().down("headercontainer").getGridColumns();var k=[];Ext.Array.each(i,function(a,b){if(a.dataIndex!=""){var d={boxLabel:a.text,name:a.dataIndex,checked:true};k.push(d)}});if(!Ext.WindowManager.get("winCsvColumnSelectVouchers")){var j=Ext.widget("winCsvColumnSelect",{id:"winCsvColumnSelectVouchers",columns:k});j.show()}},csvExportSubmit:function(M){var w=this;var I=M.up("window");var K=I.down("form");var x=K.query("checkbox");var J=false;var L=[];var i=0;Ext.Array.each(x,function(a){if(a.getValue()){J=true;L[i]={name:a.getName()};i=i+1}},w);if(!J){Ext.ux.Toaster.msg(i18n("sSelect_one_or_more"),i18n("sSelect_one_or_more_columns_please"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var D=[];var G=0;var A=false;var E="";var y=w.getGrid().getStore().getFilters();if(y.count()>0){var z=0;while(G<y.count()){A=true;var F=y.getAt(G).serialize();F.field=F.property;D[G]=F;G=G+1}}var C="columns="+encodeURIComponent(Ext.JSON.encode(L));var H=Ext.Object.toQueryString(Ext.Ajax.getExtraParams());var B="?"+H+"&"+C;if(A){E="filter="+encodeURIComponent(Ext.JSON.encode(D));B=B+"&"+E}window.open(w.getUrlExportCsv()+B);I.close()}},email:function(n){var k=this;var i=k.getGrid().getSelectionModel().getCount();if(i==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(i>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var m=k.getGrid().getSelectionModel().getLastSelected();var l=m.get("name");if(!Ext.WindowManager.get("winVoucherEmailDetailId"+m.getId())){var j=Ext.widget("winVoucherEmailDetail",{id:"winVoucherEmailDetailId"+m.getId(),voucherId:m.getId(),voucher_name:l});j.show()}}}},emailSend:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.setLoading(true);g.submit({clientValidation:true,url:j.getUrlEmailSend(),success:function(b,a){i.close();Ext.ux.Toaster.msg("Voucher details sent","Voucher details sent fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},quantityChange:function(k){var l=this;var h=k.up("form");var i=h.down("#batch");var j=k.getValue();if(j>1){i.setVisible(true);i.setDisabled(false)}else{i.setVisible(false);i.setDisabled(true)}},chkActivateOnLoginChange:function(p){var m=this;var n=p.up("form");var o=n.down("#days_valid");var j=n.down("#hours_valid");var k=n.down("#minutes_valid");var l=p.getValue();if(l){o.setVisible(true);o.setDisabled(false);j.setVisible(true);j.setDisabled(false);k.setVisible(true);k.setDisabled(false)}else{o.setVisible(false);o.setDisabled(true);j.setVisible(false);j.setDisabled(true);k.setVisible(false);k.setDisabled(true)}},chkNeverExpireChange:function(i){var l=this;var e=i.up("form");var j=e.down("#expire");var k=i.getValue();if(k){j.setDisabled(true)}else{j.setDisabled(false)}},chkSsidOnlyChange:function(i){var l=this;var h=i.up("form");var j=h.down("#ssid_list");var k=i.getValue();if(k){j.setVisible(true);j.setDisabled(false)}else{j.setVisible(false);j.setDisabled(true)}},selectVoucherPrivate:function(o,j,l,p,m){var n=this;tb=n.getPrivateGrid().down("toolbar[dock=top]");var k=j.get("delete");if(k==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},onBeforeEditVoucherPrivate:function(e,h){var g=this;return h.record.get("edit")},cmbVendorChange:function(j){var l=this;var k=j.getValue();var h=j.up("gridVoucherPrivate");var i=h.down("cmbAttribute");i.getStore().getProxy().setExtraParam("vendor",k);i.getStore().load()},attrAdd:function(n){var l=this;var m=n.up("gridVoucherPrivate");var b=m.down("cmbAttribute");var j=b.getValue();if(j==null){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var k=m.getStore().find("attribute",j);if(k==-1){m.getStore().add(Ext.create("Rd.model.mPrivateAttribute",{type:"check",attribute:j,op:":=",value:i18n("sReplace_this_value"),"delete":true,edit:true}));m.getStore().sync()}}},attrReload:function(b){var g=this;var h=b.up("gridVoucherPrivate");h.getStore().load()},attrDelete:function(e){var h=this;var g=e.up("gridVoucherPrivate");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.reload()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},deviceAdd:function(k){var j=this;var l=k.up("pnlVoucher");var h=l.down("gridVoucherDevices").getStore();if(!Ext.WindowManager.get("winVoucherAddDeviceId")){var i=Ext.widget("winVoucherAddDevice",{id:"winVoucherAddDeviceId",store:h,username:l.v_name});i.show()}},btnDeviceAddSave:function(h){var j=this;var i=h.up("winVoucherAddDevice");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAddDevice(),success:function(b,a){i.close();i.store.load();Ext.ux.Toaster.msg(i18n("sItem_added"),i18n("sItem_added_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},deviceReload:function(b){var g=this;var h=b.up("gridVoucherDevices");h.getStore().load()},deviceDelete:function(j){var i=this;var g=j.up("pnlVoucher");var h=g.down("gridVoucherDevices");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){h.getStore().remove(h.getSelectionModel().getSelection());h.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:function(e,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),e.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}},gridVoucherRadacctsReload:function(g){var h=this;var e=g.up("gridVoucherRadaccts");e.getSelectionModel().deselectAll(true);e.getStore().load()},deleteRadaccts:function(e){var h=this;var g=e.up("grid");if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){var d=g.getSelectionModel().getSelection();var b=[];Ext.Array.forEach(d,function(l){var k=l.getId();Ext.Array.push(b,{id:k})});Ext.Ajax.request({url:h.getUrlDeleteRadaccts(),method:"POST",jsonData:b,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getSelectionModel().deselectAll(true);g.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getSelectionModel().deselectAll(true);g.getStore().load()}})}})}},genericDelete:function(e){var h=this;var g=e.up("grid");console.log(g);if(g.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(a){if(a=="yes"){g.getStore().remove(g.getSelectionModel().getSelection());g.getStore().sync({success:function(b,d){Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);g.getStore().load()},failure:function(k,l,b,d){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);g.getStore().load()}})}})}},changePassword:function(){var i=this;var g=i.getGrid().getSelectionModel().getCount();if(g==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{if(g>1){Ext.ux.Toaster.msg(i18n("sLimit_the_selection"),i18n("sSelection_limited_to_one"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=i.getGrid().getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winVoucherPassword"+j.getId())){var h=Ext.widget("winVoucherPassword",{id:"winVoucherPassword"+j.getId(),voucher_id:j.getId(),username:j.get("name"),title:i18n("sChange_password_for")+" "+j.get("name")});h.show()}}}},changePasswordSubmit:function(j){var l=this;var k=j.up("window");var m=k.down("form");var n={};var i=l.getGrid().getSelectionModel().getLastSelected();n.voucher_id=i.getId();m.submit({clientValidation:true,url:l.getUrlChangePassword(),params:n,success:function(b,a){if(a.result.success==false){Ext.ux.Toaster.msg("Problem encountered",a.result.message.message,Ext.ux.Constants.clsError,Ext.ux.Constants.msgError)}else{k.close();l.reload();Ext.ux.Toaster.msg(i18n("sPassword_changed"),i18n("sPassword_changed_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)}},failure:Ext.ux.formFail})},testRadius:function(g){var i=this;var h=g.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_test"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var j=h.getSelectionModel().getLastSelected();i.application.runAction("cRadiusClient","TestVoucher",j)}},renderEventRealm:function(k){var i=this;var m=k.up("pnlVoucher");m.cmbRealmRendered=true;if(m.record!=undefined){var n=m.record.get("realm");var j=m.record.get("realm_id");var l=Ext.create("Rd.model.mRealm",{name:n,id:j});k.getStore().loadData([l],false)}},renderEventProfile:function(k){var i=this;var n=k.up("pnlVoucher");n.cmbProfileRendered=true;if(n.record!=undefined){var j=n.record.get("profile");var l=n.record.get("profile_id");var m=Ext.create("Rd.model.mProfile",{name:j,id:l});k.getStore().loadData([m],false)}},graph:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="voucherTabGraph_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnGraph,xtype:"pnlVoucherGraphs",v_name:k});n.setActiveTab(l)}},loadGraph:function(e){var h=this;e.down("chart").setLoading(true);var g=e.down("#day");e.down("chart").getStore().getProxy().setExtraParam("day",g.getValue());h.reloadChart(e)},reloadDailyGraph:function(e){var d=this;tab=e.up("#daily");d.reloadChart(tab)},changeDailyGraph:function(j,i,d){var k=this;var l=j.up("#daily");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadWeeklyGraph:function(e){var d=this;tab=e.up("#weekly");d.reloadChart(tab)},changeWeeklyGraph:function(j,i,d){var k=this;var l=j.up("#weekly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadMonthlyGraph:function(e){var d=this;tab=e.up("#monthly");d.reloadChart(tab)},changeMonthlyGraph:function(j,i,d){var k=this;var l=j.up("#monthly");l.down("chart").getStore().getProxy().setExtraParam("day",i);k.reloadChart(l)},reloadChart:function(e){var h=this;var g=e.down("chart");g.setLoading(true);g.getStore().load({scope:h,callback:function(o,p,b){g.setLoading(false);if(b){Ext.ux.Toaster.msg("Graph fetched","Graph detail fetched OK",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);var a=g.getStore().getProxy().getReader().rawData;var m=Ext.ux.bytesToHuman(a.totalIn);var n=Ext.ux.bytesToHuman(a.totalOut);var d=Ext.ux.bytesToHuman(a.totalInOut);e.down("#totals").update({"in":m,out:n,total:d})}else{Ext.ux.Toaster.msg("Problem fetching graph","Problem fetching graph detail",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}}})}},0,0,0,0,0,0,[Rd.controller,"cVouchers"],0));(Ext.cmd.derive("Rd.controller.cWelcome",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.setHtml("            <h2>Welcome to this controll panel</h2>            Please start off by creating a new <b>Realm</b>.            ");d.populated=true},init:function(){var b=this;if(b.inited){return}b.inited=true}},0,0,0,0,0,0,[Rd.controller,"cWelcome"],0));(Ext.cmd.derive("Rd.view.whiteLists.gridWhiteLists",Ext.grid.Panel,{multiSelect:true,store:"sWhiteLists",stateful:true,stateId:"StateGridSch",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/white-lists/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var b=this;b.bbar=[{xtype:"pagingtoolbar",store:b.store,dock:"bottom",displayInfo:true}];b.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:b.urlMenu});b.columns=[{xtype:"rownumberer",stateId:"StateGridBl1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridBl3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridBl5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridBl6"}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridWhiteLists"],["component","box","container","panel","tablepanel","gridpanel","grid","gridWhiteLists"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridWhiteLists:true},["widget.gridWhiteLists"],0,[Rd.view.whiteLists,"gridWhiteLists"],0));(Ext.cmd.derive("Rd.model.mWhiteList",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"owner",type:"string"},{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mWhiteList"],0));(Ext.cmd.derive("Rd.model.mWhiteListEntry",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"black_list_id",type:"int"},{name:"domain",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"}]},0,0,0,0,0,0,[Rd.model,"mWhiteListEntry"],0));(Ext.cmd.derive("Rd.view.whiteLists.pnlWhiteListDetail",Ext.tab.Panel,{border:false,record:null,plain:true,cls:"subTab",white_list_id:null,initComponent:function(){var b=this;b.items=[{title:i18n("sBasic_info"),itemId:"tabBasicInfo",layout:"hbox",items:{xtype:"form",height:"100%",width:400,layout:"anchor",autoScroll:true,frame:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},items:[{itemId:"id",xtype:"textfield",name:"id",hidden:true},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description"},{xtype:"textfield",fieldLabel:"Comment",name:"comment"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",cls:"lblRd"}],buttons:[{itemId:"save",text:i18n("sSave"),scale:"large",glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],listeners:{beforerender:function(a){a.loadRecord(b.record)}}}},{title:"White List Entries",layout:"fit",xtype:"gridWhiteListEntries",record:b.record}];Ext.tab.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlWhiteListDetail"],["component","box","container","panel","tabpanel","pnlWhiteListDetail"],{component:true,box:true,container:true,panel:true,tabpanel:true,pnlWhiteListDetail:true},["widget.pnlWhiteListDetail"],0,[Rd.view.whiteLists,"pnlWhiteListDetail"],0));(Ext.cmd.derive("Rd.store.sWhiteLists",Ext.data.Store,{model:"Rd.model.mBlackList",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/white-lists/index.json",reader:{type:"json",rootProperty:"items",messageProperty:"message",totalProperty:"totalCount"},simpleSortMode:true},autoLoad:true},0,0,0,0,0,0,[Rd.store,"sWhiteLists"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListAddWizard",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"New White List",width:400,height:450,plain:true,border:false,layout:"card",iconCls:"add",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},no_tree:false,user_id:"",owner:"",startScreen:"scrnApTree",initComponent:function(){var g=this;var h=g.mkScrnApTree();var e=g.mkScrnData();g.items=[h,e];Ext.window.Window.prototype.initComponent.apply(this,arguments);g.getLayout().setActiveItem(g.startScreen)},mkScrnApTree:function(){var b=Ext.create("Rd.view.components.pnlAccessProvidersTree",{itemId:"scrnApTree"});return b},mkScrnData:function(){var e=this;var g=[{itemId:"btnDataPrev",text:i18n("sPrev"),scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}];if(e.no_tree==true){var g=[{itemId:"btnDataNext",text:i18n("sNext"),scale:"large",iconCls:"b-next",glyph:Rd.config.icnNext,formBind:true,margin:"0 20 40 0"}]}var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",itemId:"scrnData",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",margin:15},defaultType:"textfield",items:[{itemId:"user_id",xtype:"textfield",name:"user_id",hidden:true,value:e.user_id},{xtype:"textfield",name:"id",hidden:true},{itemId:"owner",xtype:"displayfield",fieldLabel:i18n("sOwner"),value:e.owner,labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:"Description",name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:"Comment",name:"comment",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sAlso_show_to_sub_providers"),name:"available_to_siblings",inputValue:"available_to_siblings",itemId:"a_to_s",checked:false,cls:"lblRd"}],buttons:g});return h}},0,["winWhiteListAddWizard"],["component","box","container","panel","window","winWhiteListAddWizard"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListAddWizard:true},["widget.winWhiteListAddWizard"],0,[Rd.view.whiteLists,"winWhiteListAddWizard"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListEntryAdd",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Add White List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAdd,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRd",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:false,labelClsExtra:"lblRdReq"},{itemId:"white_list_id",xtype:"textfield",name:"white_list_id",hidden:true,value:e.white_list_id}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWhiteListEntryAdd"],["component","box","container","panel","window","winWhiteListEntryAdd"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListEntryAdd:true},["widget.winWhiteListEntryAdd"],0,[Rd.view.whiteLists,"winWhiteListEntryAdd"],0));(Ext.cmd.derive("Rd.view.whiteLists.winWhiteListEntryEdit",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Edit White List Entry",width:500,height:200,plain:true,border:false,layout:"fit",glyph:Rd.config.icnEdit,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var g=e.record;var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelClsExtra:"lblRdReq",labelWidth:Rd.config.labelWidth,margin:10},defaultType:"textfield",buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:Rd.config.buttonMargin}],items:[{xtype:"textfield",fieldLabel:"Domain",name:"domain",allowBlank:true,value:g.get("domain")},{itemId:"id",xtype:"textfield",name:"id",hidden:true,value:e.entry_id},{itemId:"white_list_id",xtype:"textfield",name:"white_list_id",hidden:true,value:g.get("white_list_id")}]});e.items=h;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winWhiteListEntryEdit"],["component","box","container","panel","window","winWhiteListEntryEdit"],{component:true,box:true,container:true,panel:true,window:true,winWhiteListEntryEdit:true},["widget.winWhiteListEntryEdit"],0,[Rd.view.whiteLists,"winWhiteListEntryEdit"],0));(Ext.cmd.derive("Rd.view.whiteLists.gridWhiteListEntries",Ext.grid.Panel,{multiSelect:true,stateful:true,stateId:"SSE",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/white-lists/menu-for-white-list-entries.json",initComponent:function(){var d=this;var e=d.record.getId();d.columns=[{xtype:"rownumberer",stateId:"BLE1"},{text:"Domain",dataIndex:"domain",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"BLE2"},{text:"Created",dataIndex:"created",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE3"},{text:"Modified",dataIndex:"modified",tdCls:"gridTree",hidden:false,flex:1,xtype:"datecolumn",format:"Y-m-d H:i:s",filter:{type:"date",dateFormat:"Y-m-d"},stateId:"BLE4"}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.store=Ext.create(Ext.data.Store,{model:"Rd.model.mWhiteListEntry",proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/white-lists/index-white-list-entry.json",extraParams:{white_list_id:e},reader:{type:"json",rootProperty:"items",messageProperty:"message"},simpleSortMode:true},listeners:{load:function(b,h,a){if(!a){Ext.ux.Toaster.msg("Error encountered",b.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this},autoLoad:false});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];Ext.grid.Panel.prototype.initComponent.apply(this,arguments)},convertMinutesToTime:function(j){var h=j%60;var g=(j-h)/60;var i=g.toString()+":"+(h<10?"0":"")+h.toString();return i}},0,["gridWhiteListEntries"],["component","box","container","panel","tablepanel","gridpanel","grid","gridWhiteListEntries"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridWhiteListEntries:true},["widget.gridWhiteListEntries"],0,[Rd.view.whiteLists,"gridWhiteListEntries"],0));(Ext.cmd.derive("Rd.controller.cWhiteLists",Ext.app.Controller,{actionIndex:function(e){var d=this;if(d.populated){return}e.add({xtype:"tabpanel",border:false,itemId:"tabWhiteLists",plain:true,cls:"subSubTab",items:[{title:i18n("sHome"),xtype:"gridWhiteLists",glyph:Rd.config.icnHome}]});d.populated=true},views:["whiteLists.gridWhiteLists","whiteLists.winWhiteListAddWizard","whiteLists.pnlWhiteListDetail","whiteLists.gridWhiteListEntries","whiteLists.winWhiteListEntryAdd","whiteLists.winWhiteListEntryEdit"],stores:["sAccessProvidersTree","sWhiteLists"],models:["mAccessProviderTree","mWhiteList","mWhiteListEntry"],selectedRecord:null,config:{urlApChildCheck:"/cake3/rd_cake/access-providers/child-check.json",urlAdd:"/cake3/rd_cake/white-lists/add.json",urlDelete:"/cake3/rd_cake/white-lists/delete.json",urlEdit:"/cake3/rd_cake/white-lists/edit.json",urlAddEntry:"/cake3/rd_cake/white-lists/add-whitelist-entry.json",urlEditEntry:"/cake3/rd_cake/white-lists/edit-whitelist-entry.json",urlDeleteEntry:"/cake3/rd_cake/white-lists/delete-whitelist-entry.json"},refs:[{ref:"grid",selector:"gridWhiteLists"}],init:function(){var b=this;if(b.inited){return}b.inited=true;b.control({"#tabWhiteLists":{destroy:b.appClose},"gridWhiteLists #reload":{click:b.reload},"gridWhiteLists #add":{click:b.add},"gridWhiteLists #delete":{click:b.del},"gridWhiteLists #edit":{click:b.edit},gridWhiteLists:{select:b.select},"winWhiteListAddWizard #btnTreeNext":{click:b.btnTreeNext},"winWhiteListAddWizard #btnDataPrev":{click:b.btnDataPrev},"winWhiteListAddWizard #btnDataNext":{click:b.btnDataNext},"winWhiteListEdit #save":{click:b.btnEditSave},"pnlWhiteListDetail gridWhiteListEntries":{activate:b.gridActivate},"#tabWhiteLists gridWhiteLists":{activate:b.gridActivate},"pnlWhiteListDetail #tabBasicInfo #save":{click:b.saveBasicInfo},"gridWhiteListEntries #reload":{click:b.reloadEntries},"gridWhiteListEntries #add":{click:b.addEntry},"gridWhiteListEntries #edit":{click:b.editEntry},"gridWhiteListEntries #delete":{click:b.deleteEntry},"winWhiteListEntryAdd  #save":{click:b.saveWhiteListEntryAdd},"winWhiteListEntryEdit  #save":{click:b.saveWhiteListEntryEdit}})},appClose:function(){var b=this;b.populated=false},reload:function(){var b=this;b.getGrid().getSelectionModel().deselectAll(true);b.getGrid().getStore().load()},gridActivate:function(d){var e=this;d.getStore().load()},add:function(e){var d=this;Ext.Ajax.request({url:d.getUrlApChildCheck(),method:"GET",success:function(b){var a=Ext.JSON.decode(b.responseText);if(a.success){if(a.items.tree==true){if(!Ext.WindowManager.get("winWhiteListAddWizardId")){var h=Ext.widget("winWhiteListAddWizard",{id:"winWhiteListAddWizardId"});h.show()}}else{if(!Ext.WindowManager.get("winWhiteListAddWizardId")){var h=Ext.widget("winWhiteListAddWizard",{id:"winWhiteListAddWizardId",startScreen:"scrnData",user_id:"0",owner:i18n("sLogged_in_user"),no_tree:true});h.show()}}}},scope:d})},btnTreeNext:function(h){var k=this;var i=h.up("treepanel");var l=i.getSelectionModel().getLastSelected();if(l){var j=h.up("winWhiteListAddWizard");j.down("#owner").setValue(l.get("username"));j.down("#user_id").setValue(l.getId());j.getLayout().setActiveItem("scrnData")}else{Ext.ux.Toaster.msg(i18n("sSelect_an_owner"),i18n("sFirst_select_an_Access_Provider_who_will_be_the_owner"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},btnDataPrev:function(g){var e=this;var h=g.up("winWhiteListAddWizard");h.getLayout().setActiveItem("scrnApTree")},btnDataNext:function(h){var j=this;var i=h.up("window");var g=i.down("form");g.submit({clientValidation:true,url:j.getUrlAdd(),success:function(b,a){i.close();j.getStore("sWhiteLists").load();Ext.ux.Toaster.msg(i18n("sNew_item_created"),i18n("sItem_created_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},select:function(l,h){var j=this;tb=j.getGrid().down("toolbar[dock=top]");var k=h.get("update");if(k==true){if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(false)}}else{if(tb.down("#edit")!=null){tb.down("#edit").setDisabled(true)}}var i=h.get("delete");if(i==true){if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(false)}}else{if(tb.down("#delete")!=null){tb.down("#delete").setDisabled(true)}}},del:function(){var b=this;if(b.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(g){if(g=="yes"){var a=b.getGrid().getSelectionModel().getSelection();var h=[];Ext.Array.forEach(a,function(e){var d=e.getId();Ext.Array.push(h,{id:d})});Ext.Ajax.request({url:b.getUrlDelete(),method:"POST",jsonData:h,success:function(d,e){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);b.reload()},failure:function(d,e){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),d.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);b.reload()}})}})}},edit:function(q){var o=this;if(o.getGrid().getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var n=o.getGrid().up("tabpanel");var p=o.getGrid().getSelectionModel().getLastSelected();var m=p.getId();var l="whiteListTab_"+m;var r=n.down("#"+l);if(r){n.setActiveTab(l);return}var k=p.get("name");n.add({title:k,itemId:l,closable:true,glyph:Rd.config.icnEdit,xtype:"pnlWhiteListDetail",white_list_id:m,record:p});n.setActiveTab(l)}},saveBasicInfo:function(g){var h=this;var e=g.up("form");e.submit({clientValidation:true,url:h.getUrlEdit(),success:function(b,a){h.reload();Ext.ux.Toaster.msg(i18n("sItems_modified"),i18n("sItems_modified_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo)},failure:Ext.ux.formFail})},reloadEntries:function(b){var e=this;b.up("grid").getSelectionModel().deselectAll(true);b.up("grid").getStore().load()},addEntry:function(m){var l=this;var k=m.up("pnlWhiteListDetail").white_list_id;var n=m.up("grid");var i=n.getStore();if(!Ext.WindowManager.get("winSheduleEntryAdd"+k)){var j=Ext.widget("winWhiteListEntryAdd",{id:"winWhiteListEntryAdd"+k,white_list_id:k,store:i});j.show()}},saveWhiteListEntryAdd:function(h){var j=this;var g=h.up("form");var i=h.up("winWhiteListEntryAdd");g.submit({clientValidation:true,url:j.getUrlAddEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item added Fine","Item added Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},editEntry:function(m){var k=this;var n=m.up("grid");var i=n.getStore();if(n.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_edit"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{var l=n.getSelectionModel().getLastSelected();if(!Ext.WindowManager.get("winWhiteListEntryEditId")){var j=Ext.widget("winWhiteListEntryEdit",{id:"winWhiteListEntryEditId",record:l,entry_id:l.getId(),store:i});j.show()}}},saveWhiteListEntryEdit:function(h){var j=this;var g=h.up("form");var i=h.up("winWhiteListEntryEdit");g.submit({clientValidation:true,url:j.getUrlEditEntry(),success:function(b,a){Ext.ux.Toaster.msg("Item updated Fine","Item updated Fine",Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);i.store.load();i.close()},failure:Ext.ux.formFail})},deleteEntry:function(b){var g=this;var h=b.up("grid");if(h.getSelectionModel().getCount()==0){Ext.ux.Toaster.msg(i18n("sSelect_an_item"),i18n("sFirst_select_an_item_to_delete"),Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}else{Ext.MessageBox.confirm(i18n("sConfirm"),i18n("sAre_you_sure_you_want_to_do_that_qm"),function(d){if(d=="yes"){var a=h.getSelectionModel().getSelection();var e=[];Ext.Array.forEach(a,function(l){var k=l.getId();Ext.Array.push(e,{id:k})});Ext.Ajax.request({url:g.getUrlDeleteEntry(),method:"POST",jsonData:e,success:function(k,l){console.log("success");Ext.ux.Toaster.msg(i18n("sItem_deleted"),i18n("sItem_deleted_fine"),Ext.ux.Constants.clsInfo,Ext.ux.Constants.msgInfo);h.getStore().load()},failure:function(k,l){Ext.ux.Toaster.msg(i18n("sProblems_deleting_item"),k.proxy.getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);h.getStore().load()}})}})}}},0,0,0,0,0,0,[Rd.controller,"cWhiteLists"],0));(Ext.cmd.derive("Rd.model.mAutoSetup",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"owner",type:"string"},{name:"name",type:"string"},{name:"dns_name",type:"string"},{name:"ip_address",type:"string"},{name:"ip_mask",type:"string"},{name:"ip_gateway",type:"string"},{name:"ip_dns_1",type:"string"},{name:"ip_dns_2",type:"string"},{name:"wifi_active",type:"bool"},{name:"channel",type:"int"},{name:"power",type:"int"},{name:"distance",type:"int"},{name:"ssid_secure",type:"string"},{name:"radius",type:"string"},{name:"secret",type:"string"},{name:"ssid_open",type:"string"},{name:"eduroam",type:"bool"},{name:"vpn_server",type:"string"},{name:"tunnel_ip",type:"string"},{name:"contact_ip",type:"string"},{name:"last_contact",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mAutoSetup"],0));(Ext.cmd.derive("Rd.model.mFinAuthorizeNetTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"description",type:"string"},{name:"x_response_code",type:"int"},{name:"x_response_subcode",type:"int"},{name:"x_response_reason_code",type:"int"},{name:"x_response_reason_text",type:"string"},{name:"x_auth_code",type:"string"},{name:"x_avs_code",type:"string"},{name:"x_trans_id",type:"string"},{name:"x_auth_code",type:"string"},{name:"x_method",type:"string"},{name:"x_card_type",type:"string"},{name:"x_account_number",type:"string"},{name:"x_first_name",type:"string"},{name:"x_last_name",type:"string"},{name:"x_company",type:"string"},{name:"x_address",type:"string"},{name:"x_city",type:"string"},{name:"x_state",type:"string"},{name:"x_zip",type:"string"},{name:"x_country",type:"string"},{name:"x_phone",type:"string"},{name:"x_fax",type:"string"},{name:"x_email",type:"string"},{name:"x_amount",type:"string"},{name:"x_catalog_link_id",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"tag",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinAuthorizeNetTransaction"],0));(Ext.cmd.derive("Rd.model.mFinMyGateToken",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"permanent_user",type:"string"},{name:"permanent_user_id",type:"int"},{name:"fin_payment_plan",type:"string"},{name:"fin_payment_plan_id",type:"int"},{name:"client_pin",type:"string"},{name:"client_uci",type:"string"},{name:"client_uid",type:"string"},{name:"override",type:"string"},{name:"override_completed",type:"bool"},{name:"active",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinMyGateToken"],0));(Ext.cmd.derive("Rd.model.mFinMyGateTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"fin_my_gate_token",type:"string"},{name:"fin_my_gate_token_id",type:"int"},{name:"permanent_user",type:"string"},{name:"status",type:"string"},{name:"type",type:"string"},{name:"my_gate_reference",type:"string"},{name:"message",type:"string"},{name:"amount",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinMyGateTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPayUTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"merchantReference",type:"string"},{name:"payUReference",type:"string"},{name:"TransactionType",type:"string"},{name:"TransactionState",type:"string"},{name:"ResultCode",type:"string"},{name:"ResultMessage",type:"string"},{name:"DisplayMessage",type:"string"},{name:"merchUserId",type:"string"},{name:"firstName",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"mobile",type:"string"},{name:"regionalId",type:"string"},{name:"amountInCents",type:"int"},{name:"currencyCode",type:"string"},{name:"description",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPayUTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPaymentPlan",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"profile",type:"string"},{name:"profile_id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"currency_code",type:"string"},{name:"value",type:"string"},{name:"tax",type:"string"},{name:"active",type:"bool"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPaymentPlan"],0));(Ext.cmd.derive("Rd.model.mFinPaypalTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"business",type:"string"},{name:"option_name1",type:"string"},{name:"option_selection1",type:"string"},{name:"item_name",type:"string"},{name:"item_number",type:"string"},{name:"first_name",type:"string"},{name:"last_name",type:"string"},{name:"payer_email",type:"string"},{name:"payer_id",type:"string"},{name:"payer_status",type:"string"},{name:"payment_gross",type:"string"},{name:"mc_gross",type:"string"},{name:"mc_fee",type:"string"},{name:"mc_currency",type:"string"},{name:"payment_date",type:"string"},{name:"payment_status",type:"string"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPaypalTransaction"],0));(Ext.cmd.derive("Rd.model.mFinPremiumSmsTransaction",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"txn_id",type:"string"},{name:"user",type:"string"},{name:"user_id",type:"int"},{name:"voucher_name",type:"string"},{name:"voucher_id",type:"int"},{name:"top_up_id",type:"int"},{name:"mobile",type:"string"},{name:"description",type:"string"},{name:"created",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"modified",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mFinPremiumSmsTransaction"],0));(Ext.cmd.derive("Rd.model.mPolicyTagSelection",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"comment",type:"string"},{name:"protection_level",type:"string"},{name:"selected",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mPolicyTagSelection"],0));(Ext.cmd.derive("Rd.model.mRealms",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"creator",type:"string"},"phone","fax","cell","email","url","street_no","street","town_suburb","city","country","lat","lon",{name:"available_to_siblings",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mRealms"],0));(Ext.cmd.derive("Rd.model.mTemplate",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"name",type:"string"},{name:"owner",type:"string"},{name:"check_attribute_count",type:"int"},{name:"reply_attribute_count",type:"int"},{name:"available_to_siblings",type:"bool"},{name:"notes",type:"bool"},{name:"update",type:"bool"},{name:"delete",type:"bool"}]},0,0,0,0,0,0,[Rd.model,"mTemplate"],0));(Ext.cmd.derive("Rd.model.mTemplateEdit",Ext.data.Model,{fields:[{name:"id",type:"int"},{name:"attribute",type:"string"},{name:"type",type:"string"},{name:"tooltip",type:"string"},{name:"unit",type:"string"}]},0,0,0,0,0,0,[Rd.model,"mTemplateEdit"],0));(Ext.cmd.derive("Rd.model.mWallpaper",Ext.data.Model,{fields:["id","file","r_dir","img"]},0,0,0,0,0,0,[Rd.model,"mWallpaper"],0));(Ext.cmd.derive("Rd.view.accessProviders.winDetail",Ext.window.Window,{title:i18n("sNew_Access_Provider"),layout:"fit",autoShow:true,width:400,height:500,resizable:false,iconCls:"add",glyph:Rd.config.icnAdd,parent_name:"",parent_id:"",initComponent:function(){var b=this;b.items=[{xtype:"frmAccessProviderDetail",pwdHidden:false,parent_id:this.parent_id,parent_name:this.parent_name}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winAccessProviderDetail"],["component","box","container","panel","window","winAccessProviderDetail"],{component:true,box:true,container:true,panel:true,window:true,winAccessProviderDetail:true},["widget.winAccessProviderDetail"],0,[Rd.view.accessProviders,"winDetail"],0));(Ext.cmd.derive("Rd.view.aps.pnlAccessPointDetail",Ext.panel.Panel,{border:false,plain:true,title:"More Info",collapsible:true,collapsed:true,width:300,layout:"fit",initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},items:[{layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:false,items:[{title:"Connected",html:"bla"},{title:"Device health",html:"Nee"}]}]},0,["pnlAccessPointDetail"],["component","box","container","panel","pnlAccessPointDetail"],{component:true,box:true,container:true,panel:true,pnlAccessPointDetail:true},["widget.pnlAccessPointDetail"],0,[Rd.view.aps,"pnlAccessPointDetail"],0));(Ext.cmd.derive("Rd.view.aps.winApAttachAp",Ext.window.Window,{closable:true,draggable:true,resizable:true,title:"Attach Device to Profile",width:400,height:450,plain:true,border:false,layout:"fit",glyph:Rd.config.icnAttach,autoShow:false,defaults:{border:false},initComponent:function(){var e=this;var d=Ext.create("Ext.form.Panel",{border:false,layout:"fit",defaults:{anchor:"100%"},itemId:"scrnData",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:Rd.config.labelWidth,maxWidth:Rd.config.maxWidth,margin:Rd.config.fieldMargin},defaultType:"textfield",buttons:[{itemId:"saveAttach",text:i18n("sOK"),scale:"large",formBind:true,glyph:Rd.config.icnYes,margin:Rd.config.buttonMargin}],items:[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:false,tabPosition:"bottom",border:false,items:[{title:"Basic",layout:"anchor",glyph:Rd.config.icnStar,itemId:"tabRequired",defaults:{anchor:"100%"},autoScroll:true,items:[{itemId:"rem_unknown",xtype:"textfield",name:"rem_unknown",hidden:true,value:"rem_unknown"},{xtype:"textfield",fieldLabel:i18n("sMAC_address"),name:"mac",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq",vtype:"MacAddress",fieldStyle:"text-transform:lowercase",value:e.mac},{xtype:"textfield",fieldLabel:i18n("sName"),name:"name",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sDescription"),name:"description",allowBlank:true,labelClsExtra:"lblRd"},{xtype:"cmbApHardwareModels",labelClsExtra:"lblRdReq",allowBlank:false}]}]}]});e.items=d;Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winApAttachAp"],["component","box","container","panel","window","winApAttachAp"],{component:true,box:true,container:true,panel:true,window:true,winApAttachAp:true},["widget.winApAttachAp"],0,[Rd.view.aps,"winApAttachAp"],0));(Ext.cmd.derive("Rd.view.components.ajaxCheckbox",Ext.form.field.Checkbox,{url:null,initComponent:function(){var b=this;Ext.Ajax.request({url:b.url,method:"GET",success:b.configureCheckbox,scope:b});Ext.form.field.Checkbox.prototype.initComponent.apply(this,arguments)},configureCheckbox:function(g){var h=this;var e=Ext.JSON.decode(g.responseText);if(e.success){if(e.items.disabled==true){h.setDisabled(true)}else{h.setDisabled(false)}if(e.items.checked==true){h.setValue(true)}else{h.setValue(false)}}}},0,["ajaxCheckbox"],["component","box","field","checkboxfield","checkbox","ajaxCheckbox"],{component:true,box:true,field:true,checkboxfield:true,checkbox:true,ajaxCheckbox:true},["widget.ajaxCheckbox"],0,[Rd.view.components,"ajaxCheckbox"],0));(Ext.cmd.derive("Rd.view.components.cmbFinPaymentPlans",Ext.form.ComboBox,{fieldLabel:"Payment plan",labelSeparator:"",forceSelection:true,queryMode:"remote",valueField:"id",displayField:"name",typeAhead:true,allowBlank:false,mode:"local",name:"fin_payment_plan_id",labelClsExtra:"lblRd",extraParam:false,store:"sFinPaymentPlans",initComponent:function(){Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbFinPaymentPlans"],["component","box","field","textfield","pickerfield","combobox","combo","cmbFinPaymentPlans"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbFinPaymentPlans:true},["widget.cmbFinPaymentPlans"],0,[Rd.view.components,"cmbFinPaymentPlans"],0));(Ext.cmd.derive("Rd.view.globalTags.gridGlobalTags",Ext.grid.Panel,{multiSelect:true,store:"sGlobalTags",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},urlMenu:"/cake3/rd_cake/global-tags/menu-for-grid.json",plugins:"gridfilters",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"basic",text:"Basic"},{id:"medium",text:"Medium"},{id:"full",text:"Full"}]});d.bbar=[{xtype:"pagingtoolbar",store:d.store,dock:"bottom",displayInfo:true}];d.tbar=Ext.create("Rd.view.components.ajaxToolbar",{url:d.urlMenu});d.columns=[{xtype:"rownumberer",stateId:"StateGridGD1"},{text:i18n("sOwner"),dataIndex:"owner",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD2",hidden:true},{text:i18n("sName"),dataIndex:"name",tdCls:"gridMain",flex:1,filter:{type:"string"},stateId:"StateGridGD3"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD4"},{text:i18n("sComment"),dataIndex:"comment",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridGD5"},{text:i18n("sAvailable_to_sub_providers"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate("<tpl if='available_to_siblings == true'><div class=\"fieldGreen\">"+i18n("sYes")+"</div></tpl>","<tpl if='available_to_siblings == false'><div class=\"fieldRed\">"+i18n("sNo")+"</div></tpl>"),dataIndex:"available_to_siblings",filter:{type:"boolean",defaultValue:false,yesText:"Yes",noText:"No"},stateId:"StateGridGD5"},{text:"Protection Level",flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">Basic</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">Medium</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">Full</div></tpl>'),dataIndex:"protection_level",filter:{type:"list",store:e},stateId:"StateGridGD6"}];d.callParent(arguments)}},0,["gridGlobalTags"],["component","box","container","panel","tablepanel","gridpanel","grid","gridGlobalTags"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridGlobalTags:true},["widget.gridGlobalTags"],0,[Rd.view.globalTags,"gridGlobalTags"],0));(Ext.cmd.derive("Rd.view.i18n.vWinLanguagesEdit",Ext.window.Window,{closable:true,draggable:false,resizable:false,title:"Edit Languages",width:380,height:380,plain:true,border:false,layout:"card",iconCls:"edit",glyph:Rd.config.icnEdit,defaults:{border:false},initComponent:function(){var h=this;var e=h.mkScrnEditLanguage();var g=h.mkScrnEditLanguageDo();this.items=[e,g];Ext.window.Window.prototype.initComponent.apply(this,arguments)},mkScrnEditLanguage:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:"Select a language to edit",width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{xtype:"cmbJustLanguages"}],buttons:[{itemId:"btnEditLanguageNext",text:"Next",scale:"large",formBind:true,margin:"0 20 40 0",iconCls:"b-next",glyph:Rd.config.icnNext}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditLanguage",items:[g,h]});return e},mkScrnEditLanguageDo:function(){var g=Ext.create("Ext.container.Container",{border:false,baseCls:"regMsg",html:"Supply the following detail please",width:"100%"});var h=Ext.create("Ext.form.Panel",{border:false,layout:"anchor",width:"100%",flex:1,defaults:{anchor:"100%"},fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"top",labelSeparator:"",margin:15},defaultType:"textfield",items:[{name:"name",fieldLabel:"Language name",itemId:"inpNewCountry",allowBlank:false,emptyText:"language name",blankText:"Specify a valid name for the language",textValid:true,validator:function(){return this.textValid}},{name:"iso_code",fieldLabel:"ISO code",itemId:"inpNewIso",allowBlank:false,emptyText:"eg pt or de",blankText:"Specify a valid iso language code",textValid:true,validator:function(){return this.textValid}}],buttons:[{itemId:"btnEditLanguageDoPrev",text:"Prev",scale:"large",iconCls:"b-prev",glyph:Rd.config.icnBack,margin:"0 20 40 0"},{itemId:"btnEditLanguageDoNext",text:"Next",scale:"large",formBind:true,iconCls:"b-next",glyph:Rd.config.icnNext,action:"save",margin:"0 20 40 0"}]});var e=Ext.create("Ext.panel.Panel",{layout:"vbox",border:false,itemId:"scrnEditLanguageDo",items:[g,h]});return e}},0,["editLanguagesW"],["component","box","container","panel","window","editLanguagesW"],{component:true,box:true,container:true,panel:true,window:true,editLanguagesW:true},["widget.editLanguagesW"],0,[Rd.view.i18n,"vWinLanguagesEdit"],0));(Ext.cmd.derive("Rd.view.logViewer.pnlViewFile",Ext.panel.Panel,{html:"",autoScroll:true,autoCreate:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",iconCls:"b-clear",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),items:[{xtype:"button",iconCls:"b-start",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",iconCls:"b-stop",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",iconCls:"b-btn_info",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;b.callParent(arguments)}},0,["pnlViewFile"],["component","box","container","panel","pnlViewFile"],{component:true,box:true,container:true,panel:true,pnlViewFile:true},["widget.pnlViewFile"],0,[Rd.view.logViewer,"pnlViewFile"],0));(Ext.cmd.derive("Rd.view.logViewer.pnlViewFile",Ext.panel.Panel,{html:"",autoScroll:true,border:"5 5 5 5",bodyCls:"fileViewer",tbar:[{xtype:"buttongroup",title:i18n("sAction"),items:[{xtype:"button",glyph:Rd.config.icnClear,scale:"large",itemId:"clear",tooltip:i18n("sClear_screen")}]},{xtype:"buttongroup",title:i18n("sStart_fs_Stop"),width:200,items:[{xtype:"button",glyph:Rd.config.icnStart,scale:"large",itemId:"start",tooltip:i18n("sStart_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:true},{xtype:"button",glyph:Rd.config.icnStop,scale:"large",itemId:"stop",tooltip:i18n("sStop_FreeRADIUS"),toggleGroup:"start_stop",enableToggle:true,pressed:false},{xtype:"button",glyph:Rd.config.icnInfo,scale:"large",itemId:"info",tooltip:i18n("sFreeRADIUS_info")}]}],bbar:[{xtype:"component",itemId:"feedback",tpl:"{message}",style:"margin-right:5px",cls:"lblYfi"}],initComponent:function(){var b=this;Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlViewFile"],["component","box","container","panel","pnlViewFile"],{component:true,box:true,container:true,panel:true,pnlViewFile:true},["widget.pnlViewFile"],0,[Rd.view.logViewer,"pnlViewFile"],0));(Ext.cmd.derive("Rd.view.meshes.cmbCodec",Ext.form.ComboBox,{fieldLabel:"Codec1",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"codec1",labelClsExtra:"lblRd",value:"gsm",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"gsm",text:"gsm"},{id:"ulaw",text:"ulaw"},{id:"alaw",text:"alaw"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbCodec"],["component","box","field","textfield","pickerfield","combobox","combo","cmbCodec"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbCodec:true},["widget.cmbCodec"],0,[Rd.view.meshes,"cmbCodec"],0));(Ext.cmd.derive("Rd.view.meshes.cmbDialoutCode",Ext.form.ComboBox,{fieldLabel:"Dialout code",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"dialout",labelClsExtra:"lblRd",value:"#",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"#",text:"#"},{id:"9",text:"9"},{id:"0",text:"0"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbDialoutCode"],["component","box","field","textfield","pickerfield","combobox","combo","cmbDialoutCode"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbDialoutCode:true},["widget.cmbDialoutCode"],0,[Rd.view.meshes,"cmbDialoutCode"],0));(Ext.cmd.derive("Rd.view.meshes.cmbEntryPoints",Ext.form.ComboBox,{fieldLabel:i18n("sConnects_with"),labelSeparator:"",store:"sMeshEntryPoints",queryMode:"local",valueField:"id",displayField:"name",allowBlank:false,editable:false,mode:"local",itemId:"entry_points",name:"entry_points",value:"none",multiSelect:true,labelClsExtra:"lblRdReq"},0,["cmbEntryPoints"],["component","box","field","textfield","pickerfield","combobox","combo","cmbEntryPoints"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbEntryPoints:true},["widget.cmbEntryPoints"],0,[Rd.view.meshes,"cmbEntryPoints"],0));(Ext.cmd.derive("Rd.view.meshes.cmbSoftphoneSupport",Ext.form.ComboBox,{fieldLabel:"Softphone Support",labelSeparator:"",forceSelection:true,queryMode:"local",displayField:"text",valueField:"id",typeAhead:true,allowBlank:false,mode:"local",name:"softph",labelClsExtra:"lblRd",value:"OFF",initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"OFF",text:"Off"},{id:"CLIENT",text:"Client"},{id:"MASTER",text:"Master"}]});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbSoftphoneSupport"],["component","box","field","textfield","pickerfield","combobox","combo","cmbSoftphoneSupport"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbSoftphoneSupport:true},["widget.cmbSoftphoneSupport"],0,[Rd.view.meshes,"cmbSoftphoneSupport"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshEdit",Ext.window.Window,{width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"mesh",glyph:Rd.config.icnMeshEdit,animCollapse:false,border:false,isWindow:true,minimizable:true,maximizable:true,constrainHeader:true,layout:"border",stateful:true,autoShow:false,meshName:"",meshId:"",initComponent:function(){var b=this;b.items=[{region:"north",xtype:"pnlBanner",heading:b.title,image:"resources/images/48x48/mesh_edit.png"},{region:"center",xtype:"panel",layout:"fit",border:false,items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:i18n("sEntry_points"),itemId:"tabEntryPoints",xtype:"gridMeshEntries",meshId:b.meshId},{title:i18n("sMesh_settings"),itemId:"tabMeshSettings",xtype:"pnlMeshSettings",meshId:b.meshId},{title:i18n("sExit_points"),itemId:"tabExitPoints",xtype:"gridMeshExits",meshId:b.meshId},{title:i18n("sNode_settings"),itemId:"tabNodeCommonSettings",xtype:"pnlNodeCommonSettings",meshId:b.meshId},{title:i18n("sNodes"),itemId:"tabNodes",xtype:"gridNodes",meshId:b.meshId}]}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshEdit"],["component","box","container","panel","window","winMeshEdit"],{component:true,box:true,container:true,panel:true,window:true,winMeshEdit:true},["widget.winMeshEdit"],0,[Rd.view.meshes,"winMeshEdit"],0));(Ext.cmd.derive("Rd.view.meshes.winMeshView",Ext.window.Window,{width:Rd.config.winWidth,height:Rd.config.winHeight,iconCls:"mesh",glyph:Rd.config.icnView,animCollapse:false,border:false,isWindow:true,minimizable:true,maximizable:true,constrainHeader:true,layout:"border",stateful:true,autoShow:false,meshId:"",initComponent:function(){var b=this;b.items=[{region:"north",xtype:"pnlBanner",heading:b.title,image:"resources/images/48x48/mesh_view.png"},{region:"center",xtype:"panel",layout:"fit",border:false,items:[{xtype:"tabpanel",layout:"fit",margins:"0 0 0 0",border:false,plain:true,cls:"subTab",items:[{title:"Overview",itemId:"tabMeshViewOverwiew",xtype:"pnlMeshViewNodes",meshId:b.meshId},{title:"SSID &#8660; Device",itemId:"tabMeshViewEntries",xtype:"gridMeshViewEntries",meshId:b.meshId},{title:"Node &#8660; Device",itemId:"tabMeshViewNodes",xtype:"gridMeshViewNodes",meshId:b.meshId},{title:"Node &#8660; Nodes",itemId:"tabMeshViewNodeNodes",xtype:"gridMeshViewNodeNodes",meshId:b.meshId},{title:"Nodes",itemId:"tabMeshViewNodeDetails",xtype:"gridMeshViewNodeDetails",meshId:b.meshId}]}]}];Ext.window.Window.prototype.initComponent.apply(this,arguments)}},0,["winMeshView"],["component","box","container","panel","window","winMeshView"],{component:true,box:true,container:true,panel:true,window:true,winMeshView:true},["widget.winMeshView"],0,[Rd.view.meshes,"winMeshView"],0));(Ext.cmd.derive("Rd.view.nas.frmNasBasic",Ext.form.Panel,{border:false,layout:"fit",autoScroll:true,fieldDefaults:{msgTarget:"under",labelClsExtra:"lblRd",labelAlign:"left",labelSeparator:"",labelWidth:200,margin:15},buttons:[{itemId:"save",text:i18n("sOK"),scale:"large",iconCls:"b-btn_ok",glyph:Rd.config.icnYes,formBind:true,margin:"0 20 40 0"}],defaultType:"textfield",marginSize:5,initComponent:function(){var h=Ext.create("Ext.data.Store",{fields:["id","text"],data:[{id:"off",text:i18n("sOff")},{id:"ping",text:i18n("sPing")},{id:"heartbeat",text:i18n("sHeartbeat")}]});var g=Ext.create("Ext.form.ComboBox",{fieldLabel:i18n("sMonitor_method"),store:h,itemId:"monitorType",name:"monitor",queryMode:"local",displayField:"text",valueField:"id"});var e=this;e.items=[{xtype:"tabpanel",layout:"fit",xtype:"tabpanel",margins:"0 0 0 0",plain:true,tabPosition:"bottom",border:true,items:[{title:i18n("sRequired_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"nasname",xtype:"textfield",fieldLabel:i18n("sIP_Address"),name:"nasname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sName"),name:"shortname",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"},{xtype:"textfield",fieldLabel:i18n("sSecret"),name:"secret",allowBlank:false,blankText:i18n("sSupply_a_value"),labelClsExtra:"lblRdReq"}]},{title:i18n("sOptional_Info"),layout:"anchor",defaults:{anchor:"100%"},items:[{itemId:"type",xtype:"textfield",fieldLabel:i18n("sType"),name:"type",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sPorts"),name:"ports",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sCommunity"),name:"community",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sServer"),name:"server",labelClsExtra:"lblRd"},{xtype:"textareafield",grow:true,name:"description",fieldLabel:i18n("sDescription"),anchor:"100%",labelClsExtra:"lblRd"}]},{title:i18n("sMonitor_settings"),layout:"anchor",defaults:{anchor:"100%"},items:[g,{xtype:"numberfield",anchor:"100%",name:"heartbeat_dead_after",itemId:"heartbeat_dead_after",fieldLabel:i18n("sHeartbeat_is_dead_after"),value:300,maxValue:21600,minValue:300,hidden:true},{xtype:"numberfield",anchor:"100%",name:"ping_interval",itemId:"ping_interval",fieldLabel:i18n("sPing_interval"),value:300,maxValue:21600,minValue:300,hidden:true}]},{title:i18n("sMaps_info"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:i18n("sLongitude"),name:"lon",labelClsExtra:"lblRd"},{xtype:"textfield",fieldLabel:i18n("sLatitude"),name:"lat",labelClsExtra:"lblRd"},{xtype:"checkbox",boxLabel:i18n("sDispaly_on_public_maps"),name:"on_public_maps",inputValue:"on_public_maps",checked:false,cls:"lblRd",margin:e.marginSize}]},{title:i18n("sEnhancements"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",boxLabel:i18n("sRecord_authentication_requests"),name:"record_auth",inputValue:"record_auth",checked:false,cls:"lblRd",margin:e.marginSize},{xtype:"checkbox",boxLabel:i18n("sAuto_close_stale_sessions"),name:"session_auto_close",inputValue:"session_auto_close",checked:false,cls:"lblRd",margin:e.marginSize},{xtype:"numberfield",anchor:"100%",name:"session_dead_time",fieldLabel:i18n("sAuto_close_activation_time"),value:300,maxValue:21600,minValue:300,hidden:false}]}]}];Ext.form.Panel.prototype.initComponent.apply(this,arguments)}},0,["frmNasBasic"],["component","box","container","panel","form","frmNasBasic"],{component:true,box:true,container:true,panel:true,form:true,frmNasBasic:true},["widget.frmNasBasic"],0,[Rd.view.nas,"frmNasBasic"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicyFilters",Ext.form.ComboBox,{fieldLabel:"Filter",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"cmbFilter",name:"filter_id",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/filters/index-for-list.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicyFilters"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicyFilters"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicyFilters:true},["widget.cmbPolicyFilters"],0,[Rd.view.policies,"cmbPolicyFilters"],0));(Ext.cmd.derive("Rd.view.policies.cmbPolicySchedules",Ext.form.ComboBox,{fieldLabel:"Schedule",labelSeparator:"",queryMode:"local",valueField:"id",displayField:"name",editable:false,mode:"local",itemId:"cmbSchedule",name:"schedule_id",labelClsExtra:"lblRdReq",allowBlank:false,initComponent:function(){var d=this;var e=Ext.create("Ext.data.Store",{fields:[{name:"id",type:"int"},{name:"name",type:"string"}],proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/schedules/index-for-list.json",reader:{type:"json",rootProperty:"items",messageProperty:"message"}},autoLoad:true});d.store=e;Ext.form.field.ComboBox.prototype.initComponent.apply(this,arguments)}},0,["cmbPolicySchedules"],["component","box","field","textfield","pickerfield","combobox","combo","cmbPolicySchedules"],{component:true,box:true,field:true,textfield:true,pickerfield:true,combobox:true,combo:true,cmbPolicySchedules:true},["widget.cmbPolicySchedules"],0,[Rd.view.policies,"cmbPolicySchedules"],0));(Ext.cmd.derive("Rd.view.policies.gridPolicyTagSelection",Ext.grid.Panel,{multiSelect:true,store:"sPolicies",stateful:true,stateId:"StateGridGD",stateEvents:["groupclick","columnhide"],border:false,viewConfig:{loadMask:true},tbar:[{xtype:"button",glyph:Rd.config.icnReload,scale:"large",itemId:"reload",tooltip:i18n("sReload")},{xtype:"tbfill"}],columns:[{xtype:"rownumberer",stateId:"StateGridPTS1"},{text:i18n("sName"),flex:1,xtype:"templatecolumn",tpl:new Ext.XTemplate('<tpl if=\'protection_level == "basic"\'><div class="fieldGreen">{name}</div></tpl>','<tpl if=\'protection_level == "medium"\'><div class="fieldYellow">{name}</div></tpl>','<tpl if=\'protection_level == "full"\'><div class="fieldOrange">{name}</div></tpl>'),dataIndex:"name",filter:{type:"string"},stateId:"StateGridPTS3",tdCls:"gridTree"},{text:i18n("sDescription"),dataIndex:"description",tdCls:"gridTree",flex:1,filter:{type:"string"},stateId:"StateGridPTS4"},{xtype:"advCheckColumn",text:"Select",dataIndex:"selected",renderer:function(l,k,h){var j="x-",i=[j+"grid-checkheader"];if(l){i.push(j+"grid-checkheader-checked")}return'<div class="'+i.join(" ")+'">&#160;</div>'}}],initComponent:function(){var b=this;b.store=Ext.create(Ext.data.Store,{model:"Rd.model.mPolicyTagSelection",autoLoad:true,proxy:{type:"ajax",format:"json",batchActions:true,url:"/cake3/rd_cake/global-tags/index-for-policy.json",extraParams:{policy_id:b.policyId},reader:{type:"json",rootProperty:"items",messageProperty:"message"},api:{read:"/cake3/rd_cake/global-tags/index-for-policy.json",update:"/cake3/rd_cake/global-tags/edit-for-policy.json"}},listeners:{load:function(j,k,l,a,m){if(!a){Ext.ux.Toaster.msg(i18n("sError_encountered"),j.getProxy().getReader().rawData.message.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}},scope:this}});Ext.grid.Panel.prototype.initComponent.apply(this,arguments)}},0,["gridPolicyTagSelection"],["component","box","container","panel","tablepanel","gridpanel","grid","gridPolicyTagSelection"],{component:true,box:true,container:true,panel:true,tablepanel:true,gridpanel:true,grid:true,gridPolicyTagSelection:true},["widget.gridPolicyTagSelection"],0,[Rd.view.policies,"gridPolicyTagSelection"],0));(Ext.cmd.derive("Rd.view.policies.pnlPolicy",Ext.panel.Panel,{plain:true,initComponent:function(){var b=this;b.items=[];Ext.panel.Panel.prototype.initComponent.apply(this,arguments)}},0,["pnlPolicy"],["component","box","container","panel","pnlPolicy"],{component:true,box:true,container:true,panel:true,pnlPolicy:true},["widget.pnlPolicy"],0,[Rd.view.policies,"pnlPolicy"],0));Ext.define("Rd.Application",{extend:"Ext.app.Application",name:"Rd",controllers:["cStartup","cLogin"],dashboardData:null,languages:null,selLanguage:null,autoCreateViewport:true,init:function(){var d=this;if(document.getElementById("divSplash")){var e=document.getElementById("divSplash");e.parentNode.removeChild(e)}d.addUx();Ext.tip.QuickTipManager.init();Ext.state.Manager.setProvider(Ext.create("Ext.state.LocalStorageProvider"));d.applyVtypes();Ext.ariaWarn=Ext.emptyFn},launch:function(){var b=this;b.runAction("cStartup","Index")},runAction:function(a,k,l,n){var b=this;var m=b.getController(a);m.init(b);return m["action"+k](l,n)},setDashboardData:function(d){var e=this;e.dashboardData=d},getDashboardData:function(){var b=this;return b.dashboardData},setLanguages:function(d){var e=this;e.languages=d},getLanguages:function(d){var e=this;return e.languages},setSelLanguage:function(d){var e=this;e.selLanguage=d},getSelLanguage:function(d){var e=this;return e.selLanguage},applyVtypes:function(){Ext.apply(Ext.form.field.VTypes,{IPAddress:function(b){return(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/).test(b)},IPAddressText:i18n("sExample")+": 192.168.1.1",IPAddressMask:/[\d\.]/i,MacAddress:function(b){return(/^([a-fA-F0-9]{2}-){5}[a-fA-F0-9]{2}$/).test(b)},MacAddressMask:/[a-fA-F0-9\-]/,MacAddressText:i18n("sExample")+": 01-23-45-67-89-AB",DnsName:function(b){return(/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$/).test(b)},DnsNameText:i18n("This is not a valid DNS name"),PasswordMatch:function(k,l){var j=this;var b=l.up("form");var a=b.down("#password");if(a!=null){if(k!=a.getValue()){return false}else{return true}}return true},PasswordMatchText:i18n("sPasswords_does_not_match"),Numeric:function(){var b=/[0-9]/;return function(a){return b.test(a)}}(),NumericText:"Only numbers are allowed",NumericMask:/[0-9]/})},addUx:function(){Ext.namespace("Ext.ux");Ext.ux.Constants={msgWarn:4000,msgInfo:2000,msgError:8000,clsWarn:"warn",clsInfo:"info",clsError:"error"};Ext.ux.Toaster=function(){var e;var h=500;function g(b,a){return'<div class="msg"><h3>'+b+"</h3><p>"+a+"</p></div>"}return{msg:function(a,d,k,b){if(!e){e=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},false)}var l=Ext.DomHelper.append(e,g(a,d),true);if(k!==undefined){l.addCls(k)}if(b===undefined){b=h}l.on("click",function(){l.destroy()});l.hide();l.slideIn("t").ghost("t",{delay:b,remove:true})}}}();Ext.ux.formFail=function(e,d){console.log(d);switch(d.failureType){case Ext.form.action.Action.CLIENT_INVALID:Ext.ux.Toaster.msg("Failure","Form fields may not be submitted with invalid values",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);break;case Ext.form.action.Action.CONNECT_FAILURE:Ext.ux.Toaster.msg("Failure","Ajax communication failed",Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn);break;case Ext.form.action.Action.SERVER_INVALID:Ext.ux.Toaster.msg("Failure",d.result.message,Ext.ux.Constants.clsWarn,Ext.ux.Constants.msgWarn)}};Ext.ux.bytesToHuman=function(h){if((h==0)||(h==null)){return"0 kb"}var e=-1;var g=[" kb"," Mb"," Gb"," Tb","Pb","Eb","Zb","Yb"];do{h=h/1024;e++}while(h>=1024);return Math.max(h,0.1).toFixed(1)+g[e]};Ext.ux.secondsToHuman=function(k){var i=Math.floor(k/86400);var m=Math.floor((k%86400)/3600);var n=Math.floor(((k%86400)%3600)/60);var j=((k%86400)%3600)%60;return l(i,2)+":"+l(m,2)+":"+l(n,2)+":"+l(j,2);function l(b,a){return Array(Math.max(a-String(b).length+1,0)).join(0)+b}};Ext.ux.centsToHuman=function(b){return(b/100).toFixed(2)}},onAppUpdate:function(){Ext.Msg.confirm("Application Update","This application has an update, reload?",function(b){if(b==="yes"){window.location.reload()}})}});Ext.application({name:"Rd",extend:"Rd.Application"});
